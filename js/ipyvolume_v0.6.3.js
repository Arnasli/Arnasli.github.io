define(["@jupyter-widgets/base"],(function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://unpkg.com/ipyvolume@0.6.3/dist/",n(n.s=21)}([function(e,t,n){"use strict";function r(){}n.r(t),n.d(t,"WebGLRenderTargetCube",(function(){return fn})),n.d(t,"WebGLRenderTarget",(function(){return hn})),n.d(t,"WebGLRenderer",(function(){return go})),n.d(t,"ShaderLib",(function(){return An})),n.d(t,"UniformsLib",(function(){return Tn})),n.d(t,"UniformsUtils",(function(){return wn})),n.d(t,"ShaderChunk",(function(){return bn})),n.d(t,"FogExp2",(function(){return vo})),n.d(t,"Fog",(function(){return _o})),n.d(t,"Scene",(function(){return yo})),n.d(t,"Sprite",(function(){return Eo})),n.d(t,"LOD",(function(){return Mo})),n.d(t,"SkinnedMesh",(function(){return Ao})),n.d(t,"Skeleton",(function(){return So})),n.d(t,"Bone",(function(){return To})),n.d(t,"Mesh",(function(){return Sr})),n.d(t,"LineSegments",(function(){return Ro})),n.d(t,"LineLoop",(function(){return Po})),n.d(t,"Line",(function(){return Co})),n.d(t,"Points",(function(){return No})),n.d(t,"Group",(function(){return uo})),n.d(t,"VideoTexture",(function(){return Io})),n.d(t,"DataTexture",(function(){return dn})),n.d(t,"DataTexture3D",(function(){return kr})),n.d(t,"CompressedTexture",(function(){return Do})),n.d(t,"CubeTexture",(function(){return Ur})),n.d(t,"CanvasTexture",(function(){return zo})),n.d(t,"DepthTexture",(function(){return Uo})),n.d(t,"Texture",(function(){return un})),n.d(t,"CompressedTextureLoader",(function(){return ds})),n.d(t,"DataTextureLoader",(function(){return ps})),n.d(t,"CubeTextureLoader",(function(){return gs})),n.d(t,"TextureLoader",(function(){return vs})),n.d(t,"ObjectLoader",(function(){return Ec})),n.d(t,"MaterialLoader",(function(){return dc})),n.d(t,"BufferGeometryLoader",(function(){return pc})),n.d(t,"DefaultLoadingManager",(function(){return ls})),n.d(t,"LoadingManager",(function(){return us})),n.d(t,"JSONLoader",(function(){return wc})),n.d(t,"ImageLoader",(function(){return ms})),n.d(t,"ImageBitmapLoader",(function(){return Lc})),n.d(t,"FontLoader",(function(){return Oc})),n.d(t,"FileLoader",(function(){return fs})),n.d(t,"Loader",(function(){return xc})),n.d(t,"LoaderUtils",(function(){return bc})),n.d(t,"Cache",(function(){return cs})),n.d(t,"AudioLoader",(function(){return Vc})),n.d(t,"SpotLightShadow",(function(){return Vs})),n.d(t,"SpotLight",(function(){return Ws})),n.d(t,"PointLight",(function(){return qs})),n.d(t,"RectAreaLight",(function(){return $s})),n.d(t,"HemisphereLight",(function(){return Hs})),n.d(t,"DirectionalLightShadow",(function(){return Ys})),n.d(t,"DirectionalLight",(function(){return Zs})),n.d(t,"AmbientLight",(function(){return Js})),n.d(t,"LightShadow",(function(){return Gs})),n.d(t,"Light",(function(){return js})),n.d(t,"StereoCamera",(function(){return Wc})),n.d(t,"PerspectiveCamera",(function(){return ho})),n.d(t,"OrthographicCamera",(function(){return Xs})),n.d(t,"CubeCamera",(function(){return qc})),n.d(t,"ArrayCamera",(function(){return fo})),n.d(t,"Camera",(function(){return lo})),n.d(t,"AudioListener",(function(){return Xc})),n.d(t,"PositionalAudio",(function(){return Zc})),n.d(t,"AudioContext",(function(){return Gc})),n.d(t,"AudioAnalyser",(function(){return Jc})),n.d(t,"Audio",(function(){return Yc})),n.d(t,"VectorKeyframeTrack",(function(){return lc})),n.d(t,"StringKeyframeTrack",(function(){return uc})),n.d(t,"QuaternionKeyframeTrack",(function(){return cc})),n.d(t,"NumberKeyframeTrack",(function(){return ac})),n.d(t,"ColorKeyframeTrack",(function(){return oc})),n.d(t,"BooleanKeyframeTrack",(function(){return ic})),n.d(t,"PropertyMixer",(function(){return $c})),n.d(t,"PropertyBinding",(function(){return pu})),n.d(t,"KeyframeTrack",(function(){return rc})),n.d(t,"AnimationUtils",(function(){return Ks})),n.d(t,"AnimationObjectGroup",(function(){return mu})),n.d(t,"AnimationMixer",(function(){return vu})),n.d(t,"AnimationClip",(function(){return hc})),n.d(t,"Uniform",(function(){return _u})),n.d(t,"InstancedBufferGeometry",(function(){return yu})),n.d(t,"BufferGeometry",(function(){return nr})),n.d(t,"Geometry",(function(){return Hn})),n.d(t,"InterleavedBufferAttribute",(function(){return bo})),n.d(t,"InstancedInterleavedBuffer",(function(){return xu})),n.d(t,"InterleavedBuffer",(function(){return xo})),n.d(t,"InstancedBufferAttribute",(function(){return bu})),n.d(t,"Face3",(function(){return Rn})),n.d(t,"Object3D",(function(){return kn})),n.d(t,"Raycaster",(function(){return wu})),n.d(t,"Layers",(function(){return On})),n.d(t,"EventDispatcher",(function(){return r})),n.d(t,"Clock",(function(){return Su})),n.d(t,"QuaternionLinearInterpolant",(function(){return sc})),n.d(t,"LinearInterpolant",(function(){return tc})),n.d(t,"DiscreteInterpolant",(function(){return nc})),n.d(t,"CubicInterpolant",(function(){return ec})),n.d(t,"Interpolant",(function(){return Qs})),n.d(t,"Triangle",(function(){return Er})),n.d(t,"Math",(function(){return Zt})),n.d(t,"Spherical",(function(){return Tu})),n.d(t,"Cylindrical",(function(){return Au})),n.d(t,"Plane",(function(){return gn})),n.d(t,"Frustum",(function(){return vn})),n.d(t,"Sphere",(function(){return mn})),n.d(t,"Ray",(function(){return wr})),n.d(t,"Matrix4",(function(){return $t})),n.d(t,"Matrix3",(function(){return en})),n.d(t,"Box3",(function(){return pn})),n.d(t,"Box2",(function(){return Lu})),n.d(t,"Line3",(function(){return Cu})),n.d(t,"Euler",(function(){return Pn})),n.d(t,"Vector4",(function(){return ln})),n.d(t,"Vector3",(function(){return Qt})),n.d(t,"Vector2",(function(){return Jt})),n.d(t,"Quaternion",(function(){return Kt})),n.d(t,"Color",(function(){return Mn})),n.d(t,"ImmediateRenderObject",(function(){return Ru})),n.d(t,"VertexNormalsHelper",(function(){return Pu})),n.d(t,"SpotLightHelper",(function(){return Ou})),n.d(t,"SkeletonHelper",(function(){return Nu})),n.d(t,"PointLightHelper",(function(){return Iu})),n.d(t,"RectAreaLightHelper",(function(){return Du})),n.d(t,"HemisphereLightHelper",(function(){return zu})),n.d(t,"GridHelper",(function(){return Uu})),n.d(t,"PolarGridHelper",(function(){return ku})),n.d(t,"FaceNormalsHelper",(function(){return Fu})),n.d(t,"DirectionalLightHelper",(function(){return Bu})),n.d(t,"CameraHelper",(function(){return ju})),n.d(t,"BoxHelper",(function(){return Hu})),n.d(t,"Box3Helper",(function(){return Gu})),n.d(t,"PlaneHelper",(function(){return Vu})),n.d(t,"ArrowHelper",(function(){return Wu})),n.d(t,"AxesHelper",(function(){return qu})),n.d(t,"Shape",(function(){return Bs})),n.d(t,"Path",(function(){return Fs})),n.d(t,"ShapePath",(function(){return Cc})),n.d(t,"Font",(function(){return Rc})),n.d(t,"CurvePath",(function(){return ks})),n.d(t,"Curve",(function(){return _s})),n.d(t,"ImageUtils",(function(){return sn})),n.d(t,"ShapeUtils",(function(){return Sa})),n.d(t,"WebGLUtils",(function(){return co})),n.d(t,"WireframeGeometry",(function(){return ko})),n.d(t,"ParametricGeometry",(function(){return Fo})),n.d(t,"ParametricBufferGeometry",(function(){return Bo})),n.d(t,"TetrahedronGeometry",(function(){return Go})),n.d(t,"TetrahedronBufferGeometry",(function(){return Vo})),n.d(t,"OctahedronGeometry",(function(){return Wo})),n.d(t,"OctahedronBufferGeometry",(function(){return qo})),n.d(t,"IcosahedronGeometry",(function(){return Xo})),n.d(t,"IcosahedronBufferGeometry",(function(){return Yo})),n.d(t,"DodecahedronGeometry",(function(){return Zo})),n.d(t,"DodecahedronBufferGeometry",(function(){return Jo})),n.d(t,"PolyhedronGeometry",(function(){return jo})),n.d(t,"PolyhedronBufferGeometry",(function(){return Ho})),n.d(t,"TubeGeometry",(function(){return $o})),n.d(t,"TubeBufferGeometry",(function(){return Ko})),n.d(t,"TorusKnotGeometry",(function(){return Qo})),n.d(t,"TorusKnotBufferGeometry",(function(){return ea})),n.d(t,"TorusGeometry",(function(){return ta})),n.d(t,"TorusBufferGeometry",(function(){return na})),n.d(t,"TextGeometry",(function(){return Oa})),n.d(t,"TextBufferGeometry",(function(){return Na})),n.d(t,"SphereGeometry",(function(){return Ia})),n.d(t,"SphereBufferGeometry",(function(){return Da})),n.d(t,"RingGeometry",(function(){return za})),n.d(t,"RingBufferGeometry",(function(){return Ua})),n.d(t,"PlaneGeometry",(function(){return or})),n.d(t,"PlaneBufferGeometry",(function(){return ar})),n.d(t,"LatheGeometry",(function(){return ka})),n.d(t,"LatheBufferGeometry",(function(){return Fa})),n.d(t,"ShapeGeometry",(function(){return Ba})),n.d(t,"ShapeBufferGeometry",(function(){return ja})),n.d(t,"ExtrudeGeometry",(function(){return La})),n.d(t,"ExtrudeBufferGeometry",(function(){return Ca})),n.d(t,"EdgesGeometry",(function(){return Ga})),n.d(t,"ConeGeometry",(function(){return qa})),n.d(t,"ConeBufferGeometry",(function(){return Xa})),n.d(t,"CylinderGeometry",(function(){return Va})),n.d(t,"CylinderBufferGeometry",(function(){return Wa})),n.d(t,"CircleGeometry",(function(){return Ya})),n.d(t,"CircleBufferGeometry",(function(){return Za})),n.d(t,"BoxGeometry",(function(){return rr})),n.d(t,"BoxBufferGeometry",(function(){return ir})),n.d(t,"ShadowMaterial",(function(){return $a})),n.d(t,"SpriteMaterial",(function(){return wo})),n.d(t,"RawShaderMaterial",(function(){return Ka})),n.d(t,"ShaderMaterial",(function(){return br})),n.d(t,"PointsMaterial",(function(){return Oo})),n.d(t,"MeshPhysicalMaterial",(function(){return es})),n.d(t,"MeshStandardMaterial",(function(){return Qa})),n.d(t,"MeshPhongMaterial",(function(){return ts})),n.d(t,"MeshToonMaterial",(function(){return ns})),n.d(t,"MeshNormalMaterial",(function(){return rs})),n.d(t,"MeshLambertMaterial",(function(){return is})),n.d(t,"MeshDepthMaterial",(function(){return ro})),n.d(t,"MeshDistanceMaterial",(function(){return io})),n.d(t,"MeshBasicMaterial",(function(){return Mr})),n.d(t,"MeshMatcapMaterial",(function(){return os})),n.d(t,"LineDashedMaterial",(function(){return as})),n.d(t,"LineBasicMaterial",(function(){return Lo})),n.d(t,"Material",(function(){return xr})),n.d(t,"Float64BufferAttribute",(function(){return Kn})),n.d(t,"Float32BufferAttribute",(function(){return $n})),n.d(t,"Uint32BufferAttribute",(function(){return Jn})),n.d(t,"Int32BufferAttribute",(function(){return Zn})),n.d(t,"Uint16BufferAttribute",(function(){return Yn})),n.d(t,"Int16BufferAttribute",(function(){return Xn})),n.d(t,"Uint8ClampedBufferAttribute",(function(){return qn})),n.d(t,"Uint8BufferAttribute",(function(){return Wn})),n.d(t,"Int8BufferAttribute",(function(){return Vn})),n.d(t,"BufferAttribute",(function(){return Gn})),n.d(t,"ArcCurve",(function(){return xs})),n.d(t,"CatmullRomCurve3",(function(){return Ts})),n.d(t,"CubicBezierCurve",(function(){return Rs})),n.d(t,"CubicBezierCurve3",(function(){return Ps})),n.d(t,"EllipseCurve",(function(){return ys})),n.d(t,"LineCurve",(function(){return Os})),n.d(t,"LineCurve3",(function(){return Ns})),n.d(t,"QuadraticBezierCurve",(function(){return Is})),n.d(t,"QuadraticBezierCurve3",(function(){return Ds})),n.d(t,"SplineCurve",(function(){return zs})),n.d(t,"REVISION",(function(){return m})),n.d(t,"MOUSE",(function(){return g})),n.d(t,"CullFaceNone",(function(){return v})),n.d(t,"CullFaceBack",(function(){return _})),n.d(t,"CullFaceFront",(function(){return y})),n.d(t,"CullFaceFrontBack",(function(){return x})),n.d(t,"FrontFaceDirectionCW",(function(){return b})),n.d(t,"FrontFaceDirectionCCW",(function(){return w})),n.d(t,"BasicShadowMap",(function(){return E})),n.d(t,"PCFShadowMap",(function(){return M})),n.d(t,"PCFSoftShadowMap",(function(){return S})),n.d(t,"FrontSide",(function(){return T})),n.d(t,"BackSide",(function(){return A})),n.d(t,"DoubleSide",(function(){return L})),n.d(t,"FlatShading",(function(){return C})),n.d(t,"SmoothShading",(function(){return R})),n.d(t,"NoColors",(function(){return P})),n.d(t,"FaceColors",(function(){return O})),n.d(t,"VertexColors",(function(){return N})),n.d(t,"NoBlending",(function(){return I})),n.d(t,"NormalBlending",(function(){return D})),n.d(t,"AdditiveBlending",(function(){return z})),n.d(t,"SubtractiveBlending",(function(){return U})),n.d(t,"MultiplyBlending",(function(){return k})),n.d(t,"CustomBlending",(function(){return F})),n.d(t,"AddEquation",(function(){return B})),n.d(t,"SubtractEquation",(function(){return j})),n.d(t,"ReverseSubtractEquation",(function(){return H})),n.d(t,"MinEquation",(function(){return G})),n.d(t,"MaxEquation",(function(){return V})),n.d(t,"ZeroFactor",(function(){return W})),n.d(t,"OneFactor",(function(){return q})),n.d(t,"SrcColorFactor",(function(){return X})),n.d(t,"OneMinusSrcColorFactor",(function(){return Y})),n.d(t,"SrcAlphaFactor",(function(){return Z})),n.d(t,"OneMinusSrcAlphaFactor",(function(){return J})),n.d(t,"DstAlphaFactor",(function(){return $})),n.d(t,"OneMinusDstAlphaFactor",(function(){return K})),n.d(t,"DstColorFactor",(function(){return Q})),n.d(t,"OneMinusDstColorFactor",(function(){return ee})),n.d(t,"SrcAlphaSaturateFactor",(function(){return te})),n.d(t,"NeverDepth",(function(){return ne})),n.d(t,"AlwaysDepth",(function(){return re})),n.d(t,"LessDepth",(function(){return ie})),n.d(t,"LessEqualDepth",(function(){return oe})),n.d(t,"EqualDepth",(function(){return ae})),n.d(t,"GreaterEqualDepth",(function(){return se})),n.d(t,"GreaterDepth",(function(){return ce})),n.d(t,"NotEqualDepth",(function(){return ue})),n.d(t,"MultiplyOperation",(function(){return le})),n.d(t,"MixOperation",(function(){return he})),n.d(t,"AddOperation",(function(){return fe})),n.d(t,"NoToneMapping",(function(){return de})),n.d(t,"LinearToneMapping",(function(){return pe})),n.d(t,"ReinhardToneMapping",(function(){return me})),n.d(t,"Uncharted2ToneMapping",(function(){return ge})),n.d(t,"CineonToneMapping",(function(){return ve})),n.d(t,"UVMapping",(function(){return _e})),n.d(t,"CubeReflectionMapping",(function(){return ye})),n.d(t,"CubeRefractionMapping",(function(){return xe})),n.d(t,"EquirectangularReflectionMapping",(function(){return be})),n.d(t,"EquirectangularRefractionMapping",(function(){return we})),n.d(t,"SphericalReflectionMapping",(function(){return Ee})),n.d(t,"CubeUVReflectionMapping",(function(){return Me})),n.d(t,"CubeUVRefractionMapping",(function(){return Se})),n.d(t,"RepeatWrapping",(function(){return Te})),n.d(t,"ClampToEdgeWrapping",(function(){return Ae})),n.d(t,"MirroredRepeatWrapping",(function(){return Le})),n.d(t,"NearestFilter",(function(){return Ce})),n.d(t,"NearestMipMapNearestFilter",(function(){return Re})),n.d(t,"NearestMipMapLinearFilter",(function(){return Pe})),n.d(t,"LinearFilter",(function(){return Oe})),n.d(t,"LinearMipMapNearestFilter",(function(){return Ne})),n.d(t,"LinearMipMapLinearFilter",(function(){return Ie})),n.d(t,"UnsignedByteType",(function(){return De})),n.d(t,"ByteType",(function(){return ze})),n.d(t,"ShortType",(function(){return Ue})),n.d(t,"UnsignedShortType",(function(){return ke})),n.d(t,"IntType",(function(){return Fe})),n.d(t,"UnsignedIntType",(function(){return Be})),n.d(t,"FloatType",(function(){return je})),n.d(t,"HalfFloatType",(function(){return He})),n.d(t,"UnsignedShort4444Type",(function(){return Ge})),n.d(t,"UnsignedShort5551Type",(function(){return Ve})),n.d(t,"UnsignedShort565Type",(function(){return We})),n.d(t,"UnsignedInt248Type",(function(){return qe})),n.d(t,"AlphaFormat",(function(){return Xe})),n.d(t,"RGBFormat",(function(){return Ye})),n.d(t,"RGBAFormat",(function(){return Ze})),n.d(t,"LuminanceFormat",(function(){return Je})),n.d(t,"LuminanceAlphaFormat",(function(){return $e})),n.d(t,"RGBEFormat",(function(){return Ke})),n.d(t,"DepthFormat",(function(){return Qe})),n.d(t,"DepthStencilFormat",(function(){return et})),n.d(t,"RedFormat",(function(){return tt})),n.d(t,"RGB_S3TC_DXT1_Format",(function(){return nt})),n.d(t,"RGBA_S3TC_DXT1_Format",(function(){return rt})),n.d(t,"RGBA_S3TC_DXT3_Format",(function(){return it})),n.d(t,"RGBA_S3TC_DXT5_Format",(function(){return ot})),n.d(t,"RGB_PVRTC_4BPPV1_Format",(function(){return at})),n.d(t,"RGB_PVRTC_2BPPV1_Format",(function(){return st})),n.d(t,"RGBA_PVRTC_4BPPV1_Format",(function(){return ct})),n.d(t,"RGBA_PVRTC_2BPPV1_Format",(function(){return ut})),n.d(t,"RGB_ETC1_Format",(function(){return lt})),n.d(t,"RGBA_ASTC_4x4_Format",(function(){return ht})),n.d(t,"RGBA_ASTC_5x4_Format",(function(){return ft})),n.d(t,"RGBA_ASTC_5x5_Format",(function(){return dt})),n.d(t,"RGBA_ASTC_6x5_Format",(function(){return pt})),n.d(t,"RGBA_ASTC_6x6_Format",(function(){return mt})),n.d(t,"RGBA_ASTC_8x5_Format",(function(){return gt})),n.d(t,"RGBA_ASTC_8x6_Format",(function(){return vt})),n.d(t,"RGBA_ASTC_8x8_Format",(function(){return _t})),n.d(t,"RGBA_ASTC_10x5_Format",(function(){return yt})),n.d(t,"RGBA_ASTC_10x6_Format",(function(){return xt})),n.d(t,"RGBA_ASTC_10x8_Format",(function(){return bt})),n.d(t,"RGBA_ASTC_10x10_Format",(function(){return wt})),n.d(t,"RGBA_ASTC_12x10_Format",(function(){return Et})),n.d(t,"RGBA_ASTC_12x12_Format",(function(){return Mt})),n.d(t,"LoopOnce",(function(){return St})),n.d(t,"LoopRepeat",(function(){return Tt})),n.d(t,"LoopPingPong",(function(){return At})),n.d(t,"InterpolateDiscrete",(function(){return Lt})),n.d(t,"InterpolateLinear",(function(){return Ct})),n.d(t,"InterpolateSmooth",(function(){return Rt})),n.d(t,"ZeroCurvatureEnding",(function(){return Pt})),n.d(t,"ZeroSlopeEnding",(function(){return Ot})),n.d(t,"WrapAroundEnding",(function(){return Nt})),n.d(t,"TrianglesDrawMode",(function(){return It})),n.d(t,"TriangleStripDrawMode",(function(){return Dt})),n.d(t,"TriangleFanDrawMode",(function(){return zt})),n.d(t,"LinearEncoding",(function(){return Ut})),n.d(t,"sRGBEncoding",(function(){return kt})),n.d(t,"GammaEncoding",(function(){return Ft})),n.d(t,"RGBEEncoding",(function(){return Bt})),n.d(t,"LogLuvEncoding",(function(){return jt})),n.d(t,"RGBM7Encoding",(function(){return Ht})),n.d(t,"RGBM16Encoding",(function(){return Gt})),n.d(t,"RGBDEncoding",(function(){return Vt})),n.d(t,"BasicDepthPacking",(function(){return Wt})),n.d(t,"RGBADepthPacking",(function(){return qt})),n.d(t,"TangentSpaceNormalMap",(function(){return Xt})),n.d(t,"ObjectSpaceNormalMap",(function(){return Yt})),n.d(t,"CubeGeometry",(function(){return rr})),n.d(t,"Face4",(function(){return Xu})),n.d(t,"LineStrip",(function(){return Yu})),n.d(t,"LinePieces",(function(){return Zu})),n.d(t,"MeshFaceMaterial",(function(){return Ju})),n.d(t,"MultiMaterial",(function(){return $u})),n.d(t,"PointCloud",(function(){return Ku})),n.d(t,"Particle",(function(){return Qu})),n.d(t,"ParticleSystem",(function(){return el})),n.d(t,"PointCloudMaterial",(function(){return tl})),n.d(t,"ParticleBasicMaterial",(function(){return nl})),n.d(t,"ParticleSystemMaterial",(function(){return rl})),n.d(t,"Vertex",(function(){return il})),n.d(t,"DynamicBufferAttribute",(function(){return ol})),n.d(t,"Int8Attribute",(function(){return al})),n.d(t,"Uint8Attribute",(function(){return sl})),n.d(t,"Uint8ClampedAttribute",(function(){return cl})),n.d(t,"Int16Attribute",(function(){return ul})),n.d(t,"Uint16Attribute",(function(){return ll})),n.d(t,"Int32Attribute",(function(){return hl})),n.d(t,"Uint32Attribute",(function(){return fl})),n.d(t,"Float32Attribute",(function(){return dl})),n.d(t,"Float64Attribute",(function(){return pl})),n.d(t,"ClosedSplineCurve3",(function(){return ml})),n.d(t,"SplineCurve3",(function(){return gl})),n.d(t,"Spline",(function(){return vl})),n.d(t,"AxisHelper",(function(){return _l})),n.d(t,"BoundingBoxHelper",(function(){return yl})),n.d(t,"EdgesHelper",(function(){return xl})),n.d(t,"WireframeHelper",(function(){return bl})),n.d(t,"XHRLoader",(function(){return wl})),n.d(t,"BinaryTextureLoader",(function(){return El})),n.d(t,"GeometryUtils",(function(){return Ml})),n.d(t,"Projector",(function(){return Sl})),n.d(t,"CanvasRenderer",(function(){return Tl})),n.d(t,"SceneUtils",(function(){return Al})),n.d(t,"LensFlare",(function(){return Ll})),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}),Object.assign(r.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});var i,o,a,s,c,u,l,h,f,d,p,m="97",g={LEFT:0,MIDDLE:1,RIGHT:2},v=0,_=1,y=2,x=3,b=0,w=1,E=0,M=1,S=2,T=0,A=1,L=2,C=1,R=2,P=0,O=1,N=2,I=0,D=1,z=2,U=3,k=4,F=5,B=100,j=101,H=102,G=103,V=104,W=200,q=201,X=202,Y=203,Z=204,J=205,$=206,K=207,Q=208,ee=209,te=210,ne=0,re=1,ie=2,oe=3,ae=4,se=5,ce=6,ue=7,le=0,he=1,fe=2,de=0,pe=1,me=2,ge=3,ve=4,_e=300,ye=301,xe=302,be=303,we=304,Ee=305,Me=306,Se=307,Te=1e3,Ae=1001,Le=1002,Ce=1003,Re=1004,Pe=1005,Oe=1006,Ne=1007,Ie=1008,De=1009,ze=1010,Ue=1011,ke=1012,Fe=1013,Be=1014,je=1015,He=1016,Ge=1017,Ve=1018,We=1019,qe=1020,Xe=1021,Ye=1022,Ze=1023,Je=1024,$e=1025,Ke=Ze,Qe=1026,et=1027,tt=1028,nt=33776,rt=33777,it=33778,ot=33779,at=35840,st=35841,ct=35842,ut=35843,lt=36196,ht=37808,ft=37809,dt=37810,pt=37811,mt=37812,gt=37813,vt=37814,_t=37815,yt=37816,xt=37817,bt=37818,wt=37819,Et=37820,Mt=37821,St=2200,Tt=2201,At=2202,Lt=2300,Ct=2301,Rt=2302,Pt=2400,Ot=2401,Nt=2402,It=0,Dt=1,zt=2,Ut=3e3,kt=3001,Ft=3007,Bt=3002,jt=3003,Ht=3004,Gt=3005,Vt=3006,Wt=3200,qt=3201,Xt=0,Yt=1,Zt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&r|128]+e[r>>8&255]+"-"+e[r>>16&255]+e[r>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Zt.DEG2RAD},radToDeg:function(e){return e*Zt.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function Jt(e,t){this.x=e||0,this.y=t||0}function $t(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Kt(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}function Qt(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function en(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Jt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Jt.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:(i=new Jt,o=new Jt,function(e,t){return i.set(e,e),o.set(t,t),this.clamp(i,o)}),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}}),Object.assign($t.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,o,a,s,c,u,l,h,f,d,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=c,g[6]=u,g[10]=l,g[14]=h,g[3]=f,g[7]=d,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new $t).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:(d=new Qt,function(e){var t=this.elements,n=e.elements,r=1/d.setFromMatrixColumn(e,0).length(),i=1/d.setFromMatrixColumn(e,1).length(),o=1/d.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),c=Math.sin(r),u=Math.cos(i),l=Math.sin(i);if("XYZ"===e.order){var h=o*u,f=o*l,d=a*u,p=a*l;t[0]=s*u,t[4]=-s*l,t[8]=c,t[1]=f+d*c,t[5]=h-p*c,t[9]=-a*s,t[2]=p-h*c,t[6]=d+f*c,t[10]=o*s}else if("YXZ"===e.order){var m=s*u,g=s*l,v=c*u,_=c*l;t[0]=m+_*a,t[4]=v*a-g,t[8]=o*c,t[1]=o*l,t[5]=o*u,t[9]=-a,t[2]=g*a-v,t[6]=_+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*u,g=s*l,v=c*u,_=c*l;t[0]=m-_*a,t[4]=-o*l,t[8]=v+g*a,t[1]=g+v*a,t[5]=o*u,t[9]=_-m*a,t[2]=-o*c,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){h=o*u,f=o*l,d=a*u,p=a*l;t[0]=s*u,t[4]=d*c-f,t[8]=h*c+p,t[1]=s*l,t[5]=p*c+h,t[9]=f*c-d,t[2]=-c,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var y=o*s,x=o*c,b=a*s,w=a*c;t[0]=s*u,t[4]=w-y*l,t[8]=b*l+x,t[1]=l,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=x*l+b,t[10]=y-w*l}else if("XZY"===e.order){y=o*s,x=o*c,b=a*s,w=a*c;t[0]=s*u,t[4]=-l,t[8]=c*u,t[1]=y*l+w,t[5]=o*u,t[9]=x*l-b,t[2]=b*l-x,t[6]=a*u,t[10]=w*l+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:(h=new Qt(0,0,0),f=new Qt(1,1,1),function(e){return this.compose(h,e,f)}),lookAt:(c=new Qt,u=new Qt,l=new Qt,function(e,t,n){var r=this.elements;return l.subVectors(e,t),0===l.lengthSq()&&(l.z=1),l.normalize(),c.crossVectors(n,l),0===c.lengthSq()&&(1===Math.abs(n.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),c.crossVectors(n,l)),c.normalize(),u.crossVectors(l,c),r[0]=c.x,r[4]=u.x,r[8]=l.x,r[1]=c.y,r[5]=u.y,r[9]=l.y,r[2]=c.z,r[6]=u.z,r[10]=l.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],c=n[12],u=n[1],l=n[5],h=n[9],f=n[13],d=n[2],p=n[6],m=n[10],g=n[14],v=n[3],_=n[7],y=n[11],x=n[15],b=r[0],w=r[4],E=r[8],M=r[12],S=r[1],T=r[5],A=r[9],L=r[13],C=r[2],R=r[6],P=r[10],O=r[14],N=r[3],I=r[7],D=r[11],z=r[15];return i[0]=o*b+a*S+s*C+c*N,i[4]=o*w+a*T+s*R+c*I,i[8]=o*E+a*A+s*P+c*D,i[12]=o*M+a*L+s*O+c*z,i[1]=u*b+l*S+h*C+f*N,i[5]=u*w+l*T+h*R+f*I,i[9]=u*E+l*A+h*P+f*D,i[13]=u*M+l*L+h*O+f*z,i[2]=d*b+p*S+m*C+g*N,i[6]=d*w+p*T+m*R+g*I,i[10]=d*E+p*A+m*P+g*D,i[14]=d*M+p*L+m*O+g*z,i[3]=v*b+_*S+y*C+x*N,i[7]=v*w+_*T+y*R+x*I,i[11]=v*E+_*A+y*P+x*D,i[15]=v*M+_*L+y*O+x*z,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new Qt;return function(t){for(var n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix4(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],c=e[13],u=e[2],l=e[6],h=e[10],f=e[14];return e[3]*(+i*s*l-r*c*l-i*a*h+n*c*h+r*a*f-n*s*f)+e[7]*(+t*s*f-t*c*h+i*o*h-r*o*f+r*c*u-i*s*u)+e[11]*(+t*c*l-t*a*f-i*o*l+n*o*f+i*a*u-n*c*u)+e[15]*(-r*a*u-t*s*l+t*a*h+r*o*l-n*o*h+n*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],o=r[1],a=r[2],s=r[3],c=r[4],u=r[5],l=r[6],h=r[7],f=r[8],d=r[9],p=r[10],m=r[11],g=r[12],v=r[13],_=r[14],y=r[15],x=d*_*h-v*p*h+v*l*m-u*_*m-d*l*y+u*p*y,b=g*p*h-f*_*h-g*l*m+c*_*m+f*l*y-c*p*y,w=f*v*h-g*d*h+g*u*m-c*v*m-f*u*y+c*d*y,E=g*d*l-f*v*l-g*u*p+c*v*p+f*u*_-c*d*_,M=i*x+o*b+a*w+s*E;if(0===M){var S="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(S);return console.warn(S),this.identity()}var T=1/M;return n[0]=x*T,n[1]=(v*p*s-d*_*s-v*a*m+o*_*m+d*a*y-o*p*y)*T,n[2]=(u*_*s-v*l*s+v*a*h-o*_*h-u*a*y+o*l*y)*T,n[3]=(d*l*s-u*p*s-d*a*h+o*p*h+u*a*m-o*l*m)*T,n[4]=b*T,n[5]=(f*_*s-g*p*s+g*a*m-i*_*m-f*a*y+i*p*y)*T,n[6]=(g*l*s-c*_*s-g*a*h+i*_*h+c*a*y-i*l*y)*T,n[7]=(c*p*s-f*l*s+f*a*h-i*p*h-c*a*m+i*l*m)*T,n[8]=w*T,n[9]=(g*d*s-f*v*s-g*o*m+i*v*m+f*o*y-i*d*y)*T,n[10]=(c*v*s-g*u*s+g*o*h-i*v*h-c*o*y+i*u*y)*T,n[11]=(f*u*s-c*d*s-f*o*h+i*d*h+c*o*m-i*u*m)*T,n[12]=E*T,n[13]=(f*v*a-g*d*a+g*o*p-i*v*p-f*o*_+i*d*_)*T,n[14]=(g*u*a-c*v*a-g*o*l+i*v*l+c*o*_-i*u*_)*T,n[15]=(c*d*a-f*u*a+f*o*l-i*d*l-c*o*p+i*u*p)*T,this},scale:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z,c=i*o,u=i*a;return this.set(c*o+n,c*a-r*s,c*s+r*a,0,c*a+r*s,u*a+n,u*s-r*o,0,c*s-r*a,u*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,c=i+i,u=o+o,l=a+a,h=i*c,f=i*u,d=i*l,p=o*u,m=o*l,g=a*l,v=s*c,_=s*u,y=s*l,x=n.x,b=n.y,w=n.z;return r[0]=(1-(p+g))*x,r[1]=(f+y)*x,r[2]=(d-_)*x,r[3]=0,r[4]=(f-y)*b,r[5]=(1-(h+g))*b,r[6]=(m+v)*b,r[7]=0,r[8]=(d+_)*w,r[9]=(m-v)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:(a=new Qt,s=new $t,function(e,t,n){var r=this.elements,i=a.set(r[0],r[1],r[2]).length(),o=a.set(r[4],r[5],r[6]).length(),c=a.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],s.copy(this);var u=1/i,l=1/o,h=1/c;return s.elements[0]*=u,s.elements[1]*=u,s.elements[2]*=u,s.elements[4]*=l,s.elements[5]*=l,s.elements[6]*=l,s.elements[8]*=h,s.elements[9]*=h,s.elements[10]*=h,t.setFromRotationMatrix(s),n.x=i,n.y=o,n.z=c,this}),makePerspective:function(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),c=2*i/(n-r),u=(t+e)/(t-e),l=(n+r)/(n-r),h=-(o+i)/(o-i),f=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),c=1/(n-r),u=1/(o-i),l=(t+e)*s,h=(n+r)*c,f=(o+i)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}),Object.assign(Kt,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,o,a){var s=n[r+0],c=n[r+1],u=n[r+2],l=n[r+3],h=i[o+0],f=i[o+1],d=i[o+2],p=i[o+3];if(l!==p||s!==h||c!==f||u!==d){var m=1-a,g=s*h+c*f+u*d+l*p,v=g>=0?1:-1,_=1-g*g;if(_>Number.EPSILON){var y=Math.sqrt(_),x=Math.atan2(y,g*v);m=Math.sin(m*x)/y,a=Math.sin(a*x)/y}var b=a*v;if(s=s*m+h*b,c=c*m+f*b,u=u*m+d*b,l=l*m+p*b,m===1-a){var w=1/Math.sqrt(s*s+c*c+u*u+l*l);s*=w,c*=w,u*=w,l*=w}}e[t]=s,e[t+1]=c,e[t+2]=u,e[t+3]=l}}),Object.defineProperties(Kt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Kt.prototype,{isQuaternion:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,c=a(n/2),u=a(r/2),l=a(i/2),h=s(n/2),f=s(r/2),d=s(i/2);return"XYZ"===o?(this._x=h*u*l+c*f*d,this._y=c*f*l-h*u*d,this._z=c*u*d+h*f*l,this._w=c*u*l-h*f*d):"YXZ"===o?(this._x=h*u*l+c*f*d,this._y=c*f*l-h*u*d,this._z=c*u*d-h*f*l,this._w=c*u*l+h*f*d):"ZXY"===o?(this._x=h*u*l-c*f*d,this._y=c*f*l+h*u*d,this._z=c*u*d+h*f*l,this._w=c*u*l-h*f*d):"ZYX"===o?(this._x=h*u*l-c*f*d,this._y=c*f*l+h*u*d,this._z=c*u*d-h*f*l,this._w=c*u*l+h*f*d):"YZX"===o?(this._x=h*u*l+c*f*d,this._y=c*f*l+h*u*d,this._z=c*u*d-h*f*l,this._w=c*u*l-h*f*d):"XZY"===o&&(this._x=h*u*l-c*f*d,this._y=c*f*l-h*u*d,this._z=c*u*d+h*f*l,this._w=c*u*l+h*f*d),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],c=n[9],u=n[2],l=n[6],h=n[10],f=r+s+h;return f>0?(t=.5/Math.sqrt(f+1),this._w=.25/t,this._x=(l-c)*t,this._y=(o-u)*t,this._z=(a-i)*t):r>s&&r>h?(t=2*Math.sqrt(1+r-s-h),this._w=(l-c)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+u)/t):s>h?(t=2*Math.sqrt(1+s-r-h),this._w=(o-u)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(c+l)/t):(t=2*Math.sqrt(1+h-r-s),this._w=(a-i)/t,this._x=(o+u)/t,this._y=(c+l)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t=new Qt;return function(n,r){return void 0===t&&(t=new Qt),(e=n.dot(r)+1)<1e-6?(e=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,r),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),angleTo:function(e){return 2*Math.acos(Math.abs(Zt.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y,c=t._z,u=t._w;return this._x=n*u+o*a+r*c-i*s,this._y=r*u+o*s+i*a-n*c,this._z=i*u+o*c+n*s-r*a,this._w=o*u-n*a-r*s-i*c,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var c=1-t;return this._w=c*o+t*this._w,this._x=c*n+t*this._x,this._y=c*r+t*this._y,this._z=c*i+t*this._z,this.normalize()}var u=Math.sqrt(s),l=Math.atan2(u,a),h=Math.sin((1-t)*l)/u,f=Math.sin(t*l)/u;return this._w=o*h+this._w*f,this._x=n*h+this._x*f,this._y=r*h+this._y*f,this._z=i*h+this._z*f,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Qt.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(p=new Kt,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(p.setFromEuler(e))}),applyAxisAngle:function(){var e=new Kt;return function(t,n){return this.applyQuaternion(e.setFromAxisAngle(t,n))}}(),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,c=s*t+o*r-a*n,u=s*n+a*t-i*r,l=s*r+i*n-o*t,h=-i*t-o*n-a*r;return this.x=c*s+h*-i+u*-a-l*-o,this.y=u*s+h*-o+l*-i-c*-a,this.z=l*s+h*-a+c*-o-u*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(){var e=new $t;return function(t){return this.applyMatrix4(e.getInverse(t.projectionMatrix)).applyMatrix4(t.matrixWorld)}}(),transformDirection:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new Qt,t=new Qt;return function(n,r){return e.set(n,n,n),t.set(r,r,r),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new Qt;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new Qt;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Zt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(en.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,o,a,s,c){var u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=i,u[5]=s,u[6]=n,u[7]=o,u[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new Qt;return function(t){for(var n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix3(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[3],s=n[6],c=n[1],u=n[4],l=n[7],h=n[2],f=n[5],d=n[8],p=r[0],m=r[3],g=r[6],v=r[1],_=r[4],y=r[7],x=r[2],b=r[5],w=r[8];return i[0]=o*p+a*v+s*x,i[3]=o*m+a*_+s*b,i[6]=o*g+a*y+s*w,i[1]=c*p+u*v+l*x,i[4]=c*m+u*_+l*b,i[7]=c*g+u*y+l*w,i[2]=h*p+f*v+d*x,i[5]=h*m+f*_+d*b,i[8]=h*g+f*y+d*w,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-n*i*u+n*a*s+r*i*c-r*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],c=n[4],u=n[5],l=n[6],h=n[7],f=n[8],d=f*c-u*h,p=u*l-f*s,m=h*s-c*l,g=i*d+o*p+a*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var _=1/g;return r[0]=d*_,r[1]=(a*h-f*o)*_,r[2]=(u*o-a*c)*_,r[3]=p*_,r[4]=(f*i-a*l)*_,r[5]=(a*s-u*i)*_,r[6]=m*_,r[7]=(o*l-h*i)*_,r[8]=(c*i-o*s)*_,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,o,a){var s=Math.cos(i),c=Math.sin(i);this.set(n*s,n*c,-n*(s*o+c*a)+o+e,-r*c,r*s,-r*(-c*o+s*a)+a+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],c=r[4],u=r[7];return r[0]=t*i+n*s,r[3]=t*o+n*c,r[6]=t*a+n*u,r[1]=-n*i+t*s,r[4]=-n*o+t*c,r[7]=-n*a+t*u,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var tn,nn,rn,on,an,sn={getDataURL:function(e){var t;if(e instanceof HTMLCanvasElement)t=e;else{(t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=e.width,t.height=e.height;var n=t.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height)}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},cn=0;function un(e,t,n,r,i,o,a,s,c,u){Object.defineProperty(this,"id",{value:cn++}),this.uuid=Zt.generateUUID(),this.name="",this.image=void 0!==e?e:un.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:un.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:Ae,this.wrapT=void 0!==r?r:Ae,this.magFilter=void 0!==i?i:Oe,this.minFilter=void 0!==o?o:Ie,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:Ze,this.type=void 0!==s?s:De,this.offset=new Jt(0,0),this.repeat=new Jt(1,1),this.center=new Jt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new en,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:Ut,this.version=0,this.onUpdate=null}function ln(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1}function hn(e,t,n){this.width=e,this.height=t,this.scissor=new ln(0,0,e,t),this.scissorTest=!1,this.viewport=new ln(0,0,e,t),void 0===(n=n||{}).minFilter&&(n.minFilter=Oe),this.texture=new un(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.generateMipmaps=void 0===n.generateMipmaps||n.generateMipmaps,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function fn(e,t,n){hn.call(this,e,t,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function dn(e,t,n,r,i,o,a,s,c,u,l,h){un.call(this,null,o,a,s,c,u,r,i,l,h),this.image={data:e,width:t,height:n},this.magFilter=void 0!==c?c:Ce,this.minFilter=void 0!==u?u:Ce,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function pn(e,t){this.min=void 0!==e?e:new Qt(1/0,1/0,1/0),this.max=void 0!==t?t:new Qt(-1/0,-1/0,-1/0)}function mn(e,t){this.center=void 0!==e?e:new Qt,this.radius=void 0!==t?t:0}function gn(e,t){this.normal=void 0!==e?e:new Qt(1,0,0),this.constant=void 0!==t?t:0}function vn(e,t,n,r,i,o){this.planes=[void 0!==e?e:new gn,void 0!==t?t:new gn,void 0!==n?n:new gn,void 0!==r?r:new gn,void 0!==i?i:new gn,void 0!==o?o:new gn]}un.DEFAULT_IMAGE=void 0,un.DEFAULT_MAPPING=_e,un.prototype=Object.assign(Object.create(r.prototype),{constructor:un,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=Zt.generateUUID()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)i.push(sn.getDataURL(r[o]))}else i=sn.getDataURL(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==_e)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Te:e.x=e.x-Math.floor(e.x);break;case Ae:e.x=e.x<0?0:1;break;case Le:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Te:e.y=e.y-Math.floor(e.y);break;case Ae:e.y=e.y<0?0:1;break;case Le:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(un.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ln.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,i,o=e.elements,a=o[0],s=o[4],c=o[8],u=o[1],l=o[5],h=o[9],f=o[2],d=o[6],p=o[10];if(Math.abs(s-u)<.01&&Math.abs(c-f)<.01&&Math.abs(h-d)<.01){if(Math.abs(s+u)<.1&&Math.abs(c+f)<.1&&Math.abs(h+d)<.1&&Math.abs(a+l+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,g=(l+1)/2,v=(p+1)/2,_=(s+u)/4,y=(c+f)/4,x=(h+d)/4;return m>g&&m>v?m<.01?(n=0,r=.707106781,i=.707106781):(r=_/(n=Math.sqrt(m)),i=y/n):g>v?g<.01?(n=.707106781,r=0,i=.707106781):(n=_/(r=Math.sqrt(g)),i=x/r):v<.01?(n=.707106781,r=.707106781,i=0):(n=y/(i=Math.sqrt(v)),r=x/i),this.set(n,r,i,t),this}var b=Math.sqrt((d-h)*(d-h)+(c-f)*(c-f)+(u-s)*(u-s));return Math.abs(b)<.001&&(b=1),this.x=(d-h)/b,this.y=(c-f)/b,this.z=(u-s)/b,this.w=Math.acos((a+l+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(n,r){return void 0===e&&(e=new ln,t=new ln),e.set(n,n,n,n),t.set(r,r,r,r),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),hn.prototype=Object.assign(Object.create(r.prototype),{constructor:hn,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),fn.prototype=Object.create(hn.prototype),fn.prototype.constructor=fn,fn.prototype.isWebGLRenderTargetCube=!0,dn.prototype=Object.create(un.prototype),dn.prototype.constructor=dn,dn.prototype.isDataTexture=!0,Object.assign(pn.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.length;s<c;s+=3){var u=e[s],l=e[s+1],h=e[s+2];u<t&&(t=u),l<n&&(n=l),h<r&&(r=h),u>i&&(i=u),l>o&&(o=l),h>a&&(a=h)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.count;s<c;s++){var u=e.getX(s),l=e.getY(s),h=e.getZ(s);u<t&&(t=u),l<n&&(n=l),h<r&&(r=h),u>i&&(i=u),l>o&&(o=l),h>a&&(a=h)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Qt;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Qt),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Qt),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,n,r=new Qt;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(t=0,n=a.length;t<n;t++)r.copy(a[t]),r.applyMatrix4(i.matrixWorld),e.expandByPoint(r)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(t=0,n=s.count;t<n;t++)r.fromBufferAttribute(s,t).applyMatrix4(i.matrixWorld),e.expandByPoint(r)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(i),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Qt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:(nn=new Qt,function(e){return this.clampPoint(e.center,nn),nn.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(){var e=new Qt,t=new Qt,n=new Qt,r=new Qt,i=new Qt,o=new Qt,a=new Qt,s=new Qt,c=new Qt,u=new Qt;function l(r){var i,o;for(i=0,o=r.length-3;i<=o;i+=3){a.fromArray(r,i);var s=c.x*Math.abs(a.x)+c.y*Math.abs(a.y)+c.z*Math.abs(a.z),u=e.dot(a),l=t.dot(a),h=n.dot(a);if(Math.max(-Math.max(u,l,h),Math.min(u,l,h))>s)return!1}return!0}return function(a){if(this.isEmpty())return!1;this.getCenter(s),c.subVectors(this.max,s),e.subVectors(a.a,s),t.subVectors(a.b,s),n.subVectors(a.c,s),r.subVectors(t,e),i.subVectors(n,t),o.subVectors(e,n);var h=[0,-r.z,r.y,0,-i.z,i.y,0,-o.z,o.y,r.z,0,-r.x,i.z,0,-i.x,o.z,0,-o.x,-r.y,r.x,0,-i.y,i.x,0,-o.y,o.x,0];return!!l(h)&&(!!l(h=[1,0,0,0,1,0,0,0,1])&&(u.crossVectors(r,i),l(h=[u.x,u.y,u.z])))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Qt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Qt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new Qt;return function(t){return void 0===t&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),t=new mn),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(tn=[new Qt,new Qt,new Qt,new Qt,new Qt,new Qt,new Qt,new Qt],function(e){return this.isEmpty()?this:(tn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),tn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),tn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),tn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),tn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),tn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),tn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),tn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(tn),this)}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(mn.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(rn=new pn,function(e,t){var n=this.center;void 0!==t?n.copy(t):rn.setFromPoints(e).getCenter(n);for(var r=0,i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Qt),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new pn),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(gn.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new Qt,t=new Qt;return function(n,r,i){var o=e.subVectors(i,r).cross(t.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Qt),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new Qt;return function(t,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new Qt);var r=t.delta(e),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:n.copy(r).multiplyScalar(o).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Qt),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new Qt,t=new en;return function(n,r){var i=r||t.getNormalMatrix(n),o=this.coplanarPoint(e).applyMatrix4(n),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(vn.prototype,{set:function(e,t,n,r,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],c=n[5],u=n[6],l=n[7],h=n[8],f=n[9],d=n[10],p=n[11],m=n[12],g=n[13],v=n[14],_=n[15];return t[0].setComponents(a-r,l-s,p-h,_-m).normalize(),t[1].setComponents(a+r,l+s,p+h,_+m).normalize(),t[2].setComponents(a+i,l+c,p+f,_+g).normalize(),t[3].setComponents(a-i,l-c,p-f,_-g).normalize(),t[4].setComponents(a-o,l-u,p-d,_-v).normalize(),t[5].setComponents(a+o,l+u,p+d,_+v).normalize(),this},intersectsObject:(an=new mn,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),an.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(an)}),intersectsSprite:function(){var e=new mn;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:(on=new Qt,function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(on.x=r.normal.x>0?e.max.x:e.min.x,on.y=r.normal.y>0?e.max.y:e.min.y,on.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(on)<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var _n,yn,xn,bn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif\n",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif\n",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n}\n",background_vert:"varying vec2 vUv;\nvoid main() {\n\tvUv = uv;\n\tgl_Position = vec4( position, 1.0 );\n\tgl_Position.z = 1.0;\n}\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\tvec4 matcapColor = texture2D( matcap, uv );\n\tmatcapColor = matcapTexelToLinear( matcapColor );\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n"},wn={merge:function(e){for(var t={},n=0;n<e.length;n++){var r=this.clone(e[n]);for(var i in r)t[i]=r[i]}return t},clone:function(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}},En={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Mn(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}Object.assign(Mn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(){function e(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}return function(t,n,r){if(t=Zt.euclideanModulo(t,1),n=Zt.clamp(n,0,1),r=Zt.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,o=2*r-i;this.r=e(o,i,t+1/3),this.g=e(o,i,t),this.b=e(o,i,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,c=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(a,s,c)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u,l=(u=n[1]).length;if(3===l)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}e&&e.length>0&&(void 0!==(u=En[e])?this.setHex(u):console.warn("THREE.Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(){function e(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),copyLinearToSRGB:function(){function e(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),c=(s+a)/2;if(s===a)t=0,n=0;else{var u=a-s;switch(n=c<=.5?u/(a+s):u/(2-a-s),a){case r:t=(i-o)/u+(i<o?6:0);break;case i:t=(o-r)/u+2;break;case o:t=(r-i)/u+4}t/=6}return e.h=t,e.s=n,e.l=c,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(xn={},function(e,t,n){return this.getHSL(xn),xn.h+=e,xn.s+=t,xn.l+=n,this.setHSL(xn.h,xn.s,xn.l),this}),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:(_n={h:0,s:0,l:0},yn={h:0,s:0,l:0},function(e,t){this.getHSL(_n),e.getHSL(yn);var n=Zt.lerp(_n.h,yn.h,t),r=Zt.lerp(_n.s,yn.s,t),i=Zt.lerp(_n.l,yn.l,t);return this.setHSL(n,r,i),this}),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Sn,Tn={common:{diffuse:{value:new Mn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new en},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Jt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Mn(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Mn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new en}},sprite:{diffuse:{value:new Mn(15658734)},opacity:{value:1},center:{value:new Jt(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new en}}},An={basic:{uniforms:wn.merge([Tn.common,Tn.specularmap,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.fog]),vertexShader:bn.meshbasic_vert,fragmentShader:bn.meshbasic_frag},lambert:{uniforms:wn.merge([Tn.common,Tn.specularmap,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.fog,Tn.lights,{emissive:{value:new Mn(0)}}]),vertexShader:bn.meshlambert_vert,fragmentShader:bn.meshlambert_frag},phong:{uniforms:wn.merge([Tn.common,Tn.specularmap,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.gradientmap,Tn.fog,Tn.lights,{emissive:{value:new Mn(0)},specular:{value:new Mn(1118481)},shininess:{value:30}}]),vertexShader:bn.meshphong_vert,fragmentShader:bn.meshphong_frag},standard:{uniforms:wn.merge([Tn.common,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.roughnessmap,Tn.metalnessmap,Tn.fog,Tn.lights,{emissive:{value:new Mn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:bn.meshphysical_vert,fragmentShader:bn.meshphysical_frag},matcap:{uniforms:wn.merge([Tn.common,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.fog,{matcap:{value:null}}]),vertexShader:bn.meshmatcap_vert,fragmentShader:bn.meshmatcap_frag},points:{uniforms:wn.merge([Tn.points,Tn.fog]),vertexShader:bn.points_vert,fragmentShader:bn.points_frag},dashed:{uniforms:wn.merge([Tn.common,Tn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:bn.linedashed_vert,fragmentShader:bn.linedashed_frag},depth:{uniforms:wn.merge([Tn.common,Tn.displacementmap]),vertexShader:bn.depth_vert,fragmentShader:bn.depth_frag},normal:{uniforms:wn.merge([Tn.common,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,{opacity:{value:1}}]),vertexShader:bn.normal_vert,fragmentShader:bn.normal_frag},sprite:{uniforms:wn.merge([Tn.sprite,Tn.fog]),vertexShader:bn.sprite_vert,fragmentShader:bn.sprite_frag},background:{uniforms:{t2D:{value:null}},vertexShader:bn.background_vert,fragmentShader:bn.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:bn.cube_vert,fragmentShader:bn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:bn.equirect_vert,fragmentShader:bn.equirect_frag},distanceRGBA:{uniforms:wn.merge([Tn.common,Tn.displacementmap,{referencePosition:{value:new Qt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:bn.distanceRGBA_vert,fragmentShader:bn.distanceRGBA_frag},shadow:{uniforms:wn.merge([Tn.lights,Tn.fog,{color:{value:new Mn(0)},opacity:{value:1}}]),vertexShader:bn.shadow_vert,fragmentShader:bn.shadow_frag}};function Ln(){var e=null,t=!1,n=null;function r(i,o){!1!==t&&(n(i,o),e.requestAnimationFrame(r))}return{start:function(){!0!==t&&null!==n&&(e.requestAnimationFrame(r),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Cn(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){n.isInterleavedBufferAttribute&&(n=n.data);var i=t.get(n);void 0===i?t.set(n,function(t,n){var r=t.array,i=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,o=e.createBuffer();e.bindBuffer(n,o),e.bufferData(n,r,i),t.onUploadCallback();var a=e.FLOAT;return r instanceof Float32Array?a=e.FLOAT:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=e.UNSIGNED_SHORT:r instanceof Int16Array?a=e.SHORT:r instanceof Uint32Array?a=e.UNSIGNED_INT:r instanceof Int32Array?a=e.INT:r instanceof Int8Array?a=e.BYTE:r instanceof Uint8Array&&(a=e.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(n,r)):i.version<n.version&&(!function(t,n,r){var i=n.array,o=n.updateRange;e.bindBuffer(r,t),!1===n.dynamic?e.bufferData(r,i,e.STATIC_DRAW):-1===o.count?e.bufferSubData(r,0,i):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(r,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(i.buffer,n,r),i.version=n.version)}}}function Rn(e,t,n,r,i,o){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new Qt,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new Mn,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}function Pn(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||Pn.DefaultOrder}function On(){this.mask=1}An.physical={uniforms:wn.merge([An.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:bn.meshphysical_vert,fragmentShader:bn.meshphysical_frag},Object.assign(Rn.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),Pn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Pn.DefaultOrder="XYZ",Object.defineProperties(Pn.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(Pn.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=Zt.clamp,i=e.elements,o=i[0],a=i[4],s=i[8],c=i[1],u=i[5],l=i[9],h=i[2],f=i[6],d=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(s,d),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o))):"ZYX"===t?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(f,d),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===t?(this._z=Math.asin(r(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===t?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(f,u),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new $t;return function(t,n,r){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,n,r)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(Sn=new Kt,function(e){return Sn.setFromEuler(this),this.setFromQuaternion(Sn,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Qt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(On.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Nn,In,Dn,zn,Un=0;function kn(){Object.defineProperty(this,"id",{value:Un++}),this.uuid=Zt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=kn.DefaultUp.clone();var e=new Qt,t=new Pn,n=new Kt,r=new Qt(1,1,1);t.onChange((function(){n.setFromEuler(t,!1)})),n.onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new $t},normalMatrix:{value:new en}}),this.matrix=new $t,this.matrixWorld=new $t,this.matrixAutoUpdate=kn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new On,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}kn.DefaultUp=new Qt(0,1,0),kn.DefaultMatrixAutoUpdate=!0,kn.prototype=Object.assign(Object.create(r.prototype),{constructor:kn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(zn=new Kt,function(e,t){return zn.setFromAxisAngle(e,t),this.quaternion.multiply(zn),this}),rotateOnWorldAxis:function(){var e=new Kt;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new Qt(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new Qt(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new Qt(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new Qt;return function(t,n){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(n)),this}}(),translateX:function(){var e=new Qt(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new Qt(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new Qt(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(Dn=new $t,function(e){return e.applyMatrix4(Dn.getInverse(this.matrixWorld))}),lookAt:function(){var e=new Kt,t=new $t,n=new Qt,r=new Qt;return function(i,o,a){i.isVector3?n.copy(i):n.set(i,o,a);var s=this.parent;this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld),this.isCamera?t.lookAt(r,n,this.up):t.lookAt(n,r,this.up),this.quaternion.setFromRotationMatrix(t),s&&(t.extractRotation(s.matrixWorld),e.setFromRotationMatrix(t),this.quaternion.premultiply(e.inverse()))}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Qt),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Nn=new Qt,In=new Qt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Kt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Nn,e,In),e}),getWorldScale:function(){var e=new Qt,t=new Kt;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new Qt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Qt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,c=a.length;s<c;s++){var u=a[s];i(e.shapes,u)}else i(e.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,c=this.material.length;s<c;s++)l.push(i(e.materials,this.material[s]));r.material=l}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(e).object)}if(t){var h=m(e.geometries),f=m(e.materials),d=m(e.textures),p=m(e.images);a=m(e.shapes);h.length>0&&(n.geometries=h),f.length>0&&(n.materials=f),d.length>0&&(n.textures=d),p.length>0&&(n.images=p),a.length>0&&(n.shapes=a)}return n.object=r,n;function m(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}});var Fn,Bn,jn=0;function Hn(){Object.defineProperty(this,"id",{value:jn+=2}),this.uuid=Zt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Gn(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Vn(e,t,n){Gn.call(this,new Int8Array(e),t,n)}function Wn(e,t,n){Gn.call(this,new Uint8Array(e),t,n)}function qn(e,t,n){Gn.call(this,new Uint8ClampedArray(e),t,n)}function Xn(e,t,n){Gn.call(this,new Int16Array(e),t,n)}function Yn(e,t,n){Gn.call(this,new Uint16Array(e),t,n)}function Zn(e,t,n){Gn.call(this,new Int32Array(e),t,n)}function Jn(e,t,n){Gn.call(this,new Uint32Array(e),t,n)}function $n(e,t,n){Gn.call(this,new Float32Array(e),t,n)}function Kn(e,t,n){Gn.call(this,new Float64Array(e),t,n)}function Qn(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function er(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Hn.prototype=Object.assign(Object.create(r.prototype),{constructor:Hn,isGeometry:!0,applyMatrix:function(e){for(var t=(new en).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(e)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new $t;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new $t;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new $t;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new $t;return function(t,n,r){return e.makeTranslation(t,n,r),this.applyMatrix(e),this}}(),scale:function(){var e=new $t;return function(t,n,r){return e.makeScale(t,n,r),this.applyMatrix(e),this}}(),lookAt:(Bn=new kn,function(e){Bn.lookAt(e),Bn.updateMatrix(),this.applyMatrix(Bn.matrix)}),fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index.array:void 0,r=e.attributes,i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,c=void 0!==r.uv2?r.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var u=[],l=[],h=[],f=0,d=0;f<i.length;f+=3,d+=2)t.vertices.push(new Qt(i[f],i[f+1],i[f+2])),void 0!==o&&u.push(new Qt(o[f],o[f+1],o[f+2])),void 0!==a&&t.colors.push(new Mn(a[f],a[f+1],a[f+2])),void 0!==s&&l.push(new Jt(s[d],s[d+1])),void 0!==c&&h.push(new Jt(c[d],c[d+1]));function p(e,n,r,i){var f=new Rn(e,n,r,void 0!==o?[u[e].clone(),u[n].clone(),u[r].clone()]:[],void 0!==a?[t.colors[e].clone(),t.colors[n].clone(),t.colors[r].clone()]:[],i);t.faces.push(f),void 0!==s&&t.faceVertexUvs[0].push([l[e].clone(),l[n].clone(),l[r].clone()]),void 0!==c&&t.faceVertexUvs[1].push([h[e].clone(),h[n].clone(),h[r].clone()])}var m=e.groups;if(m.length>0)for(f=0;f<m.length;f++)for(var g=m[f],v=g.start,_=(d=v,v+g.count);d<_;d+=3)void 0!==n?p(n[d],n[d+1],n[d+2],g.materialIndex):p(d,d+1,d+2,g.materialIndex);else if(void 0!==n)for(f=0;f<n.length;f+=3)p(n[f],n[f+1],n[f+2]);else for(f=0;f<i.length/3;f+=3)p(f,f+1,f+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:(Fn=new Qt,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fn).negate(),this.translate(Fn.x,Fn.y,Fn.z),this}),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,r=new $t;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var e=new Qt,t=new Qt,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r,i,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)a[t]=new Qt;if(e){var s,c,u,l=new Qt,h=new Qt;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],s=this.vertices[o.a],c=this.vertices[o.b],u=this.vertices[o.c],l.subVectors(u,c),h.subVectors(s,c),l.cross(h),a[o.a].add(l),a[o.b].add(l),a[o.c].add(l)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,n=this.vertices.length;t<n;t++)a[t].normalize();for(r=0,i=this.faces.length;r<i;r++){var f=(o=this.faces[r]).vertexNormals;3===f.length?(f[0].copy(a[o.a]),f[1].copy(a[o.b]),f[2].copy(a[o.c])):(f[0]=a[o.a].clone(),f[1]=a[o.b].clone(),f[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var r=(n=this.faces[e]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var o=new Hn;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)c=new Qt,u={a:new Qt,b:new Qt,c:new Qt},a.push(c),s.push(u)}var c,u,l=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],c=l.faceNormals[n],u=l.vertexNormals[n],c.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new pn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new mn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,c=e.faces,u=this.faceVertexUvs[0],l=e.faceVertexUvs[0],h=this.colors,f=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new en).getNormalMatrix(t));for(var d=0,p=a.length;d<p;d++){var m=a[d].clone();void 0!==t&&m.applyMatrix4(t),o.push(m)}for(d=0,p=f.length;d<p;d++)h.push(f[d].clone());for(d=0,p=c.length;d<p;d++){var g,v,_,y=c[d],x=y.vertexNormals,b=y.vertexColors;(g=new Rn(y.a+i,y.b+i,y.c+i)).normal.copy(y.normal),void 0!==r&&g.normal.applyMatrix3(r).normalize();for(var w=0,E=x.length;w<E;w++)v=x[w].clone(),void 0!==r&&v.applyMatrix3(r).normalize(),g.vertexNormals.push(v);g.color.copy(y.color);for(w=0,E=b.length;w<E;w++)_=b[w],g.vertexColors.push(_.clone());g.materialIndex=y.materialIndex+n,s.push(g)}for(d=0,p=l.length;d<p;d++){var M=l[d],S=[];if(void 0!==M){for(w=0,E=M.length;w<E;w++)S.push(M[w].clone());u.push(S)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,r,i,o,a,s,c={},u=[],l=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)e=this.vertices[n],void 0===c[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(c[t]=n,u.push(this.vertices[n]),l[n]=u.length-1):l[n]=l[c[t]];var f=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],o=[i.a,i.b,i.c];for(var d=0;d<3;d++)if(o[d]===o[(d+1)%3]){f.push(n);break}}for(n=f.length-1;n>=0;n--){var p=f[n];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new Qt(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(r=[]),a&&a.length===t&&(i=[]);for(n=0;n<t;n++){var s=e[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],c={},u=[],l={},h=[],f={};for(i=0;i<this.faces.length;i++){var d=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=d.normal.length()>0,g=d.vertexNormals.length>0,v=1!==d.color.r||1!==d.color.g||1!==d.color.b,_=d.vertexColors.length>0,y=0;if(y=E(y,0,0),y=E(y,1,!0),y=E(y,2,!1),y=E(y,3,p),y=E(y,4,m),y=E(y,5,g),y=E(y,6,v),y=E(y,7,_),a.push(y),a.push(d.a,d.b,d.c),a.push(d.materialIndex),p){var x=this.faceVertexUvs[0][i];a.push(T(x[0]),T(x[1]),T(x[2]))}if(m&&a.push(M(d.normal)),g){var b=d.vertexNormals;a.push(M(b[0]),M(b[1]),M(b[2]))}if(v&&a.push(S(d.color)),_){var w=d.vertexColors;a.push(S(w[0]),S(w[1]),S(w[2]))}}function E(e,t,n){return n?e|1<<t:e&~(1<<t)}function M(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==c[t]?c[t]:(c[t]=s.length/3,s.push(e.x,e.y,e.z),c[t])}function S(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==l[t]?l[t]:(l[t]=u.length,u.push(e.getHex()),l[t])}function T(e){var t=e.x.toString()+e.y.toString();return void 0!==f[t]?f[t]:(f[t]=h.length/2,h.push(e.x,e.y),f[t])}return e.data={},e.data.vertices=r,e.data.normals=s,u.length>0&&(e.data.colors=u),h.length>0&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){return(new Hn).copy(this)},copy:function(e){var t,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var c=e.colors;for(t=0,n=c.length;t<n;t++)this.colors.push(c[t].clone());var u=e.faces;for(t=0,n=u.length;t<n;t++)this.faces.push(u[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var l=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),r=0,i=l.length;r<i;r++){var h=l[r],f=[];for(o=0,a=h.length;o<a;o++){var d=h[o];f.push(d.clone())}this.faceVertexUvs[t].push(f)}}var p=e.morphTargets;for(t=0,n=p.length;t<n;t++){var m={};if(m.name=p[t].name,void 0!==p[t].vertices)for(m.vertices=[],r=0,i=p[t].vertices.length;r<i;r++)m.vertices.push(p[t].vertices[r].clone());if(void 0!==p[t].normals)for(m.normals=[],r=0,i=p[t].normals.length;r<i;r++)m.normals.push(p[t].normals[r].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,n=g.length;t<n;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],r=0,i=g[t].vertexNormals.length;r<i;r++){var _=g[t].vertexNormals[r],y={};y.a=_.a.clone(),y.b=_.b.clone(),y.c=_.c.clone(),v.vertexNormals.push(y)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],r=0,i=g[t].faceNormals.length;r<i;r++)v.faceNormals.push(g[t].faceNormals[r].clone());this.morphNormals.push(v)}var x=e.skinWeights;for(t=0,n=x.length;t<n;t++)this.skinWeights.push(x[t].clone());var b=e.skinIndices;for(t=0,n=b.length;t<n;t++)this.skinIndices.push(b[t].clone());var w=e.lineDistances;for(t=0,n=w.length;t<n;t++)this.lineDistances.push(w[t]);var E=e.boundingBox;null!==E&&(this.boundingBox=E.clone());var M=e.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Gn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Gn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Mn),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Jt),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new Qt),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new ln),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),Vn.prototype=Object.create(Gn.prototype),Vn.prototype.constructor=Vn,Wn.prototype=Object.create(Gn.prototype),Wn.prototype.constructor=Wn,qn.prototype=Object.create(Gn.prototype),qn.prototype.constructor=qn,Xn.prototype=Object.create(Gn.prototype),Xn.prototype.constructor=Xn,Yn.prototype=Object.create(Gn.prototype),Yn.prototype.constructor=Yn,Zn.prototype=Object.create(Gn.prototype),Zn.prototype.constructor=Zn,Jn.prototype=Object.create(Gn.prototype),Jn.prototype.constructor=Jn,$n.prototype=Object.create(Gn.prototype),$n.prototype.constructor=$n,Kn.prototype=Object.create(Gn.prototype),Kn.prototype.constructor=Kn,Object.assign(Qn.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,i=e.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:r})}void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,r=e.vertices,i=e.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=e.morphTargets,c=s.length;if(c>0){t=[];for(var u=0;u<c;u++)t[u]={name:s[u].name,data:[]};this.morphTargets.position=t}var l,h=e.morphNormals,f=h.length;if(f>0){l=[];for(u=0;u<f;u++)l[u]={name:h[u].name,data:[]};this.morphTargets.normal=l}var d=e.skinIndices,p=e.skinWeights,m=d.length===r.length,g=p.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(u=0;u<n.length;u++){var v=n[u];this.vertices.push(r[v.a],r[v.b],r[v.c]);var _=v.vertexNormals;if(3===_.length)this.normals.push(_[0],_[1],_[2]);else{var y=v.normal;this.normals.push(y,y,y)}var x,b=v.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===o)void 0!==(x=i[0][u])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Jt,new Jt,new Jt));if(!0===a)void 0!==(x=i[1][u])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Jt,new Jt,new Jt));for(var E=0;E<c;E++){var M=s[E].vertices;t[E].data.push(M[v.a],M[v.b],M[v.c])}for(E=0;E<f;E++){var S=h[E].vertexNormals[u];l[E].data.push(S.a,S.b,S.c)}m&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),g&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var tr=1;function nr(){Object.defineProperty(this,"id",{value:tr+=2}),this.uuid=Zt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function rr(e,t,n,r,i,o){Hn.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new ir(e,t,n,r,i,o)),this.mergeVertices()}function ir(e,t,n,r,i,o){nr.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var a=this;e=e||1,t=t||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var s=[],c=[],u=[],l=[],h=0,f=0;function d(e,t,n,r,i,o,d,p,m,g,v){var _,y,x=o/m,b=d/g,w=o/2,E=d/2,M=p/2,S=m+1,T=g+1,A=0,L=0,C=new Qt;for(y=0;y<T;y++){var R=y*b-E;for(_=0;_<S;_++){var P=_*x-w;C[e]=P*r,C[t]=R*i,C[n]=M,c.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[n]=p>0?1:-1,u.push(C.x,C.y,C.z),l.push(_/m),l.push(1-y/g),A+=1}}for(y=0;y<g;y++)for(_=0;_<m;_++){var O=h+_+S*y,N=h+_+S*(y+1),I=h+(_+1)+S*(y+1),D=h+(_+1)+S*y;s.push(O,N,D),s.push(N,I,D),L+=6}a.addGroup(f,L,v),f+=L,h+=A}d("z","y","x",-1,-1,n,t,e,o,i,0),d("z","y","x",1,-1,n,t,-e,o,i,1),d("x","z","y",1,1,e,n,t,r,o,2),d("x","z","y",1,-1,e,n,-t,r,o,3),d("x","y","z",1,-1,e,t,n,r,i,4),d("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.addAttribute("position",new $n(c,3)),this.addAttribute("normal",new $n(u,3)),this.addAttribute("uv",new $n(l,2))}function or(e,t,n,r){Hn.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new ar(e,t,n,r)),this.mergeVertices()}function ar(e,t,n,r){nr.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};var i,o,a=(e=e||1)/2,s=(t=t||1)/2,c=Math.floor(n)||1,u=Math.floor(r)||1,l=c+1,h=u+1,f=e/c,d=t/u,p=[],m=[],g=[],v=[];for(o=0;o<h;o++){var _=o*d-s;for(i=0;i<l;i++){var y=i*f-a;m.push(y,-_,0),g.push(0,0,1),v.push(i/c),v.push(1-o/u)}}for(o=0;o<u;o++)for(i=0;i<c;i++){var x=i+l*o,b=i+l*(o+1),w=i+1+l*(o+1),E=i+1+l*o;p.push(x,b,E),p.push(b,w,E)}this.setIndex(p),this.addAttribute("position",new $n(m,3)),this.addAttribute("normal",new $n(g,3)),this.addAttribute("uv",new $n(v,2))}nr.prototype=Object.assign(Object.create(r.prototype),{constructor:nr,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(er(e)>65535?Jn:Yn)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new Gn(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new en).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new $t;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new $t;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new $t;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new $t;return function(t,n,r){return e.makeTranslation(t,n,r),this.applyMatrix(e),this}}(),scale:function(){var e=new $t;return function(t,n,r){return e.makeScale(t,n,r),this.applyMatrix(e),this}}(),lookAt:function(){var e=new kn;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new Qt;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new $n(3*t.vertices.length,3),r=new $n(3*t.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(t.vertices)),this.addAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new $n(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new $n(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Qn).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new Gn(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);this.addAttribute("normal",new Gn(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var r=new Float32Array(3*e.colors.length);this.addAttribute("color",new Gn(r,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new Gn(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new Gn(o,2).copyVector2sArray(e.uvs2))}for(var a in this.groups=e.groups,e.morphTargets){for(var s=[],c=e.morphTargets[a],u=0,l=c.length;u<l;u++){var h=c[u],f=new $n(3*h.data.length,3);f.name=h.name,s.push(f.copyVector3sArray(h.data))}this.morphAttributes[a]=s}if(e.skinIndices.length>0){var d=new $n(4*e.skinIndices.length,4);this.addAttribute("skinIndex",d.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var p=new $n(4*e.skinWeights.length,4);this.addAttribute("skinWeight",p.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new pn);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new pn,t=new Qt;return function(){null===this.boundingSphere&&(this.boundingSphere=new mn);var n=this.attributes.position;if(n){var r=this.boundingSphere.center;e.setFromBufferAttribute(n),e.getCenter(r);for(var i=0,o=0,a=n.count;o<a;o++)t.x=n.getX(o),t.y=n.getY(o),t.z=n.getZ(o),i=Math.max(i,r.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new Gn(new Float32Array(n.length),3));else for(var r=t.normal.array,i=0,o=r.length;i<o;i++)r[i]=0;var a,s,c,u=t.normal.array,l=new Qt,h=new Qt,f=new Qt,d=new Qt,p=new Qt;if(e){var m=e.array;for(i=0,o=e.count;i<o;i+=3)a=3*m[i+0],s=3*m[i+1],c=3*m[i+2],l.fromArray(n,a),h.fromArray(n,s),f.fromArray(n,c),d.subVectors(f,h),p.subVectors(l,h),d.cross(p),u[a]+=d.x,u[a+1]+=d.y,u[a+2]+=d.z,u[s]+=d.x,u[s+1]+=d.y,u[s+2]+=d.z,u[c]+=d.x,u[c+1]+=d.y,u[c+2]+=d.z}else for(i=0,o=n.length;i<o;i+=9)l.fromArray(n,i),h.fromArray(n,i+3),f.fromArray(n,i+6),d.subVectors(f,h),p.subVectors(l,h),d.cross(p),u[i]=d.x,u[i+1]=d.y,u[i+2]=d.z,u[i+3]=d.x,u[i+4]=d.y,u[i+5]=d.z,u[i+6]=d.x,u[i+7]=d.y,u[i+8]=d.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,o=e.attributes[r],a=o.array,s=0,c=o.itemSize*t;s<a.length;s++,c++)i[c]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new Qt;return function(){for(var t=this.attributes.normal,n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.normalize(),t.setXYZ(n,e.x,e.y,e.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new nr,t=this.index.array,n=this.attributes;for(var r in n){for(var i=n[r],o=i.array,a=i.itemSize,s=new o.constructor(t.length*a),c=0,u=0,l=0,h=t.length;l<h;l++){c=t[l]*a;for(var f=0;f<a;f++)s[u++]=o[c++]}e.addAttribute(r,new Gn(s,a))}var d=this.groups;for(l=0,h=d.length;l<h;l++){var p=d[l];e.addGroup(p.start,p.count,p.materialIndex)}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;if(null!==r){var i=Array.prototype.slice.call(r.array);e.data.index={type:r.array.constructor.name,array:i}}var o=this.attributes;for(var n in o){var a=o[n];i=Array.prototype.slice.call(a.array);e.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:i,normalized:a.normalized}}var s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));var c=this.boundingSphere;return null!==c&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e},clone:function(){return(new nr).copy(this)},copy:function(e){var t,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var c=[],u=s[t];for(n=0,r=u.length;n<r;n++)c.push(u[n].clone());this.morphAttributes[t]=c}var l=e.groups;for(n=0,r=l.length;n<r;n++){var h=l[n];this.addGroup(h.start,h.count,h.materialIndex)}var f=e.boundingBox;null!==f&&(this.boundingBox=f.clone());var d=e.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),rr.prototype=Object.create(Hn.prototype),rr.prototype.constructor=rr,ir.prototype=Object.create(nr.prototype),ir.prototype.constructor=ir,or.prototype=Object.create(Hn.prototype),or.prototype.constructor=or,ar.prototype=Object.create(nr.prototype),ar.prototype.constructor=ar;var sr,cr,ur,lr,hr,fr,dr,pr,mr,gr,vr,_r,yr=0;function xr(){Object.defineProperty(this,"id",{value:yr++}),this.uuid=Zt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=D,this.side=T,this.flatShading=!1,this.vertexColors=P,this.opacity=1,this.transparent=!1,this.blendSrc=Z,this.blendDst=J,this.blendEquation=B,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=oe,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function br(e){xr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function wr(e,t){this.origin=void 0!==e?e:new Qt,this.direction=void 0!==t?t:new Qt}function Er(e,t,n){this.a=void 0!==e?e:new Qt,this.b=void 0!==t?t:new Qt,this.c=void 0!==n?n:new Qt}function Mr(e){xr.call(this),this.type="MeshBasicMaterial",this.color=new Mn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Sr(e,t){kn.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new nr,this.material=void 0!==t?t:new Mr({color:16777215*Math.random()}),this.drawMode=It,this.updateMorphTargets()}function Tr(e,t,n,r){var i,o,a=new Mn(0),s=0;function c(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,r)}return{getClearColor:function(){return a},setClearColor:function(e,t){a.set(e),c(a,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){c(a,s=e)},render:function(t,r,u,l){var h=r.background;null===h?c(a,s):h&&h.isColor&&(c(h,1),l=!0),(e.autoClear||l)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),h&&h.isCubeTexture?(void 0===o&&((o=new Sr(new ir(1,1,1),new br({uniforms:wn.clone(An.cube.uniforms),vertexShader:An.cube.vertexShader,fragmentShader:An.cube.fragmentShader,side:A,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(o)),o.material.uniforms.tCube.value=h,t.push(o,o.geometry,o.material,0,null)):h&&h.isTexture&&(void 0===i&&((i=new Sr(new ar(2,2),new br({uniforms:wn.clone(An.background.uniforms),vertexShader:An.background.vertexShader,fragmentShader:An.background.fragmentShader,side:T,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),n.update(i)),i.material.uniforms.t2D.value=h,t.push(i,i.geometry,i.material,0,null))}}}function Ar(e,t,n,r){var i;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i)},this.renderInstances=function(o,a,s){var c;if(r.isWebGL2)c=e;else if(null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[r.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](i,a,s,o.maxInstancedCount),n.update(s,i,o.maxInstancedCount)}}function Lr(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var c=!0===n.logarithmicDepthBuffer,u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),l=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),f=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),d=e.getParameter(e.MAX_VERTEX_ATTRIBS),p=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),m=e.getParameter(e.MAX_VARYING_VECTORS),g=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),v=l>0,_=o||!!t.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:f,maxAttributes:d,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:_,floatVertexTextures:v&&_}}function Cr(){var e=this,t=null,n=0,r=!1,i=!1,o=new gn,a=new en,s={value:null,needsUpdate:!1};function c(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(t,n,r,i){var c=null!==t?t.length:0,u=null;if(0!==c){if(u=s.value,!0!==i||null===u){var l=r+4*c,h=n.matrixWorldInverse;a.getNormalMatrix(h),(null===u||u.length<l)&&(u=new Float32Array(l));for(var f=0,d=r;f!==c;++f,d+=4)o.copy(t[f]).applyMatrix4(h,a),o.normal.toArray(u,d),u[d+3]=o.constant}s.value=u,s.needsUpdate=!0}return e.numPlanes=c,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,o){var a=0!==e.length||i||0!==n||r;return r=i,t=u(e,o,0),n=e.length,a},this.beginShadows=function(){i=!0,u(null)},this.endShadows=function(){i=!1,c()},this.setState=function(e,o,a,l,h,f){if(!r||null===e||0===e.length||i&&!a)i?u(null):c();else{var d=i?0:n,p=4*d,m=h.clippingState||null;s.value=m,m=u(e,l,p,f);for(var g=0;g!==p;++g)m[g]=t[g];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=d}}}function Rr(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=r,r}}}function Pr(e,t,n){var r={},i={};function o(e){var a=e.target,s=r[a.id];for(var c in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[c]);a.removeEventListener("dispose",o),delete r[a.id];var u=i[s.id];u&&(t.remove(u),delete i[s.id]),n.memory.geometries--}return{get:function(e,t){var i=r[t.id];return i||(t.addEventListener("dispose",o),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new nr).setFromObject(e)),i=t._bufferGeometry),r[t.id]=i,n.memory.geometries++,i)},update:function(n){var r=n.index,i=n.attributes;for(var o in null!==r&&t.update(r,e.ELEMENT_ARRAY_BUFFER),i)t.update(i[o],e.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],c=0,u=s.length;c<u;c++)t.update(s[c],e.ARRAY_BUFFER)},getWireframeAttribute:function(n){var r=i[n.id];if(r)return r;var o,a=[],s=n.index,c=n.attributes;if(null!==s)for(var u=0,l=(o=s.array).length;u<l;u+=3){var h=o[u+0],f=o[u+1],d=o[u+2];a.push(h,f,f,d,d,h)}else for(u=0,l=(o=c.position.array).length/3-1;u<l;u+=3){h=u+0,f=u+1,d=u+2;a.push(h,f,f,d,d,h)}return r=new(er(a)>65535?Jn:Yn)(a,1),t.update(r,e.ELEMENT_ARRAY_BUFFER),i[n.id]=r,r}}}function Or(e,t,n,r){var i,o,a;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,o,t*a),n.update(r,i)},this.renderInstances=function(s,c,u){var l;if(r.isWebGL2)l=e;else if(null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[r.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](i,u,o,c*a,s.maxInstancedCount),n.update(u,i,s.maxInstancedCount)}}function Nr(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(i=i||1,t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.TRIANGLE_STRIP:case e.TRIANGLE_FAN:t.triangles+=i*(n-2);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function Ir(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Dr(e){var t={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,c=s.length,u=t[i.id];if(void 0===u){u=[];for(var l=0;l<c;l++)u[l]=[l,0];t[i.id]=u}var h=o.morphTargets&&i.morphAttributes.position,f=o.morphNormals&&i.morphAttributes.normal;for(l=0;l<c;l++){0!==(d=u[l])[1]&&(h&&i.removeAttribute("morphTarget"+l),f&&i.removeAttribute("morphNormal"+l))}for(l=0;l<c;l++){(d=u[l])[0]=l,d[1]=s[l]}for(u.sort(Ir),l=0;l<8;l++){var d;if(d=u[l]){var p=d[0],m=d[1];if(m){h&&i.addAttribute("morphTarget"+l,h[p]),f&&i.addAttribute("morphNormal"+l,f[p]),n[l]=m;continue}}n[l]=0}a.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function zr(e,t){var n={};return{update:function(r){var i=t.render.frame,o=r.geometry,a=e.get(r,o);return n[a.id]!==i&&(o.isGeometry&&a.updateFromObject(r),e.update(a),n[a.id]=i),a},dispose:function(){n={}}}}function Ur(e,t,n,r,i,o,a,s,c,u){e=void 0!==e?e:[],t=void 0!==t?t:ye,un.call(this,e,t,n,r,i,o,a,s,c,u),this.flipY=!1}function kr(e,t,n,r){un.call(this,null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=Ce,this.minFilter=Ce,this.generateMipmaps=!1,this.flipY=!1}xr.prototype=Object.assign(Object.create(r.prototype),{constructor:xr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]="overdraw"===t?Number(n):n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===C;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==D&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==T&&(n.side=this.side),this.vertexColors!==P&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),o=r(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),br.prototype=Object.create(xr.prototype),br.prototype.constructor=br,br.prototype.isShaderMaterial=!0,br.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=wn.clone(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},br.prototype.toJSON=function(e){var t=xr.prototype.toJSON.call(this,e);for(var n in t.uniforms={},this.uniforms){var r=this.uniforms[n].value;r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}return Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Object.assign(wr.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Qt),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new Qt;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Qt),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new Qt;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:(cr=new Qt,ur=new Qt,lr=new Qt,function(e,t,n,r){cr.copy(e).add(t).multiplyScalar(.5),ur.copy(t).sub(e).normalize(),lr.copy(this.origin).sub(cr);var i,o,a,s,c=.5*e.distanceTo(t),u=-this.direction.dot(ur),l=lr.dot(this.direction),h=-lr.dot(ur),f=lr.lengthSq(),d=Math.abs(1-u*u);if(d>0)if(o=u*l-h,s=c*d,(i=u*h-l)>=0)if(o>=-s)if(o<=s){var p=1/d;a=(i*=p)*(i+u*(o*=p)+2*l)+o*(u*i+o+2*h)+f}else o=c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*h)+f;else o=-c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*h)+f;else o<=-s?a=-(i=Math.max(0,-(-u*c+l)))*i+(o=i>0?-c:Math.min(Math.max(-c,-h),c))*(o+2*h)+f:o<=s?(i=0,a=(o=Math.min(Math.max(-c,-h),c))*(o+2*h)+f):a=-(i=Math.max(0,-(u*c+l)))*i+(o=i>0?c:Math.min(Math.max(-c,-h),c))*(o+2*h)+f;else o=u>0?-c:c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*h)+f;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(ur).multiplyScalar(o).add(cr),a}),intersectSphere:function(){var e=new Qt;return function(t,n){e.subVectors(t.center,this.origin);var r=e.dot(this.direction),i=e.dot(e)-r*r,o=t.radius*t.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=r-a,c=r+a;return s<0&&c<0?null:s<0?this.at(c,n):this.at(s,n)}}(),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,r,i,o,a,s,c=1/this.direction.x,u=1/this.direction.y,l=1/this.direction.z,h=this.origin;return c>=0?(n=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(n=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(i=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),l>=0?(a=(e.min.z-h.z)*l,s=(e.max.z-h.z)*l):(a=(e.max.z-h.z)*l,s=(e.min.z-h.z)*l),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},intersectsBox:(sr=new Qt,function(e){return null!==this.intersectBox(e,sr)}),intersectTriangle:function(){var e=new Qt,t=new Qt,n=new Qt,r=new Qt;return function(i,o,a,s,c){t.subVectors(o,i),n.subVectors(a,i),r.crossVectors(t,n);var u,l=this.direction.dot(r);if(l>0){if(s)return null;u=1}else{if(!(l<0))return null;u=-1,l=-l}e.subVectors(this.origin,i);var h=u*this.direction.dot(n.crossVectors(e,n));if(h<0)return null;var f=u*this.direction.dot(t.cross(e));if(f<0)return null;if(h+f>l)return null;var d=-u*e.dot(r);return d<0?null:this.at(d/l,c)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Er,{getNormal:(fr=new Qt,function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Qt),r.subVectors(n,t),fr.subVectors(e,t),r.cross(fr);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}),getBarycoord:function(){var e=new Qt,t=new Qt,n=new Qt;return function(r,i,o,a,s){e.subVectors(a,i),t.subVectors(o,i),n.subVectors(r,i);var c=e.dot(e),u=e.dot(t),l=e.dot(n),h=t.dot(t),f=t.dot(n),d=c*h-u*u;if(void 0===s&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new Qt),0===d)return s.set(-2,-1,-1);var p=1/d,m=(h*l-u*f)*p,g=(c*f-u*l)*p;return s.set(1-m-g,g,m)}}(),containsPoint:function(){var e=new Qt;return function(t,n,r,i){return Er.getBarycoord(t,n,r,i,e),e.x>=0&&e.y>=0&&e.x+e.y<=1}}(),getUV:(hr=new Qt,function(e,t,n,r,i,o,a,s){return this.getBarycoord(e,t,n,r,hr),s.set(0,0),s.addScaledVector(i,hr.x),s.addScaledVector(o,hr.y),s.addScaledVector(a,hr.z),s})}),Object.assign(Er.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new Qt,t=new Qt;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Qt),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Er.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Qt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Er.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return Er.containsPoint(e,this.a,this.b,this.c)},getUV:function(e,t,n,r,i){return Er.getUV(e,this.a,this.b,this.c,t,n,r,i)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:(dr=new Qt,pr=new Qt,mr=new Qt,gr=new Qt,vr=new Qt,_r=new Qt,function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Qt);var n,r,i=this.a,o=this.b,a=this.c;dr.subVectors(o,i),pr.subVectors(a,i),gr.subVectors(e,i);var s=dr.dot(gr),c=pr.dot(gr);if(s<=0&&c<=0)return t.copy(i);vr.subVectors(e,o);var u=dr.dot(vr),l=pr.dot(vr);if(u>=0&&l<=u)return t.copy(o);var h=s*l-u*c;if(h<=0&&s>=0&&u<=0)return n=s/(s-u),t.copy(i).addScaledVector(dr,n);_r.subVectors(e,a);var f=dr.dot(_r),d=pr.dot(_r);if(d>=0&&f<=d)return t.copy(a);var p=f*c-s*d;if(p<=0&&c>=0&&d<=0)return r=c/(c-d),t.copy(i).addScaledVector(pr,r);var m=u*d-f*l;if(m<=0&&l-u>=0&&f-d>=0)return mr.subVectors(a,o),r=(l-u)/(l-u+(f-d)),t.copy(o).addScaledVector(mr,r);var g=1/(m+p+h);return n=p*g,r=h*g,t.copy(i).addScaledVector(dr,n).addScaledVector(pr,r)}),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Mr.prototype=Object.create(xr.prototype),Mr.prototype.constructor=Mr,Mr.prototype.isMeshBasicMaterial=!0,Mr.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Sr.prototype=Object.assign(Object.create(kn.prototype),{constructor:Sr,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return kn.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)n=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=r.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)n=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}},raycast:function(){var e=new $t,t=new wr,n=new mn,r=new Qt,i=new Qt,o=new Qt,a=new Qt,s=new Qt,c=new Qt,u=new Jt,l=new Jt,h=new Jt,f=new Qt,d=new Qt;function p(e,t,n,r,i,o,a,s){if(null===(t.side===A?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,t.side!==L,s)))return null;d.copy(s),d.applyMatrix4(e.matrixWorld);var c=n.ray.origin.distanceTo(d);return c<n.near||c>n.far?null:{distance:c,point:d.clone(),object:e}}function m(e,t,n,a,s,c,d,m,g){r.fromBufferAttribute(s,d),i.fromBufferAttribute(s,m),o.fromBufferAttribute(s,g);var v=p(e,t,n,a,r,i,o,f);if(v){c&&(u.fromBufferAttribute(c,d),l.fromBufferAttribute(c,m),h.fromBufferAttribute(c,g),v.uv=Er.getUV(f,r,i,o,u,l,h,new Jt));var _=new Rn(d,m,g);Er.getNormal(r,i,o,_.normal),v.face=_}return v}return function(d,g){var v,_=this.geometry,y=this.material,x=this.matrixWorld;if(void 0!==y&&(null===_.boundingSphere&&_.computeBoundingSphere(),n.copy(_.boundingSphere),n.applyMatrix4(x),!1!==d.ray.intersectsSphere(n)&&(e.getInverse(x),t.copy(d.ray).applyMatrix4(e),null===_.boundingBox||!1!==t.intersectsBox(_.boundingBox))))if(_.isBufferGeometry){var b,w,E,M,S,T,A,L,C,R=_.index,P=_.attributes.position,O=_.attributes.uv,N=_.groups,I=_.drawRange;if(null!==R)if(Array.isArray(y))for(M=0,T=N.length;M<T;M++)for(C=y[(L=N[M]).materialIndex],S=Math.max(L.start,I.start),A=Math.min(L.start+L.count,I.start+I.count);S<A;S+=3)b=R.getX(S),w=R.getX(S+1),E=R.getX(S+2),(v=m(this,C,d,t,P,O,b,w,E))&&(v.faceIndex=Math.floor(S/3),g.push(v));else for(M=Math.max(0,I.start),T=Math.min(R.count,I.start+I.count);M<T;M+=3)b=R.getX(M),w=R.getX(M+1),E=R.getX(M+2),(v=m(this,y,d,t,P,O,b,w,E))&&(v.faceIndex=Math.floor(M/3),g.push(v));else if(void 0!==P)if(Array.isArray(y))for(M=0,T=N.length;M<T;M++)for(C=y[(L=N[M]).materialIndex],S=Math.max(L.start,I.start),A=Math.min(L.start+L.count,I.start+I.count);S<A;S+=3)(v=m(this,C,d,t,P,O,b=S,w=S+1,E=S+2))&&(v.faceIndex=Math.floor(S/3),g.push(v));else for(M=Math.max(0,I.start),T=Math.min(P.count,I.start+I.count);M<T;M+=3)(v=m(this,y,d,t,P,O,b=M,w=M+1,E=M+2))&&(v.faceIndex=Math.floor(M/3),g.push(v))}else if(_.isGeometry){var D,z,U,k,F=Array.isArray(y),B=_.vertices,j=_.faces,H=_.faceVertexUvs[0];H.length>0&&(k=H);for(var G=0,V=j.length;G<V;G++){var W=j[G],q=F?y[W.materialIndex]:y;if(void 0!==q){if(D=B[W.a],z=B[W.b],U=B[W.c],!0===q.morphTargets){var X=_.morphTargets,Y=this.morphTargetInfluences;r.set(0,0,0),i.set(0,0,0),o.set(0,0,0);for(var Z=0,J=X.length;Z<J;Z++){var $=Y[Z];if(0!==$){var K=X[Z].vertices;r.addScaledVector(a.subVectors(K[W.a],D),$),i.addScaledVector(s.subVectors(K[W.b],z),$),o.addScaledVector(c.subVectors(K[W.c],U),$)}}r.add(D),i.add(z),o.add(U),D=r,z=i,U=o}if(v=p(this,q,d,t,D,z,U,f)){if(k&&k[G]){var Q=k[G];u.copy(Q[0]),l.copy(Q[1]),h.copy(Q[2]),v.uv=Er.getUV(f,D,z,U,u,l,h,new Jt)}v.face=W,v.faceIndex=G,g.push(v)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ur.prototype=Object.create(un.prototype),Ur.prototype.constructor=Ur,Ur.prototype.isCubeTexture=!0,Object.defineProperty(Ur.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),kr.prototype=Object.create(un.prototype),kr.prototype.constructor=kr,kr.prototype.isDataTexture3D=!0;var Fr=new un,Br=new kr,jr=new Ur;function Hr(){this.seq=[],this.map={}}var Gr=[],Vr=[],Wr=new Float32Array(16),qr=new Float32Array(9),Xr=new Float32Array(4);function Yr(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,o=Gr[i];if(void 0===o&&(o=new Float32Array(i),Gr[i]=o),0!==t){r.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=n,e[a].toArray(o,s)}return o}function Zr(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Jr(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function $r(e,t){var n=Vr[t];void 0===n&&(n=new Int32Array(t),Vr[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocTextureUnit();return n}function Kr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Qr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function ei(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Zr(n,t))return;e.uniform2fv(this.addr,t),Jr(n,t)}}function ti(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Zr(n,t))return;e.uniform3fv(this.addr,t),Jr(n,t)}}function ni(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Zr(n,t))return;e.uniform4fv(this.addr,t),Jr(n,t)}}function ri(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Zr(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Jr(n,t)}else{if(Zr(n,r))return;Xr.set(r),e.uniformMatrix2fv(this.addr,!1,Xr),Jr(n,r)}}function ii(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Zr(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Jr(n,t)}else{if(Zr(n,r))return;qr.set(r),e.uniformMatrix3fv(this.addr,!1,qr),Jr(n,r)}}function oi(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Zr(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Jr(n,t)}else{if(Zr(n,r))return;Wr.set(r),e.uniformMatrix4fv(this.addr,!1,Wr),Jr(n,r)}}function ai(e,t,n){var r=this.cache,i=n.allocTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(t||Fr,i)}function si(e,t,n){var r=this.cache,i=n.allocTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Br,i)}function ci(e,t,n){var r=this.cache,i=n.allocTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||jr,i)}function ui(e,t){var n=this.cache;Zr(n,t)||(e.uniform2iv(this.addr,t),Jr(n,t))}function li(e,t){var n=this.cache;Zr(n,t)||(e.uniform3iv(this.addr,t),Jr(n,t))}function hi(e,t){var n=this.cache;Zr(n,t)||(e.uniform4iv(this.addr,t),Jr(n,t))}function fi(e,t){var n=this.cache;Zr(n,t)||(e.uniform1fv(this.addr,t),Jr(n,t))}function di(e,t){var n=this.cache;Zr(n,t)||(e.uniform1iv(this.addr,t),Jr(n,t))}function pi(e,t){var n=this.cache,r=Yr(t,this.size,2);Zr(n,r)||(e.uniform2fv(this.addr,r),this.updateCache(r))}function mi(e,t){var n=this.cache,r=Yr(t,this.size,3);Zr(n,r)||(e.uniform3fv(this.addr,r),this.updateCache(r))}function gi(e,t){var n=this.cache,r=Yr(t,this.size,4);Zr(n,r)||(e.uniform4fv(this.addr,r),this.updateCache(r))}function vi(e,t){var n=this.cache,r=Yr(t,this.size,4);Zr(n,r)||(e.uniformMatrix2fv(this.addr,!1,r),this.updateCache(r))}function _i(e,t){var n=this.cache,r=Yr(t,this.size,9);Zr(n,r)||(e.uniformMatrix3fv(this.addr,!1,r),this.updateCache(r))}function yi(e,t){var n=this.cache,r=Yr(t,this.size,16);Zr(n,r)||(e.uniformMatrix4fv(this.addr,!1,r),this.updateCache(r))}function xi(e,t,n){var r=this.cache,i=t.length,o=$r(n,i);!1===Zr(r,o)&&(e.uniform1iv(this.addr,o),Jr(r,o));for(var a=0;a!==i;++a)n.setTexture2D(t[a]||Fr,o[a])}function bi(e,t,n){var r=this.cache,i=t.length,o=$r(n,i);!1===Zr(r,o)&&(e.uniform1iv(this.addr,o),Jr(r,o));for(var a=0;a!==i;++a)n.setTextureCube(t[a]||jr,o[a])}function wi(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Kr;case 35664:return ei;case 35665:return ti;case 35666:return ni;case 35674:return ri;case 35675:return ii;case 35676:return oi;case 35678:case 36198:return ai;case 35679:return si;case 35680:return ci;case 5124:case 35670:return Qr;case 35667:case 35671:return ui;case 35668:case 35672:return li;case 35669:case 35673:return hi}}(t.type)}function Ei(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return fi;case 35664:return pi;case 35665:return mi;case 35666:return gi;case 35674:return vi;case 35675:return _i;case 35676:return yi;case 35678:return xi;case 35680:return bi;case 5124:case 35670:return di;case 35667:case 35671:return ui;case 35668:case 35672:return li;case 35669:case 35673:return hi}}(t.type)}function Mi(e){this.id=e,Hr.call(this)}Ei.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Jr(t,e)},Mi.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(e,t[a.id],n)}};var Si=/([\w\d_]+)(\])?(\[|\.)?/g;function Ti(e,t){e.seq.push(t),e.map[t.id]=t}function Ai(e,t,n){var r=e.name,i=r.length;for(Si.lastIndex=0;;){var o=Si.exec(r),a=Si.lastIndex,s=o[1],c="]"===o[2],u=o[3];if(c&&(s|=0),void 0===u||"["===u&&a+2===i){Ti(n,void 0===u?new wi(s,e,t):new Ei(s,e,t));break}var l=n.map[s];void 0===l&&Ti(n,l=new Mi(s)),n=l}}function Li(e,t,n){Hr.call(this),this.renderer=n;for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<r;++i){var o=e.getActiveUniform(t,i);Ai(o,e.getUniformLocation(t,o.name),this)}}function Ci(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),!1===e.getShaderParameter(r,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(r),function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(n)),r}Li.prototype.setValue=function(e,t,n){var r=this.map[t];void 0!==r&&r.setValue(e,n,this.renderer)},Li.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},Li.upload=function(e,t,n,r){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}},Li.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var o=e[r];o.id in t&&n.push(o)}return n};var Ri=0;function Pi(e){switch(e){case Ut:return["Linear","( value )"];case kt:return["sRGB","( value )"];case Bt:return["RGBE","( value )"];case Ht:return["RGBM","( value, 7.0 )"];case Gt:return["RGBM","( value, 16.0 )"];case Vt:return["RGBD","( value, 256.0 )"];case Ft:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Oi(e,t){var n=Pi(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Ni(e,t){var n;switch(t){case pe:n="Linear";break;case me:n="Reinhard";break;case ge:n="Uncharted2";break;case ve:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ii(e){return""!==e}function Di(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function zi(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function Ui(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(e,t){var n=bn[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Ui(n)}))}function ki(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,(function(e,t,n,r){for(var i="",o=parseInt(t);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]");return i}))}function Fi(e,t,n,r,i,o,a){var s=e.context,c=r.defines,u=i.vertexShader,l=i.fragmentShader,h="SHADOWMAP_TYPE_BASIC";o.shadowMapType===M?h="SHADOWMAP_TYPE_PCF":o.shadowMapType===S&&(h="SHADOWMAP_TYPE_PCF_SOFT");var f="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",p="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case ye:case xe:f="ENVMAP_TYPE_CUBE";break;case Me:case Se:f="ENVMAP_TYPE_CUBE_UV";break;case be:case we:f="ENVMAP_TYPE_EQUIREC";break;case Ee:f="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case xe:case we:d="ENVMAP_MODE_REFRACTION"}switch(r.combine){case le:p="ENVMAP_BLENDING_MULTIPLY";break;case he:p="ENVMAP_BLENDING_MIX";break;case fe:p="ENVMAP_BLENDING_ADD"}}var m,g,v,_,y,x=e.gammaFactor>0?e.gammaFactor:1,b=a.isWebGL2?"":function(e,t,n){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ii).join("\n")}(r.extensions,o,t),w=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(c),E=s.createProgram();if(r.isRawShaderMaterial?((m=[w].filter(Ii).join("\n")).length>0&&(m+="\n"),(g=[b,w].filter(Ii).join("\n")).length>0&&(g+="\n")):(m=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,w,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+x,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ii).join("\n"),g=[b,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,w,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+x,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+f:"",o.envMap?"#define "+d:"",o.envMap?"#define "+p:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&(a.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==de?"#define TONE_MAPPING":"",o.toneMapping!==de?bn.tonemapping_pars_fragment:"",o.toneMapping!==de?Ni("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.matcapEncoding||o.envMapEncoding||o.emissiveMapEncoding?bn.encodings_pars_fragment:"",o.mapEncoding?Oi("mapTexelToLinear",o.mapEncoding):"",o.matcapEncoding?Oi("matcapTexelToLinear",o.matcapEncoding):"",o.envMapEncoding?Oi("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Oi("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?(v="linearToOutputTexel",_=o.outputEncoding,y=Pi(_),"vec4 "+v+"( vec4 value ) { return LinearTo"+y[0]+y[1]+"; }"):"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Ii).join("\n")),u=zi(u=Di(u=Ui(u),o),o),l=zi(l=Di(l=Ui(l),o),o),u=ki(u),l=ki(l),a.isWebGL2&&!r.isRawShaderMaterial){var T=!1,A=/^\s*#version\s+300\s+es\s*\n/;r.isShaderMaterial&&null!==u.match(A)&&null!==l.match(A)&&(T=!0,u=u.replace(A,""),l=l.replace(A,"")),m=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,g=["#version 300 es\n","#define varying in",T?"":"out highp vec4 pc_fragColor;",T?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g}var L=m+u,C=g+l,R=Ci(s,s.VERTEX_SHADER,L),P=Ci(s,s.FRAGMENT_SHADER,C);s.attachShader(E,R),s.attachShader(E,P),void 0!==r.index0AttributeName?s.bindAttribLocation(E,0,r.index0AttributeName):!0===o.morphTargets&&s.bindAttribLocation(E,0,"position"),s.linkProgram(E);var O,N,I=s.getProgramInfoLog(E).trim(),D=s.getShaderInfoLog(R).trim(),z=s.getShaderInfoLog(P).trim(),U=!0,k=!0;return!1===s.getProgramParameter(E,s.LINK_STATUS)?(U=!1,console.error("THREE.WebGLProgram: shader error: ",s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(E,s.VALIDATE_STATUS),"gl.getProgramInfoLog",I,D,z)):""!==I?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",I):""!==D&&""!==z||(k=!1),k&&(this.diagnostics={runnable:U,material:r,programLog:I,vertexShader:{log:D,prefix:m},fragmentShader:{log:z,prefix:g}}),s.deleteShader(R),s.deleteShader(P),this.getUniforms=function(){return void 0===O&&(O=new Li(s,E,e)),O},this.getAttributes=function(){return void 0===N&&(N=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o=e.getActiveAttrib(t,i).name;n[o]=e.getAttribLocation(t,o)}return n}(s,E)),N},this.destroy=function(){s.deleteProgram(E),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=Ri++,this.code=n,this.usedTimes=1,this.program=E,this.vertexShader=R,this.fragmentShader=P,this}function Bi(e,t,n){var r=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},o=["precision","supportsVertexTextures","map","mapEncoding","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function a(e,t){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=Ut,n===Ut&&t&&(n=Ft),n}this.getParameters=function(t,r,o,s,c,u,l){var h=i[t.type],f=l.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(n.floatVertexTextures)return 1024;var r=n.maxVertexUniforms,i=Math.floor((r-20)/4),o=Math.min(i,t.length);return o<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+o+"."),0):o}(l):0,d=n.precision;null!==t.precision&&(d=n.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",d,"instead.");var p=e.getRenderTarget();return{shaderID:h,precision:d,supportsVertexTextures:n.vertexTextures,outputEncoding:a(p?p.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:a(t.map,e.gammaInput),matcap:!!t.matcap,matcapEncoding:a(t.matcap,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:a(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===Me||t.envMap.mapping===Se),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:a(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===Yt,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!s,useFog:t.fog,fogExp:s&&s.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:t.skinning&&f>0,maxBones:f,useVertexTexture:n.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:c,numClipIntersection:u,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&l.receiveShadow&&o.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===L,flipSided:t.side===A,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)r.push(i),r.push(t.defines[i]);for(var a=0;a<o.length;a++)r.push(n[o[a]]);return r.push(t.onBeforeCompile.toString()),r.push(e.gammaOutput),r.join()},this.acquireProgram=function(i,o,a,s){for(var c,u=0,l=r.length;u<l;u++){var h=r[u];if(h.code===s){++(c=h).usedTimes;break}}return void 0===c&&(c=new Fi(e,t,s,i,o,a,n),r.push(c)),c},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=r.indexOf(e);r[t]=r[r.length-1],r.pop(),e.destroy()}},this.programs=r}function ji(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Hi(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Gi(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Vi(){var e=[],t=0,n=[],r=[];return{opaque:n,transparent:r,init:function(){t=0,n.length=0,r.length=0},push:function(i,o,a,s,c){var u=e[t];void 0===u?(u={id:i.id,object:i,geometry:o,material:a,program:a.program,renderOrder:i.renderOrder,z:s,group:c},e[t]=u):(u.id=i.id,u.object=i,u.geometry=o,u.material=a,u.program=a.program,u.renderOrder=i.renderOrder,u.z=s,u.group=c),(!0===a.transparent?r:n).push(u),t++},sort:function(){n.length>1&&n.sort(Hi),r.length>1&&r.sort(Gi)}}}function Wi(){var e={};return{get:function(t,n){var r=t.id+","+n.id,i=e[r];return void 0===i&&(i=new Vi,e[r]=i),i},dispose:function(){e={}}}}function qi(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Qt,color:new Mn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Jt};break;case"SpotLight":n={position:new Qt,direction:new Qt,color:new Mn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Jt};break;case"PointLight":n={position:new Qt,color:new Mn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Jt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new Qt,skyColor:new Mn,groundColor:new Mn};break;case"RectAreaLight":n={color:new Mn,position:new Qt,halfWidth:new Qt,halfHeight:new Qt}}return e[t.id]=n,n}}}var Xi,Yi,Zi,Ji,$i,Ki,Qi=0;function eo(){var e=new qi,t={id:Qi++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=new Qt,r=new $t,i=new $t;return{setup:function(o,a,s){for(var c=0,u=0,l=0,h=0,f=0,d=0,p=0,m=0,g=s.matrixWorldInverse,v=0,_=o.length;v<_;v++){var y=o[v],x=y.color,b=y.intensity,w=y.distance,E=y.shadow&&y.shadow.map?y.shadow.map.texture:null;if(y.isAmbientLight)c+=x.r*b,u+=x.g*b,l+=x.b*b;else if(y.isDirectionalLight){if((S=e.get(y)).color.copy(y.color).multiplyScalar(y.intensity),S.direction.setFromMatrixPosition(y.matrixWorld),n.setFromMatrixPosition(y.target.matrixWorld),S.direction.sub(n),S.direction.transformDirection(g),S.shadow=y.castShadow,y.castShadow){var M=y.shadow;S.shadowBias=M.bias,S.shadowRadius=M.radius,S.shadowMapSize=M.mapSize}t.directionalShadowMap[h]=E,t.directionalShadowMatrix[h]=y.shadow.matrix,t.directional[h]=S,h++}else if(y.isSpotLight){if((S=e.get(y)).position.setFromMatrixPosition(y.matrixWorld),S.position.applyMatrix4(g),S.color.copy(x).multiplyScalar(b),S.distance=w,S.direction.setFromMatrixPosition(y.matrixWorld),n.setFromMatrixPosition(y.target.matrixWorld),S.direction.sub(n),S.direction.transformDirection(g),S.coneCos=Math.cos(y.angle),S.penumbraCos=Math.cos(y.angle*(1-y.penumbra)),S.decay=y.decay,S.shadow=y.castShadow,y.castShadow){M=y.shadow;S.shadowBias=M.bias,S.shadowRadius=M.radius,S.shadowMapSize=M.mapSize}t.spotShadowMap[d]=E,t.spotShadowMatrix[d]=y.shadow.matrix,t.spot[d]=S,d++}else if(y.isRectAreaLight){(S=e.get(y)).color.copy(x).multiplyScalar(b),S.position.setFromMatrixPosition(y.matrixWorld),S.position.applyMatrix4(g),i.identity(),r.copy(y.matrixWorld),r.premultiply(g),i.extractRotation(r),S.halfWidth.set(.5*y.width,0,0),S.halfHeight.set(0,.5*y.height,0),S.halfWidth.applyMatrix4(i),S.halfHeight.applyMatrix4(i),t.rectArea[p]=S,p++}else if(y.isPointLight){if((S=e.get(y)).position.setFromMatrixPosition(y.matrixWorld),S.position.applyMatrix4(g),S.color.copy(y.color).multiplyScalar(y.intensity),S.distance=y.distance,S.decay=y.decay,S.shadow=y.castShadow,y.castShadow){M=y.shadow;S.shadowBias=M.bias,S.shadowRadius=M.radius,S.shadowMapSize=M.mapSize,S.shadowCameraNear=M.camera.near,S.shadowCameraFar=M.camera.far}t.pointShadowMap[f]=E,t.pointShadowMatrix[f]=y.shadow.matrix,t.point[f]=S,f++}else if(y.isHemisphereLight){var S;(S=e.get(y)).direction.setFromMatrixPosition(y.matrixWorld),S.direction.transformDirection(g),S.direction.normalize(),S.skyColor.copy(y.color).multiplyScalar(b),S.groundColor.copy(y.groundColor).multiplyScalar(b),t.hemi[m]=S,m++}}t.ambient[0]=c,t.ambient[1]=u,t.ambient[2]=l,t.directional.length=h,t.spot.length=d,t.rectArea.length=p,t.point.length=f,t.hemi.length=m,t.hash.stateID=t.id,t.hash.directionalLength=h,t.hash.pointLength=f,t.hash.spotLength=d,t.hash.rectAreaLength=p,t.hash.hemiLength=m,t.hash.shadowsLength=a.length},state:t}}function to(){var e=new eo,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(r){e.setup(t,n,r)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function no(){var e={};return{get:function(t,n){var r;return void 0===e[t.id]?(r=new to,e[t.id]={},e[t.id][n.id]=r):void 0===e[t.id][n.id]?(r=new to,e[t.id][n.id]=r):r=e[t.id][n.id],r},dispose:function(){e={}}}}function ro(e){xr.call(this),this.type="MeshDepthMaterial",this.depthPacking=Wt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function io(e){xr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Qt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function oo(e,t,n){for(var r=new vn,i=new $t,o=new Jt,a=new Jt(n,n),s=new Qt,c=new Qt,u=1,l=2,h=1+(u|l),f=new Array(h),d=new Array(h),p={},m={0:A,1:T,2:L},g=[new Qt(1,0,0),new Qt(-1,0,0),new Qt(0,0,1),new Qt(0,0,-1),new Qt(0,1,0),new Qt(0,-1,0)],v=[new Qt(0,1,0),new Qt(0,1,0),new Qt(0,1,0),new Qt(0,1,0),new Qt(0,0,1),new Qt(0,0,-1)],_=[new ln,new ln,new ln,new ln,new ln,new ln],y=0;y!==h;++y){var x=0!=(y&u),b=0!=(y&l),w=new ro({depthPacking:qt,morphTargets:x,skinning:b});f[y]=w;var E=new io({morphTargets:x,skinning:b});d[y]=E}var S=this;function C(t,n,r,i,o,a){var s=t.geometry,c=null,h=f,g=t.customDepthMaterial;if(r&&(h=d,g=t.customDistanceMaterial),g)c=g;else{var v=!1;n.morphTargets&&(s&&s.isBufferGeometry?v=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(v=s.morphTargets&&s.morphTargets.length>0)),t.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var _=t.isSkinnedMesh&&n.skinning,y=0;v&&(y|=u),_&&(y|=l),c=h[y]}if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var x=c.uuid,b=n.uuid,w=p[x];void 0===w&&(w={},p[x]=w);var E=w[b];void 0===E&&(E=c.clone(),w[b]=E),c=E}return c.visible=n.visible,c.wireframe=n.wireframe,c.side=null!=n.shadowSide?n.shadowSide:m[n.side],c.clipShadows=n.clipShadows,c.clippingPlanes=n.clippingPlanes,c.clipIntersection=n.clipIntersection,c.wireframeLinewidth=n.wireframeLinewidth,c.linewidth=n.linewidth,r&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(i),c.nearDistance=o,c.farDistance=a),c}function R(n,i,o,a){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var s=t.update(n),u=n.material;if(Array.isArray(u))for(var l=s.groups,h=0,f=l.length;h<f;h++){var d=l[h],p=u[d.materialIndex];if(p&&p.visible){var m=C(n,p,a,c,o.near,o.far);e.renderBufferDirect(o,null,s,m,n,d)}}else if(u.visible){m=C(n,u,a,c,o.near,o.far);e.renderBufferDirect(o,null,s,m,n,null)}}for(var g=n.children,v=0,_=g.length;v<_;v++)R(g[v],i,o,a)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=M,this.render=function(t,n,u){if(!1!==S.enabled&&(!1!==S.autoUpdate||!1!==S.needsUpdate)&&0!==t.length){var l,h=e.context,f=e.state;f.disable(h.BLEND),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var d=0,p=t.length;d<p;d++){var m=t[d],y=m.shadow,x=m&&m.isPointLight;if(void 0!==y){var b=y.camera;if(o.copy(y.mapSize),o.min(a),x){var w=o.x,E=o.y;_[0].set(2*w,E,w,E),_[1].set(0,E,w,E),_[2].set(3*w,E,w,E),_[3].set(w,E,w,E),_[4].set(3*w,0,w,E),_[5].set(w,0,w,E),o.x*=4,o.y*=2}if(null===y.map){var M={minFilter:Ce,magFilter:Ce,format:Ze};y.map=new hn(o.x,o.y,M),y.map.texture.name=m.name+".shadowMap",b.updateProjectionMatrix()}y.isSpotLightShadow&&y.update(m);var T=y.map,A=y.matrix;c.setFromMatrixPosition(m.matrixWorld),b.position.copy(c),x?(l=6,A.makeTranslation(-c.x,-c.y,-c.z)):(l=1,s.setFromMatrixPosition(m.target.matrixWorld),b.lookAt(s),b.updateMatrixWorld(),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(b.projectionMatrix),A.multiply(b.matrixWorldInverse)),e.setRenderTarget(T),e.clear();for(var L=0;L<l;L++){if(x){s.copy(b.position),s.add(g[L]),b.up.copy(v[L]),b.lookAt(s),b.updateMatrixWorld();var C=_[L];f.viewport(C)}i.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),r.setFromMatrix(i),R(n,u,b,x)}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}S.needsUpdate=!1}}}function ao(e,t,n,r){var i=new function(){var t=!1,n=new ln,r=null,i=new ln(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,a,s){!0===s&&(t*=a,r*=a,o*=a),n.set(t,r,o,a),!1===i.equals(n)&&(e.clearColor(t,r,o,a),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(t){t?$(e.DEPTH_TEST):K(e.DEPTH_TEST)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case ne:e.depthFunc(e.NEVER);break;case re:e.depthFunc(e.ALWAYS);break;case ie:e.depthFunc(e.LESS);break;case oe:e.depthFunc(e.LEQUAL);break;case ae:e.depthFunc(e.EQUAL);break;case se:e.depthFunc(e.GEQUAL);break;case ce:e.depthFunc(e.GREATER);break;case ue:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},a=new function(){var t=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,u=null;return{setTest:function(t){t?$(e.STENCIL_TEST):K(e.STENCIL_TEST)},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,a){r===t&&i===n&&o===a||(e.stencilFunc(t,n,a),r=t,i=n,o=a)},setOp:function(t,n,r){a===t&&s===n&&c===r||(e.stencilOp(t,n,r),a=t,s=n,c=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,u=null}}},s=e.getParameter(e.MAX_VERTEX_ATTRIBS),c=new Uint8Array(s),u=new Uint8Array(s),l=new Uint8Array(s),h={},f=null,d=null,p=null,m=null,g=null,x=null,b=null,w=null,E=null,M=null,S=!1,T=null,C=null,R=null,P=null,O=null,N=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),j=!1,H=0,G=e.getParameter(e.VERSION);-1!==G.indexOf("WebGL")?(H=parseFloat(/^WebGL\ ([0-9])/.exec(G)[1]),j=H>=1):-1!==G.indexOf("OpenGL ES")&&(H=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(G)[1]),j=H>=2);var V=null,W={},q=new ln,X=new ln;function Y(t,n,r){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var a=0;a<r;a++)e.texImage2D(n+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return o}var Z={};function J(n,i){(c[n]=1,0===u[n]&&(e.enableVertexAttribArray(n),u[n]=1),l[n]!==i)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),l[n]=i)}function $(t){!0!==h[t]&&(e.enable(t),h[t]=!0)}function K(t){!1!==h[t]&&(e.disable(t),h[t]=!1)}function Q(t,r,i,o,a,s,c,u){if(t!==I){if(p||($(e.BLEND),p=!0),t===F)a=a||r,s=s||i,c=c||o,r===g&&a===w||(e.blendEquationSeparate(n.convert(r),n.convert(a)),g=r,w=a),i===x&&o===b&&s===E&&c===M||(e.blendFuncSeparate(n.convert(i),n.convert(o),n.convert(s),n.convert(c)),x=i,b=o,E=s,M=c),m=t,S=null;else if(t!==m||u!==S){if(g===B&&w===B||(e.blendEquation(e.FUNC_ADD),g=B,w=B),u)switch(t){case D:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case z:e.blendFunc(e.ONE,e.ONE);break;case U:e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA);break;case k:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case D:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case z:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case U:e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR);break;case k:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}x=null,b=null,E=null,M=null,m=t,S=u}}else p&&(K(e.BLEND),p=!1)}function ee(t){T!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),T=t)}function te(t){t!==v?($(e.CULL_FACE),t!==C&&(t===_?e.cullFace(e.BACK):t===y?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):K(e.CULL_FACE),C=t}function le(t,n,r){t?($(e.POLYGON_OFFSET_FILL),P===n&&O===r||(e.polygonOffset(n,r),P=n,O=r)):K(e.POLYGON_OFFSET_FILL)}function he(t){void 0===t&&(t=e.TEXTURE0+N-1),V!==t&&(e.activeTexture(t),V=t)}return Z[e.TEXTURE_2D]=Y(e.TEXTURE_2D,e.TEXTURE_2D,1),Z[e.TEXTURE_CUBE_MAP]=Y(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),$(e.DEPTH_TEST),o.setFunc(oe),ee(!1),te(_),$(e.CULL_FACE),Q(I),{buffers:{color:i,depth:o,stencil:a},initAttributes:function(){for(var e=0,t=c.length;e<t;e++)c[e]=0},enableAttribute:function(e){J(e,0)},enableAttributeAndDivisor:J,disableUnusedAttributes:function(){for(var t=0,n=u.length;t!==n;++t)u[t]!==c[t]&&(e.disableVertexAttribArray(t),u[t]=0)},enable:$,disable:K,getCompressedTextureFormats:function(){if(null===f&&(f=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var n=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),r=0;r<n.length;r++)f.push(n[r]);return f},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:Q,setMaterial:function(t,n){t.side===L?K(e.CULL_FACE):$(e.CULL_FACE);var r=t.side===A;n&&(r=!r),ee(r),t.blending===D&&!1===t.transparent?Q(I):Q(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite),le(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:ee,setCullFace:te,setLineWidth:function(t){t!==R&&(j&&e.lineWidth(t),R=t)},setPolygonOffset:le,setScissorTest:function(t){t?$(e.SCISSOR_TEST):K(e.SCISSOR_TEST)},activeTexture:he,bindTexture:function(t,n){null===V&&he();var r=W[V];void 0===r&&(r={type:void 0,texture:void 0},W[V]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||Z[t]),r.type=t,r.texture=n)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===q.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),q.copy(t))},viewport:function(t){!1===X.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),X.copy(t))},reset:function(){for(var t=0;t<u.length;t++)1===u[t]&&(e.disableVertexAttribArray(t),u[t]=0);h={},f=null,V=null,W={},d=null,m=null,T=null,C=null,i.reset(),o.reset(),a.reset()}}}function so(e,t,n,r,i,o,a){var s,c={};function u(e,t){if(e.width>t||e.height>t){if("data"in e)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+e.width+"x"+e.height+").");var n=t/Math.max(e.width,e.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return r.width=Math.floor(e.width*n),r.height=Math.floor(e.height*n),r.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+r.width+"x"+r.height),r}return e}function l(e){return Zt.isPowerOfTwo(e.width)&&Zt.isPowerOfTwo(e.height)}function h(e,t){return e.generateMipmaps&&t&&e.minFilter!==Ce&&e.minFilter!==Oe}function f(t,n,i,o){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function d(t,n){if(!i.isWebGL2)return t;if(t===e.RED){if(n===e.FLOAT)return e.R32F;if(n===e.HALF_FLOAT)return e.R16F;if(n===e.UNSIGNED_BYTE)return e.R8}if(t===e.RGB){if(n===e.FLOAT)return e.RGB32F;if(n===e.HALF_FLOAT)return e.RGB16F;if(n===e.UNSIGNED_BYTE)return e.RGB8}if(t===e.RGBA){if(n===e.FLOAT)return e.RGBA32F;if(n===e.HALF_FLOAT)return e.RGBA16F;if(n===e.UNSIGNED_BYTE)return e.RGBA8}return t}function p(t){return t===Ce||t===Re||t===Pe?e.NEAREST:e.LINEAR}function m(t){var n=t.target;n.removeEventListener("dispose",m),function(t){var n=r.get(t);if(t.image&&n.__image__webglTextureCube)e.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture)}r.remove(t)}(n),n.isVideoTexture&&delete c[n.id],a.memory.textures--}function g(t){var n=t.target;n.removeEventListener("dispose",g),function(t){var n=r.get(t),i=r.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[o]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(t.texture),r.remove(t)}(n),a.memory.textures--}function v(t,i){var o=r.get(t);if(t.isVideoTexture&&function(e){var t=e.id,n=a.render.frame;c[t]!==n&&(c[t]=n,e.update())}(t),t.version>0&&o.__version!==t.version){var s=t.image;if(void 0===s)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==s.complete)return void y(o,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_2D,o.__webglTexture)}function _(n,a,s){var c;if(s?(e.texParameteri(n,e.TEXTURE_WRAP_S,o.convert(a.wrapS)),e.texParameteri(n,e.TEXTURE_WRAP_T,o.convert(a.wrapT)),e.texParameteri(n,e.TEXTURE_MAG_FILTER,o.convert(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,o.convert(a.minFilter))):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),a.wrapS===Ae&&a.wrapT===Ae||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,p(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,p(a.minFilter)),a.minFilter!==Ce&&a.minFilter!==Oe&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),c=t.get("EXT_texture_filter_anisotropic")){if(a.type===je&&null===t.get("OES_texture_float_linear"))return;if(a.type===He&&null===(i.isWebGL2||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function y(t,r,c){var p;p=r.isDataTexture3D?e.TEXTURE_3D:e.TEXTURE_2D,void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",m),t.__webglTexture=e.createTexture(),a.memory.textures++),n.activeTexture(e.TEXTURE0+c),n.bindTexture(p,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,r.unpackAlignment);var g=u(r.image,i.maxTextureSize);(function(e){return!i.isWebGL2&&(e.wrapS!==Ae||e.wrapT!==Ae||e.minFilter!==Ce&&e.minFilter!==Oe)})(r)&&!1===l(g)&&(g=function(e){return e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap?(void 0===s&&(s=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),s.width=Zt.floorPowerOfTwo(e.width),s.height=Zt.floorPowerOfTwo(e.height),s.getContext("2d").drawImage(e,0,0,s.width,s.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+s.width+"x"+s.height),s):e}(g));var v=l(g),y=o.convert(r.format),x=o.convert(r.type),b=d(y,x);_(p,r,v);var w,E=r.mipmaps;if(r.isDepthTexture){if(b=e.DEPTH_COMPONENT,r.type===je){if(!i.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");b=e.DEPTH_COMPONENT32F}else i.isWebGL2&&(b=e.DEPTH_COMPONENT16);r.format===Qe&&b===e.DEPTH_COMPONENT&&r.type!==ke&&r.type!==Be&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=ke,x=o.convert(r.type)),r.format===et&&(b=e.DEPTH_STENCIL,r.type!==qe&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=qe,x=o.convert(r.type))),n.texImage2D(e.TEXTURE_2D,0,b,g.width,g.height,0,y,x,null)}else if(r.isDataTexture)if(E.length>0&&v){for(var M=0,S=E.length;M<S;M++)w=E[M],n.texImage2D(e.TEXTURE_2D,M,b,w.width,w.height,0,y,x,w.data);r.generateMipmaps=!1,t.__maxMipLevel=E.length-1}else n.texImage2D(e.TEXTURE_2D,0,b,g.width,g.height,0,y,x,g.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(M=0,S=E.length;M<S;M++)w=E[M],r.format!==Ze&&r.format!==Ye?n.getCompressedTextureFormats().indexOf(y)>-1?n.compressedTexImage2D(e.TEXTURE_2D,M,b,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(e.TEXTURE_2D,M,b,w.width,w.height,0,y,x,w.data);t.__maxMipLevel=E.length-1}else if(r.isDataTexture3D)n.texImage3D(e.TEXTURE_3D,0,b,g.width,g.height,g.depth,0,y,x,g.data),t.__maxMipLevel=0;else if(E.length>0&&v){for(M=0,S=E.length;M<S;M++)w=E[M],n.texImage2D(e.TEXTURE_2D,M,b,y,x,w);r.generateMipmaps=!1,t.__maxMipLevel=E.length-1}else n.texImage2D(e.TEXTURE_2D,0,b,y,x,g),t.__maxMipLevel=0;h(r,v)&&f(e.TEXTURE_2D,r,g.width,g.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function x(t,i,a,s){var c=o.convert(i.texture.format),u=o.convert(i.texture.type),l=d(c,u);n.texImage2D(s,0,l,i.width,i.height,0,c,u,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,a,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function b(t,n){e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):n.depthBuffer&&n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,n.width,n.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function w(t){var n=r.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),v(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Qe)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0);else{if(n.depthTexture.format!==et)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=e.createRenderbuffer(),b(n.__webglDepthbuffer[o],t)}else e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),b(n.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}this.setTexture2D=v,this.setTexture3D=function(t,i){var o=r.get(t);t.version>0&&o.__version!==t.version?y(o,t,i):(n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_3D,o.__webglTexture))},this.setTextureCube=function(t,s){var c=r.get(t);if(6===t.image.length)if(t.version>0&&c.__version!==t.version){c.__image__webglTextureCube||(t.addEventListener("dispose",m),c.__image__webglTextureCube=e.createTexture(),a.memory.textures++),n.activeTexture(e.TEXTURE0+s),n.bindTexture(e.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var p=t&&t.isCompressedTexture,g=t.image[0]&&t.image[0].isDataTexture,v=[],y=0;y<6;y++)v[y]=p||g?g?t.image[y].image:t.image[y]:u(t.image[y],i.maxCubemapSize);var x=v[0],b=l(x),w=o.convert(t.format),E=o.convert(t.type),M=d(w,E);_(e.TEXTURE_CUBE_MAP,t,b);for(y=0;y<6;y++)if(p)for(var S,T=v[y].mipmaps,A=0,L=T.length;A<L;A++)S=T[A],t.format!==Ze&&t.format!==Ye?n.getCompressedTextureFormats().indexOf(w)>-1?n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,A,M,S.width,S.height,0,S.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,A,M,S.width,S.height,0,w,E,S.data);else g?n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,M,v[y].width,v[y].height,0,w,E,v[y].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,M,w,E,v[y]);c.__maxMipLevel=p?T.length-1:0,h(t,b)&&f(e.TEXTURE_CUBE_MAP,t,x.width,x.height),c.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(e.TEXTURE0+s),n.bindTexture(e.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,i){n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_CUBE_MAP,r.get(t).__webglTexture)},this.setupRenderTarget=function(t){var i=r.get(t),o=r.get(t.texture);t.addEventListener("dispose",g),o.__webglTexture=e.createTexture(),a.memory.textures++;var s=!0===t.isWebGLRenderTargetCube,c=l(t);if(s){i.__webglFramebuffer=[];for(var u=0;u<6;u++)i.__webglFramebuffer[u]=e.createFramebuffer()}else i.__webglFramebuffer=e.createFramebuffer();if(s){n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture),_(e.TEXTURE_CUBE_MAP,t.texture,c);for(u=0;u<6;u++)x(i.__webglFramebuffer[u],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+u);h(t.texture,c)&&f(e.TEXTURE_CUBE_MAP,t.texture,t.width,t.height),n.bindTexture(e.TEXTURE_CUBE_MAP,null)}else n.bindTexture(e.TEXTURE_2D,o.__webglTexture),_(e.TEXTURE_2D,t.texture,c),x(i.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),h(t.texture,c)&&f(e.TEXTURE_2D,t.texture,t.width,t.height),n.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&w(t)},this.updateRenderTargetMipmap=function(t){var i=t.texture;if(h(i,l(t))){var o=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=r.get(i).__webglTexture;n.bindTexture(o,a),f(o,i,t.width,t.height),n.bindTexture(o,null)}}}function co(e,t,n){return{convert:function(r){var i;if(r===Te)return e.REPEAT;if(r===Ae)return e.CLAMP_TO_EDGE;if(r===Le)return e.MIRRORED_REPEAT;if(r===Ce)return e.NEAREST;if(r===Re)return e.NEAREST_MIPMAP_NEAREST;if(r===Pe)return e.NEAREST_MIPMAP_LINEAR;if(r===Oe)return e.LINEAR;if(r===Ne)return e.LINEAR_MIPMAP_NEAREST;if(r===Ie)return e.LINEAR_MIPMAP_LINEAR;if(r===De)return e.UNSIGNED_BYTE;if(r===Ge)return e.UNSIGNED_SHORT_4_4_4_4;if(r===Ve)return e.UNSIGNED_SHORT_5_5_5_1;if(r===We)return e.UNSIGNED_SHORT_5_6_5;if(r===ze)return e.BYTE;if(r===Ue)return e.SHORT;if(r===ke)return e.UNSIGNED_SHORT;if(r===Fe)return e.INT;if(r===Be)return e.UNSIGNED_INT;if(r===je)return e.FLOAT;if(r===He){if(n.isWebGL2)return e.HALF_FLOAT;if(null!==(i=t.get("OES_texture_half_float")))return i.HALF_FLOAT_OES}if(r===Xe)return e.ALPHA;if(r===Ye)return e.RGB;if(r===Ze)return e.RGBA;if(r===Je)return e.LUMINANCE;if(r===$e)return e.LUMINANCE_ALPHA;if(r===Qe)return e.DEPTH_COMPONENT;if(r===et)return e.DEPTH_STENCIL;if(r===tt)return e.RED;if(r===B)return e.FUNC_ADD;if(r===j)return e.FUNC_SUBTRACT;if(r===H)return e.FUNC_REVERSE_SUBTRACT;if(r===W)return e.ZERO;if(r===q)return e.ONE;if(r===X)return e.SRC_COLOR;if(r===Y)return e.ONE_MINUS_SRC_COLOR;if(r===Z)return e.SRC_ALPHA;if(r===J)return e.ONE_MINUS_SRC_ALPHA;if(r===$)return e.DST_ALPHA;if(r===K)return e.ONE_MINUS_DST_ALPHA;if(r===Q)return e.DST_COLOR;if(r===ee)return e.ONE_MINUS_DST_COLOR;if(r===te)return e.SRC_ALPHA_SATURATE;if((r===nt||r===rt||r===it||r===ot)&&null!==(i=t.get("WEBGL_compressed_texture_s3tc"))){if(r===nt)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===rt)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===it)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===ot)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((r===at||r===st||r===ct||r===ut)&&null!==(i=t.get("WEBGL_compressed_texture_pvrtc"))){if(r===at)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===st)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===ct)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===ut)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===lt&&null!==(i=t.get("WEBGL_compressed_texture_etc1")))return i.COMPRESSED_RGB_ETC1_WEBGL;if((r===ht||r===ft||r===dt||r===pt||r===mt||r===gt||r===vt||r===_t||r===yt||r===xt||r===bt||r===wt||r===Et||r===Mt)&&null!==(i=t.get("WEBGL_compressed_texture_astc")))return r;if(r===G||r===V){if(n.isWebGL2){if(r===G)return e.MIN;if(r===V)return e.MAX}if(null!==(i=t.get("EXT_blend_minmax"))){if(r===G)return i.MIN_EXT;if(r===V)return i.MAX_EXT}}if(r===qe){if(n.isWebGL2)return e.UNSIGNED_INT_24_8;if(null!==(i=t.get("WEBGL_depth_texture")))return i.UNSIGNED_INT_24_8_WEBGL}return 0}}}function uo(){kn.call(this),this.type="Group"}function lo(){kn.call(this),this.type="Camera",this.matrixWorldInverse=new $t,this.projectionMatrix=new $t,this.projectionMatrixInverse=new $t}function ho(e,t,n,r){lo.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function fo(e){ho.call(this),this.cameras=e||[]}function po(e){var t=this,n=null,r=null,i=null,o=[],a=new $t,s=new $t,c="stage";"undefined"!=typeof window&&"VRFrameData"in window&&(r=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",_,!1));var u=new $t,l=new Kt,h=new Qt,f=new ho;f.bounds=new ln(0,0,.5,1),f.layers.enable(1);var d=new ho;d.bounds=new ln(.5,0,.5,1),d.layers.enable(2);var p,m,g=new fo([f,d]);function v(){return null!==n&&!0===n.isPresenting}function _(){if(v()){var r=n.getEyeParameters("left"),i=r.renderWidth,o=r.renderHeight;m=e.getPixelRatio(),p=e.getSize(),e.setDrawingBufferSize(2*i,o,1),b.start()}else t.enabled&&e.setDrawingBufferSize(p.width,p.height,m),b.stop()}g.layers.enable(1),g.layers.enable(2);var y=[];function x(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),n=0,r=0,i=t.length;n<i;n++){var o=t[n];if(o&&("Daydream Controller"===o.id||"Gear VR Controller"===o.id||"Oculus Go Controller"===o.id||"OpenVR Gamepad"===o.id||o.id.startsWith("Oculus Touch")||o.id.startsWith("Spatial Controller"))){if(r===e)return o;r++}}}this.enabled=!1,this.getController=function(e){var t=o[e];return void 0===t&&((t=new uo).matrixAutoUpdate=!1,t.visible=!1,o[e]=t),t},this.getDevice=function(){return n},this.setDevice=function(e){void 0!==e&&(n=e),b.setContext(e)},this.setFrameOfReferenceType=function(e){c=e},this.setPoseTarget=function(e){void 0!==e&&(i=e)},this.getCamera=function(e){var t="stage"===c?1.6:0;if(null===n)return e.position.set(0,t,0),e;if(n.depthNear=e.near,n.depthFar=e.far,n.getFrameData(r),"stage"===c){var p=n.stageParameters;p?a.fromArray(p.sittingToStandingTransform):a.makeTranslation(0,t,0)}var m=r.pose,v=null!==i?i:e;if(v.matrix.copy(a),v.matrix.decompose(v.position,v.quaternion,v.scale),null!==m.orientation&&(l.fromArray(m.orientation),v.quaternion.multiply(l)),null!==m.position&&(l.setFromRotationMatrix(a),h.fromArray(m.position),h.applyQuaternion(l),v.position.add(h)),v.updateMatrixWorld(),!1===n.isPresenting)return e;f.near=e.near,d.near=e.near,f.far=e.far,d.far=e.far,g.matrixWorld.copy(e.matrixWorld),g.matrixWorldInverse.copy(e.matrixWorldInverse),f.matrixWorldInverse.fromArray(r.leftViewMatrix),d.matrixWorldInverse.fromArray(r.rightViewMatrix),s.getInverse(a),"stage"===c&&(f.matrixWorldInverse.multiply(s),d.matrixWorldInverse.multiply(s));var _=v.parent;null!==_&&(u.getInverse(_.matrixWorld),f.matrixWorldInverse.multiply(u),d.matrixWorldInverse.multiply(u)),f.matrixWorld.getInverse(f.matrixWorldInverse),d.matrixWorld.getInverse(d.matrixWorldInverse),f.projectionMatrix.fromArray(r.leftProjectionMatrix),d.projectionMatrix.fromArray(r.rightProjectionMatrix),g.projectionMatrix.copy(f.projectionMatrix);var b=n.getLayers();if(b.length){var w=b[0];null!==w.leftBounds&&4===w.leftBounds.length&&f.bounds.fromArray(w.leftBounds),null!==w.rightBounds&&4===w.rightBounds.length&&d.bounds.fromArray(w.rightBounds)}return function(){for(var e=0;e<o.length;e++){var t=o[e],n=x(e);if(void 0!==n&&void 0!==n.pose){if(null===n.pose)return;var r=n.pose;!1===r.hasPosition&&t.position.set(.2,-.6,-.05),null!==r.position&&t.position.fromArray(r.position),null!==r.orientation&&t.quaternion.fromArray(r.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(a),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var i="Daydream Controller"===n.id?0:1;y[e]!==n.buttons[i].pressed&&(y[e]=n.buttons[i].pressed,!0===y[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),g},this.getStandingMatrix=function(){return a},this.isPresenting=v;var b=new Ln;this.setAnimationLoop=function(e){b.setAnimationLoop(e)},this.submitFrame=function(){v()&&n.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",_)}}function mo(e){var t=e.context,n=null,r=null,i=null,o="stage",a=null,s=[],c=[];function u(){return null!==r&&null!==i}var l=new ho;l.layers.enable(1),l.viewport=new ln;var h=new ho;h.layers.enable(2),h.viewport=new ln;var f=new fo([l,h]);function d(e){var t=s[c.indexOf(e.inputSource)];t&&t.dispatchEvent({type:e.type})}function p(){e.setFramebuffer(null),v.stop()}function m(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}f.layers.enable(1),f.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=s[e];return void 0===t&&((t=new uo).matrixAutoUpdate=!1,t.visible=!1,s[e]=t),t},this.getDevice=function(){return n},this.setDevice=function(e){void 0!==e&&(n=e),e instanceof XRDevice&&t.setCompatibleXRDevice(e)},this.setFrameOfReferenceType=function(e){o=e},this.setSession=function(n){null!==(r=n)&&(r.addEventListener("select",d),r.addEventListener("selectstart",d),r.addEventListener("selectend",d),r.addEventListener("end",p),r.baseLayer=new XRWebGLLayer(r,t),r.requestFrameOfReference(o).then((function(t){i=t,e.setFramebuffer(r.baseLayer.framebuffer),v.setContext(r),v.start()})),c=r.getInputSources(),r.addEventListener("inputsourceschange",(function(){c=r.getInputSources(),console.log(c)})))},this.getCamera=function(e){if(u()){var t=e.parent,n=f.cameras;m(f,t);for(var r=0;r<n.length;r++)m(n[r],t);e.matrixWorld.copy(f.matrixWorld);for(var i=e.children,o=(r=0,i.length);r<o;r++)i[r].updateMatrixWorld(!0);return f}return e},this.isPresenting=u;var g=null;var v=new Ln;v.setAnimationLoop((function(e,t){if(null!==(a=t.getDevicePose(i)))for(var n=r.baseLayer,o=t.views,u=0;u<o.length;u++){var l=o[u],h=n.getViewport(l),d=a.getViewMatrix(l),p=f.cameras[u];p.matrix.fromArray(d).getInverse(p.matrix),p.projectionMatrix.fromArray(l.projectionMatrix),p.viewport.set(h.x,h.y,h.width,h.height),0===u&&(f.matrix.copy(p.matrix),f.projectionMatrix.copy(p.projectionMatrix))}for(u=0;u<s.length;u++){var m=s[u],v=c[u];if(v){var _=t.getInputPose(v,i);if(null!==_){"targetRay"in _?m.matrix.elements=_.targetRay.transformMatrix:"pointerMatrix"in _&&(m.matrix.elements=_.pointerMatrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.visible=!0;continue}}m.visible=!1}g&&g(e)})),this.setAnimationLoop=function(e){g=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new THREE.Matrix4},this.submitFrame=function(){}}function go(e){console.log("THREE.WebGLRenderer",m);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,c=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",l=null,h=null;this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=pe,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var f,d,p,g,v,_,y,x,b,w,E,M,S,T,L,C,R,P,O=this,N=!1,I=null,D=null,z=null,U=-1,k={geometry:null,program:null,wireframe:!1},F=null,B=null,j=new ln,H=new ln,G=null,V=0,W=t.width,q=t.height,X=1,Y=new ln(0,0,W,q),Z=new ln(0,0,W,q),J=!1,$=new vn,K=new Cr,Q=!1,ee=!1,te=new $t,ne=new Qt;function re(){return null===D?X:1}try{var ie={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:c,powerPreference:u};if(t.addEventListener("webglcontextlost",ce,!1),t.addEventListener("webglcontextrestored",ue,!1),null===(f=n||t.getContext("webgl",ie)||t.getContext("experimental-webgl",ie)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===f.getShaderPrecisionFormat&&(f.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){console.error("THREE.WebGLRenderer: "+e.message)}function oe(){d=new Rr(f),(p=new Lr(f,d,e)).isWebGL2||(d.get("WEBGL_depth_texture"),d.get("OES_texture_float"),d.get("OES_texture_half_float"),d.get("OES_texture_half_float_linear"),d.get("OES_standard_derivatives"),d.get("OES_element_index_uint"),d.get("ANGLE_instanced_arrays")),d.get("OES_texture_float_linear"),P=new co(f,d,p),(g=new ao(f,d,P,p)).scissor(H.copy(Z).multiplyScalar(X)),g.viewport(j.copy(Y).multiplyScalar(X)),v=new Nr(f),_=new ji,y=new so(f,d,g,_,p,P,v),x=new Cn(f),b=new Pr(f,x,v),w=new zr(b,v),L=new Dr(f),E=new Bi(O,d,p),M=new Wi,S=new no,T=new Tr(O,g,w,s),C=new Ar(f,d,v,p),R=new Or(f,d,v,p),v.programs=E.programs,O.context=f,O.capabilities=p,O.extensions=d,O.properties=_,O.renderLists=M,O.state=g,O.info=v}oe();var ae=null;"undefined"!=typeof navigator&&(ae="xr"in navigator?new mo(O):new po(O)),this.vr=ae;var se=new oo(O,w,p.maxTextureSize);function ce(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),N=!0}function ue(){console.log("THREE.WebGLRenderer: Context Restored."),N=!1,oe()}function le(e){var t=e.target;t.removeEventListener("dispose",le),function(e){he(e),_.remove(e)}(t)}function he(e){var t=_.get(e).program;e.program=void 0,void 0!==t&&E.releaseProgram(t)}this.shadowMap=se,this.getContext=function(){return f},this.getContextAttributes=function(){return f.getContextAttributes()},this.forceContextLoss=function(){var e=d.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=d.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(e){void 0!==e&&(X=e,this.setSize(W,q,!1))},this.getSize=function(){return{width:W,height:q}},this.setSize=function(e,n,r){ae.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(W=e,q=n,t.width=e*X,t.height=n*X,!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(){return{width:W*X,height:q*X}},this.setDrawingBufferSize=function(e,n,r){W=e,q=n,X=r,t.width=e*r,t.height=n*r,this.setViewport(0,0,e,n)},this.getCurrentViewport=function(){return j},this.setViewport=function(e,t,n,r){Y.set(e,q-t-r,n,r),g.viewport(j.copy(Y).multiplyScalar(X))},this.setScissor=function(e,t,n,r){Z.set(e,q-t-r,n,r),g.scissor(H.copy(Z).multiplyScalar(X))},this.setScissorTest=function(e){g.setScissorTest(J=e)},this.getClearColor=function(){return T.getClearColor()},this.setClearColor=function(){T.setClearColor.apply(T,arguments)},this.getClearAlpha=function(){return T.getClearAlpha()},this.setClearAlpha=function(){T.setClearAlpha.apply(T,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=f.COLOR_BUFFER_BIT),(void 0===t||t)&&(r|=f.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=f.STENCIL_BUFFER_BIT),f.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ce,!1),t.removeEventListener("webglcontextrestored",ue,!1),M.dispose(),S.dispose(),_.dispose(),w.dispose(),ae.dispose(),me.stop()},this.renderBufferImmediate=function(e,t){g.initAttributes();var n=_.get(e);e.hasPositions&&!n.position&&(n.position=f.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=f.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=f.createBuffer()),e.hasColors&&!n.color&&(n.color=f.createBuffer());var r=t.getAttributes();e.hasPositions&&(f.bindBuffer(f.ARRAY_BUFFER,n.position),f.bufferData(f.ARRAY_BUFFER,e.positionArray,f.DYNAMIC_DRAW),g.enableAttribute(r.position),f.vertexAttribPointer(r.position,3,f.FLOAT,!1,0,0)),e.hasNormals&&(f.bindBuffer(f.ARRAY_BUFFER,n.normal),f.bufferData(f.ARRAY_BUFFER,e.normalArray,f.DYNAMIC_DRAW),g.enableAttribute(r.normal),f.vertexAttribPointer(r.normal,3,f.FLOAT,!1,0,0)),e.hasUvs&&(f.bindBuffer(f.ARRAY_BUFFER,n.uv),f.bufferData(f.ARRAY_BUFFER,e.uvArray,f.DYNAMIC_DRAW),g.enableAttribute(r.uv),f.vertexAttribPointer(r.uv,2,f.FLOAT,!1,0,0)),e.hasColors&&(f.bindBuffer(f.ARRAY_BUFFER,n.color),f.bufferData(f.ARRAY_BUFFER,e.colorArray,f.DYNAMIC_DRAW),g.enableAttribute(r.color),f.vertexAttribPointer(r.color,3,f.FLOAT,!1,0,0)),g.disableUnusedAttributes(),f.drawArrays(f.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,o){var a=i.isMesh&&i.normalMatrix.determinant()<0;g.setMaterial(r,a);var s=ye(e,t,r,i),c=!1;k.geometry===n.id&&k.program===s.id&&k.wireframe===(!0===r.wireframe)||(k.geometry=n.id,k.program=s.id,k.wireframe=!0===r.wireframe,c=!0),i.morphTargetInfluences&&(L.update(i,n,r,s),c=!0);var u,l=n.index,h=n.attributes.position,m=1;!0===r.wireframe&&(l=b.getWireframeAttribute(n),m=2);var v=C;null!==l&&(u=x.get(l),(v=R).setIndex(u)),c&&(!function(e,t,n){if(n&&n.isInstancedBufferGeometry&!p.isWebGL2&&null===d.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");g.initAttributes();var r=n.attributes,i=t.getAttributes(),o=e.defaultAttributeValues;for(var a in i){var s=i[a];if(s>=0){var c=r[a];if(void 0!==c){var u=c.normalized,l=c.itemSize,h=x.get(c);if(void 0===h)continue;var m=h.buffer,v=h.type,_=h.bytesPerElement;if(c.isInterleavedBufferAttribute){var y=c.data,b=y.stride,w=c.offset;y&&y.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(s,y.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=y.meshPerAttribute*y.count)):g.enableAttribute(s),f.bindBuffer(f.ARRAY_BUFFER,m),f.vertexAttribPointer(s,l,v,u,b*_,w*_)}else c.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(s,c.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=c.meshPerAttribute*c.count)):g.enableAttribute(s),f.bindBuffer(f.ARRAY_BUFFER,m),f.vertexAttribPointer(s,l,v,u,0,0)}else if(void 0!==o){var E=o[a];if(void 0!==E)switch(E.length){case 2:f.vertexAttrib2fv(s,E);break;case 3:f.vertexAttrib3fv(s,E);break;case 4:f.vertexAttrib4fv(s,E);break;default:f.vertexAttrib1fv(s,E)}}}}g.disableUnusedAttributes()}(r,s,n),null!==l&&f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,u.buffer));var _=1/0;null!==l?_=l.count:void 0!==h&&(_=h.count);var y=n.drawRange.start*m,w=n.drawRange.count*m,E=null!==o?o.start*m:0,M=null!==o?o.count*m:1/0,S=Math.max(y,E),T=Math.min(_,y+w,E+M)-1,A=Math.max(0,T-S+1);if(0!==A){if(i.isMesh)if(!0===r.wireframe)g.setLineWidth(r.wireframeLinewidth*re()),v.setMode(f.LINES);else switch(i.drawMode){case It:v.setMode(f.TRIANGLES);break;case Dt:v.setMode(f.TRIANGLE_STRIP);break;case zt:v.setMode(f.TRIANGLE_FAN)}else if(i.isLine){var P=r.linewidth;void 0===P&&(P=1),g.setLineWidth(P*re()),i.isLineSegments?v.setMode(f.LINES):i.isLineLoop?v.setMode(f.LINE_LOOP):v.setMode(f.LINE_STRIP)}else i.isPoints?v.setMode(f.POINTS):i.isSprite&&v.setMode(f.TRIANGLES);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&v.renderInstances(n,S,A):v.render(S,A)}},this.compile=function(e,t){(h=S.get(e,t)).init(),e.traverse((function(e){e.isLight&&(h.pushLight(e),e.castShadow&&h.pushShadow(e))})),h.setupLights(t),e.traverse((function(t){if(t.material)if(Array.isArray(t.material))for(var n=0;n<t.material.length;n++)_e(t.material[n],e.fog,t);else _e(t.material,e.fog,t)}))};var fe=null;var de,me=new Ln;function ge(e,t,n,r){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,c=a.geometry,u=void 0===r?a.material:r,l=a.group;if(n.isArrayCamera){B=n;for(var f=n.cameras,d=0,p=f.length;d<p;d++){var m=f[d];if(s.layers.test(m.layers)){if("viewport"in m)g.viewport(j.copy(m.viewport));else{var v=m.bounds,_=v.x*W,y=v.y*q,x=v.z*W,b=v.w*q;g.viewport(j.set(_,y,x,b).multiplyScalar(X))}h.setupLights(m),ve(s,t,m,c,u,l)}}}else B=null,ve(s,t,n,c,u,l)}}function ve(e,t,n,r,i,o){if(e.onBeforeRender(O,t,n,r,i,o),h=S.get(t,B||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){g.setMaterial(i);var a=ye(n,t.fog,i,e);k.geometry=null,k.program=null,k.wireframe=!1,function(e,t){e.render((function(e){O.renderBufferImmediate(e,t)}))}(e,a)}else O.renderBufferDirect(n,t.fog,r,i,e,o);e.onAfterRender(O,t,n,r,i,o),h=S.get(t,B||n)}function _e(e,t,n){var r=_.get(e),i=h.state.lights,o=h.state.shadowsArray,a=r.lightsHash,s=i.state.hash,c=E.getParameters(e,i.state,o,t,K.numPlanes,K.numIntersection,n),u=E.getProgramCode(e,c),l=r.program,f=!0;if(void 0===l)e.addEventListener("dispose",le);else if(l.code!==u)he(e);else if(a.stateID!==s.stateID||a.directionalLength!==s.directionalLength||a.pointLength!==s.pointLength||a.spotLength!==s.spotLength||a.rectAreaLength!==s.rectAreaLength||a.hemiLength!==s.hemiLength||a.shadowsLength!==s.shadowsLength)a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,f=!1;else{if(void 0!==c.shaderID)return;f=!1}if(f){if(c.shaderID){var d=An[c.shaderID];r.shader={name:e.type,uniforms:wn.clone(d.uniforms),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}}else r.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(r.shader,O),u=E.getProgramCode(e,c),l=E.acquireProgram(e,r.shader,c,u),r.program=l,e.program=l}var p=l.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var m=0;m<O.maxMorphTargets;m++)p["morphTarget"+m]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(m=0;m<O.maxMorphNormals;m++)p["morphNormal"+m]>=0&&e.numSupportedMorphNormals++}var g=r.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=K.numPlanes,r.numIntersection=K.numIntersection,g.clippingPlanes=K.uniform),r.fog=t,void 0===a&&(r.lightsHash=a={}),a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,e.lights&&(g.ambientLightColor.value=i.state.ambient,g.directionalLights.value=i.state.directional,g.spotLights.value=i.state.spot,g.rectAreaLights.value=i.state.rectArea,g.pointLights.value=i.state.point,g.hemisphereLights.value=i.state.hemi,g.directionalShadowMap.value=i.state.directionalShadowMap,g.directionalShadowMatrix.value=i.state.directionalShadowMatrix,g.spotShadowMap.value=i.state.spotShadowMap,g.spotShadowMatrix.value=i.state.spotShadowMatrix,g.pointShadowMap.value=i.state.pointShadowMap,g.pointShadowMatrix.value=i.state.pointShadowMatrix);var v=r.program.getUniforms(),y=Li.seqWithValue(v.seq,g);r.uniformsList=y}function ye(e,t,n,r){V=0;var i=_.get(n),o=h.state.lights,a=i.lightsHash,s=o.state.hash;if(Q&&(ee||e!==F)){var c=e===F&&n.id===U;K.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,i,c)}!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==t?n.needsUpdate=!0:(!n.lights||a.stateID===s.stateID&&a.directionalLength===s.directionalLength&&a.pointLength===s.pointLength&&a.spotLength===s.spotLength&&a.rectAreaLength===s.rectAreaLength&&a.hemiLength===s.hemiLength&&a.shadowsLength===s.shadowsLength)&&(void 0===i.numClippingPlanes||i.numClippingPlanes===K.numPlanes&&i.numIntersection===K.numIntersection)||(n.needsUpdate=!0)),n.needsUpdate&&(_e(n,t,r),n.needsUpdate=!1);var u,l,d=!1,m=!1,v=!1,y=i.program,x=y.getUniforms(),b=i.shader.uniforms;if(g.useProgram(y.program)&&(d=!0,m=!0,v=!0),n.id!==U&&(U=n.id,m=!0),d||F!==e){if(x.setValue(f,"projectionMatrix",e.projectionMatrix),p.logarithmicDepthBuffer&&x.setValue(f,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),F!==e&&(F=e,m=!0,v=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var w=x.map.cameraPosition;void 0!==w&&w.setValue(f,ne.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&x.setValue(f,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){x.setOptional(f,r,"bindMatrix"),x.setOptional(f,r,"bindMatrixInverse");var E=r.skeleton;if(E){var M=E.bones;if(p.floatVertexTextures){if(void 0===E.boneTexture){var S=Math.sqrt(4*M.length);S=Zt.ceilPowerOfTwo(S),S=Math.max(S,4);var T=new Float32Array(S*S*4);T.set(E.boneMatrices);var L=new dn(T,S,S,Ze,je);L.needsUpdate=!0,E.boneMatrices=T,E.boneTexture=L,E.boneTextureSize=S}x.setValue(f,"boneTexture",E.boneTexture),x.setValue(f,"boneTextureSize",E.boneTextureSize)}else x.setOptional(f,E,"boneMatrices")}}return m&&(x.setValue(f,"toneMappingExposure",O.toneMappingExposure),x.setValue(f,"toneMappingWhitePoint",O.toneMappingWhitePoint),n.lights&&(l=v,(u=b).ambientLightColor.needsUpdate=l,u.directionalLights.needsUpdate=l,u.pointLights.needsUpdate=l,u.spotLights.needsUpdate=l,u.rectAreaLights.needsUpdate=l,u.hemisphereLights.needsUpdate=l),t&&n.fog&&function(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(b,t),n.isMeshBasicMaterial?xe(b,n):n.isMeshLambertMaterial?(xe(b,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(b,n)):n.isMeshPhongMaterial?(xe(b,n),n.isMeshToonMaterial?function(e,t){be(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(b,n):be(b,n)):n.isMeshStandardMaterial?(xe(b,n),n.isMeshPhysicalMaterial?function(e,t){we(e,t),e.reflectivity.value=t.reflectivity,e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness}(b,n):we(b,n)):n.isMeshMatcapMaterial?(xe(b,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===A&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===A&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(b,n)):n.isMeshDepthMaterial?(xe(b,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(b,n)):n.isMeshDistanceMaterial?(xe(b,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(b,n)):n.isMeshNormalMaterial?(xe(b,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===A&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===A&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(b,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}(b,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(b,n)):n.isPointsMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*X,e.scale.value=.5*q,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(b,n):n.isSpriteMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.rotation.value=t.rotation,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(b,n):n.isShadowMaterial&&(b.color.value=n.color,b.opacity.value=n.opacity),void 0!==b.ltc_1&&(b.ltc_1.value=Tn.LTC_1),void 0!==b.ltc_2&&(b.ltc_2.value=Tn.LTC_2),Li.upload(f,i.uniformsList,b,O)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Li.upload(f,i.uniformsList,b,O),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&x.setValue(f,"center",r.center),x.setValue(f,"modelViewMatrix",r.modelViewMatrix),x.setValue(f,"normalMatrix",r.normalMatrix),x.setValue(f,"modelMatrix",r.matrixWorld),y}function xe(e,t){var n;e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=_.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}function be(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===A&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===A&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function we(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===A&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===A&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}me.setAnimationLoop((function(e){ae.isPresenting()||fe&&fe(e)})),"undefined"!=typeof window&&me.setContext(window),this.setAnimationLoop=function(e){fe=e,ae.setAnimationLoop(e),me.start()},this.render=function(e,t,n,r){if(t&&t.isCamera){if(!N){k.geometry=null,k.program=null,k.wireframe=!1,U=-1,F=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ae.enabled&&(t=ae.getCamera(t)),(h=S.get(e,t)).init(),e.onBeforeRender(O,e,t,n),te.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),$.setFromMatrix(te),ee=this.localClippingEnabled,Q=K.init(this.clippingPlanes,ee,t),(l=M.get(e,t)).init(),function e(t,n,r){if(!1===t.visible)return;var i=t.layers.test(n.layers);if(i)if(t.isLight)h.pushLight(t),t.castShadow&&h.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||$.intersectsSprite(t)){r&&ne.setFromMatrixPosition(t.matrixWorld).applyMatrix4(te);var o=w.update(t),a=t.material;l.push(t,o,a,ne.z,null)}}else if(t.isImmediateRenderObject)r&&ne.setFromMatrixPosition(t.matrixWorld).applyMatrix4(te),l.push(t,null,t.material,ne.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||$.intersectsObject(t))){r&&ne.setFromMatrixPosition(t.matrixWorld).applyMatrix4(te);o=w.update(t),a=t.material;if(Array.isArray(a))for(var s=o.groups,c=0,u=s.length;c<u;c++){var f=s[c],d=a[f.materialIndex];d&&d.visible&&l.push(t,o,d,ne.z,f)}else a.visible&&l.push(t,o,a,ne.z,null)}var p=t.children;for(c=0,u=p.length;c<u;c++)e(p[c],n,r)}(e,t,O.sortObjects),!0===O.sortObjects&&l.sort(),Q&&K.beginShadows();var i=h.state.shadowsArray;se.render(i,e,t),h.setupLights(t),Q&&K.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),T.render(l,e,t,r);var o=l.opaque,a=l.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;o.length&&ge(o,e,t,s),a.length&&ge(a,e,t,s)}else o.length&&ge(o,e,t),a.length&&ge(a,e,t);n&&y.updateRenderTargetMipmap(n),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),e.onAfterRender(O,e,t),ae.enabled&&ae.submitFrame(),l=null,h=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var e=V;return e>=p.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+p.maxTextures),V+=1,e},this.setTexture2D=(de=!1,function(e,t){e&&e.isWebGLRenderTarget&&(de||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),de=!0),e=e.texture),y.setTexture2D(e,t)}),this.setTexture3D=function(e,t){y.setTexture3D(e,t)},this.setTexture=function(){var e=!1;return function(t,n){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),y.setTexture2D(t,n)}}(),this.setTextureCube=function(){var e=!1;return function(t,n){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?y.setTextureCube(t,n):y.setTextureCubeDynamic(t,n)}}(),this.setFramebuffer=function(e){I=e},this.getRenderTarget=function(){return D},this.setRenderTarget=function(e){D=e,e&&void 0===_.get(e).__webglFramebuffer&&y.setupRenderTarget(e);var t=I,n=!1;if(e){var r=_.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(t=r[e.activeCubeFace],n=!0):t=r,j.copy(e.viewport),H.copy(e.scissor),G=e.scissorTest}else j.copy(Y).multiplyScalar(X),H.copy(Z).multiplyScalar(X),G=J;if(z!==t&&(f.bindFramebuffer(f.FRAMEBUFFER,t),z=t),g.viewport(j),g.scissor(H),g.setScissorTest(G),n){var i=_.get(e.texture);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,i.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,n,r,i,o){if(e&&e.isWebGLRenderTarget){var a=_.get(e).__webglFramebuffer;if(a){var s=!1;a!==z&&(f.bindFramebuffer(f.FRAMEBUFFER,a),s=!0);try{var c=e.texture,u=c.format,l=c.type;if(u!==Ze&&P.convert(u)!==f.getParameter(f.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(l===De||P.convert(l)===f.getParameter(f.IMPLEMENTATION_COLOR_READ_TYPE)||l===je&&(p.isWebGL2||d.get("OES_texture_float")||d.get("WEBGL_color_buffer_float"))||l===He&&(p.isWebGL2?d.get("EXT_color_buffer_float"):d.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");f.checkFramebufferStatus(f.FRAMEBUFFER)===f.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&f.readPixels(t,n,r,i,P.convert(u),P.convert(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&f.bindFramebuffer(f.FRAMEBUFFER,z)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){var r=t.image.width,i=t.image.height,o=P.convert(t.format);this.setTexture2D(t,0),f.copyTexImage2D(f.TEXTURE_2D,n||0,o,e.x,e.y,r,i,0)},this.copyTextureToTexture=function(e,t,n,r){var i=t.image.width,o=t.image.height,a=P.convert(n.format),s=P.convert(n.type);this.setTexture2D(n,0),t.isDataTexture?f.texSubImage2D(f.TEXTURE_2D,r||0,e.x,e.y,i,o,a,s,t.image.data):f.texSubImage2D(f.TEXTURE_2D,r||0,e.x,e.y,a,s,t.image)}}function vo(e,t){this.name="",this.color=new Mn(e),this.density=void 0!==t?t:25e-5}function _o(e,t,n){this.name="",this.color=new Mn(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function yo(){kn.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function xo(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function bo(e,t,n,r){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function wo(e){xr.call(this),this.type="SpriteMaterial",this.color=new Mn(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function Eo(e){if(kn.call(this),this.type="Sprite",void 0===Xi){Xi=new nr;var t=new xo(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Xi.setIndex([0,1,2,0,2,3]),Xi.addAttribute("position",new bo(t,3,0,!1)),Xi.addAttribute("uv",new bo(t,2,3,!1))}this.geometry=Xi,this.material=void 0!==e?e:new wo,this.center=new Jt(.5,.5)}function Mo(){kn.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function So(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new $t)}}function To(){kn.call(this),this.type="Bone"}function Ao(e,t){Sr.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new $t,this.bindMatrixInverse=new $t;var n=new So(this.initBones());this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function Lo(e){xr.call(this),this.type="LineBasicMaterial",this.color=new Mn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function Co(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),kn.call(this),this.type="Line",this.geometry=void 0!==e?e:new nr,this.material=void 0!==t?t:new Lo({color:16777215*Math.random()})}function Ro(e,t){Co.call(this,e,t),this.type="LineSegments"}function Po(e,t){Co.call(this,e,t),this.type="LineLoop"}function Oo(e){xr.call(this),this.type="PointsMaterial",this.color=new Mn(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function No(e,t){kn.call(this),this.type="Points",this.geometry=void 0!==e?e:new nr,this.material=void 0!==t?t:new Oo({color:16777215*Math.random()})}function Io(e,t,n,r,i,o,a,s,c){un.call(this,e,t,n,r,i,o,a,s,c),this.generateMipmaps=!1}function Do(e,t,n,r,i,o,a,s,c,u,l,h){un.call(this,null,o,a,s,c,u,r,i,l,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function zo(e,t,n,r,i,o,a,s,c){un.call(this,e,t,n,r,i,o,a,s,c),this.needsUpdate=!0}function Uo(e,t,n,r,i,o,a,s,c,u){if((u=void 0!==u?u:Qe)!==Qe&&u!==et)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===Qe&&(n=ke),void 0===n&&u===et&&(n=qe),un.call(this,null,r,i,o,a,s,u,n,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:Ce,this.minFilter=void 0!==s?s:Ce,this.flipY=!1,this.generateMipmaps=!1}function ko(e){nr.call(this),this.type="WireframeGeometry";var t,n,r,i,o,a,s,c,u,l,h=[],f=[0,0],d={},p=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,r=m.length;t<r;t++){var g=m[t];for(n=0;n<3;n++)s=g[p[n]],c=g[p[(n+1)%3]],f[0]=Math.min(s,c),f[1]=Math.max(s,c),void 0===d[u=f[0]+","+f[1]]&&(d[u]={index1:f[0],index2:f[1]})}for(u in d)a=d[u],l=e.vertices[a.index1],h.push(l.x,l.y,l.z),l=e.vertices[a.index2],h.push(l.x,l.y,l.z)}else if(e&&e.isBufferGeometry){var v,_,y,x,b,w,E;if(l=new Qt,null!==e.index){for(v=e.attributes.position,_=e.index,0===(y=e.groups).length&&(y=[{start:0,count:_.count,materialIndex:0}]),i=0,o=y.length;i<o;++i)for(t=b=(x=y[i]).start,r=b+x.count;t<r;t+=3)for(n=0;n<3;n++)s=_.getX(t+n),c=_.getX(t+(n+1)%3),f[0]=Math.min(s,c),f[1]=Math.max(s,c),void 0===d[u=f[0]+","+f[1]]&&(d[u]={index1:f[0],index2:f[1]});for(u in d)a=d[u],l.fromBufferAttribute(v,a.index1),h.push(l.x,l.y,l.z),l.fromBufferAttribute(v,a.index2),h.push(l.x,l.y,l.z)}else for(t=0,r=(v=e.attributes.position).count/3;t<r;t++)for(n=0;n<3;n++)w=3*t+n,l.fromBufferAttribute(v,w),h.push(l.x,l.y,l.z),E=3*t+(n+1)%3,l.fromBufferAttribute(v,E),h.push(l.x,l.y,l.z)}this.addAttribute("position",new $n(h,3))}function Fo(e,t,n){Hn.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new Bo(e,t,n)),this.mergeVertices()}function Bo(e,t,n){nr.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var r,i,o=[],a=[],s=[],c=[],u=new Qt,l=new Qt,h=new Qt,f=new Qt,d=new Qt;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var p=t+1;for(r=0;r<=n;r++){var m=r/n;for(i=0;i<=t;i++){var g=i/t;e(g,m,l),a.push(l.x,l.y,l.z),g-1e-5>=0?(e(g-1e-5,m,h),f.subVectors(l,h)):(e(g+1e-5,m,h),f.subVectors(h,l)),m-1e-5>=0?(e(g,m-1e-5,h),d.subVectors(l,h)):(e(g,m+1e-5,h),d.subVectors(h,l)),u.crossVectors(f,d).normalize(),s.push(u.x,u.y,u.z),c.push(g,m)}}for(r=0;r<n;r++)for(i=0;i<t;i++){var v=r*p+i,_=r*p+i+1,y=(r+1)*p+i+1,x=(r+1)*p+i;o.push(v,_,x),o.push(_,y,x)}this.setIndex(o),this.addAttribute("position",new $n(a,3)),this.addAttribute("normal",new $n(s,3)),this.addAttribute("uv",new $n(c,2))}function jo(e,t,n,r){Hn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new Ho(e,t,n,r)),this.mergeVertices()}function Ho(e,t,n,r){nr.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},n=n||1;var i=[],o=[];function a(e,t,n,r){var i,o,a=Math.pow(2,r),c=[];for(i=0;i<=a;i++){c[i]=[];var u=e.clone().lerp(n,i/a),l=t.clone().lerp(n,i/a),h=a-i;for(o=0;o<=h;o++)c[i][o]=0===o&&i===a?u:u.clone().lerp(l,o/h)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var f=Math.floor(o/2);o%2==0?(s(c[i][f+1]),s(c[i+1][f]),s(c[i][f])):(s(c[i][f+1]),s(c[i+1][f+1]),s(c[i+1][f]))}}function s(e){i.push(e.x,e.y,e.z)}function c(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function u(e,t,n,r){r<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=r/2/Math.PI+.5)}function l(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){for(var n=new Qt,r=new Qt,i=new Qt,o=0;o<t.length;o+=3)c(t[o+0],n),c(t[o+1],r),c(t[o+2],i),a(n,r,i,e)}(r=r||0),function(e){for(var t=new Qt,n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){for(var e=new Qt,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var n=l(e)/2/Math.PI+.5,r=h(e)/Math.PI+.5;o.push(n,1-r)}(function(){for(var e=new Qt,t=new Qt,n=new Qt,r=new Qt,a=new Jt,s=new Jt,c=new Jt,h=0,f=0;h<i.length;h+=9,f+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),a.set(o[f+0],o[f+1]),s.set(o[f+2],o[f+3]),c.set(o[f+4],o[f+5]),r.copy(e).add(t).add(n).divideScalar(3);var d=l(r);u(a,f+0,e,d),u(s,f+2,t,d),u(c,f+4,n,d)}})(),function(){for(var e=0;e<o.length;e+=6){var t=o[e+0],n=o[e+2],r=o[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);i>.9&&a<.1&&(t<.2&&(o[e+0]+=1),n<.2&&(o[e+2]+=1),r<.2&&(o[e+4]+=1))}}()}(),this.addAttribute("position",new $n(i,3)),this.addAttribute("normal",new $n(i.slice(),3)),this.addAttribute("uv",new $n(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Go(e,t){Hn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Vo(e,t)),this.mergeVertices()}function Vo(e,t){Ho.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Wo(e,t){Hn.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new qo(e,t)),this.mergeVertices()}function qo(e,t){Ho.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Xo(e,t){Hn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Yo(e,t)),this.mergeVertices()}function Yo(e,t){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Ho.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Zo(e,t){Hn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Jo(e,t)),this.mergeVertices()}function Jo(e,t){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Ho.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function $o(e,t,n,r,i,o){Hn.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new Ko(e,t,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Ko(e,t,n,r,i){nr.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},t=t||64,n=n||1,r=r||8,i=i||!1;var o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,c=new Qt,u=new Qt,l=new Jt,h=new Qt,f=[],d=[],p=[],m=[];function g(i){h=e.getPointAt(i/t,h);var a=o.normals[i],l=o.binormals[i];for(s=0;s<=r;s++){var p=s/r*Math.PI*2,m=Math.sin(p),g=-Math.cos(p);u.x=g*a.x+m*l.x,u.y=g*a.y+m*l.y,u.z=g*a.z+m*l.z,u.normalize(),d.push(u.x,u.y,u.z),c.x=h.x+n*u.x,c.y=h.y+n*u.y,c.z=h.z+n*u.z,f.push(c.x,c.y,c.z)}}!function(){for(a=0;a<t;a++)g(a);g(!1===i?t:0),function(){for(a=0;a<=t;a++)for(s=0;s<=r;s++)l.x=a/t,l.y=s/r,p.push(l.x,l.y)}(),function(){for(s=1;s<=t;s++)for(a=1;a<=r;a++){var e=(r+1)*(s-1)+(a-1),n=(r+1)*s+(a-1),i=(r+1)*s+a,o=(r+1)*(s-1)+a;m.push(e,n,o),m.push(n,i,o)}}()}(),this.setIndex(m),this.addAttribute("position",new $n(f,3)),this.addAttribute("normal",new $n(d,3)),this.addAttribute("uv",new $n(p,2))}function Qo(e,t,n,r,i,o,a){Hn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new ea(e,t,n,r,i,o)),this.mergeVertices()}function ea(e,t,n,r,i,o){nr.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var a,s,c=[],u=[],l=[],h=[],f=new Qt,d=new Qt,p=new Qt,m=new Qt,g=new Qt,v=new Qt,_=new Qt;for(a=0;a<=n;++a){var y=a/n*i*Math.PI*2;for(A(y,i,o,e,p),A(y+.01,i,o,e,m),v.subVectors(m,p),_.addVectors(m,p),g.crossVectors(v,_),_.crossVectors(g,v),g.normalize(),_.normalize(),s=0;s<=r;++s){var x=s/r*Math.PI*2,b=-t*Math.cos(x),w=t*Math.sin(x);f.x=p.x+(b*_.x+w*g.x),f.y=p.y+(b*_.y+w*g.y),f.z=p.z+(b*_.z+w*g.z),u.push(f.x,f.y,f.z),d.subVectors(f,p).normalize(),l.push(d.x,d.y,d.z),h.push(a/n),h.push(s/r)}}for(s=1;s<=n;s++)for(a=1;a<=r;a++){var E=(r+1)*(s-1)+(a-1),M=(r+1)*s+(a-1),S=(r+1)*s+a,T=(r+1)*(s-1)+a;c.push(E,M,T),c.push(M,S,T)}function A(e,t,n,r,i){var o=Math.cos(e),a=Math.sin(e),s=n/t*e,c=Math.cos(s);i.x=r*(2+c)*.5*o,i.y=r*(2+c)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(c),this.addAttribute("position",new $n(u,3)),this.addAttribute("normal",new $n(l,3)),this.addAttribute("uv",new $n(h,2))}function ta(e,t,n,r,i){Hn.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new na(e,t,n,r,i)),this.mergeVertices()}function na(e,t,n,r,i){nr.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,s=[],c=[],u=[],l=[],h=new Qt,f=new Qt,d=new Qt;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var p=a/r*i,m=o/n*Math.PI*2;f.x=(e+t*Math.cos(m))*Math.cos(p),f.y=(e+t*Math.cos(m))*Math.sin(p),f.z=t*Math.sin(m),c.push(f.x,f.y,f.z),h.x=e*Math.cos(p),h.y=e*Math.sin(p),d.subVectors(f,h).normalize(),u.push(d.x,d.y,d.z),l.push(a/r),l.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++){var g=(r+1)*o+a-1,v=(r+1)*(o-1)+a-1,_=(r+1)*(o-1)+a,y=(r+1)*o+a;s.push(g,v,y),s.push(v,_,y)}this.setIndex(s),this.addAttribute("position",new $n(c,3)),this.addAttribute("normal",new $n(u,3)),this.addAttribute("uv",new $n(l,2))}ro.prototype=Object.create(xr.prototype),ro.prototype.constructor=ro,ro.prototype.isMeshDepthMaterial=!0,ro.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},io.prototype=Object.create(xr.prototype),io.prototype.constructor=io,io.prototype.isMeshDistanceMaterial=!0,io.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},uo.prototype=Object.assign(Object.create(kn.prototype),{constructor:uo,isGroup:!0}),lo.prototype=Object.assign(Object.create(kn.prototype),{constructor:lo,isCamera:!0,copy:function(e,t){return kn.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Qt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){kn.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),ho.prototype=Object.assign(Object.create(lo.prototype),{constructor:ho,isPerspectiveCamera:!0,copy:function(e,t){return lo.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Zt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Zt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Zt.RAD2DEG*Math.atan(Math.tan(.5*Zt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Zt.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,t-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var c=this.filmOffset;0!==c&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=kn.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),fo.prototype=Object.assign(Object.create(ho.prototype),{constructor:fo,isArrayCamera:!0}),vo.prototype.isFogExp2=!0,vo.prototype.clone=function(){return new vo(this.color,this.density)},vo.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},_o.prototype.isFog=!0,_o.prototype.clone=function(){return new _o(this.color,this.near,this.far)},_o.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},yo.prototype=Object.assign(Object.create(kn.prototype),{constructor:yo,copy:function(e,t){return kn.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=kn.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),Object.defineProperty(xo.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(xo.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(bo.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(bo.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}}),wo.prototype=Object.create(xr.prototype),wo.prototype.constructor=wo,wo.prototype.isSpriteMaterial=!0,wo.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},Eo.prototype=Object.assign(Object.create(kn.prototype),{constructor:Eo,isSprite:!0,raycast:function(){var e=new Qt,t=new Qt,n=new Qt,r=new Jt,i=new Jt,o=new $t,a=new Qt,s=new Qt,c=new Qt,u=new Jt,l=new Jt,h=new Jt;function f(e,t,n,a,s,c){r.subVectors(e,n).addScalar(.5).multiply(a),void 0!==s?(i.x=c*r.x-s*r.y,i.y=s*r.x+c*r.y):i.copy(r),e.copy(t),e.x+=i.x,e.y+=i.y,e.applyMatrix4(o)}return function(r,i){t.setFromMatrixScale(this.matrixWorld),o.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),n.setFromMatrixPosition(this.modelViewMatrix);var d,p,m=this.material.rotation;0!==m&&(p=Math.cos(m),d=Math.sin(m));var g=this.center;f(a.set(-.5,-.5,0),n,g,t,d,p),f(s.set(.5,-.5,0),n,g,t,d,p),f(c.set(.5,.5,0),n,g,t,d,p),u.set(0,0),l.set(1,0),h.set(1,1);var v=r.ray.intersectTriangle(a,s,c,!1,e);if(null!==v||(f(s.set(-.5,.5,0),n,g,t,d,p),l.set(0,1),null!==(v=r.ray.intersectTriangle(a,c,s,!1,e)))){var _=r.ray.origin.distanceTo(e);_<r.near||_>r.far||i.push({distance:_,point:e.clone(),uv:Er.getUV(e,a,s,c,u,l,h,new Jt),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return kn.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),Mo.prototype=Object.assign(Object.create(kn.prototype),{constructor:Mo,copy:function(e){kn.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,r=0;r<n.length&&!(t<n[r].distance);r++);n.splice(r,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object},raycast:(Yi=new Qt,function(e,t){Yi.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Yi);this.getObjectForDistance(n).raycast(e,t)}),update:function(){var e=new Qt,t=new Qt;return function(n){var r=this.levels;if(r.length>1){e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);r[0].object.visible=!0;for(var o=1,a=r.length;o<a&&i>=r[o].distance;o++)r[o-1].object.visible=!1,r[o].object.visible=!0;for(;o<a;o++)r[o].object.visible=!1}}}(),toJSON:function(e){var t=kn.prototype.toJSON.call(this,e);t.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Object.assign(So.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new $t;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(Zi=new $t,Ji=new $t,function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=e.length;i<o;i++){var a=e[i]?e[i].matrixWorld:Ji;Zi.multiplyMatrices(a,t[i]),Zi.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)}),clone:function(){return new So(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}}),To.prototype=Object.assign(Object.create(kn.prototype),{constructor:To,isBone:!0}),Ao.prototype=Object.assign(Object.create(Sr.prototype),{constructor:Ao,isSkinnedMesh:!0,initBones:function(){var e,t,n,r,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,r=this.geometry.bones.length;n<r;n++)t=this.geometry.bones[n],e=new To,i.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(n=0,r=this.geometry.bones.length;n<r;n++)-1!==(t=this.geometry.bones[n]).parent&&null!==t.parent&&void 0!==i[t.parent]?i[t.parent].add(i[n]):this.add(i[n])}return this.updateMatrixWorld(!0),i},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var n=this.geometry.skinWeights[t];(e=1/n.manhattanLength())!==1/0?n.multiplyScalar(e):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var r=new ln,i=this.geometry.attributes.skinWeight;for(t=0;t<i.count;t++)r.x=i.getX(t),r.y=i.getY(t),r.z=i.getZ(t),r.w=i.getW(t),(e=1/r.manhattanLength())!==1/0?r.multiplyScalar(e):r.set(1,0,0,0),i.setXYZW(t,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(e){Sr.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Lo.prototype=Object.create(xr.prototype),Lo.prototype.constructor=Lo,Lo.prototype.isLineBasicMaterial=!0,Lo.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Co.prototype=Object.assign(Object.create(kn.prototype),{constructor:Co,isLine:!0,computeLineDistances:($i=new Qt,Ki=new Qt,function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)$i.fromBufferAttribute(t,r-1),Ki.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=$i.distanceTo(Ki);e.addAttribute("lineDistance",new $n(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var o=e.vertices;for((n=e.lineDistances)[0]=0,r=1,i=o.length;r<i;r++)n[r]=n[r-1],n[r]+=o[r-1].distanceTo(o[r])}return this}),raycast:function(){var e=new $t,t=new wr,n=new mn;return function(r,i){var o=r.linePrecision,a=this.geometry,s=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(s),n.radius+=o,!1!==r.ray.intersectsSphere(n)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var c=o/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,l=new Qt,h=new Qt,f=new Qt,d=new Qt,p=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var m=a.index,g=a.attributes.position.array;if(null!==m)for(var v=m.array,_=0,y=v.length-1;_<y;_+=p){var x=v[_],b=v[_+1];if(l.fromArray(g,3*x),h.fromArray(g,3*b),!(t.distanceSqToSegment(l,h,d,f)>u))d.applyMatrix4(this.matrixWorld),(M=r.ray.origin.distanceTo(d))<r.near||M>r.far||i.push({distance:M,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}else for(_=0,y=g.length/3-1;_<y;_+=p){if(l.fromArray(g,3*_),h.fromArray(g,3*_+3),!(t.distanceSqToSegment(l,h,d,f)>u))d.applyMatrix4(this.matrixWorld),(M=r.ray.origin.distanceTo(d))<r.near||M>r.far||i.push({distance:M,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else if(a.isGeometry){var w=a.vertices,E=w.length;for(_=0;_<E-1;_+=p){var M;if(!(t.distanceSqToSegment(w[_],w[_+1],d,f)>u))d.applyMatrix4(this.matrixWorld),(M=r.ray.origin.distanceTo(d))<r.near||M>r.far||i.push({distance:M,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ro.prototype=Object.assign(Object.create(Co.prototype),{constructor:Ro,isLineSegments:!0,computeLineDistances:function(){var e=new Qt,t=new Qt;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[],o=0,a=r.count;o<a;o+=2)e.fromBufferAttribute(r,o),t.fromBufferAttribute(r,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t);n.addAttribute("lineDistance",new $n(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var s=n.vertices;for(i=n.lineDistances,o=0,a=s.length;o<a;o+=2)e.copy(s[o]),t.copy(s[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t)}return this}}()}),Po.prototype=Object.assign(Object.create(Co.prototype),{constructor:Po,isLineLoop:!0}),Oo.prototype=Object.create(xr.prototype),Oo.prototype.constructor=Oo,Oo.prototype.isPointsMaterial=!0,Oo.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},No.prototype=Object.assign(Object.create(kn.prototype),{constructor:No,isPoints:!0,raycast:function(){var e=new $t,t=new wr,n=new mn;return function(r,i){var o=this,a=this.geometry,s=this.matrixWorld,c=r.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(s),n.radius+=c,!1!==r.ray.intersectsSphere(n)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var u=c/((this.scale.x+this.scale.y+this.scale.z)/3),l=u*u,h=new Qt,f=new Qt;if(a.isBufferGeometry){var d=a.index,p=a.attributes.position.array;if(null!==d)for(var m=d.array,g=0,v=m.length;g<v;g++){var _=m[g];h.fromArray(p,3*_),b(h,_)}else{g=0;for(var y=p.length/3;g<y;g++)h.fromArray(p,3*g),b(h,g)}}else{var x=a.vertices;for(g=0,y=x.length;g<y;g++)b(x[g],g)}}function b(e,n){var a=t.distanceSqToPoint(e);if(a<l){t.closestPointToPoint(e,f),f.applyMatrix4(s);var c=r.ray.origin.distanceTo(f);if(c<r.near||c>r.far)return;i.push({distance:c,distanceToRay:Math.sqrt(a),point:f.clone(),index:n,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Io.prototype=Object.assign(Object.create(un.prototype),{constructor:Io,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Do.prototype=Object.create(un.prototype),Do.prototype.constructor=Do,Do.prototype.isCompressedTexture=!0,zo.prototype=Object.create(un.prototype),zo.prototype.constructor=zo,zo.prototype.isCanvasTexture=!0,Uo.prototype=Object.create(un.prototype),Uo.prototype.constructor=Uo,Uo.prototype.isDepthTexture=!0,ko.prototype=Object.create(nr.prototype),ko.prototype.constructor=ko,Fo.prototype=Object.create(Hn.prototype),Fo.prototype.constructor=Fo,Bo.prototype=Object.create(nr.prototype),Bo.prototype.constructor=Bo,jo.prototype=Object.create(Hn.prototype),jo.prototype.constructor=jo,Ho.prototype=Object.create(nr.prototype),Ho.prototype.constructor=Ho,Go.prototype=Object.create(Hn.prototype),Go.prototype.constructor=Go,Vo.prototype=Object.create(Ho.prototype),Vo.prototype.constructor=Vo,Wo.prototype=Object.create(Hn.prototype),Wo.prototype.constructor=Wo,qo.prototype=Object.create(Ho.prototype),qo.prototype.constructor=qo,Xo.prototype=Object.create(Hn.prototype),Xo.prototype.constructor=Xo,Yo.prototype=Object.create(Ho.prototype),Yo.prototype.constructor=Yo,Zo.prototype=Object.create(Hn.prototype),Zo.prototype.constructor=Zo,Jo.prototype=Object.create(Ho.prototype),Jo.prototype.constructor=Jo,$o.prototype=Object.create(Hn.prototype),$o.prototype.constructor=$o,Ko.prototype=Object.create(nr.prototype),Ko.prototype.constructor=Ko,Qo.prototype=Object.create(Hn.prototype),Qo.prototype.constructor=Qo,ea.prototype=Object.create(nr.prototype),ea.prototype.constructor=ea,ta.prototype=Object.create(Hn.prototype),ta.prototype.constructor=ta,na.prototype=Object.create(nr.prototype),na.prototype.constructor=na;var ra=function(e,t,n){n=n||2;var r,i,o,a,s,c,u,l=t&&t.length,h=l?t[0]*n:e.length,f=ia(e,0,h,n,!0),d=[];if(!f)return d;if(l&&(f=function(e,t,n,r){var i,o,a,s,c,u=[];for(i=0,o=t.length;i<o;i++)a=t[i]*r,s=i<o-1?t[i+1]*r:e.length,(c=ia(e,a,s,r,!1))===c.next&&(c.steiner=!0),u.push(pa(c));for(u.sort(ha),i=0;i<u.length;i++)fa(u[i],n),n=oa(n,n.next);return n}(e,t,f,n)),e.length>80*n){r=o=e[0],i=a=e[1];for(var p=n;p<h;p+=n)(s=e[p])<r&&(r=s),(c=e[p+1])<i&&(i=c),s>o&&(o=s),c>a&&(a=c);u=0!==(u=Math.max(o-r,a-i))?1/u:0}return aa(f,d,n,r,i,u),d};function ia(e,t,n,r,i){var o,a;if(i===function(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,n,r)>0)for(o=t;o<n;o+=r)a=wa(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=wa(o,e[o],e[o+1],a);return a&&_a(a,a.next)&&(Ea(a),a=a.next),a}function oa(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!_a(r,r.next)&&0!==va(r.prev,r,r.next))r=r.next;else{if(Ea(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function aa(e,t,n,r,i,o,a){if(e){!a&&o&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=da(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,c,u=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<u&&(s++,r=r.nextZ);t++);for(c=u;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(e,r,i,o);for(var s,c,u=e;e.prev!==e.next;)if(s=e.prev,c=e.next,o?ca(e,r,i,o):sa(e))t.push(s.i/n),t.push(e.i/n),t.push(c.i/n),Ea(e),e=c.next,u=c.next;else if((e=c)===u){a?1===a?aa(e=ua(e,t,n),t,n,r,i,o,2):2===a&&la(e,t,n,r,i,o):aa(oa(e),t,n,r,i,o,1);break}}}function sa(e){var t=e.prev,n=e,r=e.next;if(va(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(ma(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&va(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function ca(e,t,n,r){var i=e.prev,o=e,a=e.next;if(va(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,c=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=da(s,c,t,n,r),f=da(u,l,t,n,r),d=e.nextZ;d&&d.z<=f;){if(d!==e.prev&&d!==e.next&&ma(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&va(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=e.prevZ;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&ma(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&va(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function ua(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!_a(i,o)&&ya(i,r,r.next,o)&&xa(i,o)&&xa(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),Ea(r),Ea(r.next),r=e=o),r=r.next}while(r!==e);return r}function la(e,t,n,r,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&ga(a,s)){var c=ba(a,s);return a=oa(a,a.next),c=oa(c,c.next),aa(a,t,n,r,i,o),void aa(c,t,n,r,i,o)}s=s.next}a=a.next}while(a!==e)}function ha(e,t){return e.x-t.x}function fa(e,t){if(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n.prev;var c,u=n,l=n.x,h=n.y,f=1/0;r=n.next;for(;r!==u;)i>=r.x&&r.x>=l&&i!==r.x&&ma(o<h?i:a,o,l,h,o<h?a:i,o,r.x,r.y)&&((c=Math.abs(o-r.y)/(i-r.x))<f||c===f&&r.x>n.x)&&xa(r,e)&&(n=r,f=c),r=r.next;return n}(e,t)){var n=ba(t,e);oa(n,n.next)}}function da(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function pa(e){var t=e,n=e;do{t.x<n.x&&(n=t),t=t.next}while(t!==e);return n}function ma(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function ga(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&ya(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&xa(e,t)&&xa(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)}function va(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function _a(e,t){return e.x===t.x&&e.y===t.y}function ya(e,t,n,r){return!!(_a(e,t)&&_a(n,r)||_a(e,r)&&_a(n,t))||va(e,t,n)>0!=va(e,t,r)>0&&va(n,r,e)>0!=va(n,r,t)>0}function xa(e,t){return va(e.prev,e,e.next)<0?va(e,t,e.next)>=0&&va(e,e.prev,t)>=0:va(e,t,e.prev)<0||va(e,e.next,t)<0}function ba(e,t){var n=new Ma(e.i,e.x,e.y),r=new Ma(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function wa(e,t,n,r){var i=new Ma(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ea(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ma(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Sa={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return Sa.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];Ta(e),Aa(n,e);var o=e.length;t.forEach(Ta);for(var a=0;a<t.length;a++)r.push(o),o+=t[a].length,Aa(n,t[a]);var s=ra(n,r);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function Ta(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Aa(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function La(e,t){Hn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Ca(e,t)),this.mergeVertices()}function Ca(e,t){nr.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var n=this,r=[],i=[],o=0,a=e.length;o<a;o++){s(e[o])}function s(e){var o=[],a=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,c=void 0!==t.depth?t.depth:100,u=void 0===t.bevelEnabled||t.bevelEnabled,l=void 0!==t.bevelThickness?t.bevelThickness:6,h=void 0!==t.bevelSize?t.bevelSize:l-2,f=void 0!==t.bevelSegments?t.bevelSegments:3,d=t.extrudePath,p=void 0!==t.UVGenerator?t.UVGenerator:Ra;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=t.amount);var m,g,v,_,y,x,b,w,E=!1;d&&(m=d.getSpacedPoints(s),E=!0,u=!1,g=d.computeFrenetFrames(s,!1),v=new Qt,_=new Qt,y=new Qt),u||(f=0,l=0,h=0);var M=e.extractPoints(a),S=M.shape,T=M.holes;if(!Sa.isClockWise(S))for(S=S.reverse(),b=0,w=T.length;b<w;b++)x=T[b],Sa.isClockWise(x)&&(T[b]=x.reverse());var A=Sa.triangulateShape(S,T),L=S;for(b=0,w=T.length;b<w;b++)x=T[b],S=S.concat(x);function C(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var R,P,O,N,I,D,z=S.length,U=A.length;function k(e,t,n){var r,i,o,a=e.x-t.x,s=e.y-t.y,c=n.x-e.x,u=n.y-e.y,l=a*a+s*s,h=a*u-s*c;if(Math.abs(h)>Number.EPSILON){var f=Math.sqrt(l),d=Math.sqrt(c*c+u*u),p=t.x-s/f,m=t.y+a/f,g=((n.x-u/d-p)*u-(n.y+c/d-m)*c)/(a*u-s*c),v=(r=p+a*g-e.x)*r+(i=m+s*g-e.y)*i;if(v<=2)return new Jt(r,i);o=Math.sqrt(v/2)}else{var _=!1;a>Number.EPSILON?c>Number.EPSILON&&(_=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(_=!0):Math.sign(s)===Math.sign(u)&&(_=!0),_?(r=-s,i=a,o=Math.sqrt(l)):(r=a,i=s,o=Math.sqrt(l/2))}return new Jt(r/o,i/o)}for(var F=[],B=0,j=L.length,H=j-1,G=B+1;B<j;B++,H++,G++)H===j&&(H=0),G===j&&(G=0),F[B]=k(L[B],L[H],L[G]);var V,W,q=[],X=F.concat();for(b=0,w=T.length;b<w;b++){for(x=T[b],V=[],B=0,H=(j=x.length)-1,G=B+1;B<j;B++,H++,G++)H===j&&(H=0),G===j&&(G=0),V[B]=k(x[B],x[H],x[G]);q.push(V),X=X.concat(V)}for(R=0;R<f;R++){for(O=R/f,N=l*Math.cos(O*Math.PI/2),P=h*Math.sin(O*Math.PI/2),B=0,j=L.length;B<j;B++)Z((I=C(L[B],F[B],P)).x,I.y,-N);for(b=0,w=T.length;b<w;b++)for(x=T[b],V=q[b],B=0,j=x.length;B<j;B++)Z((I=C(x[B],V[B],P)).x,I.y,-N)}for(P=h,B=0;B<z;B++)I=u?C(S[B],X[B],P):S[B],E?(_.copy(g.normals[0]).multiplyScalar(I.x),v.copy(g.binormals[0]).multiplyScalar(I.y),y.copy(m[0]).add(_).add(v),Z(y.x,y.y,y.z)):Z(I.x,I.y,0);for(W=1;W<=s;W++)for(B=0;B<z;B++)I=u?C(S[B],X[B],P):S[B],E?(_.copy(g.normals[W]).multiplyScalar(I.x),v.copy(g.binormals[W]).multiplyScalar(I.y),y.copy(m[W]).add(_).add(v),Z(y.x,y.y,y.z)):Z(I.x,I.y,c/s*W);for(R=f-1;R>=0;R--){for(O=R/f,N=l*Math.cos(O*Math.PI/2),P=h*Math.sin(O*Math.PI/2),B=0,j=L.length;B<j;B++)Z((I=C(L[B],F[B],P)).x,I.y,c+N);for(b=0,w=T.length;b<w;b++)for(x=T[b],V=q[b],B=0,j=x.length;B<j;B++)I=C(x[B],V[B],P),E?Z(I.x,I.y+m[s-1].y,m[s-1].x+N):Z(I.x,I.y,c+N)}function Y(e,t){var n,r;for(B=e.length;--B>=0;){n=B,(r=B-1)<0&&(r=e.length-1);var i=0,o=s+2*f;for(i=0;i<o;i++){var a=z*i,c=z*(i+1);$(t+n+a,t+r+a,t+r+c,t+n+c)}}}function Z(e,t,n){o.push(e),o.push(t),o.push(n)}function J(e,t,i){K(e),K(t),K(i);var o=r.length/3,a=p.generateTopUV(n,r,o-3,o-2,o-1);Q(a[0]),Q(a[1]),Q(a[2])}function $(e,t,i,o){K(e),K(t),K(o),K(t),K(i),K(o);var a=r.length/3,s=p.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);Q(s[0]),Q(s[1]),Q(s[3]),Q(s[1]),Q(s[2]),Q(s[3])}function K(e){r.push(o[3*e+0]),r.push(o[3*e+1]),r.push(o[3*e+2])}function Q(e){i.push(e.x),i.push(e.y)}!function(){var e=r.length/3;if(u){var t=0,i=z*t;for(B=0;B<U;B++)J((D=A[B])[2]+i,D[1]+i,D[0]+i);for(i=z*(t=s+2*f),B=0;B<U;B++)J((D=A[B])[0]+i,D[1]+i,D[2]+i)}else{for(B=0;B<U;B++)J((D=A[B])[2],D[1],D[0]);for(B=0;B<U;B++)J((D=A[B])[0]+z*s,D[1]+z*s,D[2]+z*s)}n.addGroup(e,r.length/3-e,0)}(),function(){var e=r.length/3,t=0;for(Y(L,t),t+=L.length,b=0,w=T.length;b<w;b++)Y(x=T[b],t),t+=x.length;n.addGroup(e,r.length/3-e,1)}()}this.addAttribute("position",new $n(r,3)),this.addAttribute("uv",new $n(i,2)),this.computeVertexNormals()}La.prototype=Object.create(Hn.prototype),La.prototype.constructor=La,La.prototype.toJSON=function(){var e=Hn.prototype.toJSON.call(this);return Pa(this.parameters.shapes,this.parameters.options,e)},Ca.prototype=Object.create(nr.prototype),Ca.prototype.constructor=Ca,Ca.prototype.toJSON=function(){var e=nr.prototype.toJSON.call(this);return Pa(this.parameters.shapes,this.parameters.options,e)};var Ra={generateTopUV:function(e,t,n,r,i){var o=t[3*n],a=t[3*n+1],s=t[3*r],c=t[3*r+1],u=t[3*i],l=t[3*i+1];return[new Jt(o,a),new Jt(s,c),new Jt(u,l)]},generateSideWallUV:function(e,t,n,r,i,o){var a=t[3*n],s=t[3*n+1],c=t[3*n+2],u=t[3*r],l=t[3*r+1],h=t[3*r+2],f=t[3*i],d=t[3*i+1],p=t[3*i+2],m=t[3*o],g=t[3*o+1],v=t[3*o+2];return Math.abs(s-l)<.01?[new Jt(a,1-c),new Jt(u,1-h),new Jt(f,1-p),new Jt(m,1-v)]:[new Jt(s,1-c),new Jt(l,1-h),new Jt(d,1-p),new Jt(g,1-v)]}};function Pa(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var o=e[r];n.shapes.push(o.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function Oa(e,t){Hn.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Na(e,t)),this.mergeVertices()}function Na(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Hn;var r=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Ca.call(this,r,t),this.type="TextBufferGeometry"}function Ia(e,t,n,r,i,o,a){Hn.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Da(e,t,n,r,i,o,a)),this.mergeVertices()}function Da(e,t,n,r,i,o,a){nr.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var s,c,u=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),l=0,h=[],f=new Qt,d=new Qt,p=[],m=[],g=[],v=[];for(c=0;c<=n;c++){var _=[],y=c/n;for(s=0;s<=t;s++){var x=s/t;f.x=-e*Math.cos(r+x*i)*Math.sin(o+y*a),f.y=e*Math.cos(o+y*a),f.z=e*Math.sin(r+x*i)*Math.sin(o+y*a),m.push(f.x,f.y,f.z),d.set(f.x,f.y,f.z).normalize(),g.push(d.x,d.y,d.z),v.push(x,1-y),_.push(l++)}h.push(_)}for(c=0;c<n;c++)for(s=0;s<t;s++){var b=h[c][s+1],w=h[c][s],E=h[c+1][s],M=h[c+1][s+1];(0!==c||o>0)&&p.push(b,w,M),(c!==n-1||u<Math.PI)&&p.push(w,E,M)}this.setIndex(p),this.addAttribute("position",new $n(m,3)),this.addAttribute("normal",new $n(g,3)),this.addAttribute("uv",new $n(v,2))}function za(e,t,n,r,i,o){Hn.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Ua(e,t,n,r,i,o)),this.mergeVertices()}function Ua(e,t,n,r,i,o){nr.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},e=e||.5,t=t||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,c,u=[],l=[],h=[],f=[],d=e,p=(t-e)/(r=void 0!==r?Math.max(1,r):1),m=new Qt,g=new Jt;for(s=0;s<=r;s++){for(c=0;c<=n;c++)a=i+c/n*o,m.x=d*Math.cos(a),m.y=d*Math.sin(a),l.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,f.push(g.x,g.y);d+=p}for(s=0;s<r;s++){var v=s*(n+1);for(c=0;c<n;c++){var _=a=c+v,y=a+n+1,x=a+n+2,b=a+1;u.push(_,y,b),u.push(y,x,b)}}this.setIndex(u),this.addAttribute("position",new $n(l,3)),this.addAttribute("normal",new $n(h,3)),this.addAttribute("uv",new $n(f,2))}function ka(e,t,n,r){Hn.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new Fa(e,t,n,r)),this.mergeVertices()}function Fa(e,t,n,r){nr.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||2*Math.PI,r=Zt.clamp(r,0,2*Math.PI);var i,o,a,s=[],c=[],u=[],l=1/t,h=new Qt,f=new Jt;for(o=0;o<=t;o++){var d=n+o*l*r,p=Math.sin(d),m=Math.cos(d);for(a=0;a<=e.length-1;a++)h.x=e[a].x*p,h.y=e[a].y,h.z=e[a].x*m,c.push(h.x,h.y,h.z),f.x=o/t,f.y=a/(e.length-1),u.push(f.x,f.y)}for(o=0;o<t;o++)for(a=0;a<e.length-1;a++){var g=i=a+o*e.length,v=i+e.length,_=i+e.length+1,y=i+1;s.push(g,v,y),s.push(v,_,y)}if(this.setIndex(s),this.addAttribute("position",new $n(c,3)),this.addAttribute("uv",new $n(u,2)),this.computeVertexNormals(),r===2*Math.PI){var x=this.attributes.normal.array,b=new Qt,w=new Qt,E=new Qt;for(i=t*e.length*3,o=0,a=0;o<e.length;o++,a+=3)b.x=x[a+0],b.y=x[a+1],b.z=x[a+2],w.x=x[i+a+0],w.y=x[i+a+1],w.z=x[i+a+2],E.addVectors(b,w).normalize(),x[a+0]=x[i+a+0]=E.x,x[a+1]=x[i+a+1]=E.y,x[a+2]=x[i+a+2]=E.z}}function Ba(e,t){Hn.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new ja(e,t)),this.mergeVertices()}function ja(e,t){nr.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],r=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(e))u(e);else for(var c=0;c<e.length;c++)u(e[c]),this.addGroup(a,s,c),a+=s,s=0;function u(e){var a,c,u,l=r.length/3,h=e.extractPoints(t),f=h.shape,d=h.holes;if(!1===Sa.isClockWise(f))for(f=f.reverse(),a=0,c=d.length;a<c;a++)u=d[a],!0===Sa.isClockWise(u)&&(d[a]=u.reverse());var p=Sa.triangulateShape(f,d);for(a=0,c=d.length;a<c;a++)u=d[a],f=f.concat(u);for(a=0,c=f.length;a<c;a++){var m=f[a];r.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,c=p.length;a<c;a++){var g=p[a],v=g[0]+l,_=g[1]+l,y=g[2]+l;n.push(v,_,y),s+=3}}this.setIndex(n),this.addAttribute("position",new $n(r,3)),this.addAttribute("normal",new $n(i,3)),this.addAttribute("uv",new $n(o,2))}function Ha(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function Ga(e,t){nr.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,r,i,o,a=[],s=Math.cos(Zt.DEG2RAD*t),c=[0,0],u={},l=["a","b","c"];e.isBufferGeometry?(o=new Hn).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,f=o.faces,d=0,p=f.length;d<p;d++)for(var m=f[d],g=0;g<3;g++)n=m[l[g]],r=m[l[(g+1)%3]],c[0]=Math.min(n,r),c[1]=Math.max(n,r),void 0===u[i=c[0]+","+c[1]]?u[i]={index1:c[0],index2:c[1],face1:d,face2:void 0}:u[i].face2=d;for(i in u){var v=u[i];if(void 0===v.face2||f[v.face1].normal.dot(f[v.face2].normal)<=s){var _=h[v.index1];a.push(_.x,_.y,_.z),_=h[v.index2],a.push(_.x,_.y,_.z)}}this.addAttribute("position",new $n(a,3))}function Va(e,t,n,r,i,o,a,s){Hn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Wa(e,t,n,r,i,o,a,s)),this.mergeVertices()}function Wa(e,t,n,r,i,o,a,s){nr.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var c=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var u=[],l=[],h=[],f=[],d=0,p=[],m=n/2,g=0;function v(n){var i,o,p,v=new Jt,_=new Qt,y=0,x=!0===n?e:t,b=!0===n?1:-1;for(o=d,i=1;i<=r;i++)l.push(0,m*b,0),h.push(0,b,0),f.push(.5,.5),d++;for(p=d,i=0;i<=r;i++){var w=i/r*s+a,E=Math.cos(w),M=Math.sin(w);_.x=x*M,_.y=m*b,_.z=x*E,l.push(_.x,_.y,_.z),h.push(0,b,0),v.x=.5*E+.5,v.y=.5*M*b+.5,f.push(v.x,v.y),d++}for(i=0;i<r;i++){var S=o+i,T=p+i;!0===n?u.push(T,T+1,S):u.push(T+1,T,S),y+=3}c.addGroup(g,y,!0===n?1:2),g+=y}!function(){var o,v,_=new Qt,y=new Qt,x=0,b=(t-e)/n;for(v=0;v<=i;v++){var w=[],E=v/i,M=E*(t-e)+e;for(o=0;o<=r;o++){var S=o/r,T=S*s+a,A=Math.sin(T),L=Math.cos(T);y.x=M*A,y.y=-E*n+m,y.z=M*L,l.push(y.x,y.y,y.z),_.set(A,b,L).normalize(),h.push(_.x,_.y,_.z),f.push(S,1-E),w.push(d++)}p.push(w)}for(o=0;o<r;o++)for(v=0;v<i;v++){var C=p[v][o],R=p[v+1][o],P=p[v+1][o+1],O=p[v][o+1];u.push(C,R,O),u.push(R,P,O),x+=6}c.addGroup(g,x,0),g+=x}(),!1===o&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(u),this.addAttribute("position",new $n(l,3)),this.addAttribute("normal",new $n(h,3)),this.addAttribute("uv",new $n(f,2))}function qa(e,t,n,r,i,o,a){Va.call(this,0,e,t,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Xa(e,t,n,r,i,o,a){Wa.call(this,0,e,t,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Ya(e,t,n,r){Hn.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new Za(e,t,n,r)),this.mergeVertices()}function Za(e,t,n,r){nr.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],c=[],u=[],l=new Qt,h=new Jt;for(s.push(0,0,0),c.push(0,0,1),u.push(.5,.5),o=0,i=3;o<=t;o++,i+=3){var f=n+o/t*r;l.x=e*Math.cos(f),l.y=e*Math.sin(f),s.push(l.x,l.y,l.z),c.push(0,0,1),h.x=(s[i]/e+1)/2,h.y=(s[i+1]/e+1)/2,u.push(h.x,h.y)}for(i=1;i<=t;i++)a.push(i,i+1,0);this.setIndex(a),this.addAttribute("position",new $n(s,3)),this.addAttribute("normal",new $n(c,3)),this.addAttribute("uv",new $n(u,2))}Oa.prototype=Object.create(Hn.prototype),Oa.prototype.constructor=Oa,Na.prototype=Object.create(Ca.prototype),Na.prototype.constructor=Na,Ia.prototype=Object.create(Hn.prototype),Ia.prototype.constructor=Ia,Da.prototype=Object.create(nr.prototype),Da.prototype.constructor=Da,za.prototype=Object.create(Hn.prototype),za.prototype.constructor=za,Ua.prototype=Object.create(nr.prototype),Ua.prototype.constructor=Ua,ka.prototype=Object.create(Hn.prototype),ka.prototype.constructor=ka,Fa.prototype=Object.create(nr.prototype),Fa.prototype.constructor=Fa,Ba.prototype=Object.create(Hn.prototype),Ba.prototype.constructor=Ba,Ba.prototype.toJSON=function(){var e=Hn.prototype.toJSON.call(this);return Ha(this.parameters.shapes,e)},ja.prototype=Object.create(nr.prototype),ja.prototype.constructor=ja,ja.prototype.toJSON=function(){var e=nr.prototype.toJSON.call(this);return Ha(this.parameters.shapes,e)},Ga.prototype=Object.create(nr.prototype),Ga.prototype.constructor=Ga,Va.prototype=Object.create(Hn.prototype),Va.prototype.constructor=Va,Wa.prototype=Object.create(nr.prototype),Wa.prototype.constructor=Wa,qa.prototype=Object.create(Va.prototype),qa.prototype.constructor=qa,Xa.prototype=Object.create(Wa.prototype),Xa.prototype.constructor=Xa,Ya.prototype=Object.create(Hn.prototype),Ya.prototype.constructor=Ya,Za.prototype=Object.create(nr.prototype),Za.prototype.constructor=Za;var Ja=Object.freeze({WireframeGeometry:ko,ParametricGeometry:Fo,ParametricBufferGeometry:Bo,TetrahedronGeometry:Go,TetrahedronBufferGeometry:Vo,OctahedronGeometry:Wo,OctahedronBufferGeometry:qo,IcosahedronGeometry:Xo,IcosahedronBufferGeometry:Yo,DodecahedronGeometry:Zo,DodecahedronBufferGeometry:Jo,PolyhedronGeometry:jo,PolyhedronBufferGeometry:Ho,TubeGeometry:$o,TubeBufferGeometry:Ko,TorusKnotGeometry:Qo,TorusKnotBufferGeometry:ea,TorusGeometry:ta,TorusBufferGeometry:na,TextGeometry:Oa,TextBufferGeometry:Na,SphereGeometry:Ia,SphereBufferGeometry:Da,RingGeometry:za,RingBufferGeometry:Ua,PlaneGeometry:or,PlaneBufferGeometry:ar,LatheGeometry:ka,LatheBufferGeometry:Fa,ShapeGeometry:Ba,ShapeBufferGeometry:ja,ExtrudeGeometry:La,ExtrudeBufferGeometry:Ca,EdgesGeometry:Ga,ConeGeometry:qa,ConeBufferGeometry:Xa,CylinderGeometry:Va,CylinderBufferGeometry:Wa,CircleGeometry:Ya,CircleBufferGeometry:Za,BoxGeometry:rr,BoxBufferGeometry:ir});function $a(e){xr.call(this),this.type="ShadowMaterial",this.color=new Mn(0),this.transparent=!0,this.setValues(e)}function Ka(e){br.call(this,e),this.type="RawShaderMaterial"}function Qa(e){xr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Mn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xt,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function es(e){Qa.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function ts(e){xr.call(this),this.type="MeshPhongMaterial",this.color=new Mn(16777215),this.specular=new Mn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xt,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ns(e){ts.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function rs(e){xr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xt,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function is(e){xr.call(this),this.type="MeshLambertMaterial",this.color=new Mn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=le,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function os(e){if(xr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Mn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xt,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(e),null===this.matcap){var t=document.createElement("canvas");t.width=1,t.height=1;var n=t.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,1,1),this.matcap=new THREE.CanvasTexture(t)}}function as(e){Lo.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}$a.prototype=Object.create(xr.prototype),$a.prototype.constructor=$a,$a.prototype.isShadowMaterial=!0,$a.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this},Ka.prototype=Object.create(br.prototype),Ka.prototype.constructor=Ka,Ka.prototype.isRawShaderMaterial=!0,Qa.prototype=Object.create(xr.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isMeshStandardMaterial=!0,Qa.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},es.prototype=Object.create(Qa.prototype),es.prototype.constructor=es,es.prototype.isMeshPhysicalMaterial=!0,es.prototype.copy=function(e){return Qa.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},ts.prototype=Object.create(xr.prototype),ts.prototype.constructor=ts,ts.prototype.isMeshPhongMaterial=!0,ts.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ns.prototype=Object.create(ts.prototype),ns.prototype.constructor=ns,ns.prototype.isMeshToonMaterial=!0,ns.prototype.copy=function(e){return ts.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},rs.prototype=Object.create(xr.prototype),rs.prototype.constructor=rs,rs.prototype.isMeshNormalMaterial=!0,rs.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},is.prototype=Object.create(xr.prototype),is.prototype.constructor=is,is.prototype.isMeshLambertMaterial=!0,is.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},os.prototype=Object.create(xr.prototype),os.prototype.constructor=os,os.prototype.isMeshMatcapMaterial=!0,os.prototype.copy=function(e){return xr.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},as.prototype=Object.create(Lo.prototype),as.prototype.constructor=as,as.prototype.isLineDashedMaterial=!0,as.prototype.copy=function(e){return Lo.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var ss=Object.freeze({ShadowMaterial:$a,SpriteMaterial:wo,RawShaderMaterial:Ka,ShaderMaterial:br,PointsMaterial:Oo,MeshPhysicalMaterial:es,MeshStandardMaterial:Qa,MeshPhongMaterial:ts,MeshToonMaterial:ns,MeshNormalMaterial:rs,MeshLambertMaterial:is,MeshDepthMaterial:ro,MeshDistanceMaterial:io,MeshBasicMaterial:Mr,MeshMatcapMaterial:os,LineDashedMaterial:as,LineBasicMaterial:Lo,Material:xr}),cs={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function us(e,t,n){var r=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===i&&void 0!==r.onStart&&r.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==r.onProgress&&r.onProgress(e,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var ls=new us,hs={};function fs(e){this.manager=void 0!==e?e:ls}function ds(e){this.manager=void 0!==e?e:ls,this._parser=null}function ps(e){this.manager=void 0!==e?e:ls,this._parser=null}function ms(e){this.manager=void 0!==e?e:ls}function gs(e){this.manager=void 0!==e?e:ls}function vs(e){this.manager=void 0!==e?e:ls}function _s(){this.type="Curve",this.arcLengthDivisions=200}function ys(e,t,n,r,i,o,a,s){_s.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function xs(e,t,n,r,i,o){ys.call(this,e,t,n,n,r,i,o),this.type="ArcCurve"}function bs(){var e=0,t=0,n=0,r=0;function i(i,o,a,s){e=i,t=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(e,t,n,r,o){i(t,n,o*(n-e),o*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,o,a,s){var c=(t-e)/o-(n-e)/(o+a)+(n-t)/a,u=(n-t)/a-(r-t)/(a+s)+(r-n)/s;i(t,n,c*=a,u*=a)},calc:function(i){var o=i*i;return e+t*i+n*o+r*(o*i)}}}Object.assign(fs.prototype,{load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=cs.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;if(void 0===hs[e]){var a=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],c=!!a[2],u=a[3];u=window.decodeURIComponent(u),c&&(u=window.atob(u));try{var l,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var f=new Uint8Array(u.length),d=0;d<u.length;d++)f[d]=u.charCodeAt(d);l="blob"===h?new Blob([f.buffer],{type:s}):f.buffer;break;case"document":var p=new DOMParser;l=p.parseFromString(u,s);break;case"json":l=JSON.parse(u);break;default:l=u}window.setTimeout((function(){t&&t(l),i.manager.itemEnd(e)}),0)}catch(t){window.setTimeout((function(){r&&r(t),i.manager.itemEnd(e),i.manager.itemError(e)}),0)}}else{hs[e]=[],hs[e].push({onLoad:t,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var g in m.open("GET",e,!0),m.addEventListener("load",(function(t){var n=this.response;cs.add(e,n);var r=hs[e];if(delete hs[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(o=0,a=r.length;o<a;o++){var s;(s=r[o]).onError&&s.onError(t)}i.manager.itemEnd(e),i.manager.itemError(e)}}),!1),m.addEventListener("progress",(function(t){for(var n=hs[e],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(t)}}),!1),m.addEventListener("error",(function(t){var n=hs[e];delete hs[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemEnd(e),i.manager.itemError(e)}),!1),m.addEventListener("abort",(function(t){var n=hs[e];delete hs[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemEnd(e),i.manager.itemError(e)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(e),m}hs[e].push({onLoad:t,onProgress:n,onError:r})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(ds.prototype,{load:function(e,t,n,r){var i=this,o=[],a=new Do;a.image=o;var s=new fs(this.manager);function c(c){s.load(e[c],(function(e){var n=i._parser(e,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(a.minFilter=Oe),a.format=n.format,a.needsUpdate=!0,t&&t(a))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,l=0,h=e.length;l<h;++l)c(l);else s.load(e,(function(e){var n=i._parser(e,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+c]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=Oe),a.format=n.format,a.needsUpdate=!0,t&&t(a)}),n,r);return a},setPath:function(e){return this.path=e,this}}),Object.assign(ps.prototype,{load:function(e,t,n,r){var i=this,o=new dn,a=new fs(this.manager);return a.setResponseType("arraybuffer"),a.load(e,(function(e){var n=i._parser(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:Ae,o.wrapT=void 0!==n.wrapT?n.wrapT:Ae,o.magFilter=void 0!==n.magFilter?n.magFilter:Oe,o.minFilter=void 0!==n.minFilter?n.minFilter:Ie,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=Oe),o.needsUpdate=!0,t&&t(o,n))}),n,r),o}}),Object.assign(ms.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=cs.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),cs.add(e,this),t&&t(this),i.manager.itemEnd(e)}function c(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),r&&r(t),i.manager.itemEnd(e),i.manager.itemError(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",c,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(gs.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=new Ur,o=new ms(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(e[n],(function(e){i.images[n]=e,6===++a&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var c=0;c<e.length;++c)s(c);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(vs.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=new un,o=new ms(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(n){i.image=n;var r=e.search(/\.jpe?g$/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?Ye:Ze,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(_s.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=e;n++)o+=(t=this.getPoint(n/e)).distanceTo(i),r.push(o),i=t;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),i=0,o=r.length;n=t||e*r[o-1];for(var a,s=0,c=o-1;s<=c;)if((a=r[i=Math.floor(s+(c-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){c=i;break}c=i-1}if(r[i=c]===n)return i/(o-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(o-1)},getTangent:function(e){var t=e-1e-4,n=e+1e-4;t<0&&(t=0),n>1&&(n=1);var r=this.getPoint(t);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,r,i,o=new Qt,a=[],s=[],c=[],u=new Qt,l=new $t;for(n=0;n<=e;n++)r=n/e,a[n]=this.getTangentAt(r),a[n].normalize();s[0]=new Qt,c[0]=new Qt;var h=Number.MAX_VALUE,f=Math.abs(a[0].x),d=Math.abs(a[0].y),p=Math.abs(a[0].z);for(f<=h&&(h=f,o.set(1,0,0)),d<=h&&(h=d,o.set(0,1,0)),p<=h&&o.set(0,0,1),u.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],u),c[0].crossVectors(a[0],s[0]),n=1;n<=e;n++)s[n]=s[n-1].clone(),c[n]=c[n-1].clone(),u.crossVectors(a[n-1],a[n]),u.length()>Number.EPSILON&&(u.normalize(),i=Math.acos(Zt.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(l.makeRotationAxis(u,i))),c[n].crossVectors(a[n],s[n]);if(!0===t)for(i=Math.acos(Zt.clamp(s[0].dot(s[e]),-1,1)),i/=e,a[0].dot(u.crossVectors(s[0],s[e]))>0&&(i=-i),n=1;n<=e;n++)s[n].applyMatrix4(l.makeRotationAxis(a[n],i*n)),c[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),ys.prototype=Object.create(_s.prototype),ys.prototype.constructor=ys,ys.prototype.isEllipseCurve=!0,ys.prototype.getPoint=function(e,t){for(var n=t||new Jt,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var u=Math.cos(this.aRotation),l=Math.sin(this.aRotation),h=s-this.aX,f=c-this.aY;s=h*u-f*l+this.aX,c=h*l+f*u+this.aY}return n.set(s,c)},ys.prototype.copy=function(e){return _s.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ys.prototype.toJSON=function(){var e=_s.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},ys.prototype.fromJSON=function(e){return _s.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},xs.prototype=Object.create(ys.prototype),xs.prototype.constructor=xs,xs.prototype.isArcCurve=!0;var ws=new Qt,Es=new bs,Ms=new bs,Ss=new bs;function Ts(e,t,n,r){_s.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=r||.5}function As(e,t,n,r,i){var o=.5*(r-t),a=.5*(i-n),s=e*e;return(2*n-2*r+o+a)*(e*s)+(-3*n+3*r-2*o-a)*s+o*e+n}function Ls(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function Cs(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function Rs(e,t,n,r){_s.call(this),this.type="CubicBezierCurve",this.v0=e||new Jt,this.v1=t||new Jt,this.v2=n||new Jt,this.v3=r||new Jt}function Ps(e,t,n,r){_s.call(this),this.type="CubicBezierCurve3",this.v0=e||new Qt,this.v1=t||new Qt,this.v2=n||new Qt,this.v3=r||new Qt}function Os(e,t){_s.call(this),this.type="LineCurve",this.v1=e||new Jt,this.v2=t||new Jt}function Ns(e,t){_s.call(this),this.type="LineCurve3",this.v1=e||new Qt,this.v2=t||new Qt}function Is(e,t,n){_s.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Jt,this.v1=t||new Jt,this.v2=n||new Jt}function Ds(e,t,n){_s.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Qt,this.v1=t||new Qt,this.v2=n||new Qt}function zs(e){_s.call(this),this.type="SplineCurve",this.points=e||[]}Ts.prototype=Object.create(_s.prototype),Ts.prototype.constructor=Ts,Ts.prototype.isCatmullRomCurve3=!0,Ts.prototype.getPoint=function(e,t){var n,r,i,o,a=t||new Qt,s=this.points,c=s.length,u=(c-(this.closed?0:1))*e,l=Math.floor(u),h=u-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/c)+1)*c:0===h&&l===c-1&&(l=c-2,h=1),this.closed||l>0?n=s[(l-1)%c]:(ws.subVectors(s[0],s[1]).add(s[0]),n=ws),r=s[l%c],i=s[(l+1)%c],this.closed||l+2<c?o=s[(l+2)%c]:(ws.subVectors(s[c-1],s[c-2]).add(s[c-1]),o=ws),"centripetal"===this.curveType||"chordal"===this.curveType){var f="chordal"===this.curveType?.5:.25,d=Math.pow(n.distanceToSquared(r),f),p=Math.pow(r.distanceToSquared(i),f),m=Math.pow(i.distanceToSquared(o),f);p<1e-4&&(p=1),d<1e-4&&(d=p),m<1e-4&&(m=p),Es.initNonuniformCatmullRom(n.x,r.x,i.x,o.x,d,p,m),Ms.initNonuniformCatmullRom(n.y,r.y,i.y,o.y,d,p,m),Ss.initNonuniformCatmullRom(n.z,r.z,i.z,o.z,d,p,m)}else"catmullrom"===this.curveType&&(Es.initCatmullRom(n.x,r.x,i.x,o.x,this.tension),Ms.initCatmullRom(n.y,r.y,i.y,o.y,this.tension),Ss.initCatmullRom(n.z,r.z,i.z,o.z,this.tension));return a.set(Es.calc(h),Ms.calc(h),Ss.calc(h)),a},Ts.prototype.copy=function(e){_s.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Ts.prototype.toJSON=function(){var e=_s.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Ts.prototype.fromJSON=function(e){_s.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Qt).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Rs.prototype=Object.create(_s.prototype),Rs.prototype.constructor=Rs,Rs.prototype.isCubicBezierCurve=!0,Rs.prototype.getPoint=function(e,t){var n=t||new Jt,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Cs(e,r.x,i.x,o.x,a.x),Cs(e,r.y,i.y,o.y,a.y)),n},Rs.prototype.copy=function(e){return _s.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Rs.prototype.toJSON=function(){var e=_s.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Rs.prototype.fromJSON=function(e){return _s.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Ps.prototype=Object.create(_s.prototype),Ps.prototype.constructor=Ps,Ps.prototype.isCubicBezierCurve3=!0,Ps.prototype.getPoint=function(e,t){var n=t||new Qt,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Cs(e,r.x,i.x,o.x,a.x),Cs(e,r.y,i.y,o.y,a.y),Cs(e,r.z,i.z,o.z,a.z)),n},Ps.prototype.copy=function(e){return _s.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Ps.prototype.toJSON=function(){var e=_s.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Ps.prototype.fromJSON=function(e){return _s.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Os.prototype=Object.create(_s.prototype),Os.prototype.constructor=Os,Os.prototype.isLineCurve=!0,Os.prototype.getPoint=function(e,t){var n=t||new Jt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Os.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Os.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Os.prototype.copy=function(e){return _s.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Os.prototype.toJSON=function(){var e=_s.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Os.prototype.fromJSON=function(e){return _s.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ns.prototype=Object.create(_s.prototype),Ns.prototype.constructor=Ns,Ns.prototype.isLineCurve3=!0,Ns.prototype.getPoint=function(e,t){var n=t||new Qt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Ns.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Ns.prototype.copy=function(e){return _s.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ns.prototype.toJSON=function(){var e=_s.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ns.prototype.fromJSON=function(e){return _s.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Is.prototype=Object.create(_s.prototype),Is.prototype.constructor=Is,Is.prototype.isQuadraticBezierCurve=!0,Is.prototype.getPoint=function(e,t){var n=t||new Jt,r=this.v0,i=this.v1,o=this.v2;return n.set(Ls(e,r.x,i.x,o.x),Ls(e,r.y,i.y,o.y)),n},Is.prototype.copy=function(e){return _s.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Is.prototype.toJSON=function(){var e=_s.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Is.prototype.fromJSON=function(e){return _s.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ds.prototype=Object.create(_s.prototype),Ds.prototype.constructor=Ds,Ds.prototype.isQuadraticBezierCurve3=!0,Ds.prototype.getPoint=function(e,t){var n=t||new Qt,r=this.v0,i=this.v1,o=this.v2;return n.set(Ls(e,r.x,i.x,o.x),Ls(e,r.y,i.y,o.y),Ls(e,r.z,i.z,o.z)),n},Ds.prototype.copy=function(e){return _s.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ds.prototype.toJSON=function(){var e=_s.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ds.prototype.fromJSON=function(e){return _s.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},zs.prototype=Object.create(_s.prototype),zs.prototype.constructor=zs,zs.prototype.isSplineCurve=!0,zs.prototype.getPoint=function(e,t){var n=t||new Jt,r=this.points,i=(r.length-1)*e,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(As(a,s.x,c.x,u.x,l.x),As(a,s.y,c.y,u.y,l.y)),n},zs.prototype.copy=function(e){_s.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},zs.prototype.toJSON=function(){var e=_s.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e},zs.prototype.fromJSON=function(e){_s.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Jt).fromArray(r))}return this};var Us=Object.freeze({ArcCurve:xs,CatmullRomCurve3:Ts,CubicBezierCurve:Rs,CubicBezierCurve3:Ps,EllipseCurve:ys,LineCurve:Os,LineCurve3:Ns,QuadraticBezierCurve:Is,QuadraticBezierCurve3:Ds,SplineCurve:zs});function ks(){_s.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Fs(e){ks.call(this),this.type="Path",this.currentPoint=new Jt,e&&this.setFromPoints(e)}function Bs(e){Fs.call(this,e),this.uuid=Zt.generateUUID(),this.type="Shape",this.holes=[]}function js(e,t){kn.call(this),this.type="Light",this.color=new Mn(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Hs(e,t,n){js.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(kn.DefaultUp),this.updateMatrix(),this.groundColor=new Mn(t)}function Gs(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Jt(512,512),this.map=null,this.matrix=new $t}function Vs(){Gs.call(this,new ho(50,1,.5,500))}function Ws(e,t,n,r,i,o){js.call(this,e,t),this.type="SpotLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.target=new kn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Vs}function qs(e,t,n,r){js.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Gs(new ho(90,1,.5,500))}function Xs(e,t,n,r,i,o){lo.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Ys(){Gs.call(this,new Xs(-5,5,5,-5,.5,500))}function Zs(e,t){js.call(this,e,t),this.type="DirectionalLight",this.position.copy(kn.DefaultUp),this.updateMatrix(),this.target=new kn,this.shadow=new Ys}function Js(e,t){js.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function $s(e,t,n,r){js.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}ks.prototype=Object.assign(Object.create(_s.prototype),{constructor:ks,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Os(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),c=0;c<s.length;c++){var u=s[c];t&&t.equals(u)||(n.push(u),t=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){_s.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=_s.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){_s.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push((new Us[r.type]).fromJSON(r))}return this}}),Fs.prototype=Object.assign(Object.create(ks.prototype),{constructor:Fs,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new Os(this.currentPoint.clone(),new Jt(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,r){var i=new Is(this.currentPoint.clone(),new Jt(e,t),new Jt(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(e,t,n,r,i,o){var a=new Rs(this.currentPoint.clone(),new Jt(e,t),new Jt(n,r),new Jt(i,o));this.curves.push(a),this.currentPoint.set(i,o)},splineThru:function(e){var t=new zs([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,n,r,i,o)},absarc:function(e,t,n,r,i,o){this.absellipse(e,t,n,n,r,i,o)},ellipse:function(e,t,n,r,i,o,a,s){var c=this.currentPoint.x,u=this.currentPoint.y;this.absellipse(e+c,t+u,n,r,i,o,a,s)},absellipse:function(e,t,n,r,i,o,a,s){var c=new ys(e,t,n,r,i,o,a,s);if(this.curves.length>0){var u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);var l=c.getPoint(1);this.currentPoint.copy(l)},copy:function(e){return ks.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=ks.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return ks.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Bs.prototype=Object.assign(Object.create(Fs.prototype),{constructor:Bs,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Fs.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){var e=Fs.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){Fs.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push((new Fs).fromJSON(r))}return this}}),js.prototype=Object.assign(Object.create(kn.prototype),{constructor:js,isLight:!0,copy:function(e){return kn.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=kn.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Hs.prototype=Object.assign(Object.create(js.prototype),{constructor:Hs,isHemisphereLight:!0,copy:function(e){return js.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Gs.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Vs.prototype=Object.assign(Object.create(Gs.prototype),{constructor:Vs,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*Zt.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix())}}),Ws.prototype=Object.assign(Object.create(js.prototype),{constructor:Ws,isSpotLight:!0,copy:function(e){return js.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),qs.prototype=Object.assign(Object.create(js.prototype),{constructor:qs,isPointLight:!0,copy:function(e){return js.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Xs.prototype=Object.assign(Object.create(lo.prototype),{constructor:Xs,isOrthographicCamera:!0,copy:function(e,t){return lo.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,o=n+e,a=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(i+=l*(this.view.offsetX/c))+l*(this.view.width/c),s=(a-=h*(this.view.offsetY/u))-h*(this.view.height/u)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=kn.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Ys.prototype=Object.assign(Object.create(Gs.prototype),{constructor:Ys}),Zs.prototype=Object.assign(Object.create(js.prototype),{constructor:Zs,isDirectionalLight:!0,copy:function(e){return js.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Js.prototype=Object.assign(Object.create(js.prototype),{constructor:Js,isAmbientLight:!0}),$s.prototype=Object.assign(Object.create(js.prototype),{constructor:$s,isRectAreaLight:!0,copy:function(e){return js.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=js.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});var Ks={arraySlice:function(e,t,n){return Ks.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*t,c=0;c!==t;++c)i[a++]=e[s+c];return i},flattenJSON:function(e,t,n,r){for(var i=1,o=e[0];void 0!==o&&void 0===o[r];)o=e[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(t.push(o.time),n.push.apply(n,a)),o=e[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(t.push(o.time),a.toArray(n,n.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(t.push(o.time),n.push(a)),o=e[i++]}while(void 0!==o)}}};function Qs(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function ec(e,t,n,r){Qs.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function tc(e,t,n,r){Qs.call(this,e,t,n,r)}function nc(e,t,n,r){Qs.call(this,e,t,n,r)}function rc(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ks.convertArray(t,this.TimeBufferType),this.values=Ks.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function ic(e,t,n){rc.call(this,e,t,n)}function oc(e,t,n,r){rc.call(this,e,t,n,r)}function ac(e,t,n,r){rc.call(this,e,t,n,r)}function sc(e,t,n,r){Qs.call(this,e,t,n,r)}function cc(e,t,n,r){rc.call(this,e,t,n,r)}function uc(e,t,n,r){rc.call(this,e,t,n,r)}function lc(e,t,n,r){rc.call(this,e,t,n,r)}function hc(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=Zt.generateUUID(),this.duration<0&&this.resetDuration()}function fc(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ac;case"vector":case"vector2":case"vector3":case"vector4":return lc;case"color":return oc;case"quaternion":return cc;case"bool":case"boolean":return ic;case"string":return uc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];Ks.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}function dc(e){this.manager=void 0!==e?e:ls,this.textures={}}function pc(e){this.manager=void 0!==e?e:ls}Object.assign(Qs.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var o;n:{r:if(!(e<r)){for(var a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===a)break;if(i=r,e<(r=t[++n]))break t}o=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===a)break;if(r=i,e>=(i=t[--n-1]))break t}o=n,n=0}for(;n<o;){var c=n+o>>>1;e<t[c]?o=c:n=c+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,o=0;o!==r;++o)t[o]=n[i+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Qs.prototype,{beforeStart_:Qs.prototype.copySampleValue_,afterEnd_:Qs.prototype.copySampleValue_}),ec.prototype=Object.assign(Object.create(Qs.prototype),{constructor:ec,DefaultSettings_:{endingStart:Pt,endingEnd:Pt},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,o=e+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case Ot:i=e,a=2*t-n;break;case Nt:a=t+r[i=r.length-2]-r[i+1];break;default:i=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Ot:o=e,s=2*n-t;break;case Nt:o=1,s=n+r[1]-r[0];break;default:o=e-1,s=t}var c=.5*(n-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(s-n),this._offsetPrev=i*u,this._offsetNext=o*u},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,u=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,f=this._weightNext,d=(n-t)/(r-t),p=d*d,m=p*d,g=-h*m+2*h*p-h*d,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*d+1,_=(-1-f)*m+(1.5+f)*p+.5*d,y=f*m-f*p,x=0;x!==a;++x)i[x]=g*o[u+x]+v*o[c+x]+_*o[s+x]+y*o[l+x];return i}}),tc.prototype=Object.assign(Object.create(Qs.prototype),{constructor:tc,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,u=(n-t)/(r-t),l=1-u,h=0;h!==a;++h)i[h]=o[c+h]*l+o[s+h]*u;return i}}),nc.prototype=Object.assign(Object.create(Qs.prototype),{constructor:nc,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(rc,{toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Ks.convertArray(e.times,Array),values:Ks.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}),Object.assign(rc.prototype,{constructor:rc,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Ct,InterpolantFactoryMethodDiscrete:function(e){return new nc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new tc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new ec(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case Lt:t=this.InterpolantFactoryMethodDiscrete;break;case Ct:t=this.InterpolantFactoryMethodLinear;break;case Rt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Lt;case this.InterpolantFactoryMethodLinear:return Ct;case this.InterpolantFactoryMethodSmooth:return Rt}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Ks.arraySlice(n,i,o),this.values=Ks.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==r&&Ks.isTypedArray(r)){a=0;for(var c=r.length;a!==c;++a){var u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),r=this.getInterpolation()===Rt,i=1,o=e.length-1,a=1;a<o;++a){var s=!1,c=e[a];if(c!==e[a+1]&&(1!==a||c!==c[0]))if(r)s=!0;else for(var u=a*n,l=u-n,h=u+n,f=0;f!==n;++f){var d=t[u+f];if(d!==t[l+f]||d!==t[h+f]){s=!0;break}}if(s){if(a!==i){e[i]=e[a];var p=a*n,m=i*n;for(f=0;f!==n;++f)t[m+f]=t[p+f]}++i}}if(o>0){e[i]=e[o];for(p=o*n,m=i*n,f=0;f!==n;++f)t[m+f]=t[p+f];++i}return i!==e.length&&(this.times=Ks.arraySlice(e,0,i),this.values=Ks.arraySlice(t,0,i*n)),this}}),ic.prototype=Object.assign(Object.create(rc.prototype),{constructor:ic,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Lt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),oc.prototype=Object.assign(Object.create(rc.prototype),{constructor:oc,ValueTypeName:"color"}),ac.prototype=Object.assign(Object.create(rc.prototype),{constructor:ac,ValueTypeName:"number"}),sc.prototype=Object.assign(Object.create(Qs.prototype),{constructor:sc,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=(n-t)/(r-t),u=s+a;s!==u;s+=4)Kt.slerpFlat(i,0,o,s-a,o,s,c);return i}}),cc.prototype=Object.assign(Object.create(rc.prototype),{constructor:cc,ValueTypeName:"quaternion",DefaultInterpolation:Ct,InterpolantFactoryMethodLinear:function(e){return new sc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),uc.prototype=Object.assign(Object.create(rc.prototype),{constructor:uc,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Lt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),lc.prototype=Object.assign(Object.create(rc.prototype),{constructor:lc,ValueTypeName:"vector"}),Object.assign(hc,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,o=n.length;i!==o;++i)t.push(fc(n[i]).scale(r));return new hc(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,o=n.length;i!==o;++i)t.push(rc.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],c=[];s.push((a+i-1)%i,a,(a+1)%i),c.push(0,1,0);var u=Ks.getKeyframeOrder(s);s=Ks.sortedArray(s,1,u),c=Ks.sortedArray(c,1,u),r||0!==s[0]||(s.push(i),c.push(c[0])),o.push(new ac(".morphTargetInfluences["+t[a].name+"]",s,c).scale(1/n))}return new hc(e,-1,o)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],c=s.name.match(i);if(c&&c.length>1){var u=r[h=c[1]];u||(r[h]=u=[]),u.push(s)}}var l=[];for(var h in r)l.push(hc.CreateFromMorphTargetSequence(h,r[h],t,n));return l},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var o=[],a=[];Ks.flattenJSON(n,o,a,r),0!==o.length&&i.push(new e(t,o,a))}},r=[],i=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],c=0;c<s.length;c++){var u=s[c].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var l={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var f=0;f<u[h].morphTargets.length;f++)l[u[h].morphTargets[f]]=-1;for(var d in l){var p=[],m=[];for(f=0;f!==u[h].morphTargets.length;++f){var g=u[h];p.push(g.time),m.push(g.morphTarget===d?1:0)}r.push(new ac(".morphTargetInfluence["+d+"]",p,m))}o=l.length*(a||1)}else{var v=".bones["+t[c].name+"]";n(lc,v+".position",u,"pos",r),n(cc,v+".quaternion",u,"rot",r),n(lc,v+".scale",u,"scl",r)}}return 0===r.length?null:new hc(i,o,r)}}),Object.assign(hc.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(dc.prototype,{load:function(e,t,n,r){var i=this;new fs(i.manager).load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new ss[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearCoat&&(r.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(r.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.vertexColors&&(r.vertexColors=e.vertexColors),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.uniforms)for(var i in e.uniforms){var o=e.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new Mn).setHex(o.value);break;case"v2":r.uniforms[i].value=(new Jt).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new Qt).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new ln).fromArray(o.value);break;case"m4":r.uniforms[i].value=(new $t).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap),r.transparent=!0),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var a=e.normalScale;!1===Array.isArray(a)&&(a=[a,a]),r.normalScale=(new Jt).fromArray(a)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),r}}),Object.assign(pc.prototype,{load:function(e,t,n,r){var i=this;new fs(i.manager).load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){var t=new nr,n=e.data.index;if(void 0!==n){var r=new yc[n.type](n.array);t.setIndex(new Gn(r,1))}var i=e.data.attributes;for(var o in i){var a=i[o];r=new yc[a.type](a.array);t.addAttribute(o,new Gn(r,a.itemSize,a.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var c=0,u=s.length;c!==u;++c){var l=s[c];t.addGroup(l.start,l.count,l.materialIndex)}var h=e.data.boundingSphere;if(void 0!==h){var f=new Qt;void 0!==h.center&&f.fromArray(h.center),t.boundingSphere=new mn(f,h.radius)}return t}});var mc,gc,vc,_c,yc={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function xc(){}xc.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,r=t.length;n<r;n+=2){var i=t[n],o=t[n+1];if(i.test(e))return o}return null}},Object.assign(xc.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,n){for(var r=[],i=0;i<e.length;++i)r[i]=this.createMaterial(e[i],t,n);return r},createMaterial:(mc={NoBlending:I,NormalBlending:D,AdditiveBlending:z,SubtractiveBlending:U,MultiplyBlending:k,CustomBlending:F},gc=new Mn,vc=new vs,_c=new dc,function(e,t,n){var r={};function i(e,i,o,a,s){var c,u=t+e,l=xc.Handlers.get(u);null!==l?c=l.load(u):(vc.setCrossOrigin(n),c=vc.load(u)),void 0!==i&&(c.repeat.fromArray(i),1!==i[0]&&(c.wrapS=Te),1!==i[1]&&(c.wrapT=Te)),void 0!==o&&c.offset.fromArray(o),void 0!==a&&("repeat"===a[0]&&(c.wrapS=Te),"mirror"===a[0]&&(c.wrapS=Le),"repeat"===a[1]&&(c.wrapT=Te),"mirror"===a[1]&&(c.wrapT=Le)),void 0!==s&&(c.anisotropy=s);var h=Zt.generateUUID();return r[h]=c,h}var o={uuid:Zt.generateUUID(),type:"MeshLambertMaterial"};for(var a in e){var s=e[a];switch(a){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":o.name=s;break;case"blending":o.blending=mc[s];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",a,"is no longer supported.");break;case"colorDiffuse":o.color=gc.fromArray(s).getHex();break;case"colorSpecular":o.specular=gc.fromArray(s).getHex();break;case"colorEmissive":o.emissive=gc.fromArray(s).getHex();break;case"specularCoef":o.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(o.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(o.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(o.type="MeshStandardMaterial");break;case"mapDiffuse":o.map=i(s,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":o.emissiveMap=i(s,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":o.lightMap=i(s,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":o.aoMap=i(s,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":o.bumpMap=i(s,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":o.bumpScale=s;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":o.normalMap=i(s,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":o.normalScale=s;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":o.specularMap=i(s,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":o.metalnessMap=i(s,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":o.roughnessMap=i(s,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":o.alphaMap=i(s,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":o.side=A;break;case"doubleSided":o.side=L;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),o.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":o[a]=s;break;case"vertexColors":!0===s&&(o.vertexColors=N),"face"===s&&(o.vertexColors=O);break;default:console.error("THREE.Loader.createMaterial: Unsupported",a,s)}}return"MeshBasicMaterial"===o.type&&delete o.emissive,"MeshPhongMaterial"!==o.type&&delete o.specular,o.opacity<1&&(o.transparent=!0),_c.setTextures(r),_c.parse(o)})});var bc={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function wc(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:ls,this.withCredentials=!1}function Ec(e){this.manager=void 0!==e?e:ls,this.texturePath=""}Object.assign(wc.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=this,o=void 0===this.path?bc.extractUrlBase(e):this.path,a=new fs(this.manager);a.setPath(this.path),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){var r=JSON.parse(n),a=r.metadata;if(void 0!==a){var s=a.type;if(void 0!==s&&"object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.")}var c=i.parse(r,o);t(c.geometry,c.materials)}),n,r)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var n=new Hn;return function(e,t){function n(e,t){return e&1<<t}var r,i,o,a,s,c,u,l,h,f,d,p,m,g,v,_,y,x,b,w,E,M,S,T,A,L=e.faces,C=e.vertices,R=e.normals,P=e.colors,O=e.scale,N=0;if(void 0!==e.uvs){for(r=0;r<e.uvs.length;r++)e.uvs[r].length&&N++;for(r=0;r<N;r++)t.faceVertexUvs[r]=[]}for(a=0,s=C.length;a<s;)(x=new Qt).x=C[a++]*O,x.y=C[a++]*O,x.z=C[a++]*O,t.vertices.push(x);for(a=0,s=L.length;a<s;)if(d=n(f=L[a++],0),p=n(f,1),m=n(f,3),g=n(f,4),v=n(f,5),_=n(f,6),y=n(f,7),d){if((w=new Rn).a=L[a],w.b=L[a+1],w.c=L[a+3],(E=new Rn).a=L[a+1],E.b=L[a+2],E.c=L[a+3],a+=4,p&&(h=L[a++],w.materialIndex=h,E.materialIndex=h),o=t.faces.length,m)for(r=0;r<N;r++)for(T=e.uvs[r],t.faceVertexUvs[r][o]=[],t.faceVertexUvs[r][o+1]=[],i=0;i<4;i++)A=new Jt(T[2*(l=L[a++])],T[2*l+1]),2!==i&&t.faceVertexUvs[r][o].push(A),0!==i&&t.faceVertexUvs[r][o+1].push(A);if(g&&(u=3*L[a++],w.normal.set(R[u++],R[u++],R[u]),E.normal.copy(w.normal)),v)for(r=0;r<4;r++)u=3*L[a++],S=new Qt(R[u++],R[u++],R[u]),2!==r&&w.vertexNormals.push(S),0!==r&&E.vertexNormals.push(S);if(_&&(M=P[c=L[a++]],w.color.setHex(M),E.color.setHex(M)),y)for(r=0;r<4;r++)M=P[c=L[a++]],2!==r&&w.vertexColors.push(new Mn(M)),0!==r&&E.vertexColors.push(new Mn(M));t.faces.push(w),t.faces.push(E)}else{if((b=new Rn).a=L[a++],b.b=L[a++],b.c=L[a++],p&&(h=L[a++],b.materialIndex=h),o=t.faces.length,m)for(r=0;r<N;r++)for(T=e.uvs[r],t.faceVertexUvs[r][o]=[],i=0;i<3;i++)A=new Jt(T[2*(l=L[a++])],T[2*l+1]),t.faceVertexUvs[r][o].push(A);if(g&&(u=3*L[a++],b.normal.set(R[u++],R[u++],R[u])),v)for(r=0;r<3;r++)u=3*L[a++],S=new Qt(R[u++],R[u++],R[u]),b.vertexNormals.push(S);if(_&&(c=L[a++],b.color.setHex(P[c])),y)for(r=0;r<3;r++)c=L[a++],b.vertexColors.push(new Mn(P[c]));t.faces.push(b)}}(e,n),function(e,t){var n=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var r=0,i=e.skinWeights.length;r<i;r+=n){var o=e.skinWeights[r],a=n>1?e.skinWeights[r+1]:0,s=n>2?e.skinWeights[r+2]:0,c=n>3?e.skinWeights[r+3]:0;t.skinWeights.push(new ln(o,a,s,c))}if(e.skinIndices)for(r=0,i=e.skinIndices.length;r<i;r+=n){var u=e.skinIndices[r],l=n>1?e.skinIndices[r+1]:0,h=n>2?e.skinIndices[r+2]:0,f=n>3?e.skinIndices[r+3]:0;t.skinIndices.push(new ln(u,l,h,f))}t.bones=e.bones,t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,n),function(e,t){var n=e.scale;if(void 0!==e.morphTargets)for(var r=0,i=e.morphTargets.length;r<i;r++){t.morphTargets[r]={},t.morphTargets[r].name=e.morphTargets[r].name,t.morphTargets[r].vertices=[];for(var o=t.morphTargets[r].vertices,a=e.morphTargets[r].vertices,s=0,c=a.length;s<c;s+=3){var u=new Qt;u.x=a[s]*n,u.y=a[s+1]*n,u.z=a[s+2]*n,o.push(u)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var l=t.faces,h=e.morphColors[0].colors;for(r=0,i=l.length;r<i;r++)l[r].color.fromArray(h,3*r)}}(e,n),function(e,t){var n=[],r=[];void 0!==e.animation&&r.push(e.animation),void 0!==e.animations&&(e.animations.length?r=r.concat(e.animations):r.push(e.animations));for(var i=0;i<r.length;i++){var o=hc.parseAnimation(r[i],t.bones);o&&n.push(o)}if(t.morphTargets){var a=hc.CreateClipsFromMorphTargetSequences(t.morphTargets,10);n=n.concat(a)}n.length>0&&(t.animations=n)}(e,n),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:n}:{geometry:n,materials:xc.prototype.initMaterials(e.materials,this.resourcePath||t,this.crossOrigin)}}}),Object.assign(Ec.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var i=this;new fs(i.manager).load(e,(function(n){var o=null;try{o=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.")}),n,r)},setTexturePath:function(e){return this.texturePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var n=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,n),i=this.parseImages(e.images,(function(){void 0!==t&&t(s)})),o=this.parseTextures(e.textures,i),a=this.parseMaterials(e.materials,o),s=this.parseObject(e.object,r,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Bs).fromJSON(e[n]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var r=new wc,i=new pc,o=0,a=e.length;o<a;o++){var s,c=e[o];switch(c.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Ja[c.type](c.width,c.height,c.widthSegments,c.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Ja[c.type](c.width,c.height,c.depth,c.widthSegments,c.heightSegments,c.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Ja[c.type](c.radius,c.segments,c.thetaStart,c.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Ja[c.type](c.radiusTop,c.radiusBottom,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Ja[c.type](c.radius,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Ja[c.type](c.radius,c.widthSegments,c.heightSegments,c.phiStart,c.phiLength,c.thetaStart,c.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Ja[c.type](c.radius,c.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Ja[c.type](c.innerRadius,c.outerRadius,c.thetaSegments,c.phiSegments,c.thetaStart,c.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Ja[c.type](c.radius,c.tube,c.radialSegments,c.tubularSegments,c.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Ja[c.type](c.radius,c.tube,c.tubularSegments,c.radialSegments,c.p,c.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Ja[c.type](c.points,c.segments,c.phiStart,c.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Ja[c.type](c.vertices,c.indices,c.radius,c.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],l=0,h=c.shapes.length;l<h;l++){var f=t[c.shapes[l]];u.push(f)}s=new Ja[c.type](u,c.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(u=[],l=0,h=c.shapes.length;l<h;l++){f=t[c.shapes[l]];u.push(f)}var d=c.options.extrudePath;void 0!==d&&(c.options.extrudePath=(new Us[d.type]).fromJSON(d)),s=new Ja[c.type](u,c.options);break;case"BufferGeometry":s=i.parse(c);break;case"Geometry":s=r.parse(c,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+c.type+'"');continue}s.uuid=c.uuid,void 0!==c.name&&(s.name=c.name),!0===s.isBufferGeometry&&void 0!==c.userData&&(s.userData=c.userData),n[c.uuid]=s}return n},parseMaterials:function(e,t){var n={};if(void 0!==e){var r=new dc;r.setTextures(t);for(var i=0,o=e.length;i<o;i++){var a=e[i];if("MultiMaterial"===a.type){for(var s=[],c=0;c<a.materials.length;c++)s.push(r.parse(a.materials[c]));n[a.uuid]=s}else n[a.uuid]=r.parse(a)}}return n},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=hc.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),t.push(i)}return t},parseImages:function(e,t){var n=this,r={};function i(e){return n.manager.itemStart(e),o.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemEnd(e),n.manager.itemError(e)}))}if(void 0!==e&&e.length>0){var o=new ms(new us(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var c=e[a],u=c.url;if(Array.isArray(u)){r[c.uuid]=[];for(var l=0,h=u.length;l<h;l++){var f=u[l],d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:n.texturePath+f;r[c.uuid].push(i(d))}}else{d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.texturePath+c.url;r[c.uuid]=i(d)}}}return r},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a,s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(a=Array.isArray(t[s.image])?new Ur(t[s.image]):new un(t[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,Sc)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],Tc),a.wrapT=n(s.wrap[1],Tc)),void 0!==s.format&&(a.format=s.format),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,Ac)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,Ac)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),r[s.uuid]=a}return r},parseObject:function(e,t,n){var r;function i(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function o(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var o=e[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(n[o])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":r=new yo,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new Mn(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new _o(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new vo(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new ho(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new Xs(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new Js(e.color,e.intensity);break;case"DirectionalLight":r=new Zs(e.color,e.intensity);break;case"PointLight":r=new qs(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new $s(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new Ws(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new Hs(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(e.geometry),s=o(e.material);r=a.bones&&a.bones.length>0?new Ao(a,s):new Sr(a,s);break;case"LOD":r=new Mo;break;case"Line":r=new Co(i(e.geometry),o(e.material),e.mode);break;case"LineLoop":r=new Po(i(e.geometry),o(e.material));break;case"LineSegments":r=new Ro(i(e.geometry),o(e.material));break;case"PointCloud":case"Points":r=new No(i(e.geometry),o(e.material));break;case"Sprite":r=new Eo(o(e.material));break;case"Group":r=new uo;break;default:r=new kn}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,u=0;u<c.length;u++)r.add(this.parseObject(c[u],t,n));if("LOD"===e.type)for(var l=e.levels,h=0;h<l.length;h++){var f=l[h],d=r.getObjectByProperty("uuid",f.object);void 0!==d&&r.addLevel(d,f.distance)}return r}});var Mc,Sc={UVMapping:_e,CubeReflectionMapping:ye,CubeRefractionMapping:xe,EquirectangularReflectionMapping:be,EquirectangularRefractionMapping:we,SphericalReflectionMapping:Ee,CubeUVReflectionMapping:Me,CubeUVRefractionMapping:Se},Tc={RepeatWrapping:Te,ClampToEdgeWrapping:Ae,MirroredRepeatWrapping:Le},Ac={NearestFilter:Ce,NearestMipMapNearestFilter:Re,NearestMipMapLinearFilter:Pe,LinearFilter:Oe,LinearMipMapNearestFilter:Ne,LinearMipMapLinearFilter:Ie};function Lc(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:ls,this.options=void 0}function Cc(){this.type="ShapePath",this.color=new Mn,this.subPaths=[],this.currentPath=null}function Rc(e){this.type="Font",this.data=e}function Pc(e,t,n,r,i){var o=i.glyphs[e]||i.glyphs["?"];if(o){var a,s,c,u,l,h,f,d,p=new Cc;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),g=0,v=m.length;g<v;){switch(m[g++]){case"m":a=m[g++]*t+n,s=m[g++]*t+r,p.moveTo(a,s);break;case"l":a=m[g++]*t+n,s=m[g++]*t+r,p.lineTo(a,s);break;case"q":c=m[g++]*t+n,u=m[g++]*t+r,l=m[g++]*t+n,h=m[g++]*t+r,p.quadraticCurveTo(l,h,c,u);break;case"b":c=m[g++]*t+n,u=m[g++]*t+r,l=m[g++]*t+n,h=m[g++]*t+r,f=m[g++]*t+n,d=m[g++]*t+r,p.bezierCurveTo(l,h,f,d,c,u)}}return{offsetX:o.ha*t,path:p}}}function Oc(e){this.manager=void 0!==e?e:ls}Lc.prototype={constructor:Lc,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=cs.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;fetch(e).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,i.options)})).then((function(n){cs.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemEnd(e),i.manager.itemError(e)}))},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(Cc.prototype,{moveTo:function(e,t){this.currentPath=new Fs,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,r){this.currentPath.quadraticCurveTo(e,t,n,r)},bezierCurveTo:function(e,t,n,r,i,o){this.currentPath.bezierCurveTo(e,t,n,r,i,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],o=new Bs;o.curves=i.curves,t.push(o)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=t[i],s=t[o],c=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=t[o],c=-c,s=t[i],u=-u),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var l=u*(e.x-a.x)-c*(e.y-a.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return r}var i=Sa.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);var a,s,c,u=[];if(1===o.length)return s=o[0],(c=new Bs).curves=s.curves,u.push(c),u;var l=!i(o[0].getPoints());l=e?!l:l;var h,f,d=[],p=[],m=[],g=0;p[g]=void 0,m[g]=[];for(var v=0,_=o.length;v<_;v++)a=i(h=(s=o[v]).getPoints()),(a=e?!a:a)?(!l&&p[g]&&g++,p[g]={s:new Bs,p:h},p[g].s.curves=s.curves,l&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!p[0])return n(o);if(p.length>1){for(var y=!1,x=[],b=0,w=p.length;b<w;b++)d[b]=[];for(b=0,w=p.length;b<w;b++)for(var E=m[b],M=0;M<E.length;M++){for(var S=E[M],T=!0,A=0;A<p.length;A++)r(S.p,p[A].p)&&(b!==A&&x.push({froms:b,tos:A,hole:M}),T?(T=!1,d[A].push(S)):y=!0);T&&d[b].push(S)}x.length>0&&(y||(m=d))}v=0;for(var L=p.length;v<L;v++){c=p[v].s,u.push(c);for(var C=0,R=(f=m[v]).length;C<R;C++)c.holes.push(f[C].h)}return u}}),Object.assign(Rc.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var n=[],r=function(e,t,n){for(var r=Array.from?Array.from(e):String(e).split(""),i=t/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,c=0,u=0;u<r.length;u++){var l=r[u];if("\n"===l)s=0,c-=o;else{var h=Pc(l,i,s,c,n);s+=h.offsetX,a.push(h.path)}}return a}(e,t,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),Object.assign(Oc.prototype,{load:function(e,t,n,r){var i=this,o=new fs(this.manager);o.setPath(this.path),o.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)}),n,r)},parse:function(e){return new Rc(e)},setPath:function(e){return this.path=e,this}});var Nc,Ic,Dc,zc,Uc,kc,Fc,Bc,jc,Hc,Gc={getContext:function(){return void 0===Mc&&(Mc=new(window.AudioContext||window.webkitAudioContext)),Mc},setContext:function(e){Mc=e}};function Vc(e){this.manager=void 0!==e?e:ls}function Wc(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ho,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ho,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function qc(e,t,n){kn.call(this),this.type="CubeCamera";var r=new ho(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new Qt(1,0,0)),this.add(r);var i=new ho(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new Qt(-1,0,0)),this.add(i);var o=new ho(90,1,e,t);o.up.set(0,0,1),o.lookAt(new Qt(0,1,0)),this.add(o);var a=new ho(90,1,e,t);a.up.set(0,0,-1),a.lookAt(new Qt(0,-1,0)),this.add(a);var s=new ho(90,1,e,t);s.up.set(0,-1,0),s.lookAt(new Qt(0,0,1)),this.add(s);var c=new ho(90,1,e,t);c.up.set(0,-1,0),c.lookAt(new Qt(0,0,-1)),this.add(c);var u={format:Ye,magFilter:Oe,minFilter:Oe};this.renderTarget=new fn(n,n,u),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,u=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,r,n),n.activeCubeFace=1,e.render(t,i,n),n.activeCubeFace=2,e.render(t,o,n),n.activeCubeFace=3,e.render(t,a,n),n.activeCubeFace=4,e.render(t,s,n),n.texture.generateMipmaps=u,n.activeCubeFace=5,e.render(t,c,n),e.setRenderTarget(null)},this.clear=function(e,t,n,r){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,e.setRenderTarget(i),e.clear(t,n,r);e.setRenderTarget(null)}}function Xc(){kn.call(this),this.type="AudioListener",this.context=Gc.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Yc(e){kn.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Zc(e){Yc.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Jc(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function $c(e,t,n){this.binding=e,this.valueSize=n;var r,i=Float64Array;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(Vc.prototype,{load:function(e,t,n,r){var i=new fs(this.manager);i.setResponseType("arraybuffer"),i.load(e,(function(e){var n=e.slice(0);Gc.getContext().decodeAudioData(n,(function(e){t(e)}))}),n,r)}}),Object.assign(Wc.prototype,{update:(jc=new $t,Hc=new $t,function(e){if(Nc!==this||Ic!==e.focus||Dc!==e.fov||zc!==e.aspect*this.aspect||Uc!==e.near||kc!==e.far||Fc!==e.zoom||Bc!==this.eyeSep){Nc=this,Ic=e.focus,Dc=e.fov,zc=e.aspect*this.aspect,Uc=e.near,kc=e.far,Fc=e.zoom;var t,n,r=e.projectionMatrix.clone(),i=(Bc=this.eyeSep/2)*Uc/Ic,o=Uc*Math.tan(Zt.DEG2RAD*Dc*.5)/Fc;Hc.elements[12]=-Bc,jc.elements[12]=Bc,t=-o*zc+i,n=o*zc+i,r.elements[0]=2*Uc/(n-t),r.elements[8]=(n+t)/(n-t),this.cameraL.projectionMatrix.copy(r),t=-o*zc-i,n=o*zc-i,r.elements[0]=2*Uc/(n-t),r.elements[8]=(n+t)/(n-t),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Hc),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(jc)})}),qc.prototype=Object.create(kn.prototype),qc.prototype.constructor=qc,Xc.prototype=Object.assign(Object.create(kn.prototype),{constructor:Xc,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var e=new Qt,t=new Kt,n=new Qt,r=new Qt;return function(i){kn.prototype.updateMatrixWorld.call(this,i);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(e,t,n),r.set(0,0,-1).applyQuaternion(t),o.positionX?(o.positionX.setValueAtTime(e.x,this.context.currentTime),o.positionY.setValueAtTime(e.y,this.context.currentTime),o.positionZ.setValueAtTime(e.z,this.context.currentTime),o.forwardX.setValueAtTime(r.x,this.context.currentTime),o.forwardY.setValueAtTime(r.y,this.context.currentTime),o.forwardZ.setValueAtTime(r.z,this.context.currentTime),o.upX.setValueAtTime(a.x,this.context.currentTime),o.upY.setValueAtTime(a.y,this.context.currentTime),o.upZ.setValueAtTime(a.z,this.context.currentTime)):(o.setPosition(e.x,e.y,e.z),o.setOrientation(r.x,r.y,r.z,a.x,a.y,a.z))}}()}),Yc.prototype=Object.assign(Object.create(kn.prototype),{constructor:Yc,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),Zc.prototype=Object.assign(Object.create(Yc.prototype),{constructor:Zc,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(){var e=new Qt,t=new Kt,n=new Qt,r=new Qt;return function(i){kn.prototype.updateMatrixWorld.call(this,i);var o=this.panner;this.matrixWorld.decompose(e,t,n),r.set(0,0,1).applyQuaternion(t),o.setPosition(e.x,e.y,e.z),o.setOrientation(r.x,r.y,r.z)}}()}),Object.assign(Jc.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign($c.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*t;this._mixBufferRegion(n,r,a,1-i,t)}for(var s=t,c=t+t;s!==c;++s)if(n[s]!==n[s+t]){o.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=3*n;e.getValue(t,r);for(var i=n,o=r;i!==o;++i)t[i]=t[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)e[t+o]=e[n+o]},_slerp:function(e,t,n,r){Kt.slerpFlat(e,t,e,t,e,n,r)},_lerp:function(e,t,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[n+a]*r}}});var Kc,Qc,eu,tu,nu,ru,iu,ou,au,su,cu,uu,lu,hu,fu;function du(e,t,n){var r=n||pu.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function pu(e,t,n){this.path=t,this.parsedPath=n||pu.parseTrackName(t),this.node=pu.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function mu(){this.uuid=Zt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function gu(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var r=t.tracks,i=r.length,o=new Array(i),a={endingStart:Pt,endingEnd:Pt},s=0;s!==i;++s){var c=r[s].createInterpolant(null);o[s]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Tt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function vu(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function _u(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function yu(){nr.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function xu(e,t,n){xo.call(this,e,t),this.meshPerAttribute=n||1}function bu(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Gn.call(this,e,t,n),this.meshPerAttribute=r||1}function wu(e,t,n,r){this.ray=new wr(e,t),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Eu(e,t){return e.distance-t.distance}function Mu(e,t,n,r){if(!1!==e.visible&&(e.raycast(t,n),!0===r))for(var i=e.children,o=0,a=i.length;o<a;o++)Mu(i[o],t,n,!0)}function Su(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Tu(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function Au(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}function Lu(e,t){this.min=void 0!==e?e:new Jt(1/0,1/0),this.max=void 0!==t?t:new Jt(-1/0,-1/0)}function Cu(e,t){this.start=void 0!==e?e:new Qt,this.end=void 0!==t?t:new Qt}function Ru(e){kn.call(this),this.material=e,this.render=function(){}}function Pu(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16711680,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var c=new nr,u=new $n(2*a*3,3);c.addAttribute("position",u),Ro.call(this,c,new Lo({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Ou(e,t){kn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new nr,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new $n(r,3));var c=new Lo({fog:!1});this.cone=new Ro(n,c),this.add(this.cone),this.update()}function Nu(e){for(var t=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var r=0;r<t.children.length;r++)n.push.apply(n,e(t.children[r]));return n}(e),n=new nr,r=[],i=[],o=new Mn(0,0,1),a=new Mn(0,1,0),s=0;s<t.length;s++){var c=t[s];c.parent&&c.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.addAttribute("position",new $n(r,3)),n.addAttribute("color",new $n(i,3));var u=new Lo({vertexColors:N,depthTest:!1,depthWrite:!1,transparent:!0});Ro.call(this,n,u),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Iu(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var r=new Da(t,4,2),i=new Mr({wireframe:!0,fog:!1});Sr.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Du(e,t){kn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;var n=new Lo({fog:!1}),r=new nr;r.addAttribute("position",new Gn(new Float32Array(15),3)),this.line=new Co(r,n),this.add(this.line),this.update()}function zu(e,t,n){kn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new qo(t);r.rotateY(.5*Math.PI),this.material=new Mr({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=N);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.addAttribute("color",new Gn(o,3)),this.add(new Sr(r,this.material)),this.update()}function Uu(e,t,n,r){e=e||10,t=t||10,n=new Mn(void 0!==n?n:4473924),r=new Mn(void 0!==r?r:8947848);for(var i=t/2,o=e/t,a=e/2,s=[],c=[],u=0,l=0,h=-a;u<=t;u++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var f=u===i?n:r;f.toArray(c,l),l+=3,f.toArray(c,l),l+=3,f.toArray(c,l),l+=3,f.toArray(c,l),l+=3}var d=new nr;d.addAttribute("position",new $n(s,3)),d.addAttribute("color",new $n(c,3));var p=new Lo({vertexColors:N});Ro.call(this,d,p)}function ku(e,t,n,r,i,o){e=e||10,t=t||16,n=n||8,r=r||64,i=new Mn(void 0!==i?i:4473924),o=new Mn(void 0!==o?o:8947848);var a,s,c,u,l,h,f,d=[],p=[];for(u=0;u<=t;u++)c=u/t*(2*Math.PI),a=Math.sin(c)*e,s=Math.cos(c)*e,d.push(0,0,0),d.push(a,0,s),f=1&u?i:o,p.push(f.r,f.g,f.b),p.push(f.r,f.g,f.b);for(u=0;u<=n;u++)for(f=1&u?i:o,h=e-e/n*u,l=0;l<r;l++)c=l/r*(2*Math.PI),a=Math.sin(c)*h,s=Math.cos(c)*h,d.push(a,0,s),p.push(f.r,f.g,f.b),c=(l+1)/r*(2*Math.PI),a=Math.sin(c)*h,s=Math.cos(c)*h,d.push(a,0,s),p.push(f.r,f.g,f.b);var m=new nr;m.addAttribute("position",new $n(d,3)),m.addAttribute("color",new $n(p,3));var g=new Lo({vertexColors:N});Ro.call(this,m,g)}function Fu(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16776960,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new nr,u=new $n(2*a*3,3);c.addAttribute("position",u),Ro.call(this,c,new Lo({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Bu(e,t,n){kn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var r=new nr;r.addAttribute("position",new $n([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new Lo({fog:!1});this.lightPlane=new Co(r,i),this.add(this.lightPlane),(r=new nr).addAttribute("position",new $n([0,0,0,0,0,1],3)),this.targetLine=new Co(r,i),this.add(this.targetLine),this.update()}function ju(e){var t=new nr,n=new Lo({color:16777215,vertexColors:O}),r=[],i=[],o={},a=new Mn(16755200),s=new Mn(16711680),c=new Mn(43775),u=new Mn(16777215),l=new Mn(3355443);function h(e,t,n){f(e,n),f(t,n)}function f(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(r.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",c),h("u2","u3",c),h("u3","u1",c),h("c","t",u),h("p","c",l),h("cn1","cn2",l),h("cn3","cn4",l),h("cf1","cf2",l),h("cf3","cf4",l),t.addAttribute("position",new $n(r,3)),t.addAttribute("color",new $n(i,3)),Ro.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function Hu(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new nr;i.setIndex(new Gn(n,1)),i.addAttribute("position",new Gn(r,3)),Ro.call(this,i,new Lo({color:t})),this.matrixAutoUpdate=!1,this.update()}function Gu(e,t){this.type="Box3Helper",this.box=e;var n=void 0!==t?t:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new nr;i.setIndex(new Gn(r,1)),i.addAttribute("position",new $n([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Ro.call(this,i,new Lo({color:n})),this.geometry.computeBoundingSphere()}function Vu(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var r=void 0!==n?n:16776960,i=new nr;i.addAttribute("position",new $n([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Co.call(this,i,new Lo({color:r}));var o=new nr;o.addAttribute("position",new $n([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Sr(o,new Mr({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function Wu(e,t,n,r,i,o){kn.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===uu&&((uu=new nr).addAttribute("position",new $n([0,0,0,0,1,0],3)),(lu=new Wa(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Co(uu,new Lo({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Sr(lu,new Mr({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,o)}function qu(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new nr;n.addAttribute("position",new $n(t,3)),n.addAttribute("color",new $n([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new Lo({vertexColors:N});Ro.call(this,n,r)}function Xu(e,t,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Rn(e,t,n,i,o,a)}Object.assign(du.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(pu,{Composite:du,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new pu.Composite(e,t,n):new pu(e,t,n)},sanitizeNodeName:(au=new RegExp("[\\[\\]\\.:\\/]","g"),function(e){return e.replace(/\s/g,"_").replace(au,"")}),parseTrackName:(Kc="[^\\[\\]\\.:\\/]",Qc="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",eu=/((?:WC+[\/:])*)/.source.replace("WC",Kc),tu=/(WCOD+)?/.source.replace("WCOD",Qc),nu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Kc),ru=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Kc),iu=new RegExp("^"+eu+tu+nu+ru+"$"),ou=["material","materials","bones"],function(e){var t=iu.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==ou.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function(e){for(var n=0;n<e.length;n++){var i=e[n];if(i.name===t||i.uuid===t)return i;var o=r(i.children);if(o)return o}return null},i=r(e.children);if(i)return i}return null}}),Object.assign(pu.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=pu.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var o=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[r];if(void 0!==s){var c=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===i){i=a;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}else{var l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(pu.prototype,{_getValue_unbound:pu.prototype.getValue,_setValue_unbound:pu.prototype.setValue}),Object.assign(mu.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,c=void 0,u=0,l=arguments.length;u!==l;++u){var h=arguments[u],f=h.uuid,d=r[f];if(void 0===d){d=t++,r[f]=d,e.push(h);for(var p=0,m=s;p!==m;++p)a[p].push(new pu(h,i[p],o[p]))}else if(d<n){c=e[d];var g=--n,v=e[g];r[v.uuid]=d,e[d]=v,r[f]=g,e[g]=h;for(p=0,m=s;p!==m;++p){var _=a[p],y=_[g],x=_[d];_[d]=y,void 0===x&&(x=new pu(h,i[p],o[p])),_[g]=x}}else e[d]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],c=s.uuid,u=n[c];if(void 0!==u&&u>=t){var l=t++,h=e[l];n[h.uuid]=u,e[u]=h,n[c]=l,e[l]=s;for(var f=0,d=i;f!==d;++f){var p=r[f],m=p[l],g=p[u];p[u]=m,p[l]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a],u=c.uuid,l=r[u];if(void 0!==l)if(delete r[u],l<n){var h=--n,f=e[h],d=e[_=--t];r[f.uuid]=l,e[l]=f,r[d.uuid]=h,e[h]=d,e.pop();for(var p=0,m=o;p!==m;++p){var g=(y=i[p])[h],v=y[_];y[l]=g,y[h]=v,y.pop()}}else{var _;r[(d=e[_=--t]).uuid]=l,e[l]=d,e.pop();for(p=0,m=o;p!==m;++p){var y;(y=i[p])[l]=y[_],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,u=this.nCachedObjects_,l=new Array(c);r=i.length,n[e]=r,o.push(e),a.push(t),i.push(l);for(var h=u,f=s.length;h!==f;++h){var d=s[h];l[h]=new pu(d,e,t)}return l},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(gu.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,o=i/r,a=r/i;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=i,s[1]=i+n,c[0]=e/a,c[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(e-i)*n;if(o<0||0===n)return;this._startTime=null,t=n*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var c=this._interpolants,u=this._propertyBindings,l=0,h=c.length;l!==h;++l)c[l].evaluate(a),u[l].accumulate(r,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,r=this.loop,i=this._loopCount,o=r===At;if(0===e)return-1===i?t:o&&1==(1&i)?n-t:t;if(r===St){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=n)t=n;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),t>=n||t<0){var a=Math.floor(t/n);t-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&i))return this.time=t,n-t}return this.time=t,t},_setEndings:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=Ot,r.endingEnd=Ot):(r.endingStart=e?this.zeroSlopeAtStart?Ot:Pt:Nt,r.endingEnd=t?this.zeroSlopeAtEnd?Ot:Pt:Nt)},_scheduleFading:function(e,t,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=t,a[1]=i+e,s[1]=n,this}}),vu.prototype=Object.assign(Object.create(r.prototype),{constructor:vu,_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,c=this._bindingsByRootAndName,u=c[s];void 0===u&&(u={},c[s]=u);for(var l=0;l!==i;++l){var h=r[l],f=h.name,d=u[f];if(void 0!==d)o[l]=d;else{if(void 0!==(d=o[l])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,f));continue}var p=t&&t._propertyBindings[l].binding.parsedPath;++(d=new $c(pu.create(n,f,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(d,s,f),o[l]=d}a[l].resultBuffer=d.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,c=s[s.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,s[u]=c,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=r[t],o=this._bindings;void 0===i&&(i={},r[t]=i),i[n]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=t[t.length-1],c=e._cacheIndex;s._cacheIndex=c,t[c]=s,t.pop(),delete a[i];e:{for(var u in a)break e;delete o[r]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new tc(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?hc.findByName(n,e):e,o=null!==i?i.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var c=a.actionByRoot[r];if(void 0!==c)return c;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var u=new gu(this,i,t);return this._bindAction(u,s),this._addInactiveAction(u,o,r),u},existingAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?hc.findByName(n,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==n;++a){t[a]._update(r,e,i,o)}var s=this._bindings,c=this._nActiveBindings;for(a=0;a!==c;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var u=c._cacheIndex,l=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,l._cacheIndex=u,t[u]=l,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),_u.prototype.clone=function(){return new _u(void 0===this.value.clone?this.value:this.value.clone())},yu.prototype=Object.assign(Object.create(nr.prototype),{constructor:yu,isInstancedBufferGeometry:!0,copy:function(e){return nr.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),xu.prototype=Object.assign(Object.create(xo.prototype),{constructor:xu,isInstancedInterleavedBuffer:!0,copy:function(e){return xo.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),bu.prototype=Object.assign(Object.create(Gn.prototype),{constructor:bu,isInstancedBufferAttribute:!0,copy:function(e){return Gn.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(wu.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var r=n||[];return Mu(e,this,r,t),r.sort(Eu),r},intersectObjects:function(e,t,n){var r=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=e.length;i<o;i++)Mu(e[i],this,r,t);return r.sort(Eu),r}}),Object.assign(Su.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(Tu.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Zt.clamp(t/this.radius,-1,1))),this}}),Object.assign(Au.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}}),Object.assign(Lu.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Jt;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Jt),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Jt),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Jt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Jt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Jt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Cu.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Qt),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Qt),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Qt),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(su=new Qt,cu=new Qt,function(e,t){su.subVectors(e,this.start),cu.subVectors(this.end,this.start);var n=cu.dot(cu),r=cu.dot(su)/n;return t&&(r=Zt.clamp(r,0,1)),r}),closestPointToPoint:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Qt),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Ru.prototype=Object.create(kn.prototype),Ru.prototype.constructor=Ru,Ru.prototype.isImmediateRenderObject=!0,Pu.prototype=Object.create(Ro.prototype),Pu.prototype.constructor=Pu,Pu.prototype.update=function(){var e=new Qt,t=new Qt,n=new en;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,c=a.faces,u=0,l=0,h=c.length;l<h;l++)for(var f=c[l],d=0,p=f.vertexNormals.length;d<p;d++){var m=s[f[r[d]]],g=f.vertexNormals[d];e.copy(m).applyMatrix4(i),t.copy(g).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}else if(a&&a.isBufferGeometry){var v=a.attributes.position,_=a.attributes.normal;for(u=0,d=0,p=v.count;d<p;d++)e.set(v.getX(d),v.getY(d),v.getZ(d)).applyMatrix4(i),t.set(_.getX(d),_.getY(d),_.getZ(d)),t.applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}o.needsUpdate=!0}}(),Ou.prototype=Object.create(kn.prototype),Ou.prototype.constructor=Ou,Ou.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ou.prototype.update=function(){var e=new Qt,t=new Qt;return function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,r=n*Math.tan(this.light.angle);this.cone.scale.set(r,r,n),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),Nu.prototype=Object.create(Ro.prototype),Nu.prototype.constructor=Nu,Nu.prototype.updateMatrixWorld=function(){var e=new Qt,t=new $t,n=new $t;return function(r){var i=this.bones,o=this.geometry,a=o.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var s=0,c=0;s<i.length;s++){var u=i[s];u.parent&&u.parent.isBone&&(t.multiplyMatrices(n,u.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(c,e.x,e.y,e.z),t.multiplyMatrices(n,u.parent.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(c+1,e.x,e.y,e.z),c+=2)}o.getAttribute("position").needsUpdate=!0,kn.prototype.updateMatrixWorld.call(this,r)}}(),Iu.prototype=Object.create(Sr.prototype),Iu.prototype.constructor=Iu,Iu.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Iu.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Du.prototype=Object.create(kn.prototype),Du.prototype.constructor=Du,Du.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Du.prototype.update=function(){var e=.5*this.light.width,t=.5*this.light.height,n=this.line.geometry.attributes.position,r=n.array;r[0]=e,r[1]=-t,r[2]=0,r[3]=e,r[4]=t,r[5]=0,r[6]=-e,r[7]=t,r[8]=0,r[9]=-e,r[10]=-t,r[11]=0,r[12]=e,r[13]=-t,r[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},zu.prototype=Object.create(kn.prototype),zu.prototype.constructor=zu,zu.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},zu.prototype.update=function(){var e=new Qt,t=new Mn,n=new Mn;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=r.geometry.getAttribute("color");t.copy(this.light.color),n.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?t:n;i.setXYZ(o,s.r,s.g,s.b)}i.needsUpdate=!0}r.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Uu.prototype=Object.create(Ro.prototype),Uu.prototype.constructor=Uu,ku.prototype=Object.create(Ro.prototype),ku.prototype.constructor=ku,Fu.prototype=Object.create(Ro.prototype),Fu.prototype.constructor=Fu,Fu.prototype.update=function(){var e=new Qt,t=new Qt,n=new en;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,c=0,u=0,l=s.length;u<l;u++){var h=s[u],f=h.normal;e.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(r),t.copy(f).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),i.setXYZ(c,e.x,e.y,e.z),c+=1,i.setXYZ(c,t.x,t.y,t.z),c+=1}i.needsUpdate=!0}}(),Bu.prototype=Object.create(kn.prototype),Bu.prototype.constructor=Bu,Bu.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Bu.prototype.update=function(){var e=new Qt,t=new Qt,n=new Qt;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(t,e),this.lightPlane.lookAt(n),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(n),this.targetLine.scale.z=n.length()}}(),ju.prototype=Object.create(Ro.prototype),ju.prototype.constructor=ju,ju.prototype.update=function(){var e,t,n=new Qt,r=new lo;function i(i,o,a,s){n.set(o,a,s).unproject(r);var c=t[i];if(void 0!==c)for(var u=e.getAttribute("position"),l=0,h=c.length;l<h;l++)u.setXYZ(c[l],n.x,n.y,n.z)}return function(){e=this.geometry,t=this.pointMap;r.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),Hu.prototype=Object.create(Ro.prototype),Hu.prototype.constructor=Hu,Hu.prototype.update=function(){var e=new pn;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var n=e.min,r=e.max,i=this.geometry.attributes.position,o=i.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=n.x,o[4]=r.y,o[5]=r.z,o[6]=n.x,o[7]=n.y,o[8]=r.z,o[9]=r.x,o[10]=n.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=n.z,o[15]=n.x,o[16]=r.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=r.x,o[22]=n.y,o[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Hu.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Gu.prototype=Object.create(Ro.prototype),Gu.prototype.constructor=Gu,Gu.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),kn.prototype.updateMatrixWorld.call(this,e))},Vu.prototype=Object.create(Co.prototype),Vu.prototype.constructor=Vu,Vu.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?A:T,this.lookAt(this.plane.normal),kn.prototype.updateMatrixWorld.call(this,e)},Wu.prototype=Object.create(kn.prototype),Wu.prototype.constructor=Wu,Wu.prototype.setDirection=(fu=new Qt,function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(fu.set(e.z,0,-e.x).normalize(),hu=Math.acos(e.y),this.quaternion.setFromAxisAngle(fu,hu))}),Wu.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},Wu.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},qu.prototype=Object.create(Ro.prototype),qu.prototype.constructor=qu;var Yu=0,Zu=1;function Ju(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function $u(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function Ku(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new No(e,t)}function Qu(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Eo(e)}function el(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new No(e,t)}function tl(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Oo(e)}function nl(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Oo(e)}function rl(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Oo(e)}function il(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Qt(e,t,n)}function ol(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new Gn(e,t).setDynamic(!0)}function al(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Vn(e,t)}function sl(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Wn(e,t)}function cl(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new qn(e,t)}function ul(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Xn(e,t)}function ll(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Yn(e,t)}function hl(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Zn(e,t)}function fl(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Jn(e,t)}function dl(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new $n(e,t)}function pl(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Kn(e,t)}function ml(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ts.call(this,e),this.type="catmullrom",this.closed=!0}function gl(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ts.call(this,e),this.type="catmullrom"}function vl(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Ts.call(this,e),this.type="catmullrom"}function _l(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new qu(e)}function yl(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Hu(e,t)}function xl(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ro(new Ga(e.geometry),new Lo({color:void 0!==t?t:16777215}))}function bl(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ro(new ko(e.geometry),new Lo({color:void 0!==t?t:16777215}))}function wl(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new fs(e)}function El(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new ps(e)}_s.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(_s.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(ks.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new Hn,n=0,r=e.length;n<r;n++){var i=e[n];t.vertices.push(new Qt(i.x,i.y,i.z||0))}return t}}),Object.assign(Fs.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),ml.prototype=Object.create(Ts.prototype),gl.prototype=Object.create(Ts.prototype),vl.prototype=Object.create(Ts.prototype),Object.assign(vl.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Uu.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Nu.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(xc.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),bc.extractUrlBase(e)}}),Object.assign(wc.prototype,{setTexturePath:function(e){return console.warn("THREE.JSONLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(Lu.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(pn.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Cu.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Zt,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Zt.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Zt.ceilPowerOfTwo(e)}}),Object.assign(en.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign($t.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new Qt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,o)}}),gn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Kt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(wr.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Er.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Er,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Er.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Er.getNormal(e,t,n,r)}}),Object.assign(Bs.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new La(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Ba(this,e)}}),Object.assign(Jt.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Qt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ln.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Hn.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(kn.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(kn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Mo.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(So.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(_s.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),ho.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(js.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Gn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(nr.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(nr.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Ca.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(_u.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(xr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Mn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===C}}}),Object.defineProperties(ts.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(br.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(go.prototype,{clearTarget:function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(go.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(oo.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(hn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(po.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),Yc.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Vc).load(e,(function(e){t.setBuffer(e)})),this},Jc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},qc.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var Ml={merge:function(e,t,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,t=t.geometry),e.merge(t,r,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};function Sl(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function Tl(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}sn.crossOrigin=void 0,sn.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new vs;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},sn.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new gs;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},sn.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},sn.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Al={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function Ll(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(34));function o(e){if(document.body.createTextRange){const t=document.body.createTextRange();t.moveToElementText(e),t.select()}else if(window.getSelection){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}}t.semver_range=n(35).version,t.is_typedarray=function(e){return i.default(e)},t.is_arraybuffer=function(e){return ArrayBuffer.isView(e)},t.get_array_dimension=function(e){let t=0;for(;void 0!==e[0];)e=e[0],t+=1;return t},t.download_image=function(e){const t=document.createElement("a");if(t.download="ipyvolume.png",t.href=e,document.createEvent){const e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}else t.fireEvent&&t.fireEvent("onclick")},t.select_text=o,t.copy_image_to_clipboard=function(e){const t=document.createElement("img");t.contentEditable="true",t.src=e;const n=document.createElement("div");n.contentEditable="true",n.appendChild(t),document.body.appendChild(n),o(t),document.execCommand("Copy"),document.body.removeChild(n)},t.materialToLightingModel=function(e){return"MeshPhysicalMaterial"===e.type?"PHYSICAL":"MeshLambertMaterial"===e.type?"LAMBERT":"MeshPhongMaterial"===e.type?"PHONG":"DEFAULT"}},function(t,n){t.exports=e},function(e,t,n){(function(e,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o,a=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",u="__lodash_hash_undefined__",l=500,h="__lodash_placeholder__",f=1,d=2,p=4,m=1,g=2,v=1,_=2,y=4,x=8,b=16,w=32,E=64,M=128,S=256,T=512,A=30,L="...",C=800,R=16,P=1,O=2,N=1/0,I=9007199254740991,D=17976931348623157e292,z=NaN,U=4294967295,k=U-1,F=U>>>1,B=[["ary",M],["bind",v],["bindKey",_],["curry",x],["curryRight",b],["flip",T],["partial",w],["partialRight",E],["rearg",S]],j="[object Arguments]",H="[object Array]",G="[object AsyncFunction]",V="[object Boolean]",W="[object Date]",q="[object DOMException]",X="[object Error]",Y="[object Function]",Z="[object GeneratorFunction]",J="[object Map]",$="[object Number]",K="[object Null]",Q="[object Object]",ee="[object Proxy]",te="[object RegExp]",ne="[object Set]",re="[object String]",ie="[object Symbol]",oe="[object Undefined]",ae="[object WeakMap]",se="[object WeakSet]",ce="[object ArrayBuffer]",ue="[object DataView]",le="[object Float32Array]",he="[object Float64Array]",fe="[object Int8Array]",de="[object Int16Array]",pe="[object Int32Array]",me="[object Uint8Array]",ge="[object Uint8ClampedArray]",ve="[object Uint16Array]",_e="[object Uint32Array]",ye=/\b__p \+= '';/g,xe=/\b(__p \+=) '' \+/g,be=/(__e\(.*?\)|\b__t\)) \+\n'';/g,we=/&(?:amp|lt|gt|quot|#39);/g,Ee=/[&<>"']/g,Me=RegExp(we.source),Se=RegExp(Ee.source),Te=/<%-([\s\S]+?)%>/g,Ae=/<%([\s\S]+?)%>/g,Le=/<%=([\s\S]+?)%>/g,Ce=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Re=/^\w*$/,Pe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Oe=/[\\^$.*+?()[\]{}|]/g,Ne=RegExp(Oe.source),Ie=/^\s+|\s+$/g,De=/^\s+/,ze=/\s+$/,Ue=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ke=/\{\n\/\* \[wrapped with (.+)\] \*/,Fe=/,? & /,Be=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,je=/\\(\\)?/g,He=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ge=/\w*$/,Ve=/^[-+]0x[0-9a-f]+$/i,We=/^0b[01]+$/i,qe=/^\[object .+?Constructor\]$/,Xe=/^0o[0-7]+$/i,Ye=/^(?:0|[1-9]\d*)$/,Ze=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Je=/($^)/,$e=/['\n\r\u2028\u2029\\]/g,Ke="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Qe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",et="[\\ud800-\\udfff]",tt="["+Qe+"]",nt="["+Ke+"]",rt="\\d+",it="[\\u2700-\\u27bf]",ot="[a-z\\xdf-\\xf6\\xf8-\\xff]",at="[^\\ud800-\\udfff"+Qe+rt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",st="\\ud83c[\\udffb-\\udfff]",ct="[^\\ud800-\\udfff]",ut="(?:\\ud83c[\\udde6-\\uddff]){2}",lt="[\\ud800-\\udbff][\\udc00-\\udfff]",ht="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ft="(?:"+ot+"|"+at+")",dt="(?:"+ht+"|"+at+")",pt="(?:"+nt+"|"+st+")"+"?",mt="[\\ufe0e\\ufe0f]?"+pt+("(?:\\u200d(?:"+[ct,ut,lt].join("|")+")[\\ufe0e\\ufe0f]?"+pt+")*"),gt="(?:"+[it,ut,lt].join("|")+")"+mt,vt="(?:"+[ct+nt+"?",nt,ut,lt,et].join("|")+")",_t=RegExp("[']","g"),yt=RegExp(nt,"g"),xt=RegExp(st+"(?="+st+")|"+vt+mt,"g"),bt=RegExp([ht+"?"+ot+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[tt,ht,"$"].join("|")+")",dt+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[tt,ht+ft,"$"].join("|")+")",ht+"?"+ft+"+(?:['](?:d|ll|m|re|s|t|ve))?",ht+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rt,gt].join("|"),"g"),wt=RegExp("[\\u200d\\ud800-\\udfff"+Ke+"\\ufe0e\\ufe0f]"),Et=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Mt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],St=-1,Tt={};Tt[le]=Tt[he]=Tt[fe]=Tt[de]=Tt[pe]=Tt[me]=Tt[ge]=Tt[ve]=Tt[_e]=!0,Tt[j]=Tt[H]=Tt[ce]=Tt[V]=Tt[ue]=Tt[W]=Tt[X]=Tt[Y]=Tt[J]=Tt[$]=Tt[Q]=Tt[te]=Tt[ne]=Tt[re]=Tt[ae]=!1;var At={};At[j]=At[H]=At[ce]=At[ue]=At[V]=At[W]=At[le]=At[he]=At[fe]=At[de]=At[pe]=At[J]=At[$]=At[Q]=At[te]=At[ne]=At[re]=At[ie]=At[me]=At[ge]=At[ve]=At[_e]=!0,At[X]=At[Y]=At[ae]=!1;var Lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ct=parseFloat,Rt=parseInt,Pt="object"==typeof e&&e&&e.Object===Object&&e,Ot="object"==typeof self&&self&&self.Object===Object&&self,Nt=Pt||Ot||Function("return this")(),It=t&&!t.nodeType&&t,Dt=It&&"object"==typeof r&&r&&!r.nodeType&&r,zt=Dt&&Dt.exports===It,Ut=zt&&Pt.process,kt=function(){try{var e=Dt&&Dt.require&&Dt.require("util").types;return e||Ut&&Ut.binding&&Ut.binding("util")}catch(e){}}(),Ft=kt&&kt.isArrayBuffer,Bt=kt&&kt.isDate,jt=kt&&kt.isMap,Ht=kt&&kt.isRegExp,Gt=kt&&kt.isSet,Vt=kt&&kt.isTypedArray;function Wt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function qt(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function Xt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Yt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Zt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Jt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function $t(e,t){return!!(null==e?0:e.length)&&cn(e,t,0)>-1}function Kt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Qt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function en(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function tn(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function nn(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function rn(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var on=fn("length");function an(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function sn(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function cn(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):sn(e,ln,n)}function un(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function ln(e){return e!=e}function hn(e,t){var n=null==e?0:e.length;return n?mn(e,t)/n:z}function fn(e){return function(t){return null==t?o:t[e]}}function dn(e){return function(t){return null==e?o:e[t]}}function pn(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function mn(e,t){for(var n,r=-1,i=e.length;++r<i;){var a=t(e[r]);a!==o&&(n=n===o?a:n+a)}return n}function gn(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function vn(e){return function(t){return e(t)}}function _n(e,t){return Qt(t,(function(t){return e[t]}))}function yn(e,t){return e.has(t)}function xn(e,t){for(var n=-1,r=e.length;++n<r&&cn(t,e[n],0)>-1;);return n}function bn(e,t){for(var n=e.length;n--&&cn(t,e[n],0)>-1;);return n}var wn=dn({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),En=dn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Mn(e){return"\\"+Lt[e]}function Sn(e){return wt.test(e)}function Tn(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function An(e,t){return function(n){return e(t(n))}}function Ln(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==h||(e[n]=h,o[i++]=n)}return o}function Cn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function Rn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function Pn(e){return Sn(e)?function(e){var t=xt.lastIndex=0;for(;xt.test(e);)++t;return t}(e):on(e)}function On(e){return Sn(e)?function(e){return e.match(xt)||[]}(e):function(e){return e.split("")}(e)}var Nn=dn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var In=function e(t){var n,r=(t=null==t?Nt:In.defaults(Nt.Object(),t,In.pick(Nt,Mt))).Array,i=t.Date,Ke=t.Error,Qe=t.Function,et=t.Math,tt=t.Object,nt=t.RegExp,rt=t.String,it=t.TypeError,ot=r.prototype,at=Qe.prototype,st=tt.prototype,ct=t["__core-js_shared__"],ut=at.toString,lt=st.hasOwnProperty,ht=0,ft=(n=/[^.]+$/.exec(ct&&ct.keys&&ct.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",dt=st.toString,pt=ut.call(tt),mt=Nt._,gt=nt("^"+ut.call(lt).replace(Oe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vt=zt?t.Buffer:o,xt=t.Symbol,wt=t.Uint8Array,Lt=vt?vt.allocUnsafe:o,Pt=An(tt.getPrototypeOf,tt),Ot=tt.create,It=st.propertyIsEnumerable,Dt=ot.splice,Ut=xt?xt.isConcatSpreadable:o,kt=xt?xt.iterator:o,on=xt?xt.toStringTag:o,dn=function(){try{var e=Fo(tt,"defineProperty");return e({},"",{}),e}catch(e){}}(),Dn=t.clearTimeout!==Nt.clearTimeout&&t.clearTimeout,zn=i&&i.now!==Nt.Date.now&&i.now,Un=t.setTimeout!==Nt.setTimeout&&t.setTimeout,kn=et.ceil,Fn=et.floor,Bn=tt.getOwnPropertySymbols,jn=vt?vt.isBuffer:o,Hn=t.isFinite,Gn=ot.join,Vn=An(tt.keys,tt),Wn=et.max,qn=et.min,Xn=i.now,Yn=t.parseInt,Zn=et.random,Jn=ot.reverse,$n=Fo(t,"DataView"),Kn=Fo(t,"Map"),Qn=Fo(t,"Promise"),er=Fo(t,"Set"),tr=Fo(t,"WeakMap"),nr=Fo(tt,"create"),rr=tr&&new tr,ir={},or=ha($n),ar=ha(Kn),sr=ha(Qn),cr=ha(er),ur=ha(tr),lr=xt?xt.prototype:o,hr=lr?lr.valueOf:o,fr=lr?lr.toString:o;function dr(e){if(Ls(e)&&!vs(e)&&!(e instanceof vr)){if(e instanceof gr)return e;if(lt.call(e,"__wrapped__"))return fa(e)}return new gr(e)}var pr=function(){function e(){}return function(t){if(!As(t))return{};if(Ot)return Ot(t);e.prototype=t;var n=new e;return e.prototype=o,n}}();function mr(){}function gr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=o}function vr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=U,this.__views__=[]}function _r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function yr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function xr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function br(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new xr;++t<n;)this.add(e[t])}function wr(e){var t=this.__data__=new yr(e);this.size=t.size}function Er(e,t){var n=vs(e),r=!n&&gs(e),i=!n&&!r&&bs(e),o=!n&&!r&&!i&&zs(e),a=n||r||i||o,s=a?gn(e.length,rt):[],c=s.length;for(var u in e)!t&&!lt.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||qo(u,c))||s.push(u);return s}function Mr(e){var t=e.length;return t?e[bi(0,t-1)]:o}function Sr(e,t){return ca(no(e),Ir(t,0,e.length))}function Tr(e){return ca(no(e))}function Ar(e,t,n){(n===o||ds(e[t],n))&&(n!==o||t in e)||Or(e,t,n)}function Lr(e,t,n){var r=e[t];lt.call(e,t)&&ds(r,n)&&(n!==o||t in e)||Or(e,t,n)}function Cr(e,t){for(var n=e.length;n--;)if(ds(e[n][0],t))return n;return-1}function Rr(e,t,n,r){return Fr(e,(function(e,i,o){t(r,e,n(e),o)})),r}function Pr(e,t){return e&&ro(t,ic(t),e)}function Or(e,t,n){"__proto__"==t&&dn?dn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Nr(e,t){for(var n=-1,i=t.length,a=r(i),s=null==e;++n<i;)a[n]=s?o:Qs(e,t[n]);return a}function Ir(e,t,n){return e==e&&(n!==o&&(e=e<=n?e:n),t!==o&&(e=e>=t?e:t)),e}function Dr(e,t,n,r,i,a){var s,c=t&f,u=t&d,l=t&p;if(n&&(s=i?n(e,r,i,a):n(e)),s!==o)return s;if(!As(e))return e;var h=vs(e);if(h){if(s=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&lt.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!c)return no(e,s)}else{var m=Ho(e),g=m==Y||m==Z;if(bs(e))return Ji(e,c);if(m==Q||m==j||g&&!i){if(s=u||g?{}:Vo(e),!c)return u?function(e,t){return ro(e,jo(e),t)}(e,function(e,t){return e&&ro(t,oc(t),e)}(s,e)):function(e,t){return ro(e,Bo(e),t)}(e,Pr(s,e))}else{if(!At[m])return i?e:{};s=function(e,t,n){var r=e.constructor;switch(t){case ce:return $i(e);case V:case W:return new r(+e);case ue:return function(e,t){var n=t?$i(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case le:case he:case fe:case de:case pe:case me:case ge:case ve:case _e:return Ki(e,n);case J:return new r;case $:case re:return new r(e);case te:return function(e){var t=new e.constructor(e.source,Ge.exec(e));return t.lastIndex=e.lastIndex,t}(e);case ne:return new r;case ie:return i=e,hr?tt(hr.call(i)):{}}var i}(e,m,c)}}a||(a=new wr);var v=a.get(e);if(v)return v;a.set(e,s),Ns(e)?e.forEach((function(r){s.add(Dr(r,t,n,r,e,a))})):Cs(e)&&e.forEach((function(r,i){s.set(i,Dr(r,t,n,i,e,a))}));var _=h?o:(l?u?Oo:Po:u?oc:ic)(e);return Xt(_||e,(function(r,i){_&&(r=e[i=r]),Lr(s,i,Dr(r,t,n,i,e,a))})),s}function zr(e,t,n){var r=n.length;if(null==e)return!r;for(e=tt(e);r--;){var i=n[r],a=t[i],s=e[i];if(s===o&&!(i in e)||!a(s))return!1}return!0}function Ur(e,t,n){if("function"!=typeof e)throw new it(c);return ia((function(){e.apply(o,n)}),t)}function kr(e,t,n,r){var i=-1,o=$t,s=!0,c=e.length,u=[],l=t.length;if(!c)return u;n&&(t=Qt(t,vn(n))),r?(o=Kt,s=!1):t.length>=a&&(o=yn,s=!1,t=new br(t));e:for(;++i<c;){var h=e[i],f=null==n?h:n(h);if(h=r||0!==h?h:0,s&&f==f){for(var d=l;d--;)if(t[d]===f)continue e;u.push(h)}else o(t,f,r)||u.push(h)}return u}dr.templateSettings={escape:Te,evaluate:Ae,interpolate:Le,variable:"",imports:{_:dr}},dr.prototype=mr.prototype,dr.prototype.constructor=dr,gr.prototype=pr(mr.prototype),gr.prototype.constructor=gr,vr.prototype=pr(mr.prototype),vr.prototype.constructor=vr,_r.prototype.clear=function(){this.__data__=nr?nr(null):{},this.size=0},_r.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},_r.prototype.get=function(e){var t=this.__data__;if(nr){var n=t[e];return n===u?o:n}return lt.call(t,e)?t[e]:o},_r.prototype.has=function(e){var t=this.__data__;return nr?t[e]!==o:lt.call(t,e)},_r.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nr&&t===o?u:t,this},yr.prototype.clear=function(){this.__data__=[],this.size=0},yr.prototype.delete=function(e){var t=this.__data__,n=Cr(t,e);return!(n<0)&&(n==t.length-1?t.pop():Dt.call(t,n,1),--this.size,!0)},yr.prototype.get=function(e){var t=this.__data__,n=Cr(t,e);return n<0?o:t[n][1]},yr.prototype.has=function(e){return Cr(this.__data__,e)>-1},yr.prototype.set=function(e,t){var n=this.__data__,r=Cr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},xr.prototype.clear=function(){this.size=0,this.__data__={hash:new _r,map:new(Kn||yr),string:new _r}},xr.prototype.delete=function(e){var t=Uo(this,e).delete(e);return this.size-=t?1:0,t},xr.prototype.get=function(e){return Uo(this,e).get(e)},xr.prototype.has=function(e){return Uo(this,e).has(e)},xr.prototype.set=function(e,t){var n=Uo(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},br.prototype.add=br.prototype.push=function(e){return this.__data__.set(e,u),this},br.prototype.has=function(e){return this.__data__.has(e)},wr.prototype.clear=function(){this.__data__=new yr,this.size=0},wr.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},wr.prototype.get=function(e){return this.__data__.get(e)},wr.prototype.has=function(e){return this.__data__.has(e)},wr.prototype.set=function(e,t){var n=this.__data__;if(n instanceof yr){var r=n.__data__;if(!Kn||r.length<a-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new xr(r)}return n.set(e,t),this.size=n.size,this};var Fr=ao(Xr),Br=ao(Yr,!0);function jr(e,t){var n=!0;return Fr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function Hr(e,t,n){for(var r=-1,i=e.length;++r<i;){var a=e[r],s=t(a);if(null!=s&&(c===o?s==s&&!Ds(s):n(s,c)))var c=s,u=a}return u}function Gr(e,t){var n=[];return Fr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function Vr(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=Wo),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?Vr(s,t-1,n,r,i):en(i,s):r||(i[i.length]=s)}return i}var Wr=so(),qr=so(!0);function Xr(e,t){return e&&Wr(e,t,ic)}function Yr(e,t){return e&&qr(e,t,ic)}function Zr(e,t){return Jt(t,(function(t){return Ms(e[t])}))}function Jr(e,t){for(var n=0,r=(t=qi(t,e)).length;null!=e&&n<r;)e=e[la(t[n++])];return n&&n==r?e:o}function $r(e,t,n){var r=t(e);return vs(e)?r:en(r,n(e))}function Kr(e){return null==e?e===o?oe:K:on&&on in tt(e)?function(e){var t=lt.call(e,on),n=e[on];try{e[on]=o;var r=!0}catch(e){}var i=dt.call(e);r&&(t?e[on]=n:delete e[on]);return i}(e):function(e){return dt.call(e)}(e)}function Qr(e,t){return e>t}function ei(e,t){return null!=e&&lt.call(e,t)}function ti(e,t){return null!=e&&t in tt(e)}function ni(e,t,n){for(var i=n?Kt:$t,a=e[0].length,s=e.length,c=s,u=r(s),l=1/0,h=[];c--;){var f=e[c];c&&t&&(f=Qt(f,vn(t))),l=qn(f.length,l),u[c]=!n&&(t||a>=120&&f.length>=120)?new br(c&&f):o}f=e[0];var d=-1,p=u[0];e:for(;++d<a&&h.length<l;){var m=f[d],g=t?t(m):m;if(m=n||0!==m?m:0,!(p?yn(p,g):i(h,g,n))){for(c=s;--c;){var v=u[c];if(!(v?yn(v,g):i(e[c],g,n)))continue e}p&&p.push(g),h.push(m)}}return h}function ri(e,t,n){var r=null==(e=ta(e,t=qi(t,e)))?e:e[la(Ea(t))];return null==r?o:Wt(r,e,n)}function ii(e){return Ls(e)&&Kr(e)==j}function oi(e,t,n,r,i){return e===t||(null==e||null==t||!Ls(e)&&!Ls(t)?e!=e&&t!=t:function(e,t,n,r,i,a){var s=vs(e),c=vs(t),u=s?H:Ho(e),l=c?H:Ho(t),h=(u=u==j?Q:u)==Q,f=(l=l==j?Q:l)==Q,d=u==l;if(d&&bs(e)){if(!bs(t))return!1;s=!0,h=!1}if(d&&!h)return a||(a=new wr),s||zs(e)?Co(e,t,n,r,i,a):function(e,t,n,r,i,o,a){switch(n){case ue:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ce:return!(e.byteLength!=t.byteLength||!o(new wt(e),new wt(t)));case V:case W:case $:return ds(+e,+t);case X:return e.name==t.name&&e.message==t.message;case te:case re:return e==t+"";case J:var s=Tn;case ne:var c=r&m;if(s||(s=Cn),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;r|=g,a.set(e,t);var l=Co(s(e),s(t),r,i,o,a);return a.delete(e),l;case ie:if(hr)return hr.call(e)==hr.call(t)}return!1}(e,t,u,n,r,i,a);if(!(n&m)){var p=h&&lt.call(e,"__wrapped__"),v=f&&lt.call(t,"__wrapped__");if(p||v){var _=p?e.value():e,y=v?t.value():t;return a||(a=new wr),i(_,y,n,r,a)}}if(!d)return!1;return a||(a=new wr),function(e,t,n,r,i,a){var s=n&m,c=Po(e),u=c.length,l=Po(t).length;if(u!=l&&!s)return!1;var h=u;for(;h--;){var f=c[h];if(!(s?f in t:lt.call(t,f)))return!1}var d=a.get(e);if(d&&a.get(t))return d==t;var p=!0;a.set(e,t),a.set(t,e);var g=s;for(;++h<u;){f=c[h];var v=e[f],_=t[f];if(r)var y=s?r(_,v,f,t,e,a):r(v,_,f,e,t,a);if(!(y===o?v===_||i(v,_,n,r,a):y)){p=!1;break}g||(g="constructor"==f)}if(p&&!g){var x=e.constructor,b=t.constructor;x!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof x&&x instanceof x&&"function"==typeof b&&b instanceof b)&&(p=!1)}return a.delete(e),a.delete(t),p}(e,t,n,r,i,a)}(e,t,n,r,oi,i))}function ai(e,t,n,r){var i=n.length,a=i,s=!r;if(null==e)return!a;for(e=tt(e);i--;){var c=n[i];if(s&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++i<a;){var u=(c=n[i])[0],l=e[u],h=c[1];if(s&&c[2]){if(l===o&&!(u in e))return!1}else{var f=new wr;if(r)var d=r(l,h,u,e,t,f);if(!(d===o?oi(h,l,m|g,r,f):d))return!1}}return!0}function si(e){return!(!As(e)||(t=e,ft&&ft in t))&&(Ms(e)?gt:qe).test(ha(e));var t}function ci(e){return"function"==typeof e?e:null==e?Rc:"object"==typeof e?vs(e)?pi(e[0],e[1]):di(e):Fc(e)}function ui(e){if(!$o(e))return Vn(e);var t=[];for(var n in tt(e))lt.call(e,n)&&"constructor"!=n&&t.push(n);return t}function li(e){if(!As(e))return function(e){var t=[];if(null!=e)for(var n in tt(e))t.push(n);return t}(e);var t=$o(e),n=[];for(var r in e)("constructor"!=r||!t&&lt.call(e,r))&&n.push(r);return n}function hi(e,t){return e<t}function fi(e,t){var n=-1,i=ys(e)?r(e.length):[];return Fr(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function di(e){var t=ko(e);return 1==t.length&&t[0][2]?Qo(t[0][0],t[0][1]):function(n){return n===e||ai(n,e,t)}}function pi(e,t){return Yo(e)&&Ko(t)?Qo(la(e),t):function(n){var r=Qs(n,e);return r===o&&r===t?ec(n,e):oi(t,r,m|g)}}function mi(e,t,n,r,i){e!==t&&Wr(t,(function(a,s){if(i||(i=new wr),As(a))!function(e,t,n,r,i,a,s){var c=na(e,n),u=na(t,n),l=s.get(u);if(l)return void Ar(e,n,l);var h=a?a(c,u,n+"",e,t,s):o,f=h===o;if(f){var d=vs(u),p=!d&&bs(u),m=!d&&!p&&zs(u);h=u,d||p||m?vs(c)?h=c:xs(c)?h=no(c):p?(f=!1,h=Ji(u,!0)):m?(f=!1,h=Ki(u,!0)):h=[]:Ps(u)||gs(u)?(h=c,gs(c)?h=Vs(c):As(c)&&!Ms(c)||(h=Vo(u))):f=!1}f&&(s.set(u,h),i(h,u,r,a,s),s.delete(u));Ar(e,n,h)}(e,t,s,n,mi,r,i);else{var c=r?r(na(e,s),a,s+"",e,t,i):o;c===o&&(c=a),Ar(e,s,c)}}),oc)}function gi(e,t){var n=e.length;if(n)return qo(t+=t<0?n:0,n)?e[t]:o}function vi(e,t,n){var r=-1;return t=Qt(t.length?t:[Rc],vn(zo())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(fi(e,(function(e,n,i){return{criteria:Qt(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;for(;++r<a;){var c=Qi(i[r],o[r]);if(c){if(r>=s)return c;var u=n[r];return c*("desc"==u?-1:1)}}return e.index-t.index}(e,t,n)}))}function _i(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=Jr(e,a);n(s,a)&&Ti(o,qi(a,e),s)}return o}function yi(e,t,n,r){var i=r?un:cn,o=-1,a=t.length,s=e;for(e===t&&(t=no(t)),n&&(s=Qt(e,vn(n)));++o<a;)for(var c=0,u=t[o],l=n?n(u):u;(c=i(s,l,c,r))>-1;)s!==e&&Dt.call(s,c,1),Dt.call(e,c,1);return e}function xi(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;qo(i)?Dt.call(e,i,1):ki(e,i)}}return e}function bi(e,t){return e+Fn(Zn()*(t-e+1))}function wi(e,t){var n="";if(!e||t<1||t>I)return n;do{t%2&&(n+=e),(t=Fn(t/2))&&(e+=e)}while(t);return n}function Ei(e,t){return oa(ea(e,t,Rc),e+"")}function Mi(e){return Mr(dc(e))}function Si(e,t){var n=dc(e);return ca(n,Ir(t,0,n.length))}function Ti(e,t,n,r){if(!As(e))return e;for(var i=-1,a=(t=qi(t,e)).length,s=a-1,c=e;null!=c&&++i<a;){var u=la(t[i]),l=n;if(i!=s){var h=c[u];(l=r?r(h,u,c):o)===o&&(l=As(h)?h:qo(t[i+1])?[]:{})}Lr(c,u,l),c=c[u]}return e}var Ai=rr?function(e,t){return rr.set(e,t),e}:Rc,Li=dn?function(e,t){return dn(e,"toString",{configurable:!0,enumerable:!1,value:Ac(t),writable:!0})}:Rc;function Ci(e){return ca(dc(e))}function Ri(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=r(o);++i<o;)a[i]=e[i+t];return a}function Pi(e,t){var n;return Fr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function Oi(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=F){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!Ds(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return Ni(e,t,Rc,n)}function Ni(e,t,n,r){t=n(t);for(var i=0,a=null==e?0:e.length,s=t!=t,c=null===t,u=Ds(t),l=t===o;i<a;){var h=Fn((i+a)/2),f=n(e[h]),d=f!==o,p=null===f,m=f==f,g=Ds(f);if(s)var v=r||m;else v=l?m&&(r||d):c?m&&d&&(r||!p):u?m&&d&&!p&&(r||!g):!p&&!g&&(r?f<=t:f<t);v?i=h+1:a=h}return qn(a,k)}function Ii(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!ds(s,c)){var c=s;o[i++]=0===a?0:a}}return o}function Di(e){return"number"==typeof e?e:Ds(e)?z:+e}function zi(e){if("string"==typeof e)return e;if(vs(e))return Qt(e,zi)+"";if(Ds(e))return fr?fr.call(e):"";var t=e+"";return"0"==t&&1/e==-N?"-0":t}function Ui(e,t,n){var r=-1,i=$t,o=e.length,s=!0,c=[],u=c;if(n)s=!1,i=Kt;else if(o>=a){var l=t?null:Eo(e);if(l)return Cn(l);s=!1,i=yn,u=new br}else u=t?[]:c;e:for(;++r<o;){var h=e[r],f=t?t(h):h;if(h=n||0!==h?h:0,s&&f==f){for(var d=u.length;d--;)if(u[d]===f)continue e;t&&u.push(f),c.push(h)}else i(u,f,n)||(u!==c&&u.push(f),c.push(h))}return c}function ki(e,t){return null==(e=ta(e,t=qi(t,e)))||delete e[la(Ea(t))]}function Fi(e,t,n,r){return Ti(e,t,n(Jr(e,t)),r)}function Bi(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Ri(e,r?0:o,r?o+1:i):Ri(e,r?o+1:0,r?i:o)}function ji(e,t){var n=e;return n instanceof vr&&(n=n.value()),tn(t,(function(e,t){return t.func.apply(t.thisArg,en([e],t.args))}),n)}function Hi(e,t,n){var i=e.length;if(i<2)return i?Ui(e[0]):[];for(var o=-1,a=r(i);++o<i;)for(var s=e[o],c=-1;++c<i;)c!=o&&(a[o]=kr(a[o]||s,e[c],t,n));return Ui(Vr(a,1),t,n)}function Gi(e,t,n){for(var r=-1,i=e.length,a=t.length,s={};++r<i;){var c=r<a?t[r]:o;n(s,e[r],c)}return s}function Vi(e){return xs(e)?e:[]}function Wi(e){return"function"==typeof e?e:Rc}function qi(e,t){return vs(e)?e:Yo(e,t)?[e]:ua(Ws(e))}var Xi=Ei;function Yi(e,t,n){var r=e.length;return n=n===o?r:n,!t&&n>=r?e:Ri(e,t,n)}var Zi=Dn||function(e){return Nt.clearTimeout(e)};function Ji(e,t){if(t)return e.slice();var n=e.length,r=Lt?Lt(n):new e.constructor(n);return e.copy(r),r}function $i(e){var t=new e.constructor(e.byteLength);return new wt(t).set(new wt(e)),t}function Ki(e,t){var n=t?$i(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Qi(e,t){if(e!==t){var n=e!==o,r=null===e,i=e==e,a=Ds(e),s=t!==o,c=null===t,u=t==t,l=Ds(t);if(!c&&!l&&!a&&e>t||a&&s&&u&&!c&&!l||r&&s&&u||!n&&u||!i)return 1;if(!r&&!a&&!l&&e<t||l&&n&&i&&!r&&!a||c&&n&&i||!s&&i||!u)return-1}return 0}function eo(e,t,n,i){for(var o=-1,a=e.length,s=n.length,c=-1,u=t.length,l=Wn(a-s,0),h=r(u+l),f=!i;++c<u;)h[c]=t[c];for(;++o<s;)(f||o<a)&&(h[n[o]]=e[o]);for(;l--;)h[c++]=e[o++];return h}function to(e,t,n,i){for(var o=-1,a=e.length,s=-1,c=n.length,u=-1,l=t.length,h=Wn(a-c,0),f=r(h+l),d=!i;++o<h;)f[o]=e[o];for(var p=o;++u<l;)f[p+u]=t[u];for(;++s<c;)(d||o<a)&&(f[p+n[s]]=e[o++]);return f}function no(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function ro(e,t,n,r){var i=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var c=t[a],u=r?r(n[c],e[c],c,n,e):o;u===o&&(u=e[c]),i?Or(n,c,u):Lr(n,c,u)}return n}function io(e,t){return function(n,r){var i=vs(n)?qt:Rr,o=t?t():{};return i(n,e,zo(r,2),o)}}function oo(e){return Ei((function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:o,s=i>2?n[2]:o;for(a=e.length>3&&"function"==typeof a?(i--,a):o,s&&Xo(n[0],n[1],s)&&(a=i<3?o:a,i=1),t=tt(t);++r<i;){var c=n[r];c&&e(t,c,r,a)}return t}))}function ao(e,t){return function(n,r){if(null==n)return n;if(!ys(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=tt(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function so(e){return function(t,n,r){for(var i=-1,o=tt(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(!1===n(o[c],c,o))break}return t}}function co(e){return function(t){var n=Sn(t=Ws(t))?On(t):o,r=n?n[0]:t.charAt(0),i=n?Yi(n,1).join(""):t.slice(1);return r[e]()+i}}function uo(e){return function(t){return tn(Mc(gc(t).replace(_t,"")),e,"")}}function lo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=pr(e.prototype),r=e.apply(n,t);return As(r)?r:n}}function ho(e){return function(t,n,r){var i=tt(t);if(!ys(t)){var a=zo(n,3);t=ic(t),n=function(e){return a(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[a?t[s]:s]:o}}function fo(e){return Ro((function(t){var n=t.length,r=n,i=gr.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new it(c);if(i&&!s&&"wrapper"==Io(a))var s=new gr([],!0)}for(r=s?r:n;++r<n;){var u=Io(a=t[r]),l="wrapper"==u?No(a):o;s=l&&Zo(l[0])&&l[1]==(M|x|w|S)&&!l[4].length&&1==l[9]?s[Io(l[0])].apply(s,l[3]):1==a.length&&Zo(a)?s[u]():s.thru(a)}return function(){var e=arguments,r=e[0];if(s&&1==e.length&&vs(r))return s.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function po(e,t,n,i,a,s,c,u,l,h){var f=t&M,d=t&v,p=t&_,m=t&(x|b),g=t&T,y=p?o:lo(e);return function v(){for(var _=arguments.length,x=r(_),b=_;b--;)x[b]=arguments[b];if(m)var w=Do(v),E=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(x,w);if(i&&(x=eo(x,i,a,m)),s&&(x=to(x,s,c,m)),_-=E,m&&_<h){var M=Ln(x,w);return bo(e,t,po,v.placeholder,n,x,M,u,l,h-_)}var S=d?n:this,T=p?S[e]:e;return _=x.length,u?x=function(e,t){var n=e.length,r=qn(t.length,n),i=no(e);for(;r--;){var a=t[r];e[r]=qo(a,n)?i[a]:o}return e}(x,u):g&&_>1&&x.reverse(),f&&l<_&&(x.length=l),this&&this!==Nt&&this instanceof v&&(T=y||lo(T)),T.apply(S,x)}}function mo(e,t){return function(n,r){return function(e,t,n,r){return Xr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function go(e,t){return function(n,r){var i;if(n===o&&r===o)return t;if(n!==o&&(i=n),r!==o){if(i===o)return r;"string"==typeof n||"string"==typeof r?(n=zi(n),r=zi(r)):(n=Di(n),r=Di(r)),i=e(n,r)}return i}}function vo(e){return Ro((function(t){return t=Qt(t,vn(zo())),Ei((function(n){var r=this;return e(t,(function(e){return Wt(e,r,n)}))}))}))}function _o(e,t){var n=(t=t===o?" ":zi(t)).length;if(n<2)return n?wi(t,e):t;var r=wi(t,kn(e/Pn(t)));return Sn(t)?Yi(On(r),0,e).join(""):r.slice(0,e)}function yo(e){return function(t,n,i){return i&&"number"!=typeof i&&Xo(t,n,i)&&(n=i=o),t=Bs(t),n===o?(n=t,t=0):n=Bs(n),function(e,t,n,i){for(var o=-1,a=Wn(kn((t-e)/(n||1)),0),s=r(a);a--;)s[i?a:++o]=e,e+=n;return s}(t,n,i=i===o?t<n?1:-1:Bs(i),e)}}function xo(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=Gs(t),n=Gs(n)),e(t,n)}}function bo(e,t,n,r,i,a,s,c,u,l){var h=t&x;t|=h?w:E,(t&=~(h?E:w))&y||(t&=~(v|_));var f=[e,t,i,h?a:o,h?s:o,h?o:a,h?o:s,c,u,l],d=n.apply(o,f);return Zo(e)&&ra(d,f),d.placeholder=r,aa(d,e,t)}function wo(e){var t=et[e];return function(e,n){if(e=Gs(e),(n=null==n?0:qn(js(n),292))&&Hn(e)){var r=(Ws(e)+"e").split("e");return+((r=(Ws(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Eo=er&&1/Cn(new er([,-0]))[1]==N?function(e){return new er(e)}:Dc;function Mo(e){return function(t){var n=Ho(t);return n==J?Tn(t):n==ne?Rn(t):function(e,t){return Qt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function So(e,t,n,i,a,s,u,l){var f=t&_;if(!f&&"function"!=typeof e)throw new it(c);var d=i?i.length:0;if(d||(t&=~(w|E),i=a=o),u=u===o?u:Wn(js(u),0),l=l===o?l:js(l),d-=a?a.length:0,t&E){var p=i,m=a;i=a=o}var g=f?o:No(e),T=[e,t,n,i,a,p,m,s,u,l];if(g&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<(v|_|M),a=r==M&&n==x||r==M&&n==S&&e[7].length<=t[8]||r==(M|S)&&t[7].length<=t[8]&&n==x;if(!o&&!a)return e;r&v&&(e[2]=t[2],i|=n&v?0:y);var s=t[3];if(s){var c=e[3];e[3]=c?eo(c,s,t[4]):s,e[4]=c?Ln(e[3],h):t[4]}(s=t[5])&&(c=e[5],e[5]=c?to(c,s,t[6]):s,e[6]=c?Ln(e[5],h):t[6]);(s=t[7])&&(e[7]=s);r&M&&(e[8]=null==e[8]?t[8]:qn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(T,g),e=T[0],t=T[1],n=T[2],i=T[3],a=T[4],!(l=T[9]=T[9]===o?f?0:e.length:Wn(T[9]-d,0))&&t&(x|b)&&(t&=~(x|b)),t&&t!=v)A=t==x||t==b?function(e,t,n){var i=lo(e);return function a(){for(var s=arguments.length,c=r(s),u=s,l=Do(a);u--;)c[u]=arguments[u];var h=s<3&&c[0]!==l&&c[s-1]!==l?[]:Ln(c,l);return(s-=h.length)<n?bo(e,t,po,a.placeholder,o,c,h,o,o,n-s):Wt(this&&this!==Nt&&this instanceof a?i:e,this,c)}}(e,t,l):t!=w&&t!=(v|w)||a.length?po.apply(o,T):function(e,t,n,i){var o=t&v,a=lo(e);return function t(){for(var s=-1,c=arguments.length,u=-1,l=i.length,h=r(l+c),f=this&&this!==Nt&&this instanceof t?a:e;++u<l;)h[u]=i[u];for(;c--;)h[u++]=arguments[++s];return Wt(f,o?n:this,h)}}(e,t,n,i);else var A=function(e,t,n){var r=t&v,i=lo(e);return function t(){return(this&&this!==Nt&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return aa((g?Ai:ra)(A,T),e,t)}function To(e,t,n,r){return e===o||ds(e,st[n])&&!lt.call(r,n)?t:e}function Ao(e,t,n,r,i,a){return As(e)&&As(t)&&(a.set(t,e),mi(e,t,o,Ao,a),a.delete(t)),e}function Lo(e){return Ps(e)?o:e}function Co(e,t,n,r,i,a){var s=n&m,c=e.length,u=t.length;if(c!=u&&!(s&&u>c))return!1;var l=a.get(e);if(l&&a.get(t))return l==t;var h=-1,f=!0,d=n&g?new br:o;for(a.set(e,t),a.set(t,e);++h<c;){var p=e[h],v=t[h];if(r)var _=s?r(v,p,h,t,e,a):r(p,v,h,e,t,a);if(_!==o){if(_)continue;f=!1;break}if(d){if(!rn(t,(function(e,t){if(!yn(d,t)&&(p===e||i(p,e,n,r,a)))return d.push(t)}))){f=!1;break}}else if(p!==v&&!i(p,v,n,r,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function Ro(e){return oa(ea(e,o,_a),e+"")}function Po(e){return $r(e,ic,Bo)}function Oo(e){return $r(e,oc,jo)}var No=rr?function(e){return rr.get(e)}:Dc;function Io(e){for(var t=e.name+"",n=ir[t],r=lt.call(ir,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Do(e){return(lt.call(dr,"placeholder")?dr:e).placeholder}function zo(){var e=dr.iteratee||Pc;return e=e===Pc?ci:e,arguments.length?e(arguments[0],arguments[1]):e}function Uo(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function ko(e){for(var t=ic(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Ko(i)]}return t}function Fo(e,t){var n=function(e,t){return null==e?o:e[t]}(e,t);return si(n)?n:o}var Bo=Bn?function(e){return null==e?[]:(e=tt(e),Jt(Bn(e),(function(t){return It.call(e,t)})))}:Hc,jo=Bn?function(e){for(var t=[];e;)en(t,Bo(e)),e=Pt(e);return t}:Hc,Ho=Kr;function Go(e,t,n){for(var r=-1,i=(t=qi(t,e)).length,o=!1;++r<i;){var a=la(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Ts(i)&&qo(a,i)&&(vs(e)||gs(e))}function Vo(e){return"function"!=typeof e.constructor||$o(e)?{}:pr(Pt(e))}function Wo(e){return vs(e)||gs(e)||!!(Ut&&e&&e[Ut])}function qo(e,t){var n=typeof e;return!!(t=null==t?I:t)&&("number"==n||"symbol"!=n&&Ye.test(e))&&e>-1&&e%1==0&&e<t}function Xo(e,t,n){if(!As(n))return!1;var r=typeof t;return!!("number"==r?ys(n)&&qo(t,n.length):"string"==r&&t in n)&&ds(n[t],e)}function Yo(e,t){if(vs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Ds(e))||(Re.test(e)||!Ce.test(e)||null!=t&&e in tt(t))}function Zo(e){var t=Io(e),n=dr[t];if("function"!=typeof n||!(t in vr.prototype))return!1;if(e===n)return!0;var r=No(n);return!!r&&e===r[0]}($n&&Ho(new $n(new ArrayBuffer(1)))!=ue||Kn&&Ho(new Kn)!=J||Qn&&"[object Promise]"!=Ho(Qn.resolve())||er&&Ho(new er)!=ne||tr&&Ho(new tr)!=ae)&&(Ho=function(e){var t=Kr(e),n=t==Q?e.constructor:o,r=n?ha(n):"";if(r)switch(r){case or:return ue;case ar:return J;case sr:return"[object Promise]";case cr:return ne;case ur:return ae}return t});var Jo=ct?Ms:Gc;function $o(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||st)}function Ko(e){return e==e&&!As(e)}function Qo(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==o||e in tt(n)))}}function ea(e,t,n){return t=Wn(t===o?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=Wn(i.length-t,0),s=r(a);++o<a;)s[o]=i[t+o];o=-1;for(var c=r(t+1);++o<t;)c[o]=i[o];return c[t]=n(s),Wt(e,this,c)}}function ta(e,t){return t.length<2?e:Jr(e,Ri(t,0,-1))}function na(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var ra=sa(Ai),ia=Un||function(e,t){return Nt.setTimeout(e,t)},oa=sa(Li);function aa(e,t,n){var r=t+"";return oa(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(Ue,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Xt(B,(function(n){var r="_."+n[0];t&n[1]&&!$t(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ke);return t?t[1].split(Fe):[]}(r),n)))}function sa(e){var t=0,n=0;return function(){var r=Xn(),i=R-(r-n);if(n=r,i>0){if(++t>=C)return arguments[0]}else t=0;return e.apply(o,arguments)}}function ca(e,t){var n=-1,r=e.length,i=r-1;for(t=t===o?r:t;++n<t;){var a=bi(n,i),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}var ua=function(e){var t=ss(e,(function(e){return n.size===l&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Pe,(function(e,n,r,i){t.push(r?i.replace(je,"$1"):n||e)})),t}));function la(e){if("string"==typeof e||Ds(e))return e;var t=e+"";return"0"==t&&1/e==-N?"-0":t}function ha(e){if(null!=e){try{return ut.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function fa(e){if(e instanceof vr)return e.clone();var t=new gr(e.__wrapped__,e.__chain__);return t.__actions__=no(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var da=Ei((function(e,t){return xs(e)?kr(e,Vr(t,1,xs,!0)):[]})),pa=Ei((function(e,t){var n=Ea(t);return xs(n)&&(n=o),xs(e)?kr(e,Vr(t,1,xs,!0),zo(n,2)):[]})),ma=Ei((function(e,t){var n=Ea(t);return xs(n)&&(n=o),xs(e)?kr(e,Vr(t,1,xs,!0),o,n):[]}));function ga(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:js(n);return i<0&&(i=Wn(r+i,0)),sn(e,zo(t,3),i)}function va(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return n!==o&&(i=js(n),i=n<0?Wn(r+i,0):qn(i,r-1)),sn(e,zo(t,3),i,!0)}function _a(e){return(null==e?0:e.length)?Vr(e,1):[]}function ya(e){return e&&e.length?e[0]:o}var xa=Ei((function(e){var t=Qt(e,Vi);return t.length&&t[0]===e[0]?ni(t):[]})),ba=Ei((function(e){var t=Ea(e),n=Qt(e,Vi);return t===Ea(n)?t=o:n.pop(),n.length&&n[0]===e[0]?ni(n,zo(t,2)):[]})),wa=Ei((function(e){var t=Ea(e),n=Qt(e,Vi);return(t="function"==typeof t?t:o)&&n.pop(),n.length&&n[0]===e[0]?ni(n,o,t):[]}));function Ea(e){var t=null==e?0:e.length;return t?e[t-1]:o}var Ma=Ei(Sa);function Sa(e,t){return e&&e.length&&t&&t.length?yi(e,t):e}var Ta=Ro((function(e,t){var n=null==e?0:e.length,r=Nr(e,t);return xi(e,Qt(t,(function(e){return qo(e,n)?+e:e})).sort(Qi)),r}));function Aa(e){return null==e?e:Jn.call(e)}var La=Ei((function(e){return Ui(Vr(e,1,xs,!0))})),Ca=Ei((function(e){var t=Ea(e);return xs(t)&&(t=o),Ui(Vr(e,1,xs,!0),zo(t,2))})),Ra=Ei((function(e){var t=Ea(e);return t="function"==typeof t?t:o,Ui(Vr(e,1,xs,!0),o,t)}));function Pa(e){if(!e||!e.length)return[];var t=0;return e=Jt(e,(function(e){if(xs(e))return t=Wn(e.length,t),!0})),gn(t,(function(t){return Qt(e,fn(t))}))}function Oa(e,t){if(!e||!e.length)return[];var n=Pa(e);return null==t?n:Qt(n,(function(e){return Wt(t,o,e)}))}var Na=Ei((function(e,t){return xs(e)?kr(e,t):[]})),Ia=Ei((function(e){return Hi(Jt(e,xs))})),Da=Ei((function(e){var t=Ea(e);return xs(t)&&(t=o),Hi(Jt(e,xs),zo(t,2))})),za=Ei((function(e){var t=Ea(e);return t="function"==typeof t?t:o,Hi(Jt(e,xs),o,t)})),Ua=Ei(Pa);var ka=Ei((function(e){var t=e.length,n=t>1?e[t-1]:o;return n="function"==typeof n?(e.pop(),n):o,Oa(e,n)}));function Fa(e){var t=dr(e);return t.__chain__=!0,t}function Ba(e,t){return t(e)}var ja=Ro((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Nr(t,e)};return!(t>1||this.__actions__.length)&&r instanceof vr&&qo(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:Ba,args:[i],thisArg:o}),new gr(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(o),e}))):this.thru(i)}));var Ha=io((function(e,t,n){lt.call(e,n)?++e[n]:Or(e,n,1)}));var Ga=ho(ga),Va=ho(va);function Wa(e,t){return(vs(e)?Xt:Fr)(e,zo(t,3))}function qa(e,t){return(vs(e)?Yt:Br)(e,zo(t,3))}var Xa=io((function(e,t,n){lt.call(e,n)?e[n].push(t):Or(e,n,[t])}));var Ya=Ei((function(e,t,n){var i=-1,o="function"==typeof t,a=ys(e)?r(e.length):[];return Fr(e,(function(e){a[++i]=o?Wt(t,e,n):ri(e,t,n)})),a})),Za=io((function(e,t,n){Or(e,n,t)}));function Ja(e,t){return(vs(e)?Qt:fi)(e,zo(t,3))}var $a=io((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var Ka=Ei((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Xo(e,t[0],t[1])?t=[]:n>2&&Xo(t[0],t[1],t[2])&&(t=[t[0]]),vi(e,Vr(t,1),[])})),Qa=zn||function(){return Nt.Date.now()};function es(e,t,n){return t=n?o:t,t=e&&null==t?e.length:t,So(e,M,o,o,o,o,t)}function ts(e,t){var n;if("function"!=typeof t)throw new it(c);return e=js(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=o),n}}var ns=Ei((function(e,t,n){var r=v;if(n.length){var i=Ln(n,Do(ns));r|=w}return So(e,r,t,n,i)})),rs=Ei((function(e,t,n){var r=v|_;if(n.length){var i=Ln(n,Do(rs));r|=w}return So(t,r,e,n,i)}));function is(e,t,n){var r,i,a,s,u,l,h=0,f=!1,d=!1,p=!0;if("function"!=typeof e)throw new it(c);function m(t){var n=r,a=i;return r=i=o,h=t,s=e.apply(a,n)}function g(e){var n=e-l;return l===o||n>=t||n<0||d&&e-h>=a}function v(){var e=Qa();if(g(e))return _(e);u=ia(v,function(e){var n=t-(e-l);return d?qn(n,a-(e-h)):n}(e))}function _(e){return u=o,p&&r?m(e):(r=i=o,s)}function y(){var e=Qa(),n=g(e);if(r=arguments,i=this,l=e,n){if(u===o)return function(e){return h=e,u=ia(v,t),f?m(e):s}(l);if(d)return Zi(u),u=ia(v,t),m(l)}return u===o&&(u=ia(v,t)),s}return t=Gs(t)||0,As(n)&&(f=!!n.leading,a=(d="maxWait"in n)?Wn(Gs(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),y.cancel=function(){u!==o&&Zi(u),h=0,r=l=i=u=o},y.flush=function(){return u===o?s:_(Qa())},y}var os=Ei((function(e,t){return Ur(e,1,t)})),as=Ei((function(e,t,n){return Ur(e,Gs(t)||0,n)}));function ss(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new it(c);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(ss.Cache||xr),n}function cs(e){if("function"!=typeof e)throw new it(c);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}ss.Cache=xr;var us=Xi((function(e,t){var n=(t=1==t.length&&vs(t[0])?Qt(t[0],vn(zo())):Qt(Vr(t,1),vn(zo()))).length;return Ei((function(r){for(var i=-1,o=qn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return Wt(e,this,r)}))})),ls=Ei((function(e,t){var n=Ln(t,Do(ls));return So(e,w,o,t,n)})),hs=Ei((function(e,t){var n=Ln(t,Do(hs));return So(e,E,o,t,n)})),fs=Ro((function(e,t){return So(e,S,o,o,o,t)}));function ds(e,t){return e===t||e!=e&&t!=t}var ps=xo(Qr),ms=xo((function(e,t){return e>=t})),gs=ii(function(){return arguments}())?ii:function(e){return Ls(e)&&lt.call(e,"callee")&&!It.call(e,"callee")},vs=r.isArray,_s=Ft?vn(Ft):function(e){return Ls(e)&&Kr(e)==ce};function ys(e){return null!=e&&Ts(e.length)&&!Ms(e)}function xs(e){return Ls(e)&&ys(e)}var bs=jn||Gc,ws=Bt?vn(Bt):function(e){return Ls(e)&&Kr(e)==W};function Es(e){if(!Ls(e))return!1;var t=Kr(e);return t==X||t==q||"string"==typeof e.message&&"string"==typeof e.name&&!Ps(e)}function Ms(e){if(!As(e))return!1;var t=Kr(e);return t==Y||t==Z||t==G||t==ee}function Ss(e){return"number"==typeof e&&e==js(e)}function Ts(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=I}function As(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ls(e){return null!=e&&"object"==typeof e}var Cs=jt?vn(jt):function(e){return Ls(e)&&Ho(e)==J};function Rs(e){return"number"==typeof e||Ls(e)&&Kr(e)==$}function Ps(e){if(!Ls(e)||Kr(e)!=Q)return!1;var t=Pt(e);if(null===t)return!0;var n=lt.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&ut.call(n)==pt}var Os=Ht?vn(Ht):function(e){return Ls(e)&&Kr(e)==te};var Ns=Gt?vn(Gt):function(e){return Ls(e)&&Ho(e)==ne};function Is(e){return"string"==typeof e||!vs(e)&&Ls(e)&&Kr(e)==re}function Ds(e){return"symbol"==typeof e||Ls(e)&&Kr(e)==ie}var zs=Vt?vn(Vt):function(e){return Ls(e)&&Ts(e.length)&&!!Tt[Kr(e)]};var Us=xo(hi),ks=xo((function(e,t){return e<=t}));function Fs(e){if(!e)return[];if(ys(e))return Is(e)?On(e):no(e);if(kt&&e[kt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[kt]());var t=Ho(e);return(t==J?Tn:t==ne?Cn:dc)(e)}function Bs(e){return e?(e=Gs(e))===N||e===-N?(e<0?-1:1)*D:e==e?e:0:0===e?e:0}function js(e){var t=Bs(e),n=t%1;return t==t?n?t-n:t:0}function Hs(e){return e?Ir(js(e),0,U):0}function Gs(e){if("number"==typeof e)return e;if(Ds(e))return z;if(As(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=As(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Ie,"");var n=We.test(e);return n||Xe.test(e)?Rt(e.slice(2),n?2:8):Ve.test(e)?z:+e}function Vs(e){return ro(e,oc(e))}function Ws(e){return null==e?"":zi(e)}var qs=oo((function(e,t){if($o(t)||ys(t))ro(t,ic(t),e);else for(var n in t)lt.call(t,n)&&Lr(e,n,t[n])})),Xs=oo((function(e,t){ro(t,oc(t),e)})),Ys=oo((function(e,t,n,r){ro(t,oc(t),e,r)})),Zs=oo((function(e,t,n,r){ro(t,ic(t),e,r)})),Js=Ro(Nr);var $s=Ei((function(e,t){e=tt(e);var n=-1,r=t.length,i=r>2?t[2]:o;for(i&&Xo(t[0],t[1],i)&&(r=1);++n<r;)for(var a=t[n],s=oc(a),c=-1,u=s.length;++c<u;){var l=s[c],h=e[l];(h===o||ds(h,st[l])&&!lt.call(e,l))&&(e[l]=a[l])}return e})),Ks=Ei((function(e){return e.push(o,Ao),Wt(sc,o,e)}));function Qs(e,t,n){var r=null==e?o:Jr(e,t);return r===o?n:r}function ec(e,t){return null!=e&&Go(e,t,ti)}var tc=mo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=dt.call(t)),e[t]=n}),Ac(Rc)),nc=mo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=dt.call(t)),lt.call(e,t)?e[t].push(n):e[t]=[n]}),zo),rc=Ei(ri);function ic(e){return ys(e)?Er(e):ui(e)}function oc(e){return ys(e)?Er(e,!0):li(e)}var ac=oo((function(e,t,n){mi(e,t,n)})),sc=oo((function(e,t,n,r){mi(e,t,n,r)})),cc=Ro((function(e,t){var n={};if(null==e)return n;var r=!1;t=Qt(t,(function(t){return t=qi(t,e),r||(r=t.length>1),t})),ro(e,Oo(e),n),r&&(n=Dr(n,f|d|p,Lo));for(var i=t.length;i--;)ki(n,t[i]);return n}));var uc=Ro((function(e,t){return null==e?{}:function(e,t){return _i(e,t,(function(t,n){return ec(e,n)}))}(e,t)}));function lc(e,t){if(null==e)return{};var n=Qt(Oo(e),(function(e){return[e]}));return t=zo(t),_i(e,n,(function(e,n){return t(e,n[0])}))}var hc=Mo(ic),fc=Mo(oc);function dc(e){return null==e?[]:_n(e,ic(e))}var pc=uo((function(e,t,n){return t=t.toLowerCase(),e+(n?mc(t):t)}));function mc(e){return Ec(Ws(e).toLowerCase())}function gc(e){return(e=Ws(e))&&e.replace(Ze,wn).replace(yt,"")}var vc=uo((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),_c=uo((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),yc=co("toLowerCase");var xc=uo((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var bc=uo((function(e,t,n){return e+(n?" ":"")+Ec(t)}));var wc=uo((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ec=co("toUpperCase");function Mc(e,t,n){return e=Ws(e),(t=n?o:t)===o?function(e){return Et.test(e)}(e)?function(e){return e.match(bt)||[]}(e):function(e){return e.match(Be)||[]}(e):e.match(t)||[]}var Sc=Ei((function(e,t){try{return Wt(e,o,t)}catch(e){return Es(e)?e:new Ke(e)}})),Tc=Ro((function(e,t){return Xt(t,(function(t){t=la(t),Or(e,t,ns(e[t],e))})),e}));function Ac(e){return function(){return e}}var Lc=fo(),Cc=fo(!0);function Rc(e){return e}function Pc(e){return ci("function"==typeof e?e:Dr(e,f))}var Oc=Ei((function(e,t){return function(n){return ri(n,e,t)}})),Nc=Ei((function(e,t){return function(n){return ri(e,n,t)}}));function Ic(e,t,n){var r=ic(t),i=Zr(t,r);null!=n||As(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Zr(t,ic(t)));var o=!(As(n)&&"chain"in n&&!n.chain),a=Ms(e);return Xt(i,(function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=no(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,en([this.value()],arguments))})})),e}function Dc(){}var zc=vo(Qt),Uc=vo(Zt),kc=vo(rn);function Fc(e){return Yo(e)?fn(la(e)):function(e){return function(t){return Jr(t,e)}}(e)}var Bc=yo(),jc=yo(!0);function Hc(){return[]}function Gc(){return!1}var Vc=go((function(e,t){return e+t}),0),Wc=wo("ceil"),qc=go((function(e,t){return e/t}),1),Xc=wo("floor");var Yc,Zc=go((function(e,t){return e*t}),1),Jc=wo("round"),$c=go((function(e,t){return e-t}),0);return dr.after=function(e,t){if("function"!=typeof t)throw new it(c);return e=js(e),function(){if(--e<1)return t.apply(this,arguments)}},dr.ary=es,dr.assign=qs,dr.assignIn=Xs,dr.assignInWith=Ys,dr.assignWith=Zs,dr.at=Js,dr.before=ts,dr.bind=ns,dr.bindAll=Tc,dr.bindKey=rs,dr.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return vs(e)?e:[e]},dr.chain=Fa,dr.chunk=function(e,t,n){t=(n?Xo(e,t,n):t===o)?1:Wn(js(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var a=0,s=0,c=r(kn(i/t));a<i;)c[s++]=Ri(e,a,a+=t);return c},dr.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},dr.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return en(vs(n)?no(n):[n],Vr(t,1))},dr.cond=function(e){var t=null==e?0:e.length,n=zo();return e=t?Qt(e,(function(e){if("function"!=typeof e[1])throw new it(c);return[n(e[0]),e[1]]})):[],Ei((function(n){for(var r=-1;++r<t;){var i=e[r];if(Wt(i[0],this,n))return Wt(i[1],this,n)}}))},dr.conforms=function(e){return function(e){var t=ic(e);return function(n){return zr(n,e,t)}}(Dr(e,f))},dr.constant=Ac,dr.countBy=Ha,dr.create=function(e,t){var n=pr(e);return null==t?n:Pr(n,t)},dr.curry=function e(t,n,r){var i=So(t,x,o,o,o,o,o,n=r?o:n);return i.placeholder=e.placeholder,i},dr.curryRight=function e(t,n,r){var i=So(t,b,o,o,o,o,o,n=r?o:n);return i.placeholder=e.placeholder,i},dr.debounce=is,dr.defaults=$s,dr.defaultsDeep=Ks,dr.defer=os,dr.delay=as,dr.difference=da,dr.differenceBy=pa,dr.differenceWith=ma,dr.drop=function(e,t,n){var r=null==e?0:e.length;return r?Ri(e,(t=n||t===o?1:js(t))<0?0:t,r):[]},dr.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Ri(e,0,(t=r-(t=n||t===o?1:js(t)))<0?0:t):[]},dr.dropRightWhile=function(e,t){return e&&e.length?Bi(e,zo(t,3),!0,!0):[]},dr.dropWhile=function(e,t){return e&&e.length?Bi(e,zo(t,3),!0):[]},dr.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&Xo(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=js(n))<0&&(n=-n>i?0:i+n),(r=r===o||r>i?i:js(r))<0&&(r+=i),r=n>r?0:Hs(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},dr.filter=function(e,t){return(vs(e)?Jt:Gr)(e,zo(t,3))},dr.flatMap=function(e,t){return Vr(Ja(e,t),1)},dr.flatMapDeep=function(e,t){return Vr(Ja(e,t),N)},dr.flatMapDepth=function(e,t,n){return n=n===o?1:js(n),Vr(Ja(e,t),n)},dr.flatten=_a,dr.flattenDeep=function(e){return(null==e?0:e.length)?Vr(e,N):[]},dr.flattenDepth=function(e,t){return(null==e?0:e.length)?Vr(e,t=t===o?1:js(t)):[]},dr.flip=function(e){return So(e,T)},dr.flow=Lc,dr.flowRight=Cc,dr.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},dr.functions=function(e){return null==e?[]:Zr(e,ic(e))},dr.functionsIn=function(e){return null==e?[]:Zr(e,oc(e))},dr.groupBy=Xa,dr.initial=function(e){return(null==e?0:e.length)?Ri(e,0,-1):[]},dr.intersection=xa,dr.intersectionBy=ba,dr.intersectionWith=wa,dr.invert=tc,dr.invertBy=nc,dr.invokeMap=Ya,dr.iteratee=Pc,dr.keyBy=Za,dr.keys=ic,dr.keysIn=oc,dr.map=Ja,dr.mapKeys=function(e,t){var n={};return t=zo(t,3),Xr(e,(function(e,r,i){Or(n,t(e,r,i),e)})),n},dr.mapValues=function(e,t){var n={};return t=zo(t,3),Xr(e,(function(e,r,i){Or(n,r,t(e,r,i))})),n},dr.matches=function(e){return di(Dr(e,f))},dr.matchesProperty=function(e,t){return pi(e,Dr(t,f))},dr.memoize=ss,dr.merge=ac,dr.mergeWith=sc,dr.method=Oc,dr.methodOf=Nc,dr.mixin=Ic,dr.negate=cs,dr.nthArg=function(e){return e=js(e),Ei((function(t){return gi(t,e)}))},dr.omit=cc,dr.omitBy=function(e,t){return lc(e,cs(zo(t)))},dr.once=function(e){return ts(2,e)},dr.orderBy=function(e,t,n,r){return null==e?[]:(vs(t)||(t=null==t?[]:[t]),vs(n=r?o:n)||(n=null==n?[]:[n]),vi(e,t,n))},dr.over=zc,dr.overArgs=us,dr.overEvery=Uc,dr.overSome=kc,dr.partial=ls,dr.partialRight=hs,dr.partition=$a,dr.pick=uc,dr.pickBy=lc,dr.property=Fc,dr.propertyOf=function(e){return function(t){return null==e?o:Jr(e,t)}},dr.pull=Ma,dr.pullAll=Sa,dr.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?yi(e,t,zo(n,2)):e},dr.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?yi(e,t,o,n):e},dr.pullAt=Ta,dr.range=Bc,dr.rangeRight=jc,dr.rearg=fs,dr.reject=function(e,t){return(vs(e)?Jt:Gr)(e,cs(zo(t,3)))},dr.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=zo(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return xi(e,i),n},dr.rest=function(e,t){if("function"!=typeof e)throw new it(c);return Ei(e,t=t===o?t:js(t))},dr.reverse=Aa,dr.sampleSize=function(e,t,n){return t=(n?Xo(e,t,n):t===o)?1:js(t),(vs(e)?Sr:Si)(e,t)},dr.set=function(e,t,n){return null==e?e:Ti(e,t,n)},dr.setWith=function(e,t,n,r){return r="function"==typeof r?r:o,null==e?e:Ti(e,t,n,r)},dr.shuffle=function(e){return(vs(e)?Tr:Ci)(e)},dr.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Xo(e,t,n)?(t=0,n=r):(t=null==t?0:js(t),n=n===o?r:js(n)),Ri(e,t,n)):[]},dr.sortBy=Ka,dr.sortedUniq=function(e){return e&&e.length?Ii(e):[]},dr.sortedUniqBy=function(e,t){return e&&e.length?Ii(e,zo(t,2)):[]},dr.split=function(e,t,n){return n&&"number"!=typeof n&&Xo(e,t,n)&&(t=n=o),(n=n===o?U:n>>>0)?(e=Ws(e))&&("string"==typeof t||null!=t&&!Os(t))&&!(t=zi(t))&&Sn(e)?Yi(On(e),0,n):e.split(t,n):[]},dr.spread=function(e,t){if("function"!=typeof e)throw new it(c);return t=null==t?0:Wn(js(t),0),Ei((function(n){var r=n[t],i=Yi(n,0,t);return r&&en(i,r),Wt(e,this,i)}))},dr.tail=function(e){var t=null==e?0:e.length;return t?Ri(e,1,t):[]},dr.take=function(e,t,n){return e&&e.length?Ri(e,0,(t=n||t===o?1:js(t))<0?0:t):[]},dr.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Ri(e,(t=r-(t=n||t===o?1:js(t)))<0?0:t,r):[]},dr.takeRightWhile=function(e,t){return e&&e.length?Bi(e,zo(t,3),!1,!0):[]},dr.takeWhile=function(e,t){return e&&e.length?Bi(e,zo(t,3)):[]},dr.tap=function(e,t){return t(e),e},dr.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new it(c);return As(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),is(e,t,{leading:r,maxWait:t,trailing:i})},dr.thru=Ba,dr.toArray=Fs,dr.toPairs=hc,dr.toPairsIn=fc,dr.toPath=function(e){return vs(e)?Qt(e,la):Ds(e)?[e]:no(ua(Ws(e)))},dr.toPlainObject=Vs,dr.transform=function(e,t,n){var r=vs(e),i=r||bs(e)||zs(e);if(t=zo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:As(e)&&Ms(o)?pr(Pt(e)):{}}return(i?Xt:Xr)(e,(function(e,r,i){return t(n,e,r,i)})),n},dr.unary=function(e){return es(e,1)},dr.union=La,dr.unionBy=Ca,dr.unionWith=Ra,dr.uniq=function(e){return e&&e.length?Ui(e):[]},dr.uniqBy=function(e,t){return e&&e.length?Ui(e,zo(t,2)):[]},dr.uniqWith=function(e,t){return t="function"==typeof t?t:o,e&&e.length?Ui(e,o,t):[]},dr.unset=function(e,t){return null==e||ki(e,t)},dr.unzip=Pa,dr.unzipWith=Oa,dr.update=function(e,t,n){return null==e?e:Fi(e,t,Wi(n))},dr.updateWith=function(e,t,n,r){return r="function"==typeof r?r:o,null==e?e:Fi(e,t,Wi(n),r)},dr.values=dc,dr.valuesIn=function(e){return null==e?[]:_n(e,oc(e))},dr.without=Na,dr.words=Mc,dr.wrap=function(e,t){return ls(Wi(t),e)},dr.xor=Ia,dr.xorBy=Da,dr.xorWith=za,dr.zip=Ua,dr.zipObject=function(e,t){return Gi(e||[],t||[],Lr)},dr.zipObjectDeep=function(e,t){return Gi(e||[],t||[],Ti)},dr.zipWith=ka,dr.entries=hc,dr.entriesIn=fc,dr.extend=Xs,dr.extendWith=Ys,Ic(dr,dr),dr.add=Vc,dr.attempt=Sc,dr.camelCase=pc,dr.capitalize=mc,dr.ceil=Wc,dr.clamp=function(e,t,n){return n===o&&(n=t,t=o),n!==o&&(n=(n=Gs(n))==n?n:0),t!==o&&(t=(t=Gs(t))==t?t:0),Ir(Gs(e),t,n)},dr.clone=function(e){return Dr(e,p)},dr.cloneDeep=function(e){return Dr(e,f|p)},dr.cloneDeepWith=function(e,t){return Dr(e,f|p,t="function"==typeof t?t:o)},dr.cloneWith=function(e,t){return Dr(e,p,t="function"==typeof t?t:o)},dr.conformsTo=function(e,t){return null==t||zr(e,t,ic(t))},dr.deburr=gc,dr.defaultTo=function(e,t){return null==e||e!=e?t:e},dr.divide=qc,dr.endsWith=function(e,t,n){e=Ws(e),t=zi(t);var r=e.length,i=n=n===o?r:Ir(js(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},dr.eq=ds,dr.escape=function(e){return(e=Ws(e))&&Se.test(e)?e.replace(Ee,En):e},dr.escapeRegExp=function(e){return(e=Ws(e))&&Ne.test(e)?e.replace(Oe,"\\$&"):e},dr.every=function(e,t,n){var r=vs(e)?Zt:jr;return n&&Xo(e,t,n)&&(t=o),r(e,zo(t,3))},dr.find=Ga,dr.findIndex=ga,dr.findKey=function(e,t){return an(e,zo(t,3),Xr)},dr.findLast=Va,dr.findLastIndex=va,dr.findLastKey=function(e,t){return an(e,zo(t,3),Yr)},dr.floor=Xc,dr.forEach=Wa,dr.forEachRight=qa,dr.forIn=function(e,t){return null==e?e:Wr(e,zo(t,3),oc)},dr.forInRight=function(e,t){return null==e?e:qr(e,zo(t,3),oc)},dr.forOwn=function(e,t){return e&&Xr(e,zo(t,3))},dr.forOwnRight=function(e,t){return e&&Yr(e,zo(t,3))},dr.get=Qs,dr.gt=ps,dr.gte=ms,dr.has=function(e,t){return null!=e&&Go(e,t,ei)},dr.hasIn=ec,dr.head=ya,dr.identity=Rc,dr.includes=function(e,t,n,r){e=ys(e)?e:dc(e),n=n&&!r?js(n):0;var i=e.length;return n<0&&(n=Wn(i+n,0)),Is(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&cn(e,t,n)>-1},dr.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:js(n);return i<0&&(i=Wn(r+i,0)),cn(e,t,i)},dr.inRange=function(e,t,n){return t=Bs(t),n===o?(n=t,t=0):n=Bs(n),function(e,t,n){return e>=qn(t,n)&&e<Wn(t,n)}(e=Gs(e),t,n)},dr.invoke=rc,dr.isArguments=gs,dr.isArray=vs,dr.isArrayBuffer=_s,dr.isArrayLike=ys,dr.isArrayLikeObject=xs,dr.isBoolean=function(e){return!0===e||!1===e||Ls(e)&&Kr(e)==V},dr.isBuffer=bs,dr.isDate=ws,dr.isElement=function(e){return Ls(e)&&1===e.nodeType&&!Ps(e)},dr.isEmpty=function(e){if(null==e)return!0;if(ys(e)&&(vs(e)||"string"==typeof e||"function"==typeof e.splice||bs(e)||zs(e)||gs(e)))return!e.length;var t=Ho(e);if(t==J||t==ne)return!e.size;if($o(e))return!ui(e).length;for(var n in e)if(lt.call(e,n))return!1;return!0},dr.isEqual=function(e,t){return oi(e,t)},dr.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:o)?n(e,t):o;return r===o?oi(e,t,o,n):!!r},dr.isError=Es,dr.isFinite=function(e){return"number"==typeof e&&Hn(e)},dr.isFunction=Ms,dr.isInteger=Ss,dr.isLength=Ts,dr.isMap=Cs,dr.isMatch=function(e,t){return e===t||ai(e,t,ko(t))},dr.isMatchWith=function(e,t,n){return n="function"==typeof n?n:o,ai(e,t,ko(t),n)},dr.isNaN=function(e){return Rs(e)&&e!=+e},dr.isNative=function(e){if(Jo(e))throw new Ke(s);return si(e)},dr.isNil=function(e){return null==e},dr.isNull=function(e){return null===e},dr.isNumber=Rs,dr.isObject=As,dr.isObjectLike=Ls,dr.isPlainObject=Ps,dr.isRegExp=Os,dr.isSafeInteger=function(e){return Ss(e)&&e>=-I&&e<=I},dr.isSet=Ns,dr.isString=Is,dr.isSymbol=Ds,dr.isTypedArray=zs,dr.isUndefined=function(e){return e===o},dr.isWeakMap=function(e){return Ls(e)&&Ho(e)==ae},dr.isWeakSet=function(e){return Ls(e)&&Kr(e)==se},dr.join=function(e,t){return null==e?"":Gn.call(e,t)},dr.kebabCase=vc,dr.last=Ea,dr.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return n!==o&&(i=(i=js(n))<0?Wn(r+i,0):qn(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):sn(e,ln,i,!0)},dr.lowerCase=_c,dr.lowerFirst=yc,dr.lt=Us,dr.lte=ks,dr.max=function(e){return e&&e.length?Hr(e,Rc,Qr):o},dr.maxBy=function(e,t){return e&&e.length?Hr(e,zo(t,2),Qr):o},dr.mean=function(e){return hn(e,Rc)},dr.meanBy=function(e,t){return hn(e,zo(t,2))},dr.min=function(e){return e&&e.length?Hr(e,Rc,hi):o},dr.minBy=function(e,t){return e&&e.length?Hr(e,zo(t,2),hi):o},dr.stubArray=Hc,dr.stubFalse=Gc,dr.stubObject=function(){return{}},dr.stubString=function(){return""},dr.stubTrue=function(){return!0},dr.multiply=Zc,dr.nth=function(e,t){return e&&e.length?gi(e,js(t)):o},dr.noConflict=function(){return Nt._===this&&(Nt._=mt),this},dr.noop=Dc,dr.now=Qa,dr.pad=function(e,t,n){e=Ws(e);var r=(t=js(t))?Pn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return _o(Fn(i),n)+e+_o(kn(i),n)},dr.padEnd=function(e,t,n){e=Ws(e);var r=(t=js(t))?Pn(e):0;return t&&r<t?e+_o(t-r,n):e},dr.padStart=function(e,t,n){e=Ws(e);var r=(t=js(t))?Pn(e):0;return t&&r<t?_o(t-r,n)+e:e},dr.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Yn(Ws(e).replace(De,""),t||0)},dr.random=function(e,t,n){if(n&&"boolean"!=typeof n&&Xo(e,t,n)&&(t=n=o),n===o&&("boolean"==typeof t?(n=t,t=o):"boolean"==typeof e&&(n=e,e=o)),e===o&&t===o?(e=0,t=1):(e=Bs(e),t===o?(t=e,e=0):t=Bs(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=Zn();return qn(e+i*(t-e+Ct("1e-"+((i+"").length-1))),t)}return bi(e,t)},dr.reduce=function(e,t,n){var r=vs(e)?tn:pn,i=arguments.length<3;return r(e,zo(t,4),n,i,Fr)},dr.reduceRight=function(e,t,n){var r=vs(e)?nn:pn,i=arguments.length<3;return r(e,zo(t,4),n,i,Br)},dr.repeat=function(e,t,n){return t=(n?Xo(e,t,n):t===o)?1:js(t),wi(Ws(e),t)},dr.replace=function(){var e=arguments,t=Ws(e[0]);return e.length<3?t:t.replace(e[1],e[2])},dr.result=function(e,t,n){var r=-1,i=(t=qi(t,e)).length;for(i||(i=1,e=o);++r<i;){var a=null==e?o:e[la(t[r])];a===o&&(r=i,a=n),e=Ms(a)?a.call(e):a}return e},dr.round=Jc,dr.runInContext=e,dr.sample=function(e){return(vs(e)?Mr:Mi)(e)},dr.size=function(e){if(null==e)return 0;if(ys(e))return Is(e)?Pn(e):e.length;var t=Ho(e);return t==J||t==ne?e.size:ui(e).length},dr.snakeCase=xc,dr.some=function(e,t,n){var r=vs(e)?rn:Pi;return n&&Xo(e,t,n)&&(t=o),r(e,zo(t,3))},dr.sortedIndex=function(e,t){return Oi(e,t)},dr.sortedIndexBy=function(e,t,n){return Ni(e,t,zo(n,2))},dr.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Oi(e,t);if(r<n&&ds(e[r],t))return r}return-1},dr.sortedLastIndex=function(e,t){return Oi(e,t,!0)},dr.sortedLastIndexBy=function(e,t,n){return Ni(e,t,zo(n,2),!0)},dr.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=Oi(e,t,!0)-1;if(ds(e[n],t))return n}return-1},dr.startCase=bc,dr.startsWith=function(e,t,n){return e=Ws(e),n=null==n?0:Ir(js(n),0,e.length),t=zi(t),e.slice(n,n+t.length)==t},dr.subtract=$c,dr.sum=function(e){return e&&e.length?mn(e,Rc):0},dr.sumBy=function(e,t){return e&&e.length?mn(e,zo(t,2)):0},dr.template=function(e,t,n){var r=dr.templateSettings;n&&Xo(e,t,n)&&(t=o),e=Ws(e),t=Ys({},t,r,To);var i,a,s=Ys({},t.imports,r.imports,To),c=ic(s),u=_n(s,c),l=0,h=t.interpolate||Je,f="__p += '",d=nt((t.escape||Je).source+"|"+h.source+"|"+(h===Le?He:Je).source+"|"+(t.evaluate||Je).source+"|$","g"),p="//# sourceURL="+(lt.call(t,"sourceURL")?(t.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++St+"]")+"\n";e.replace(d,(function(t,n,r,o,s,c){return r||(r=o),f+=e.slice(l,c).replace($e,Mn),n&&(i=!0,f+="' +\n__e("+n+") +\n'"),s&&(a=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=c+t.length,t})),f+="';\n";var m=lt.call(t,"variable")&&t.variable;m||(f="with (obj) {\n"+f+"\n}\n"),f=(a?f.replace(ye,""):f).replace(xe,"$1").replace(be,"$1;"),f="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var g=Sc((function(){return Qe(c,p+"return "+f).apply(o,u)}));if(g.source=f,Es(g))throw g;return g},dr.times=function(e,t){if((e=js(e))<1||e>I)return[];var n=U,r=qn(e,U);t=zo(t),e-=U;for(var i=gn(r,t);++n<e;)t(n);return i},dr.toFinite=Bs,dr.toInteger=js,dr.toLength=Hs,dr.toLower=function(e){return Ws(e).toLowerCase()},dr.toNumber=Gs,dr.toSafeInteger=function(e){return e?Ir(js(e),-I,I):0===e?e:0},dr.toString=Ws,dr.toUpper=function(e){return Ws(e).toUpperCase()},dr.trim=function(e,t,n){if((e=Ws(e))&&(n||t===o))return e.replace(Ie,"");if(!e||!(t=zi(t)))return e;var r=On(e),i=On(t);return Yi(r,xn(r,i),bn(r,i)+1).join("")},dr.trimEnd=function(e,t,n){if((e=Ws(e))&&(n||t===o))return e.replace(ze,"");if(!e||!(t=zi(t)))return e;var r=On(e);return Yi(r,0,bn(r,On(t))+1).join("")},dr.trimStart=function(e,t,n){if((e=Ws(e))&&(n||t===o))return e.replace(De,"");if(!e||!(t=zi(t)))return e;var r=On(e);return Yi(r,xn(r,On(t))).join("")},dr.truncate=function(e,t){var n=A,r=L;if(As(t)){var i="separator"in t?t.separator:i;n="length"in t?js(t.length):n,r="omission"in t?zi(t.omission):r}var a=(e=Ws(e)).length;if(Sn(e)){var s=On(e);a=s.length}if(n>=a)return e;var c=n-Pn(r);if(c<1)return r;var u=s?Yi(s,0,c).join(""):e.slice(0,c);if(i===o)return u+r;if(s&&(c+=u.length-c),Os(i)){if(e.slice(c).search(i)){var l,h=u;for(i.global||(i=nt(i.source,Ws(Ge.exec(i))+"g")),i.lastIndex=0;l=i.exec(h);)var f=l.index;u=u.slice(0,f===o?c:f)}}else if(e.indexOf(zi(i),c)!=c){var d=u.lastIndexOf(i);d>-1&&(u=u.slice(0,d))}return u+r},dr.unescape=function(e){return(e=Ws(e))&&Me.test(e)?e.replace(we,Nn):e},dr.uniqueId=function(e){var t=++ht;return Ws(e)+t},dr.upperCase=wc,dr.upperFirst=Ec,dr.each=Wa,dr.eachRight=qa,dr.first=ya,Ic(dr,(Yc={},Xr(dr,(function(e,t){lt.call(dr.prototype,t)||(Yc[t]=e)})),Yc),{chain:!1}),dr.VERSION="4.17.15",Xt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){dr[e].placeholder=dr})),Xt(["drop","take"],(function(e,t){vr.prototype[e]=function(n){n=n===o?1:Wn(js(n),0);var r=this.__filtered__&&!t?new vr(this):this.clone();return r.__filtered__?r.__takeCount__=qn(n,r.__takeCount__):r.__views__.push({size:qn(n,U),type:e+(r.__dir__<0?"Right":"")}),r},vr.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Xt(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=n==P||3==n;vr.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:zo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),Xt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");vr.prototype[e]=function(){return this[n](1).value()[0]}})),Xt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");vr.prototype[e]=function(){return this.__filtered__?new vr(this):this[n](1)}})),vr.prototype.compact=function(){return this.filter(Rc)},vr.prototype.find=function(e){return this.filter(e).head()},vr.prototype.findLast=function(e){return this.reverse().find(e)},vr.prototype.invokeMap=Ei((function(e,t){return"function"==typeof e?new vr(this):this.map((function(n){return ri(n,e,t)}))})),vr.prototype.reject=function(e){return this.filter(cs(zo(e)))},vr.prototype.slice=function(e,t){e=js(e);var n=this;return n.__filtered__&&(e>0||t<0)?new vr(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==o&&(n=(t=js(t))<0?n.dropRight(-t):n.take(t-e)),n)},vr.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},vr.prototype.toArray=function(){return this.take(U)},Xr(vr.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=dr[r?"take"+("last"==t?"Right":""):t],a=r||/^find/.test(t);i&&(dr.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,c=t instanceof vr,u=s[0],l=c||vs(t),h=function(e){var t=i.apply(dr,en([e],s));return r&&f?t[0]:t};l&&n&&"function"==typeof u&&1!=u.length&&(c=l=!1);var f=this.__chain__,d=!!this.__actions__.length,p=a&&!f,m=c&&!d;if(!a&&l){t=m?t:new vr(this);var g=e.apply(t,s);return g.__actions__.push({func:Ba,args:[h],thisArg:o}),new gr(g,f)}return p&&m?e.apply(this,s):(g=this.thru(h),p?r?g.value()[0]:g.value():g)})})),Xt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=ot[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);dr.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(vs(i)?i:[],e)}return this[n]((function(n){return t.apply(vs(n)?n:[],e)}))}})),Xr(vr.prototype,(function(e,t){var n=dr[t];if(n){var r=n.name+"";lt.call(ir,r)||(ir[r]=[]),ir[r].push({name:t,func:n})}})),ir[po(o,_).name]=[{name:"wrapper",func:o}],vr.prototype.clone=function(){var e=new vr(this.__wrapped__);return e.__actions__=no(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=no(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=no(this.__views__),e},vr.prototype.reverse=function(){if(this.__filtered__){var e=new vr(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},vr.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=vs(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=qn(t,e+a);break;case"takeRight":e=Wn(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,c=s-a,u=r?s:a-1,l=this.__iteratees__,h=l.length,f=0,d=qn(c,this.__takeCount__);if(!n||!r&&i==c&&d==c)return ji(e,this.__actions__);var p=[];e:for(;c--&&f<d;){for(var m=-1,g=e[u+=t];++m<h;){var v=l[m],_=v.iteratee,y=v.type,x=_(g);if(y==O)g=x;else if(!x){if(y==P)continue e;break e}}p[f++]=g}return p},dr.prototype.at=ja,dr.prototype.chain=function(){return Fa(this)},dr.prototype.commit=function(){return new gr(this.value(),this.__chain__)},dr.prototype.next=function(){this.__values__===o&&(this.__values__=Fs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?o:this.__values__[this.__index__++]}},dr.prototype.plant=function(e){for(var t,n=this;n instanceof mr;){var r=fa(n);r.__index__=0,r.__values__=o,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},dr.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof vr){var t=e;return this.__actions__.length&&(t=new vr(this)),(t=t.reverse()).__actions__.push({func:Ba,args:[Aa],thisArg:o}),new gr(t,this.__chain__)}return this.thru(Aa)},dr.prototype.toJSON=dr.prototype.valueOf=dr.prototype.value=function(){return ji(this.__wrapped__,this.__actions__)},dr.prototype.first=dr.prototype.head,kt&&(dr.prototype[kt]=function(){return this}),dr}();Nt._=In,(i=function(){return In}.call(t,n,t,r))===o||(r.exports=i)}).call(this)}).call(this,n(29),n(30)(e))},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(20)),o=n(3),a=n(11).default,s=n(31).default;n(11);function c(e){return e.replace("#include <scales>",a).replace("#include <ipyvolume>",s)}t.scaleTypeMap={linear:1,log:2},t.patchMaterial=function(e){e.onBeforeCompile=e=>{e.vertexShader=c(e.vertexShader),e.fragmentShader=c(e.fragmentShader)}},t.patchShader=c,t.createD3Scale=function(e){if("linear"===e.type)return i.scaleLinear().domain(e.domain);if("log"===e.type)return i.scaleLog().domain(e.domain);throw new Error("Scale not supported: "+e)},t.createColormap=function(e){const t=e?e.color_range:["#ff0000","#ff0000"],n=i.scaleLinear().range(t).domain(o.range(t.length).map(e=>e/(t.length-1))),r=[];for(let e=0;e<256;e++){const t=e/255,o=i.color(String(n(t))).hex(),a=String(o),s=[parseInt("0x"+a.substring(1,3),16),parseInt("0x"+a.substring(3,5),16),parseInt("0x"+a.substring(5,7),16)];r.push(s[0],s[1],s[2])}const a=new Uint8Array(r),s=new THREE.DataTexture(a,256,1,THREE.RGBFormat,THREE.UnsignedByteType);return s.needsUpdate=!0,s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.textAlign={center:new r.Vector2(0,0),left:new r.Vector2(1,0),topLeft:new r.Vector2(1,-1),topRight:new r.Vector2(-1,-1),right:new r.Vector2(-1,0),bottomLeft:new r.Vector2(1,1),bottomRight:new r.Vector2(-1,1)};var i={};t.getFontHeight=function(e){var t=i[e];if(!t){var n=document.getElementsByTagName("body")[0],r=document.createElement("div"),o=document.createTextNode("Mq");r.appendChild(o),r.setAttribute("style","font:"+e+";position:absolute;top:0;left:0"),n.appendChild(r),t=r.offsetHeight,i[e]=t,n.removeChild(r)}return t}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(2)),a=n(3),s=i(n(12)),c=r(n(0)),u=r(n(1));const l={int8:Int8Array,int16:Int16Array,int32:Int32Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array},h={Int8Array:"int8",Int16Array:"int16",Int32Array:"int32",Uint8Array:"uint8",Uint16Array:"uint16",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64"};function f(e,t){const n=l[e.dtype];return null==e&&console.log("data is null"),e.data||console.log("data.data is null"),e.data.buffer||console.log("data.data.buffer is null"),new n(e.data.buffer)}function d(e,t){if(null==e)return null;let n=null;return a.isNumber(e)?e:((n=e.map(e=>f(e))).original_data=e,n)}function p(e,t){if(null==e)return null;let n=null;function r(e){const t=new Float32Array(3*e.length);for(let n=0;n<e.length;n++){const r=new c.Color(e[n]);t[3*n+0]=r.r,t[3*n+1]=r.g,t[3*n+2]=r.b}return t}if("string"==typeof e)return e;if(void 0!==e.dtype)n=[f(e)];else if(void 0!==e[0].dtype)n=e.map(e=>f(e));else{const t=u.get_array_dimension(e);1===t&&"string"==typeof e[0]?n=r(e):2===t&&"string"==typeof e[0][0]?n=e.map(r):console.error("don't understand color type")}return n.original_data=e,n}function m(e,t){return a.isNumber(e)?e:null!=e?void 0===e.original_data?e:e.original_data:null}t.deserialize_array_or_json=d,t.deserialize_color_or_json=p,t.serialize_array_or_json=m,t.texture={deserialize:function(e,t){return"string"==typeof e&&e.startsWith("IPY_MODEL_")?o.unpack_models(e,t):e},serialize:function(e,t){return e}},t.array_or_json={deserialize:d,serialize:m},t.color_or_json={deserialize:p,serialize:m};const g={deserialize:function(e,t){return null===e?null:s.default(f(e),e.shape)},serialize:function(e,t){if(null===e)return null;let r=e;return a.isArray(e)&&!e.data&&(r=n(13)(e)),{data:r.data.buffer,dtype:h[r.data.constructor.name],shape:r.shape}}};t.ndarray=g},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=n(3),o=r(n(0)),a=r(n(1));class s{constructor(e,t,n,r,i=[]){this.length=1/0,this.scalar={},this.scalar_vec3={},this.scalar_vec4={},this.array={},this.array_vec3={},this.array_vec4={},this.values={};for(const t of e){const e=n(t,r,s.defaults[t]);a.is_typedarray(e)?("selected"!==t&&(this.length=Math.min(this.length,e.length)),this.array[t]=e):this.scalar[t]=e,this.values[t]=e}for(const e of t){let t=n(e,r,s.defaults[e]);if(-1!==e.indexOf("color")&&"string"==typeof t){const e=new o.Color(t);t=new Float32Array([e.r,e.g,e.b])}a.is_typedarray(t)&&t.length>3?(this.array_vec3[e]=t,this.length=Math.min(this.length,t.length/3)):this.scalar_vec3[e]=t,this.values[e]=t}for(const e of i){let t=n(e,r,s.defaults[e]);if(-1!==e.indexOf("color")&&"string"==typeof t){const e=new o.Color(t);t=new Float32Array([e.r,e.g,e.b,1])}a.is_typedarray(t)&&t.length>4?(this.array_vec4[e]=t,this.length=Math.min(this.length,t.length/4)):this.scalar_vec4[e]=t,this.values[e]=t}this.length==1/0&&(this.length=1)}trim(e){this.array=i.mapValues(this.array,t=>t.length===e?t:t.slice(0,e)),this.array_vec3=i.mapValues(this.array_vec3,t=>t.length===3*e?t:t.slice(0,3*e)),this.array_vec4=i.mapValues(this.array_vec4,t=>t.length===4*e?t:t.slice(0,4*e)),this.length=e}ensure_array(e){const t=i.isArray(e)?e:[e];for(const e of t){if(void 0!==this.scalar[e]){(this.array[e]=new Float32Array(this.length)).fill(this.scalar[e]),delete this.scalar[e],delete this.values[e]}const t=this.scalar_vec3[e],n=this.scalar_vec4[e];if(void 0!==t){const n=this.array_vec3[e]=new Float32Array(3*this.length);for(let e=0;e<this.length;e++)n[3*e+0]=t[0],n[3*e+1]=t[1],n[3*e+2]=t[2];delete this.scalar_vec3[e],delete this.values[e]}if(void 0!==n){this.array_vec4[e]=new Float32Array(4*this.length);const t=this.array_vec4[e];for(let e=0;e<this.length;e++)t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3];delete this.scalar_vec4[e],delete this.values[e]}}}grow(e){this.array=i.mapValues(this.array,t=>{const n=new t.constructor(e);return n.set(t),n}),this.array_vec3=i.mapValues(this.array_vec3,t=>{const n=new t.constructor(3*e);return n.set(t),n}),this.length=length}pad(e){this.array=i.mapValues(this.array,(t,n)=>{const r=new t.constructor(e.length);return void 0===e.array[n]?r.fill(e.scalar[n],this.length):r.set(e.array[n].slice(this.length),this.length),r.set(t),r}),this.array_vec3=i.mapValues(this.array_vec3,(t,n)=>{const r=new t.constructor(3*e.length);if(void 0===e.array_vec3[n]){const t=e.scalar_vec3[n];for(let n=this.length;n<e.length;n++)r[3*n+0]=t[0],r[3*n+1]=t[1],r[3*n+2]=t[2]}else r.set(e.array_vec3[n].slice(3*this.length),3*this.length);return r.set(t),r}),this.array_vec4=i.mapValues(this.array_vec4,(t,n)=>{const r=new t.constructor(4*e.length);if(void 0===e.array_vec4[n]){const t=e.scalar_vec4[n];for(let n=this.length;n<e.length;n++)r[4*n+0]=t[0],r[4*n+1]=t[1],r[4*n+2]=t[2],r[4*n+3]=t[3]}else r.set(e.array_vec4[n].slice(4*this.length),4*this.length);return r.set(t),r}),this.length=e.length}select(e){const t=this.array.size=this.array.size.slice(),n=this.array.size_selected,r=this.array_vec4.color=this.array_vec4.color.slice(),i=this.array_vec4.color_selected;e.forEach((e,o)=>{o<this.length&&(t[o]=n[o],r[4*o+0]=i[4*o+0],r[4*o+1]=i[4*o+1],r[4*o+2]=i[4*o+2],r[4*o+3]=i[4*o+3])})}merge_to_vec3(e,t){const n=e.length,r=new Float32Array(this.length*n);e.forEach((e,t)=>{this.ensure_array(e);const i=this.array[e];for(let e=0;e<this.length;e++)r[e*n+t]=i[e];delete this.array[e],delete this.values[e]}),this.array_vec3[t]=r}pop(e){(i.isArray(e)?e:[e]).forEach((e,t)=>{[this.scalar,this.scalar_vec3,this.array,this.array_vec3].forEach(t=>{void 0!==t[e]&&delete t[e]})})}add_attributes(e,t=""){t=t,i.forOwn(this.array,(n,r)=>{if(-1===r.indexOf("selected")){const i=new o.InstancedBufferAttribute(n,1,!1,1);e.addAttribute(r+t,i)}}),i.forOwn(this.array_vec3,(n,r)=>{if(-1===r.indexOf("selected")){const i=new o.InstancedBufferAttribute(n,3,!1,1);i.normalized=-1!==r.indexOf("color"),e.addAttribute(r+t,i)}}),i.forOwn(this.array_vec4,(n,r)=>{if(-1===r.indexOf("selected")){const i=new o.InstancedBufferAttribute(n,4,!1,1);i.normalized=-1!==r.indexOf("color"),e.addAttribute(r+t,i)}}),i.forOwn(this.scalar,(n,r)=>{if(-1===r.indexOf("selected")){const i=new o.InstancedBufferAttribute(new Float32Array([n]),1,!1,this.length);e.addAttribute(r+t,i)}}),i.forOwn(this.scalar_vec3,(n,r)=>{if(-1===r.indexOf("selected")){const i=new o.InstancedBufferAttribute(n,3,!1,this.length);i.normalized=-1!==r.indexOf("color"),e.addAttribute(r+t,i)}}),i.forOwn(this.scalar_vec4,(n,r)=>{if(-1===r.indexOf("selected")){const i=new o.InstancedBufferAttribute(n,4,!1,this.length);i.normalized=-1!==r.indexOf("color"),e.addAttribute(r+t,i)}})}}t.Values=s,s.defaults={vx:0,vy:1,vz:0,x:0,y:0,z:0,size:0}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(5),s=n(27),c=function(e){function t(t,n){void 0===t&&(t=""),void 0===n&&(n={});var r=e.call(this)||this;return r._font=n.font||"30px Arial",r._fillStyle=n.fillStyle||"#FFFFFF",r._shadowColor=n.shadowColor||"rgba(0, 0, 0, 0)",r._shadowBlur=n.shadowBlur||0,r._shadowOffsetX=n.shadowOffsetX||0,r._shadowOffsetY=n.shadowOffsetY||0,r.canvas=new s.CanvasText,r.align=n.align||a.textAlign.center,r.side=n.side||o.DoubleSide,r.antialias=void 0===n.antialias||n.antialias,r.text=t,r}return i(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,this.updateText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this._font},set:function(e){this._font!==e&&(this._font=e,this.updateText())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillStyle",{get:function(){return this._fillStyle},set:function(e){this._fillStyle!==e&&(this._fillStyle=e,this.updateText())},enumerable:!0,configurable:!0}),t.prototype.cleanUp=function(){this.texture&&this.texture.dispose()},t.prototype.applyAntiAlias=function(){!1===this.antialias&&(this.texture.magFilter=o.NearestFilter,this.texture.minFilter=o.LinearMipMapLinearFilter)},t}(o.Object3D);t.Text2D=c},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(2)),o=n(3),a=r(n(0)),s=n(10),c=n(4),u=r(n(6)),l=n(1),h=r(n(7)),f=n(14),d={"mesh-vertex":n(41).default,"mesh-fragment":n(42).default};class p extends f.Object3DView{constructor(){super(...arguments),this.length=1}render(){if(this.figure=this.options.parent,!this.figure)throw"Mesh cannot be displayed, should be added to Figure";this.figure.model.on("change:_shaders",()=>{console.log("updating mesh shader (hot reload)"),this._update_materials()},this),this.previous_values={},this.attributes_changed={},window.last_mesh_view=this,this.meshes=[],this.texture_loader=new a.TextureLoader,this.textures=null,this.model.get("texture")&&this._load_textures(),this.uniforms=Object.assign({domain_x:{type:"2f",value:[0,1]},domain_y:{type:"2f",value:[0,1]},domain_z:{type:"2f",value:[0,1]},domain_color:{type:"2f",value:[0,1]},animation_time_x:{type:"f",value:1},animation_time_y:{type:"f",value:1},animation_time_z:{type:"f",value:1},animation_time_u:{type:"f",value:1},animation_time_v:{type:"f",value:1},animation_time_color:{type:"f",value:1},animation_time_texture:{type:"f",value:1},texture:{type:"t",value:null},texture_previous:{type:"t",value:null},colormap:{type:"t",value:null},id_offset:{type:"f",value:0},volume_texture:{type:"t",value:null},transfer_function:{type:"t",value:null},position_offset:{type:"3f",value:[0,0,0]},volume:{value:null}},a.UniformsUtils.merge([a.UniformsLib.common,a.UniformsLib.lights]));const e=e=>{if(this.model.get(e))return this.model.get(e).obj.clone();{const e=new a.ShaderMaterial;return e.side=a.DoubleSide,e.needsUpdate=!0,e}};this.material=e("material"),this.material_rgb=e("material"),this.material_id=e("material"),this.line_material=e("line_material"),this.material.polygonOffset=!0,this.material.polygonOffsetFactor=1,this.material.polygonOffsetUnits=.1,this.line_material_rgb=e("line_material"),this.line_material_id=e("line_material"),this.materials=[this.material,this.material_rgb,this.material_id,this.line_material,this.line_material_rgb,this.line_material_id],this._update_materials(),this.model.get("material")&&this.model.get("material").on("change",()=>{this._update_materials()}),this.model.get("line_material")&&this.model.get("line_material").on("change",()=>{this._update_materials()});this.model.on("change:volume",()=>{this._update_materials()},this),this._update_color_scale(),this.create_mesh(),this.add_to_scene();const t=()=>{const e=this.model.get("x_offset"),t=this.model.get("y_offset"),n=this.model.get("z_offset");this.uniforms.position_offset.value=[e,t,n],this.figure.update()};this.model.on("change:x_offset change:y_offset change:z_offset",t),t(),this.model.on("change:color change:sequence_index change:x change:y change:z change:v change:u change:triangles change:lines",this.on_change,this),this.model.on("change:geo change:connected",this.update_,this),this.model.on("change:color_scale",this._update_color_scale,this),this.model.on("change:texture",this._load_textures,this),this.model.on("change:visible change:lighting_model change:opacity change:material change:cast_shadow change:receive_shadow",this._update_materials,this)}_load_textures(){const e=this.model.get("texture");e.stream?(this.textures=null,this.texture_video=document.createElement("video"),e.stream.then(t=>{this.texture_video.srcObject=t,this.texture_video.play();new a.VideoTexture(this.texture_video);e.minFilter=a.LinearFilter,this.textures=[e],this._update_materials(),this.update_()})):this.textures=this.model.get("texture").map(e=>this.texture_loader.load(e,e=>{e.wrapS=a.RepeatWrapping,e.wrapT=a.RepeatWrapping,this._update_materials(),this.update_()}))}set_scales(e){const t={};for(const n of Object.keys(e))this.uniforms[`domain_${n}`].value=e[n].domain,t[`SCALE_TYPE_${n}`]=c.scaleTypeMap[e[n].type];o.isEqual(this.scale_defines,t)||(this.scale_defines=t,this._update_materials())}add_to_scene(){this.meshes.forEach(e=>{this.figure.rootObject.add(e)})}update_shadow(){this.meshes.forEach(e=>{e.castShadow=this.model.get("cast_shadow"),e.receiveShadow=this.model.get("receive_shadow")})}remove_from_scene(){this.meshes.forEach(e=>{this.figure.rootObject.remove(e),e.geometry.dispose()})}on_change(e){for(const e of Object.keys(this.model.changedAttributes())){this.previous_values[e]=this.model.previous(e);const t=e.replace("_selected","");if("sequence_index"===t){["x","y","z","u","v","color"].forEach(e=>{o.isArray(this.model.get(e))&&this.model.get(e).length>1&&(this.attributes_changed[e]=[e,"sequence_index"])}),this.attributes_changed.texture=["texture","sequence_index"]}else"triangles"===t||"lines"===t||("selected"===t?this.attributes_changed.color=[e]:(this.attributes_changed[t]=[e],["x","y","z","u","v","color"].indexOf(t)))}this.update_()}update_(){this.remove_from_scene(),this.create_mesh(),this.add_to_scene(),this._update_materials()}_get_value(e,t,n){if(!e)return n;if(o.isArray(e)&&!o.isNumber(e[0])){const n=t%e.length,r=e.original_data[n].shape[0];if(3===e.original_data[n].shape[1]&&o.isNumber(e[n][0])){const t=new Float32Array(4*r),i=e[n];for(let e=0;e<r;e++)t[4*e]=i[3*e],t[4*e+1]=i[3*e+1],t[4*e+2]=i[3*e+2],t[4*e+3]=1;return t}return e[n]}return e}get_current(e,t,n){return this._get_value(this.model.get(e),t,n)}get_previous(e,t,n){return"color"===e&&this.previous_values[e]&&o.isString(this.previous_values[e])?this._get_value(this.model.get(e),t,n):this._get_value(this.previous_values[e]||this.model.get(e),t,n)}_get_value_vec3(e,t,n){return e?o.isArray(e)?e[t%e.length]:e:n}get_current_vec3(e,t,n){return this._get_value_vec3(this.model.get(e),t,n)}get_previous_vec3(e,t,n){return this._get_value_vec3(this.previous_values[e]||this.model.get(e),t,n)}_update_color_scale(){const e=this.model.previous("color_scale"),t=this.model.get("color_scale");e&&(e.off("domain_changed",this._update_color_scale_domain),e.off("colors_changed",this._update_color_scale_texture)),(!e&&t||e&&!e)&&this._update_materials(),t&&(t.on("domain_changed",this._update_color_scale_domain,this),t.on("colors_changed",this._update_color_scale_texture,this),this._update_color_scale_texture(),this._update_color_scale_domain(),this.figure.update())}_update_color_scale_texture(){const e=this.model.get("color_scale");this.uniforms.colormap.value=c.createColormap(e),this.figure.update()}_update_color_scale_domain(){const e=this.model.get("color_scale"),t=this.model.get("color");if(t){let n,r;n=null!==e.min?e.min:Math.min(...t),r=null!==e.max?e.max:Math.max(...t),this.uniforms.domain_color.value=[n,r]}else null!==e.min&&null!==e.max?this.uniforms.domain_color.value=[e.min,e.max]:console.warn("no color set, and color scale does not have a min or max");this.figure.update()}_update_materials(){this.model.get("material")&&this.material.copy(this.model.get("material").obj),this.model.get("material")&&this.material_rgb.copy(this.model.get("material").obj),this.model.get("material")&&this.material_id.copy(this.model.get("material").obj),this.model.get("line_material")&&this.line_material.copy(this.model.get("line_material").obj),this.model.get("line_material")&&this.line_material_rgb.copy(this.model.get("line_material").obj),this.model.get("line_material")&&this.line_material_id.copy(this.model.get("line_material").obj),this.lighting_model=l.materialToLightingModel(this.material),this.material.defines=Object.assign({USE_COLOR:!0,USE_COLORMAP:null!==this.model.get("color_scale")},this.scale_defines),this.material.defines[`AS_${this.lighting_model}`]=!0,this.material.extensions={derivatives:!0},this.material_rgb.defines=Object.assign({AS_COORDINATE:!0,USE_COLOR:!0},this.scale_defines),this.material_id.defines=Object.assign({AS_ID:!0,USE_COLOR:!0},this.scale_defines),this.line_material.defines=Object.assign({IS_LINE:!0},this.scale_defines),this.line_material.defines[`AS_${this.lighting_model}`]=!0,this.line_material_rgb.defines=Object.assign({IS_LINE:!0,AS_COORDINATE:!0,USE_COLOR:!0},this.scale_defines),this.line_material_id.defines=Object.assign({IS_LINE:!0,AS_ID:!0,USE_COLOR:!0},this.scale_defines),this.material.visible=this.material.visible&&this.model.get("visible"),this.material_rgb.visible=this.material.visible&&this.model.get("visible"),this.material_id.visible=this.material.visible&&this.model.get("visible"),this.line_material.visible=this.line_material.visible&&this.model.get("visible"),this.line_material_rgb.visible=this.line_material.visible&&this.model.get("visible"),this.line_material_id.visible=this.line_material.visible&&this.model.get("visible");const e=this.figure.model.get("_shaders")["mesh-vertex"]||d["mesh-vertex"],t=this.figure.model.get("_shaders")["mesh-fragment"]||d["mesh-fragment"],n=.01*Math.random();this.material_depth=new s.MeshDepthMaterialCustom(()=>{const e=Object.assign({},this.material.defines);return delete e[`AS_${this.lighting_model}`],Object.assign({AS_DEPTH:!0},e)},this.uniforms,e,t,{depthPacking:a.RGBADepthPacking,alphaTest:.5+n}),this.material_distance=new s.MeshDistanceMaterialCustom(()=>{const e=Object.assign({},this.material.defines);return delete e[`AS_${this.lighting_model}`],Object.assign({AS_DISTANCE:!0},e)},this.uniforms,e,t,{alphaTest:.5+n}),this.materials.forEach(r=>{r.onBeforeCompile=n=>{n.vertexShader=c.patchShader(e),n.fragmentShader=c.patchShader(t),n.uniforms=Object.assign(Object.assign({},n.uniforms),this.uniforms)},r.alphaTest=.5+n,r.needsUpdate=!0,r.lights=!0}),this.update_shadow(),this.model.get("texture")&&this.textures&&(this.material.defines.USE_TEXTURE=!0);const r=this.model.get("volume");r&&(this.material.defines.USE_VOLUME=!0,this.uniforms.volume_texture.value=r.texture_volume,this.uniforms.transfer_function.value=r.texture_tf,this.uniforms.volume.value=r.uniform_volumes_values),this.material.needsUpdate=!0,this.material_rgb.needsUpdate=!0,this.material_id.needsUpdate=!0,this.line_material.needsUpdate=!0,this.line_material_rgb.needsUpdate=!0,this.line_material_id.needsUpdate=!0,this.surface_mesh&&(this.surface_mesh.customDepthMaterial=this.material_depth,this.surface_mesh.customDistanceMaterial=this.material_distance),this.figure.update()}create_mesh(){let e,t;this.meshes=[];let n,r,i=e=this.model.get("sequence_index"),o=t=i;void 0!==this.previous_values.sequence_index&&(o=t=this.previous_values.sequence_index),i>=o?(n=o-Math.floor(o),r=i-o,i=Math.ceil(i),(o=Math.floor(o))===t&&i===e||i-o>1&&(r=e-(o=i-1),n=0)):(n=Math.ceil(o)-o,r=o-i,i=Math.floor(i),(o=Math.ceil(o))===t&&i===e||o-i>1&&(n=0,r=(o=i+1)-e)),r>1&&0===(r%=1)&&(r=1),0===r&&(r=1);const s=["x","y","z","u","v"],c=[];this.model.get("color_scale")?s.push("color"):c.push("color");const u=new h.Values(s,[],this.get_current.bind(this),i,c),l=new h.Values(s,[],this.get_previous.bind(this),o,c);0===Math.max(u.length,l.length)&&console.error("no single member is an array, not supported (yet?)"),u.trim(u.length),l.trim(l.length);l.length,u.length;u.length>l.length?l.pad(u):u.length<l.length&&u.pad(l),u.merge_to_vec3(["x","y","z"],"vertices"),l.merge_to_vec3(["x","y","z"],"vertices"),u.ensure_array(["color"]),l.ensure_array(["color"]);let f=this.model.get("triangles");if(f){f=f[0];const e=new a.BufferGeometry;e.addAttribute("position",new a.BufferAttribute(u.array_vec3.vertices,3)),e.addAttribute("position_previous",new a.BufferAttribute(l.array_vec3.vertices,3)),this.model.get("color_scale")?(e.addAttribute("color_current",new a.BufferAttribute(u.array.color,1)),e.addAttribute("color_previous",new a.BufferAttribute(l.array.color,1))):(e.addAttribute("color_current",new a.BufferAttribute(u.array_vec4.color,4)),e.addAttribute("color_previous",new a.BufferAttribute(l.array_vec4.color,4))),e.setIndex(new a.BufferAttribute(f,1));const t=this.model.get("texture"),n=u.array.u,r=u.array.v;if(t&&n&&r&&this.textures){const t=i;this.uniforms.texture.value=this.textures[t%this.textures.length],this.uniforms.texture_previous.value=this.textures[o%this.textures.length],e.addAttribute("u",new a.BufferAttribute(n,1)),e.addAttribute("v",new a.BufferAttribute(r,1));const s=l.array.u,c=l.array.v;e.addAttribute("u_previous",new a.BufferAttribute(s,1)),e.addAttribute("v_previous",new a.BufferAttribute(c,1))}e.computeVertexNormals();this.figure.model.get("_shaders")["mesh-vertex"]||d["mesh-vertex"],this.figure.model.get("_shaders")["mesh-fragment"]||d["mesh-fragment"];this.surface_mesh=new a.Mesh(e,this.material),this.surface_mesh.name="Mesh: "+this.model.get("description"),this.surface_mesh.customDepthMaterial=this.material_depth,this.surface_mesh.customDistanceMaterial=this.material_distance,this.surface_mesh.frustumCulled=!1,this.surface_mesh.material_rgb=this.material_rgb,this.surface_mesh.material_id=this.material_id,this.surface_mesh.material_normal=this.material,this.surface_mesh.castShadow=this.model.get("cast_shadow"),this.surface_mesh.receiveShadow=this.model.get("receive_shadow"),this.meshes.push(this.surface_mesh)}const p=this.model.get("lines");if(p){const e=new a.BufferGeometry;e.addAttribute("position",new a.BufferAttribute(u.array_vec3.vertices,3)),e.addAttribute("position_previous",new a.BufferAttribute(l.array_vec3.vertices,3));let t=null,n=null;this.model.get("color_scale")?(t=new a.BufferAttribute(u.array.color,1),n=new a.BufferAttribute(l.array.color,1)):(t=new a.BufferAttribute(u.array_vec4.color,4),n=new a.BufferAttribute(l.array_vec4.color,4)),t.normalized=!0,e.addAttribute("color_current",t),n.normalized=!0,e.addAttribute("color_previous",n);const r=new Uint32Array(p[0]);e.setIndex(new a.BufferAttribute(r,1)),this.line_segments=new a.LineSegments(e,this.line_material),this.line_segments.name="Line for Mesh: "+this.model.get("description"),this.line_segments.frustumCulled=!1,this.line_segments.material_rgb=this.line_material_rgb,this.line_segments.material_id=this.line_material_id,this.line_segments.material_normal=this.line_material,this.meshes.push(this.line_segments)}else this.line_segments=null;this.update_shadow();for(const e of Object.keys(this.attributes_changed)){const t=this.attributes_changed[e],i="animation_time_"+e,o=()=>{t.forEach(e=>{delete this.previous_values[e]})};this.figure.transition(e=>{this.uniforms[i].value=n+r*e},o,this)}this.attributes_changed={}}}t.MeshView=p;class m extends i.WidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"MeshModel",_view_name:"MeshView",_model_module:"ipyvolume",_view_module:"ipyvolume",_model_module_version:l.semver_range,_view_module_version:l.semver_range,color:"red",color_scale:null,sequence_index:0,connected:!1,visible:!0,visible_lines:!0,visible_faces:!0,cast_shadow:!0,receive_shadow:!0,volume:null,x_offset:0,y_offset:0,z_offset:0,description:"mesh - noname",description_color:"red",hovered:null,icon:null,line_material:null,material:null,popup:null,clicked:null})}}t.MeshModel=m,m.serializers=Object.assign(Object.assign({},i.WidgetModel.serializers),{x:u.array_or_json,y:u.array_or_json,z:u.array_or_json,u:u.array_or_json,v:u.array_or_json,triangles:u.array_or_json,lines:u.array_or_json,color:u.color_or_json,color_scale:{deserialize:i.unpack_models},texture:u.texture,volume:{deserialize:i.unpack_models},material:{deserialize:i.unpack_models},line_material:{deserialize:i.unpack_models},popup:{deserialize:i.unpack_models}})},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(0)),o=n(4);class a extends i.MeshDepthMaterial{constructor(e,t,n,r,i){super(i),this.defines=e,this.uniforms=t,this.onBeforeCompile=e=>{const t=Object.assign({DEPTH_PACKING:3201},this.defines());let i="";for(const e of Object.keys(t))t[e]&&(i+=`#define ${e} ${t[e]}\n`);e.vertexShader=o.patchShader(i+n),e.fragmentShader=o.patchShader(i+r),e.uniforms=Object.assign(Object.assign({},e.uniforms),this.uniforms)}}}t.MeshDepthMaterialCustom=a;class s extends i.MeshDistanceMaterial{constructor(e,t,n,r,i){super(i),this.defines=e,this.uniforms=t,this.onBeforeCompile=e=>{const t=this.defines();let i="";for(const e of Object.keys(t))t[e]&&(i+=`#define ${e} ${t[e]}\n`);e.vertexShader=o.patchShader(i+n),e.fragmentShader=o.patchShader(i+r),e.uniforms=Object.assign(Object.assign({},e.uniforms),this.uniforms)}}}t.MeshDistanceMaterialCustom=s},function(e,t,n){"use strict";n.r(t),t.default="#define SCALE_TYPE_LINEAR 1\n#define SCALE_TYPE_LOG 2\n\n\n#ifdef USE_SCALE_X\n    #if SCALE_TYPE_x == SCALE_TYPE_LINEAR\n        #define SCALE_X(x) scale_transform_linear(x, vec2(-0.5, 0.5), domain_x)\n    #elif SCALE_TYPE_x == SCALE_TYPE_LOG\n        #define SCALE_X(x) scale_transform_log(x, vec2(-0.5, 0.5), domain_x)\n    #endif\n#endif\n\n#ifdef USE_SCALE_Y\n    #if SCALE_TYPE_y == SCALE_TYPE_LINEAR\n        #define SCALE_Y(x) scale_transform_linear(x, vec2(-0.5, 0.5), domain_y)\n    #elif SCALE_TYPE_y == SCALE_TYPE_LOG\n        #define SCALE_Y(x) scale_transform_log(x, vec2(-0.5, 0.5), domain_y)\n    #endif\n#endif\n\n#ifdef USE_SCALE_Z\n    #if SCALE_TYPE_z == SCALE_TYPE_LINEAR\n        #define SCALE_Z(x) scale_transform_linear(x, vec2(-0.5, 0.5), domain_z)\n    #elif SCALE_TYPE_z == SCALE_TYPE_LOG\n        #define SCALE_Z(x) scale_transform_log(x, vec2(-0.5, 0.5), domain_z)\n    #endif\n#endif\n\n#ifdef USE_SCALE_SIZE_X\n    #if SCALE_TYPE_size_x == SCALE_TYPE_LINEAR\n        #define SCALE_SIZE_X(x) scale_transform_linear(x, vec2(0.0, 1.0), domain_size_x)\n    #elif SCALE_TYPE_size_x == SCALE_TYPE_LOG\n        #define SCALE_SIZE_X(x) scale_transform_log(x, vec2(0.0, 1.0), domain_size_x)\n    #endif\n#endif\n\n#ifdef USE_SCALE_SIZE_Y\n    #if SCALE_TYPE_size_y == SCALE_TYPE_LINEAR\n        #define SCALE_SIZE_Y(x) scale_transform_linear(x, vec2(0.0, 1.0), domain_size_y)\n    #elif SCALE_TYPE_size_y == SCALE_TYPE_LOG\n        #define SCALE_SIZE_Y(x) scale_transform_log(x, vec2(0.0, 1.0), domain_size_y)\n    #endif\n#endif\n\n#ifdef USE_SCALE_SIZE_Z\n    #if SCALE_TYPE_size_z == SCALE_TYPE_LINEAR\n        #define SCALE_SIZE_Z(x) scale_transform_linear(x, vec2(0.0, 1.0), domain_size_z)\n    #elif SCALE_TYPE_size_z == SCALE_TYPE_LOG\n        #define SCALE_SIZE_Z(x) scale_transform_log(x, vec2(0.0, 1.0), domain_size_z)\n    #endif\n#endif\n\n#ifdef USE_SCALE_AUX\n    #if SCALE_TYPE_aux == SCALE_TYPE_LINEAR\n        #define SCALE_AUX(x) scale_transform_linear(x, vec2(0.0, 1.0), domain_aux)\n    #elif SCALE_TYPE_aux == SCALE_TYPE_LOG\n        #define SCALE_AUX(x) scale_transform_log(x, vec2(0.0, 1.0), domain_aux)\n    #endif\n#endif\n\nfloat scale_transform_linear(float domain_value, vec2 range, vec2 domain) {\n    float normalized = (domain_value - domain[0]) / (domain[1] - domain[0]);\n    float range_value = normalized * (range[1] - range[0]) + range[0];\n    return range_value;\n}\n\nfloat scale_transform_linear_inverse(float range_value, vec2 range, vec2 domain) {\n    float normalized = (range_value - range[0]) / (range[1] - range[0]);\n    float domain_value = normalized * (domain[1] - domain[0]) + domain[0];\n    return domain_value;\n}\n\nfloat scale_transform_log(float domain_value, vec2 range, vec2 domain) {\n    float normalized = (log(domain_value) - log(domain[0])) / (log(domain[1]) - log(domain[0]));\n    float range_value = normalized * (range[1] - range[0]) + range[0];\n    return range_value;\n}\n\nfloat scale_transform_log_inverse(float range_value, vec2 range, vec2 domain) {\n    float normalized = (range_value - range[0]) / (range[1] - range[0]);\n    float domain_value = exp(normalized * (log(domain[1]) - log(domain[0])) + log(domain[0]));\n    return domain_value;\n}\n"},function(e,t,n){var r=n(32),i=n(33),o="undefined"!=typeof Float64Array;function a(e,t){return e[0]-t[0]}function s(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(a);var r=new Array(n.length);for(e=0;e<r.length;++e)r[e]=n[e][1];return r}function c(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var i="generic"===e;if(-1===t){var o="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(o)()}if(0===t){o="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",o)(u[e][0])}o=["'use strict'"];var a=r(t),c=a.map((function(e){return"i"+e})),l="this.offset+"+a.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),h=a.map((function(e){return"b"+e})).join(","),f=a.map((function(e){return"c"+e})).join(",");o.push("function "+n+"(a,"+h+","+f+",d){this.data=a","this.shape=["+h+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+a.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+n+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),i?o.push("return this.data.set("+l+",v)}"):o.push("return this.data["+l+"]=v}"),o.push("proto.get=function "+n+"_get("+c.join(",")+"){"),i?o.push("return this.data.get("+l+")}"):o.push("return this.data["+l+"]}"),o.push("proto.index=function "+n+"_index(",c.join(),"){return "+l+"}"),o.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+a.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+a.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var d=a.map((function(e){return"a"+e+"=this.shape["+e+"]"})),p=a.map((function(e){return"c"+e+"=this.stride["+e+"]"}));o.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+p.join(","));for(var m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");o.push("return new "+n+"(this.data,"+a.map((function(e){return"a"+e})).join(",")+","+a.map((function(e){return"c"+e})).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+a.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+a.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");o.push("return new "+n+"(this.data,"+a.map((function(e){return"a"+e})).join(",")+","+a.map((function(e){return"b"+e})).join(",")+",c)}");var g=new Array(t),v=new Array(t);for(m=0;m<t;++m)g[m]="a[i"+m+"]",v[m]="b[i"+m+"]";o.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+g.join(",")+","+v.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+a.map((function(e){return"shape["+e+"]"})).join(",")+","+a.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(u[e],s)}var u={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};e.exports=function(e,t,n,r){if(void 0===e)return(0,u.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var a=t.length;if(void 0===n){n=new Array(a);for(var s=a-1,l=1;s>=0;--s)n[s]=l,l*=t[s]}if(void 0===r){r=0;for(s=0;s<a;++s)n[s]<0&&(r-=(t[s]-1)*n[s])}for(var h=function(e){if(i(e))return"buffer";if(o)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}(e),f=u[h];f.length<=a+1;)f.push(c(h,f.length-1));return(0,f[a+1])(e,t,n,r)}},function(e,t,n){"use strict";var r=n(12),i=n(36);e.exports=function(e,t){for(var n=[],o=e,a=1;Array.isArray(o);)n.push(o.length),a*=o.length,o=o[0];return 0===n.length?r():(t||(t=r(new Float64Array(a),n)),i(t,e),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);class i extends r.WidgetView{constructor(){super(...arguments),this.id_offset=0}onHover(e){const t=e-this.uniforms.id_offset.value;t>=0&&t<this.length?(this.model.set("hovered_index",t),this.model.set("hovered",!0)):(this.model.set("hovered_index",null),this.model.set("hovered",!1)),this.model.save_changes()}onClick(e){const t=e-this.uniforms.id_offset.value;t>=0&&t<this.length?(this.model.set("clicked_index",t),this.model.set("clicked",!0)):(this.model.set("clicked_index",null),this.model.set("clicked",!1)),this.model.save_changes()}async popup(e,t,n,r){const i=e-this.uniforms.id_offset.value;if(i>=0&&i<this.length){const e=this.model.get("popup");e&&(this.popupView||(this.popupView=await this.options.parent.create_child_view(e)),r.contains(this.popupView.el)||(r.innerHTML="",r.appendChild(this.popupView.el)),this.popupView.trigger("displayed"),e.set("description",this.model.get("description")),e.set("value",i),e.set("color",this.model.get("description_color")),e.set("icon",this.model.get("icon")),e.save_changes())}else this.popupView&&r.contains(this.popupView.el)&&(r.innerHTML="")}}t.Object3DView=i},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(2)),o=n(3),a=r(n(0)),s=n(10),c=n(14),u=n(4),l=r(n(6)),h=n(1),f=r(n(7)),d=n(43),p={"scatter-vertex":n(44).default,"scatter-fragment":n(45).default};class m extends c.Object3DView{render(){if(this.figure=this.options.parent,this.figure=this.options.parent,!this.figure)throw"Scatter cannot be displayed, should be added to Figure";this.figure.model.on("change:_shaders",()=>{console.log("updating scatter shader (hot reload)"),this._update_materials()},this),this.previous_values={},this.attributes_changed={},window.last_scatter=this,this.texture_loader=new a.TextureLoader,this.textures=null,this.model.get("texture")&&this._load_textures();const e=new a.SphereGeometry(1,2,2),t=new a.SphereBufferGeometry(.5,12,12),n=new a.BoxGeometry(1,1,1),r=new a.Geometry;for(const e of d.vertices){const t=new a.Vector3(e[1],e[2],e[0]);r.vertices.push(t)}let i=0;for(;i<d.indices.length;){const e=[];let t=0,n=!1;for(;!n;)e.push(d.indices[i]),t++,d.indices[i]<0&&(n=!0),i++;e[t-1]=-1-e[t-1];for(let t=0;t<e.length-2;t++){const n=new a.Face3(e[0],e[1+t],e[2+t]);r.faces.push(n)}}const s=new a.PlaneGeometry(2,2,1,1),c=new a.PlaneGeometry(.1,.1,1,1),l=new a.CircleGeometry(1,3,Math.PI/2),h=new a.CircleGeometry(1,32,Math.PI/2),f=new a.CylinderBufferGeometry(0,.2,1),p=new a.CylinderGeometry(.5,.5,1),m=new a.CylinderGeometry(.5,.5,1,100);this.geos={diamond:(new a.BufferGeometry).fromGeometry(e),box:(new a.BufferGeometry).fromGeometry(n),arrow:f,cylinder:(new a.BufferGeometry).fromGeometry(p),cylinder_hr:(new a.BufferGeometry).fromGeometry(m),sphere:t,cat:(new a.BufferGeometry).fromGeometry(r),square_2d:(new a.BufferGeometry).fromGeometry(s),point_2d:(new a.BufferGeometry).fromGeometry(c),circle_2d:(new a.BufferGeometry).fromGeometry(h),triangle_2d:(new a.BufferGeometry).fromGeometry(l)},this.uniforms=Object.assign({domain_x:{type:"2f",value:[0,1]},domain_y:{type:"2f",value:[0,1]},domain_z:{type:"2f",value:[0,1]},domain_size_x:{type:"2f",value:[0,1]},domain_size_y:{type:"2f",value:[0,1]},domain_size_z:{type:"2f",value:[0,1]},domain_aux:{type:"2f",value:[0,1]},domain_color:{type:"2f",value:[0,1]},animation_time_x:{type:"f",value:1},animation_time_y:{type:"f",value:1},animation_time_z:{type:"f",value:1},animation_time_aux:{type:"f",value:1},animation_time_vx:{type:"f",value:1},animation_time_vy:{type:"f",value:1},animation_time_vz:{type:"f",value:1},animation_time_size:{type:"f",value:1},animation_time_color:{type:"f",value:1},geo_matrix:{type:"mat4",value:this.model.get("geo_matrix")},aspect:{type:"vec3",value:[1,1,1]},texture:{type:"t",value:null},texture_previous:{type:"t",value:null},colormap:{type:"t",value:null},id_offset:{type:"f",value:0}},a.UniformsUtils.merge([a.UniformsLib.common,a.UniformsLib.lights]));const g=e=>this.model.get(e)?this.model.get(e).obj.clone():new a.ShaderMaterial;this.material=g("material"),this.material_rgb=g("material"),this.material_id=g("material"),this.line_material=g("line_material"),this.line_material_rgb=g("line_material"),this.line_material_id=g("line_material"),this.materials=[this.material,this.material_id,this.material_rgb,this.line_material,this.line_material_id,this.line_material_rgb],this._update_materials(),this.model.get("material")&&this.model.get("material").on("change",()=>{this._update_materials()}),this.model.get("line_material")&&this.model.get("line_material").on("change",()=>{this._update_materials()}),this.model.on("change:geo_matrix",()=>{this.uniforms.geo_matrix.value=this.model.get("geo_matrix"),this._update_materials(),this.figure.update()}),this.model.on("change:shader_snippets",()=>{this._update_materials(),this.figure.update()}),this._update_color_scale(),this.create_mesh(),this.add_to_scene(),this.model.on("change:size change:size_selected change:color change:color_selected change:sequence_index change:x change:y change:z change:aux change:selected change:vx change:vy change:vz",this.on_change,this),this.model.on("change:geo change:connected",this.update_,this),this.model.on("change:color_scale",this._update_color_scale,this),this.model.on("change:texture",this._load_textures,this),this.model.on("change:visible",this._update_materials,this),this.model.on("change:geo",()=>{this._update_materials()});const v=e=>{const t=e+"_scale",n="domain_"+e,r=()=>{const e=this.model.get(t);let r=0,i=100;e&&(null!==e.min&&(r=e.min),null!==e.max&&(i=e.max)),this.uniforms[n].value=[r,i],this.mesh&&this.figure.update()};return r(),()=>{const n=this.model.previous(t),i=this.model.get(t);n&&n.off("domain_changed",r);const a=Object.assign({},this.scale_defines);a[`SCALE_TYPE_${e}`]=u.scaleTypeMap[i?i.type:"linear"];const s=!o.isEqual(this.scale_defines,a);this.scale_defines=a,(!n&&i||n&&!n||s)&&this._update_materials(),i&&(i.on("domain_changed",r,this),r(),this.figure.update())}};["size_x","size_y","size_z","aux"].forEach(e=>{const t=v(e);t(),this.model.on(`change:${e}_scale`,t,this)}),this.model.on("change:material",this._update_materials,this),this.model.on("change:cast_shadow change:receive_shadow",this.update_,this)}_load_textures(){const e=this.model.get("texture");e.stream?(this.textures=null,this.texture_video=document.createElement("video"),e.stream.then(t=>{this.texture_video.src=window.URL.createObjectURL(t),new a.VideoTexture(this.texture_video).minFilter=a.LinearFilter,this.textures=[e],this.update_()})):this.textures=this.model.get("texture").map(e=>this.texture_loader.load(e,e=>{e.wrapS=a.RepeatWrapping,e.wrapT=a.RepeatWrapping,this.update_()}))}set_scales(e){const t=Object.assign({},this.scale_defines);for(const n of Object.keys(e))this.uniforms[`domain_${n}`].value=e[n].domain,t[`SCALE_TYPE_${n}`]=u.scaleTypeMap[e[n].type];o.isEqual(this.scale_defines,t)||(this.scale_defines=t,this._update_materials())}add_to_scene(){this.figure.rootObject.add(this.mesh),this.line_segments&&this.figure.rootObject.add(this.line_segments)}remove_from_scene(){-1===this.figure.rootObject.children.indexOf(this.mesh)&&console.warn("trying to removing scatter mesh from scene that does not include it"),this.figure.rootObject.remove(this.mesh),this.mesh.geometry.dispose(),this.line_segments&&(this.figure.rootObject.remove(this.line_segments),this.line_segments.geometry.dispose())}on_change(){for(const e of Object.keys(this.model.changedAttributes())){this.previous_values[e]=this.model.previous(e);const t=e.replace("_selected","");if("sequence_index"===t){["x","y","z","aux","vx","vy","vz","size","color"].forEach(e=>{o.isArray(this.model.get(e))&&(this.attributes_changed[e]=[e,"sequence_index"])})}else"geo"===t||("selected"===t?(this.attributes_changed.color=[e],this.attributes_changed.size=[]):(this.attributes_changed[t]=[e],-1!==["x","y","z","aux","vx","vy","vz","color"].indexOf(t)&&(this.attributes_changed.size=[])))}this.update_()}update_(){this.remove_from_scene(),this.create_mesh(),this.add_to_scene(),this.figure.update()}_get_value(e,t,n){return e?o.isArray(e)&&!o.isNumber(e[0])?e[t%e.length]:e:n}get_next(e,t,n){return this._get_value(this.model.get(e),t,n)}get_previous(e,t,n){return this._get_value(this.previous_values[e]||this.model.get(e),t,n)}_get_value_vec3(e,t,n){return e?o.isArray(e)?e[t%e.length]:e:n}get_next_vec3(e,t,n){return this._get_value_vec3(this.model.get(e),t,n)}get_previous_vec3(e,t,n){return this._get_value_vec3(this.previous_values[e]||this.model.get(e),t,n)}_update_color_scale(){const e=this.model.previous("color_scale"),t=this.model.get("color_scale");e&&(e.off("domain_changed",this._update_color_scale_domain),e.off("colors_changed",this._update_color_scale_texture)),(!e&&t||e&&!e)&&this._update_materials(),t&&(t.on("domain_changed",this._update_color_scale_domain,this),t.on("colors_changed",this._update_color_scale_texture,this),this._update_color_scale_texture(),this._update_color_scale_domain(),this.figure.update()),this.mesh&&this.update_()}_update_color_scale_texture(){const e=this.model.get("color_scale");this.uniforms.colormap.value=u.createColormap(e),this.figure.update()}_update_color_scale_domain(){const e=this.model.get("color_scale"),t=this.model.get("color");if(t){let n,r;n=null!==e.min?e.min:Math.min(...t),r=null!==e.max?e.max:Math.max(...t),this.uniforms.domain_color.value=[n,r]}else null!==e.min&&null!==e.max?this.uniforms.domain_color.value=[e.min,e.max]:console.warn("no color set, and color scale does not have a min or max");this.figure.update()}_update_materials(){this.model.get("material")&&this.material.copy(this.model.get("material").obj),this.model.get("material")&&this.material_rgb.copy(this.model.get("material").obj),this.model.get("line_material")&&this.line_material.copy(this.model.get("line_material").obj),this.model.get("line_material")&&(this.line_material_rgb.copy(this.model.get("line_material").obj),this.line_material_rgb.linewidth=this.line_material.linewidth=this.model.get("line_material").obj.linewidth),this.lighting_model=h.materialToLightingModel(this.material);const e=this.model.get("shader_snippets"),t={};for(const n of Object.keys(e))t["SHADER_SNIPPET_"+n.toUpperCase()]=e[n];this.material.defines=Object.assign(Object.assign({USE_COLOR:!0,USE_COLORMAP:null!==this.model.get("color_scale")},this.scale_defines),t),this.material.defines[`AS_${this.lighting_model}`]=!0,this.material.extensions={derivatives:!0},this.material_id.defines=Object.assign(Object.assign({AS_ID:!0,USE_COLOR:!0},this.scale_defines),t),this.material_id.extensions={derivatives:!0},this.material_rgb.defines=Object.assign(Object.assign({AS_COORDINATE:!0,USE_COLOR:!0},this.scale_defines),t),this.material_rgb.extensions={derivatives:!0},this.line_material.defines=Object.assign(Object.assign({IS_LINE:!0,USE_COLOR:!0},this.scale_defines),t),this.line_material.defines[`AS_${this.lighting_model}`]=!0,this.line_material_rgb.defines={AS_COORDINATE:!0,IS_LINE:!0,USE_COLOR:!0},this.line_material_id.defines={AS_ID:!0,IS_LINE:!0,USE_COLOR:!0},this.material.visible=this.material.visible&&this.model.get("visible"),this.material_rgb.visible=this.material.visible&&this.model.get("visible"),this.material_id.visible=this.material.visible&&this.model.get("visible"),this.line_material.visible=this.line_material.visible&&this.model.get("visible"),this.line_material_rgb.visible=this.line_material.visible&&this.model.get("visible"),this.line_material_id.visible=this.line_material.visible&&this.model.get("visible");const n=this.figure.model.get("_shaders")["scatter-vertex"]||p["scatter-vertex"],r=this.figure.model.get("_shaders")["scatter-fragment"]||p["scatter-fragment"],i=.01*Math.random();this.material_depth=new s.MeshDepthMaterialCustom(()=>{const e=Object.assign({},this.material.defines);return delete e[`AS_${this.lighting_model}`],this.model.get("geo").endsWith("2d")&&(e.AS_SPRITE=!0),Object.assign({AS_DEPTH:!0},e)},this.uniforms,n,r,{depthPacking:a.RGBADepthPacking,alphaTest:.5+i}),this.material_distance=new s.MeshDistanceMaterialCustom(()=>{const e=Object.assign({},this.material.defines);return delete e[`AS_${this.lighting_model}`],this.model.get("geo").endsWith("2d")&&(e.AS_SPRITE=!0),Object.assign({AS_DISTANCE:!0},e)},this.uniforms,n,r,{alphaTest:.5+i}),this.materials.forEach(e=>{e.onBeforeCompile=e=>{e.vertexShader=u.patchShader(n),e.fragmentShader=u.patchShader(r),e.uniforms=Object.assign(Object.assign({},e.uniforms),this.uniforms)},e.alphaTest=.5+i,e.needsUpdate=!0,e.lights=!0,this.model.get("aux")&&(e.defines.USE_AUX=!0)});const o=this.model.get("geo").endsWith("2d");if(o&&(this.material.defines.USE_SPRITE=!0,this.material_rgb.defines.USE_SPRITE=!0,this.material_id.defines.USE_SPRITE=!0),o){this.model.get("texture")&&this.textures&&(this.material.defines.USE_TEXTURE=!0)}this.material.needsUpdate=!0,this.material_rgb.needsUpdate=!0,this.material_id.needsUpdate=!0,this.line_material.needsUpdate=!0,this.line_material_rgb.needsUpdate=!0,this.line_material_id.needsUpdate=!0,this.mesh&&(this.mesh.customDepthMaterial=this.material_depth,this.mesh.customDistanceMaterial=this.material_distance),this.figure.update()}create_mesh(){let e=this.model.get("geo");e||(e="diamond");const t=e.endsWith("2d"),n=this.geos[e],r=new a.InstancedBufferGeometry,i=n.attributes.position.clone();r.addAttribute("position",i),n.index&&(r.index=n.index),r.computeVertexNormals();const o=this.model.get("sequence_index");let s=this.previous_values.sequence_index;void 0===s&&(s=o);const c=["x","y","z","aux","vx","vy","vz","size","size_selected"],u=[];this.model.get("color_scale")?c.push("color","color_selected"):u.push("color","color_selected");const l=new f.Values(c,[],this.get_next.bind(this),o,u),h=new f.Values(c,[],this.get_previous.bind(this),s,u);0===Math.max(l.length,h.length)&&console.error("no single member is an array, not supported (yet?)"),l.trim(l.length),h.trim(h.length);const d=h.length,p=l.length;if(this.model.get("selected")||this.previous_values.selected){l.ensure_array(["size","size_selected","color","color_selected"]),h.ensure_array(["size","size_selected","color","color_selected"]);let e=this.get_next("selected",o,[]);l.select(e),e=this.get_previous("selected",s,[]),h.select(e)}l.length!==h.length&&(l.ensure_array("size"),h.ensure_array("size")),l.length>h.length?(h.pad(l),h.array.size.fill(0,d)):l.length<h.length&&(l.pad(h),l.array.size.fill(0,p)),this.length=l.length,l.merge_to_vec3(["vx","vy","vz"],"v"),h.merge_to_vec3(["vx","vy","vz"],"v"),l.pop(["size_selected","color_selected"]),h.pop(["size_selected","color_selected"]),l.add_attributes(r,"_next"),h.add_attributes(r,"_previous");const m=new Float32Array(l.length);for(let e=0;e<l.length;e++)m[e]=e;const g=new a.InstancedBufferAttribute(m,1,!1,1);if(r.addAttribute("instance_id",g),t){this.model.get("texture")&&this.textures&&(this.material.uniforms.texture.value=this.textures[o%this.textures.length],this.material.uniforms.texture_previous.value=this.textures[s%this.textures.length])}if(this.mesh=new a.Mesh(r,this.material),this.mesh.castShadow=this.model.get("cast_shadow"),this.mesh.receiveShadow=this.model.get("receive_shadow"),this.mesh.customDepthMaterial=this.material_depth,this.mesh.customDistanceMaterial=this.material_distance,this.mesh.material_id=this.material_id,this.mesh.material_rgb=this.material_rgb,this.mesh.material_normal=this.material,this.model.get("connected")){const e=new a.BufferGeometry;l.merge_to_vec3(["x","y","z"],"vertices"),h.merge_to_vec3(["x","y","z"],"vertices"),e.addAttribute("position",new a.BufferAttribute(l.array_vec3.vertices,3)),e.addAttribute("position_previous",new a.BufferAttribute(h.array_vec3.vertices,3)),l.ensure_array(["color"]),h.ensure_array(["color"]),this.model.get("color_scale")?(e.addAttribute("color_next",new a.BufferAttribute(l.array.color,1)),e.addAttribute("color_previous",new a.BufferAttribute(h.array.color,1))):(e.addAttribute("color_next",new a.BufferAttribute(l.array_vec4.color,4)),e.addAttribute("color_previous",new a.BufferAttribute(h.array_vec4.color,4))),e.computeVertexNormals(),this.line_segments=new a.Line(e,this.line_material),this.line_segments.frustumCulled=!1,this.line_segments.castShadow=this.model.get("cast_shadow"),this.line_segments.receiveShadow=this.model.get("receive_shadow")}else this.line_segments=null;for(const e of Object.keys(this.attributes_changed)){const t=this.attributes_changed[e],n="animation_time_"+e,r=()=>{t.forEach(e=>{delete this.previous_values[e]})},i=e=>{this.uniforms[n].value=e};this.figure.transition(i,r,this)}this.attributes_changed={}}}t.ScatterView=m;class g extends i.WidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"ScatterModel",_view_name:"ScatterView",_model_module:"ipyvolume",_view_module:"ipyvolume",_model_module_version:h.semver_range,_view_module_version:h.semver_range,size:5,size_selected:7,color:"red",color_scale:null,color_selected:"white",geo:"diamond",geo_matrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],sequence_index:0,connected:!1,visible:!0,selected:null,shader_snippets:{size:"\n"},cast_shadow:!0,receive_shadow:!0})}}t.ScatterModel=g,g.serializers=Object.assign(Object.assign({},i.WidgetModel.serializers),{x:l.array_or_json,y:l.array_or_json,z:l.array_or_json,aux:l.array_or_json,aux_scale:{deserialize:i.unpack_models},vx:l.array_or_json,vy:l.array_or_json,vz:l.array_or_json,selected:l.array_or_json,size:l.array_or_json,size_selected:l.array_or_json,size_x_scale:{deserialize:i.unpack_models},size_y_scale:{deserialize:i.unpack_models},size_z_scale:{deserialize:i.unpack_models},color:l.color_or_json,color_scale:{deserialize:i.unpack_models},color_selected:l.color_or_json,texture:l.texture,material:{deserialize:i.unpack_models},line_material:{deserialize:i.unpack_models},popup:{deserialize:i.unpack_models}})},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(2)),o=n(3),a=r(n(0)),s=n(4),c=n(1),u={box_fragment:n(17).default,box_vertex:n(18).default};class l extends i.WidgetView{render(){this.renderer=this.options.parent,this.attributes_changed={},this.data=[];this.renderer.getRenderSize();this.texture_loader=new a.TextureLoader,this.tf_set(),this.data_set();const e=()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};this.model.on("change:rendering_method",e),e(),this.model.on("change:data",this.data_set,this);const t=()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};this.model.on("change:data_min change:data_max change:show_min change:show_max",t,this),t();const n=()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};this.model.on("change:clamp_min change:clamp_max",n,this),n();const r=()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};r(),this.model.on("change:opacity_scale",r);const i=()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};i(),this.model.on("change:lighting",i);const o=()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};o(),this.model.on("change:ray_steps",o);const s=()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};s(),this.model.on("change:brightness",s),this.model.on("change:tf",this.tf_set,this),this.model.on("change:extent",()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()});const c=()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};c(),this.model.get("material").on("change",c),this.model.on("change:visible",()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()}),window.last_volume=this}get_ray_steps(){let e=this.model.get("ray_steps");return null==e&&(e=o.max(this.data_shape)),e}data_set(){this.volume=this.model.volume,this.texture_volume=this.model.texture_volume,this.data_shape=[this.volume.slice_shape[0],this.volume.slice_shape[1],this.volume.slices],this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()}tf_set(){this.model.get("tf")&&(this.model.get("tf").on("change:rgba",this.tf_changed,this),this.tf_changed())}tf_changed(){this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()}set_scales(e){this.model.set_scales(e)}}t.VolumeView=l;class h extends i.WidgetModel{initialize(e,t){super.initialize(e,t);const n=()=>{if(this.volume=this.get("data"),!this.volume)return;const e=new Uint8Array(this.volume.tiles.buffer);this.texture_volume=new a.DataTexture(e,this.volume.image_shape[0],this.volume.image_shape[1],a.RGBAFormat,a.UnsignedByteType),this.texture_volume.magFilter=a.LinearFilter,this.texture_volume.minFilter=a.LinearFilter,this.uniform_volumes_values.rows=this.volume.rows,this.uniform_volumes_values.columns=this.volume.columns,this.uniform_volumes_values.slices=this.volume.slices,this.uniform_volumes_values.size=this.volume.image_shape,this.uniform_volumes_values.slice_size=this.volume.slice_shape,this.uniform_volumes_values.data_range=[this.get("data_min"),this.get("data_max")],this.uniform_volumes_values.show_range=[this.get("show_min"),this.get("show_max")],this.texture_volume.needsUpdate=!0,this.uniform_data.value=[this.texture_volume],this.uniform_data.value=[this.texture_volume]};this.on("change:data",()=>{n()}),this.uniform_volumes_values={scale:[1,1,1],offset:[0,0,0]},this.uniform_data={type:"tv",value:[]},n();this.on("change:data_min change:data_max change:show_min change:show_max",()=>{this.uniform_volumes_values.data_range=[this.get("data_min"),this.get("data_max")],this.uniform_volumes_values.show_range=[this.get("show_min"),this.get("show_max")]},this);const r=()=>{this.uniform_volumes_values.clamp_min=this.get("clamp_min"),this.uniform_volumes_values.clamp_max=this.get("clamp_max")};this.on("change:clamp_min change:clamp_max",r,this),r();const i=()=>{this.uniform_volumes_values.opacity_scale=this.get("opacity_scale")};i(),this.on("change:opacity_scale",i);const o=()=>{this.uniform_volumes_values.lighting=this.get("lighting")};o(),this.on("change:lighting",o);const s=()=>{this.uniform_volumes_values.brightness=this.get("brightness")};s(),this.on("change:brightness",s);const c=()=>{const e=this.get("material").obj,t=new a.Color("white");this.uniform_volumes_values.diffuseColor=e.color||t,this.uniform_volumes_values.specular=e.specular||t,this.uniform_volumes_values.shininess=e.shininess||t,this.uniform_volumes_values.emissive=e.emissive||t};c(),this.get("material").on("change",c),this.box_material=new a.ShaderMaterial({uniforms:{offset:{type:"3f",value:[0,0,0]},scale:{type:"3f",value:[1,1,1]}},fragmentShader:u.box_fragment,vertexShader:u.box_vertex,side:a.BackSide}),this.vol_box_mesh=new a.Mesh(this.vol_box_geo,this.box_material),this.vol_box_mesh.name="Box for "+this.get("description"),this.vol_box_geo=new a.BoxBufferGeometry(1,1,1),this.vol_box_mesh.isVolume=!0,this.vol_box_mesh.updateMatrix(),this.vol_box_mesh.matrixAutoUpdate=!0,this.uniform_transfer_function={type:"tv",value:[]},this.on("change:tf",this.tf_set,this),this.tf_set()}tf_set(){this.get("tf")&&(this.get("tf").on("change:rgba",this.tf_changed,this),this.tf_changed())}tf_changed(){const e=this.get("tf");e&&(this.texture_tf=new a.DataTexture(e.get_data_array(),e.get("rgba").shape[0],1,a.RGBAFormat,a.UnsignedByteType),this.texture_tf.needsUpdate=!0,this.uniform_transfer_function.value=[this.texture_tf])}is_max_intensity(){return"MAX_INTENSITY"===this.get("rendering_method")}is_normal(){return"NORMAL"===this.get("rendering_method")}set_scales(e){const t=s.createD3Scale(e.x).range([0,1]),n=s.createD3Scale(e.y).range([0,1]),r=s.createD3Scale(e.z).range([0,1]),i=this.get("extent"),o=t(i[0][0]),c=t(i[0][1]),u=n(i[1][0]),l=n(i[1][1]),h=r(i[2][0]),f=r(i[2][1]),d=Math.max(o,0),p=Math.min(c,1),m=Math.max(u,0),g=Math.min(l,1),v=Math.max(h,0),_=Math.min(f,1);this.box_geo=new a.BoxBufferGeometry(1,1,1),this.box_geo.translate(.5,.5,.5),this.box_geo.scale(p-d,g-m,_-v),this.box_geo.translate(d,m,v),this.box_geo.translate(-.5,-.5,-.5),this.vol_box_mesh.geometry=this.box_geo,this.uniform_volumes_values.scale=[1/(c-o),1/(l-u),1/(f-h)],this.uniform_volumes_values.offset=[-o,-u,-h]}add_to_scene(e){e.add(this.vol_box_mesh)}remove_from_scene(e){e.remove(this.vol_box_mesh)}defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"VolumeModel",_view_name:"VolumeView",_model_module:"ipyvolume",_view_module:"ipyvolume",_model_module_version:c.semver_range,_view_module_version:c.semver_range,sequence_index:0,step_size:.01,opacity_scale:1,brightness:1,extent:null,lighting:!0,rendering_method:"NORMAL",clamp_min:!1,clamp_max:!1,data_range:null,show_range:null,show_min:0,show_max:1,data_min:0,data_max:1,ray_steps:null,material:null,visible:!0})}}t.VolumeModel=h,h.serializers=Object.assign(Object.assign({},i.WidgetModel.serializers),{tf:{deserialize:i.unpack_models},data:{serialize:e=>e},material:{deserialize:i.unpack_models}})},function(e,t,n){"use strict";n.r(t),t.default="varying vec4 vertex_color;\n\nvoid main(void) {\n    gl_FragColor = vertex_color;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="varying vec4 vertex_color;\nuniform vec3 scale;\nuniform vec3 offset;\n\nvoid main(void) {\n    vec3 pos = position;\n    gl_Position = projectionMatrix *\n                modelViewMatrix *\n                vec4(pos,1.0);\n    //vertex_color = vec4((pos + vec3(0.5, 0.5, 0.5))*scale + offset, 1);\n    vertex_color = vec4((pos + vec3(0.5, 0.5, 0.5)), 1);\n}\n"},function(e,t,n){"use strict";function r(e,t,n){return[e[0]/t*2-1,1-e[1]/n*2]}Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.canvas=e,this.points=[]}mouseMove(e,t){this.points.push([e,t])}close(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}draw(){const e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),e.lineWidth=1.5,e.strokeStyle="rgba(255, 0, 0, 1)",e.fillStyle="rgba(255, 0, 0, 0.5)",e.beginPath();for(const t of this.points)e.lineTo(t[0],t[1]);e.closePath(),e.fill(),e.stroke()}getData(e,t){return{type:"lasso",pixel:this.points,device:this.points.map(n=>r(n,e,t))}}}t.LassoSelector=i;class o{constructor(e){this.canvas=e,this.points=[],this.begin=null,this.end=null}mouseMove(e,t){this.begin?this.end=[e,t]:this.begin=[e,t]}close(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.begin=null,this.end=null}draw(){if(this.begin&&this.end){const e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),e.lineWidth=1.5,e.strokeStyle="rgba(255, 0, 0, 1)",e.fillStyle="rgba(255, 0, 0, 0.5)",e.beginPath();const t=this.begin[0]-this.end[0],n=this.begin[1]-this.end[1],r=Math.sqrt(t*t+n*n);e.arc(this.begin[0],this.begin[1],r,0,2*Math.PI),e.fill(),e.stroke()}}getData(e,t){return{type:"circle",pixel:{begin:this.begin,end:this.end},device:{begin:r(this.begin,e,t),end:r(this.end,e,t)}}}}t.CircleSelector=o;class a{constructor(e){this.canvas=e,this.points=[],this.begin=null,this.end=null}mouseMove(e,t){this.begin?this.end=[e,t]:this.begin=[e,t]}close(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.begin=null,this.end=null}draw(){if(this.begin&&this.end){const e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),e.lineWidth=1.5,e.strokeStyle="rgba(255, 0, 0, 1)",e.fillStyle="rgba(255, 0, 0, 0.5)",e.beginPath(),e.rect(this.begin[0],this.begin[1],this.end[0]-this.begin[0],this.end[1]-this.begin[1]),e.fill(),e.stroke()}}getData(e,t){return{type:"rectangle",pixel:{begin:this.begin,end:this.end},device:{begin:r(this.begin,e,t),end:r(this.end,e,t)}}}}t.RectangleSelector=a,t.selectors={lasso:i,circle:o,rectangle:a}},function(e,t,n){"use strict";n.r(t);var r=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},i=function(e){var t;return 1===e.length&&(t=e,e=function(e,n){return r(t(e),n)}),{left:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)<0?r=o+1:i=o}return r},right:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)>0?i=o:r=o+1}return r}}};var o=i(r),a=o.right,s=o.left,c=a,u=function(e,t){null==t&&(t=l);for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return o};function l(e,t){return[e,t]}var h=function(e,t,n){var r,i,o,a,s=e.length,c=t.length,u=new Array(s*c);for(null==n&&(n=l),r=o=0;r<s;++r)for(a=e[r],i=0;i<c;++i,++o)u[o]=n(a,t[i]);return u},f=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},d=function(e){return null===e?NaN:+e},p=function(e,t){var n,r,i=e.length,o=0,a=-1,s=0,c=0;if(null==t)for(;++a<i;)isNaN(n=d(e[a]))||(c+=(r=n-s)*(n-(s+=r/++o)));else for(;++a<i;)isNaN(n=d(t(e[a],a,e)))||(c+=(r=n-s)*(n-(s+=r/++o)));if(o>1)return c/(o-1)},m=function(e,t){var n=p(e,t);return n?Math.sqrt(n):n},g=function(e,t){var n,r,i,o=e.length,a=-1;if(null==t){for(;++a<o;)if(null!=(n=e[a])&&n>=n)for(r=i=n;++a<o;)null!=(n=e[a])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++a<o;)if(null!=(n=t(e[a],a,e))&&n>=n)for(r=i=n;++a<o;)null!=(n=t(e[a],a,e))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]},v=Array.prototype,_=v.slice,y=v.map,x=function(e){return function(){return e}},b=function(e){return e},w=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o},E=Math.sqrt(50),M=Math.sqrt(10),S=Math.sqrt(2),T=function(e,t,n){var r,i,o,a,s=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(a=A(e,t,n))||!isFinite(a))return[];if(a>0)for(e=Math.ceil(e/a),t=Math.floor(t/a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(e+s)*a;else for(e=Math.floor(e*a),t=Math.ceil(t*a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(e-s)/a;return r&&o.reverse(),o};function A(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=E?10:o>=M?5:o>=S?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=E?10:o>=M?5:o>=S?2:1)}function L(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=E?i*=10:o>=M?i*=5:o>=S&&(i*=2),t<e?-i:i}var C=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1},R=function(){var e=b,t=g,n=C;function r(r){var i,o,a=r.length,s=new Array(a);for(i=0;i<a;++i)s[i]=e(r[i],i,r);var u=t(s),l=u[0],h=u[1],f=n(s,l,h);Array.isArray(f)||(f=L(l,h,f),f=w(Math.ceil(l/f)*f,h,f));for(var d=f.length;f[0]<=l;)f.shift(),--d;for(;f[d-1]>h;)f.pop(),--d;var p,m=new Array(d+1);for(i=0;i<=d;++i)(p=m[i]=[]).x0=i>0?f[i-1]:l,p.x1=i<d?f[i]:h;for(i=0;i<a;++i)l<=(o=s[i])&&o<=h&&m[c(f,o,0,d)].push(r[i]);return m}return r.value=function(t){return arguments.length?(e="function"==typeof t?t:x(t),r):e},r.domain=function(e){return arguments.length?(t="function"==typeof e?e:x([e[0],e[1]]),r):t},r.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?x(_.call(e)):x(e),r):n},r},P=function(e,t,n){if(null==n&&(n=d),r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}},O=function(e,t,n){return e=y.call(e,d).sort(r),Math.ceil((n-t)/(2*(P(e,.75)-P(e,.25))*Math.pow(e.length,-1/3)))},N=function(e,t,n){return Math.ceil((n-t)/(3.5*m(e)*Math.pow(e.length,-1/3)))},I=function(e,t){var n,r,i=e.length,o=-1;if(null==t){for(;++o<i;)if(null!=(n=e[o])&&n>=n)for(r=n;++o<i;)null!=(n=e[o])&&n>r&&(r=n)}else for(;++o<i;)if(null!=(n=t(e[o],o,e))&&n>=n)for(r=n;++o<i;)null!=(n=t(e[o],o,e))&&n>r&&(r=n);return r},D=function(e,t){var n,r=e.length,i=r,o=-1,a=0;if(null==t)for(;++o<r;)isNaN(n=d(e[o]))?--i:a+=n;else for(;++o<r;)isNaN(n=d(t(e[o],o,e)))?--i:a+=n;if(i)return a/i},z=function(e,t){var n,i=e.length,o=-1,a=[];if(null==t)for(;++o<i;)isNaN(n=d(e[o]))||a.push(n);else for(;++o<i;)isNaN(n=d(t(e[o],o,e)))||a.push(n);return P(a.sort(r),.5)},U=function(e){for(var t,n,r,i=e.length,o=-1,a=0;++o<i;)a+=e[o].length;for(n=new Array(a);--i>=0;)for(t=(r=e[i]).length;--t>=0;)n[--a]=r[t];return n},k=function(e,t){var n,r,i=e.length,o=-1;if(null==t){for(;++o<i;)if(null!=(n=e[o])&&n>=n)for(r=n;++o<i;)null!=(n=e[o])&&r>n&&(r=n)}else for(;++o<i;)if(null!=(n=t(e[o],o,e))&&n>=n)for(r=n;++o<i;)null!=(n=t(e[o],o,e))&&r>n&&(r=n);return r},F=function(e,t){for(var n=t.length,r=new Array(n);n--;)r[n]=e[t[n]];return r},B=function(e,t){if(n=e.length){var n,i,o=0,a=0,s=e[a];for(null==t&&(t=r);++o<n;)(t(i=e[o],s)<0||0!==t(s,s))&&(s=i,a=o);return 0===t(s,s)?a:void 0}},j=function(e,t,n){for(var r,i,o=(null==n?e.length:n)-(t=null==t?0:+t);o;)i=Math.random()*o--|0,r=e[o+t],e[o+t]=e[i+t],e[i+t]=r;return e},H=function(e,t){var n,r=e.length,i=-1,o=0;if(null==t)for(;++i<r;)(n=+e[i])&&(o+=n);else for(;++i<r;)(n=+t(e[i],i,e))&&(o+=n);return o},G=function(e){if(!(i=e.length))return[];for(var t=-1,n=k(e,V),r=new Array(n);++t<n;)for(var i,o=-1,a=r[t]=new Array(i);++o<i;)a[o]=e[o][t];return r};function V(e){return e.length}var W=function(){return G(arguments)},q=Array.prototype.slice,X=function(e){return e},Y=1,Z=2,J=3,$=4,K=1e-6;function Q(e){return"translate("+(e+.5)+",0)"}function ee(e){return"translate(0,"+(e+.5)+")"}function te(e){return function(t){return+e(t)}}function ne(e){var t=Math.max(0,e.bandwidth()-1)/2;return e.round()&&(t=Math.round(t)),function(n){return+e(n)+t}}function re(){return!this.__axis}function ie(e,t){var n=[],r=null,i=null,o=6,a=6,s=3,c=e===Y||e===$?-1:1,u=e===$||e===Z?"x":"y",l=e===Y||e===J?Q:ee;function h(h){var f=null==r?t.ticks?t.ticks.apply(t,n):t.domain():r,d=null==i?t.tickFormat?t.tickFormat.apply(t,n):X:i,p=Math.max(o,0)+s,m=t.range(),g=+m[0]+.5,v=+m[m.length-1]+.5,_=(t.bandwidth?ne:te)(t.copy()),y=h.selection?h.selection():h,x=y.selectAll(".domain").data([null]),b=y.selectAll(".tick").data(f,t).order(),w=b.exit(),E=b.enter().append("g").attr("class","tick"),M=b.select("line"),S=b.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),b=b.merge(E),M=M.merge(E.append("line").attr("stroke","currentColor").attr(u+"2",c*o)),S=S.merge(E.append("text").attr("fill","currentColor").attr(u,c*p).attr("dy",e===Y?"0em":e===J?"0.71em":"0.32em")),h!==y&&(x=x.transition(h),b=b.transition(h),M=M.transition(h),S=S.transition(h),w=w.transition(h).attr("opacity",K).attr("transform",(function(e){return isFinite(e=_(e))?l(e):this.getAttribute("transform")})),E.attr("opacity",K).attr("transform",(function(e){var t=this.parentNode.__axis;return l(t&&isFinite(t=t(e))?t:_(e))}))),w.remove(),x.attr("d",e===$||e==Z?a?"M"+c*a+","+g+"H0.5V"+v+"H"+c*a:"M0.5,"+g+"V"+v:a?"M"+g+","+c*a+"V0.5H"+v+"V"+c*a:"M"+g+",0.5H"+v),b.attr("opacity",1).attr("transform",(function(e){return l(_(e))})),M.attr(u+"2",c*o),S.attr(u,c*p).text(d),y.filter(re).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===Z?"start":e===$?"end":"middle"),y.each((function(){this.__axis=_}))}return h.scale=function(e){return arguments.length?(t=e,h):t},h.ticks=function(){return n=q.call(arguments),h},h.tickArguments=function(e){return arguments.length?(n=null==e?[]:q.call(e),h):n.slice()},h.tickValues=function(e){return arguments.length?(r=null==e?null:q.call(e),h):r&&r.slice()},h.tickFormat=function(e){return arguments.length?(i=e,h):i},h.tickSize=function(e){return arguments.length?(o=a=+e,h):o},h.tickSizeInner=function(e){return arguments.length?(o=+e,h):o},h.tickSizeOuter=function(e){return arguments.length?(a=+e,h):a},h.tickPadding=function(e){return arguments.length?(s=+e,h):s},h}function oe(e){return ie(Y,e)}function ae(e){return ie(Z,e)}function se(e){return ie(J,e)}function ce(e){return ie($,e)}var ue={value:function(){}};function le(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r)throw new Error("illegal type: "+e);r[e]=[]}return new he(r)}function he(e){this._=e}function fe(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function de(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function pe(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=ue,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}he.prototype=le.prototype={constructor:he,on:function(e,t){var n,r=this._,i=fe(e+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<a;)if(n=(e=i[o]).type)r[n]=pe(r[n],e.name,t);else if(null==t)for(n in r)r[n]=pe(r[n],e.name,null);return this}for(;++o<a;)if((n=(e=i[o]).type)&&(n=de(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new he(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};var me=le,ge="http://www.w3.org/1999/xhtml",ve={svg:"http://www.w3.org/2000/svg",xhtml:ge,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},_e=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),ve.hasOwnProperty(t)?{space:ve[t],local:e}:e};function ye(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ge&&t.documentElement.namespaceURI===ge?t.createElement(e):t.createElementNS(n,e)}}function xe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}var be=function(e){var t=_e(e);return(t.local?xe:ye)(t)};function we(){}var Ee=function(e){return null==e?we:function(){return this.querySelector(e)}};function Me(){return[]}var Se=function(e){return null==e?Me:function(){return this.querySelectorAll(e)}},Te=function(e){return function(){return this.matches(e)}},Ae=function(e){return new Array(e.length)};function Le(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Le.prototype={constructor:Le,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var Ce="$";function Re(e,t,n,r,i,o){for(var a,s=0,c=t.length,u=o.length;s<u;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new Le(e,o[s]);for(;s<c;++s)(a=t[s])&&(i[s]=a)}function Pe(e,t,n,r,i,o,a){var s,c,u,l={},h=t.length,f=o.length,d=new Array(h);for(s=0;s<h;++s)(c=t[s])&&(d[s]=u=Ce+a.call(c,c.__data__,s,t),u in l?i[s]=c:l[u]=c);for(s=0;s<f;++s)(c=l[u=Ce+a.call(e,o[s],s,o)])?(r[s]=c,c.__data__=o[s],l[u]=null):n[s]=new Le(e,o[s]);for(s=0;s<h;++s)(c=t[s])&&l[d[s]]===c&&(i[s]=c)}function Oe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ne(e){return function(){this.removeAttribute(e)}}function Ie(e){return function(){this.removeAttributeNS(e.space,e.local)}}function De(e,t){return function(){this.setAttribute(e,t)}}function ze(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Ue(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function ke(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}var Fe=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function Be(e){return function(){this.style.removeProperty(e)}}function je(e,t,n){return function(){this.style.setProperty(e,t,n)}}function He(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Ge(e,t){return e.style.getPropertyValue(t)||Fe(e).getComputedStyle(e,null).getPropertyValue(t)}function Ve(e){return function(){delete this[e]}}function We(e,t){return function(){this[e]=t}}function qe(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Xe(e){return e.trim().split(/^|\s+/)}function Ye(e){return e.classList||new Ze(e)}function Ze(e){this._node=e,this._names=Xe(e.getAttribute("class")||"")}function Je(e,t){for(var n=Ye(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function $e(e,t){for(var n=Ye(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Ke(e){return function(){Je(this,e)}}function Qe(e){return function(){$e(this,e)}}function et(e,t){return function(){(t.apply(this,arguments)?Je:$e)(this,e)}}Ze.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function tt(){this.textContent=""}function nt(e){return function(){this.textContent=e}}function rt(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function it(){this.innerHTML=""}function ot(e){return function(){this.innerHTML=e}}function at(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function st(){this.nextSibling&&this.parentNode.appendChild(this)}function ct(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ut(){return null}function lt(){var e=this.parentNode;e&&e.removeChild(this)}function ht(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function ft(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}var dt={},pt=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(dt={mouseenter:"mouseover",mouseleave:"mouseout"}));function mt(e,t,n){return e=gt(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function gt(e,t,n){return function(r){var i=pt;pt=r;try{e.call(this,this.__data__,t,n)}finally{pt=i}}}function vt(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function _t(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?t.length=i:delete this.__on}}}function yt(e,t,n){var r=dt.hasOwnProperty(e.type)?mt:gt;return function(i,o,a){var s,c=this.__on,u=r(t,o,a);if(c)for(var l=0,h=c.length;l<h;++l)if((s=c[l]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=t);this.addEventListener(e.type,u,n),s={type:e.type,name:e.name,value:t,listener:u,capture:n},c?c.push(s):this.__on=[s]}}function xt(e,t,n,r){var i=pt;e.sourceEvent=pt,pt=e;try{return t.apply(n,r)}finally{pt=i}}function bt(e,t,n){var r=Fe(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function wt(e,t){return function(){return bt(this,e,t)}}function Et(e,t){return function(){return bt(this,e,t.apply(this,arguments))}}var Mt=[null];function St(e,t){this._groups=e,this._parents=t}function Tt(){return new St([[document.documentElement]],Mt)}St.prototype=Tt.prototype={constructor:St,select:function(e){"function"!=typeof e&&(e=Ee(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=t[i],c=s.length,u=r[i]=new Array(c),l=0;l<c;++l)(o=s[l])&&(a=e.call(o,o.__data__,l,s))&&("__data__"in o&&(a.__data__=o.__data__),u[l]=a);return new St(r,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=Se(e));for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a,s=t[o],c=s.length,u=0;u<c;++u)(a=s[u])&&(r.push(e.call(a,a.__data__,u,s)),i.push(a));return new St(r,i)},filter:function(e){"function"!=typeof e&&(e=Te(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,c=r[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&c.push(o);return new St(r,this._parents)},data:function(e,t){if(!e)return p=new Array(this.size()),l=-1,this.each((function(e){p[++l]=e})),p;var n,r=t?Pe:Re,i=this._parents,o=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var a=o.length,s=new Array(a),c=new Array(a),u=new Array(a),l=0;l<a;++l){var h=i[l],f=o[l],d=f.length,p=e.call(h,h&&h.__data__,l,i),m=p.length,g=c[l]=new Array(m),v=s[l]=new Array(m);r(h,f,g,v,u[l]=new Array(d),p,t);for(var _,y,x=0,b=0;x<m;++x)if(_=g[x]){for(x>=b&&(b=x+1);!(y=v[b])&&++b<m;);_._next=y||null}}return(s=new St(s,i))._enter=c,s._exit=u,s},enter:function(){return new St(this._enter||this._groups.map(Ae),this._parents)},exit:function(){return new St(this._exit||this._groups.map(Ae),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof e?e(r):r.append(e+""),null!=t&&(i=t(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var c,u=t[s],l=n[s],h=u.length,f=a[s]=new Array(h),d=0;d<h;++d)(c=u[d]||l[d])&&(f[d]=c);for(;s<r;++s)a[s]=t[s];return new St(a,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Oe);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],c=s.length,u=i[o]=new Array(c),l=0;l<c;++l)(a=s[l])&&(u[l]=a);u.sort(t)}return new St(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],a=0,s=o.length;a<s;++a)(i=o[a])&&e.call(i,i.__data__,a,o);return this},attr:function(e,t){var n=_e(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?Ie:Ne:"function"==typeof t?n.local?ke:Ue:n.local?ze:De)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?Be:"function"==typeof t?He:je)(e,t,null==n?"":n)):Ge(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Ve:"function"==typeof t?qe:We)(e,t)):this.node()[e]},classed:function(e,t){var n=Xe(e+"");if(arguments.length<2){for(var r=Ye(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?et:t?Ke:Qe)(n,t))},text:function(e){return arguments.length?this.each(null==e?tt:("function"==typeof e?rt:nt)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?it:("function"==typeof e?at:ot)(e)):this.node().innerHTML},raise:function(){return this.each(st)},lower:function(){return this.each(ct)},append:function(e){var t="function"==typeof e?e:be(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:be(e),r=null==t?ut:"function"==typeof t?t:Ee(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(lt)},clone:function(e){return this.select(e?ft:ht)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=vt(e+""),a=o.length;if(!(arguments.length<2)){for(s=t?yt:_t,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],t,n));return this}var s=this.node().__on;if(s)for(var c,u=0,l=s.length;u<l;++u)for(r=0,c=s[u];r<a;++r)if((i=o[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(e,t){return this.each(("function"==typeof t?Et:wt)(e,t))}};var At=Tt,Lt=function(e){return"string"==typeof e?new St([[document.querySelector(e)]],[document.documentElement]):new St([[e]],Mt)},Ct=function(e){return Lt(be(e).call(document.documentElement))},Rt=0;function Pt(){return new Ot}function Ot(){this._="@"+(++Rt).toString(36)}Ot.prototype=Pt.prototype={constructor:Ot,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var Nt=function(){for(var e,t=pt;e=t.sourceEvent;)t=e;return t},It=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]},Dt=function(e){var t=Nt();return t.changedTouches&&(t=t.changedTouches[0]),It(e,t)},zt=function(e){return"string"==typeof e?new St([document.querySelectorAll(e)],[document.documentElement]):new St([null==e?[]:e],Mt)},Ut=function(e,t,n){arguments.length<3&&(n=t,t=Nt().changedTouches);for(var r,i=0,o=t?t.length:0;i<o;++i)if((r=t[i]).identifier===n)return It(e,r);return null},kt=function(e,t){null==t&&(t=Nt().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=It(e,t[n]);return i};function Ft(){pt.stopImmediatePropagation()}var Bt=function(){pt.preventDefault(),pt.stopImmediatePropagation()},jt=function(e){var t=e.document.documentElement,n=Lt(e).on("dragstart.drag",Bt,!0);"onselectstart"in t?n.on("selectstart.drag",Bt,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")};function Ht(e,t){var n=e.document.documentElement,r=Lt(e).on("dragstart.drag",null);t&&(r.on("click.drag",Bt,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Gt=function(e){return function(){return e}};function Vt(e,t,n,r,i,o,a,s,c,u){this.target=e,this.type=t,this.subject=n,this.identifier=r,this.active=i,this.x=o,this.y=a,this.dx=s,this.dy=c,this._=u}function Wt(){return!pt.ctrlKey&&!pt.button}function qt(){return this.parentNode}function Xt(e){return null==e?{x:pt.x,y:pt.y}:e}function Yt(){return navigator.maxTouchPoints||"ontouchstart"in this}Vt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Zt=function(){var e,t,n,r,i=Wt,o=qt,a=Xt,s=Yt,c={},u=me("start","drag","end"),l=0,h=0;function f(e){e.on("mousedown.drag",d).filter(s).on("touchstart.drag",g).on("touchmove.drag",v).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(){if(!r&&i.apply(this,arguments)){var a=y("mouse",o.apply(this,arguments),Dt,this,arguments);a&&(Lt(pt.view).on("mousemove.drag",p,!0).on("mouseup.drag",m,!0),jt(pt.view),Ft(),n=!1,e=pt.clientX,t=pt.clientY,a("start"))}}function p(){if(Bt(),!n){var r=pt.clientX-e,i=pt.clientY-t;n=r*r+i*i>h}c.mouse("drag")}function m(){Lt(pt.view).on("mousemove.drag mouseup.drag",null),Ht(pt.view,n),Bt(),c.mouse("end")}function g(){if(i.apply(this,arguments)){var e,t,n=pt.changedTouches,r=o.apply(this,arguments),a=n.length;for(e=0;e<a;++e)(t=y(n[e].identifier,r,Ut,this,arguments))&&(Ft(),t("start"))}}function v(){var e,t,n=pt.changedTouches,r=n.length;for(e=0;e<r;++e)(t=c[n[e].identifier])&&(Bt(),t("drag"))}function _(){var e,t,n=pt.changedTouches,i=n.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),e=0;e<i;++e)(t=c[n[e].identifier])&&(Ft(),t("end"))}function y(e,t,n,r,i){var o,s,h,d=n(t,e),p=u.copy();if(xt(new Vt(f,"beforestart",o,e,l,d[0],d[1],0,0,p),(function(){return null!=(pt.subject=o=a.apply(r,i))&&(s=o.x-d[0]||0,h=o.y-d[1]||0,!0)})))return function a(u){var m,g=d;switch(u){case"start":c[e]=a,m=l++;break;case"end":delete c[e],--l;case"drag":d=n(t,e),m=l}xt(new Vt(f,u,o,e,m,d[0]+s,d[1]+h,d[0]-g[0],d[1]-g[1],p),p.apply,p,[u,r,i])}}return f.filter=function(e){return arguments.length?(i="function"==typeof e?e:Gt(!!e),f):i},f.container=function(e){return arguments.length?(o="function"==typeof e?e:Gt(e),f):o},f.subject=function(e){return arguments.length?(a="function"==typeof e?e:Gt(e),f):a},f.touchable=function(e){return arguments.length?(s="function"==typeof e?e:Gt(!!e),f):s},f.on=function(){var e=u.on.apply(u,arguments);return e===u?f:e},f.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,f):Math.sqrt(h)},f},Jt=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function $t(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Kt(){}var Qt="\\s*([+-]?\\d+)\\s*",en="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",tn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",nn=/^#([0-9a-f]{3,8})$/,rn=new RegExp("^rgb\\("+[Qt,Qt,Qt]+"\\)$"),on=new RegExp("^rgb\\("+[tn,tn,tn]+"\\)$"),an=new RegExp("^rgba\\("+[Qt,Qt,Qt,en]+"\\)$"),sn=new RegExp("^rgba\\("+[tn,tn,tn,en]+"\\)$"),cn=new RegExp("^hsl\\("+[en,tn,tn]+"\\)$"),un=new RegExp("^hsla\\("+[en,tn,tn,en]+"\\)$"),ln={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function hn(){return this.rgb().formatHex()}function fn(){return this.rgb().formatRgb()}function dn(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=nn.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?pn(t):3===n?new _n(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?new _n(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?new _n(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=rn.exec(e))?new _n(t[1],t[2],t[3],1):(t=on.exec(e))?new _n(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=an.exec(e))?mn(t[1],t[2],t[3],t[4]):(t=sn.exec(e))?mn(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=cn.exec(e))?wn(t[1],t[2]/100,t[3]/100,1):(t=un.exec(e))?wn(t[1],t[2]/100,t[3]/100,t[4]):ln.hasOwnProperty(e)?pn(ln[e]):"transparent"===e?new _n(NaN,NaN,NaN,0):null}function pn(e){return new _n(e>>16&255,e>>8&255,255&e,1)}function mn(e,t,n,r){return r<=0&&(e=t=n=NaN),new _n(e,t,n,r)}function gn(e){return e instanceof Kt||(e=dn(e)),e?new _n((e=e.rgb()).r,e.g,e.b,e.opacity):new _n}function vn(e,t,n,r){return 1===arguments.length?gn(e):new _n(e,t,n,null==r?1:r)}function _n(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function yn(){return"#"+bn(this.r)+bn(this.g)+bn(this.b)}function xn(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function bn(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function wn(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Sn(e,t,n,r)}function En(e){if(e instanceof Sn)return new Sn(e.h,e.s,e.l,e.opacity);if(e instanceof Kt||(e=dn(e)),!e)return new Sn;if(e instanceof Sn)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,c=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=c<.5?o+i:2-o-i,a*=60):s=c>0&&c<1?0:a,new Sn(a,s,c,e.opacity)}function Mn(e,t,n,r){return 1===arguments.length?En(e):new Sn(e,t,n,null==r?1:r)}function Sn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Tn(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function An(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}Jt(Kt,dn,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:hn,formatHex:hn,formatHsl:function(){return En(this).formatHsl()},formatRgb:fn,toString:fn}),Jt(_n,vn,$t(Kt,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new _n(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new _n(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:yn,formatHex:yn,formatRgb:xn,toString:xn})),Jt(Sn,Mn,$t(Kt,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Sn(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Sn(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new _n(Tn(e>=240?e-240:e+120,i,r),Tn(e,i,r),Tn(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var Ln=function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return An((n-r/t)*t,a,i,o,s)}},Cn=function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return An((n-r/t)*t,i,o,a,s)}},Rn=function(e){return function(){return e}};function Pn(e,t){return function(n){return e+n*t}}function On(e,t){var n=t-e;return n?Pn(e,n>180||n<-180?n-360*Math.round(n/360):n):Rn(isNaN(e)?t:e)}function Nn(e){return 1==(e=+e)?In:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Rn(isNaN(t)?n:t)}}function In(e,t){var n=t-e;return n?Pn(e,n):Rn(isNaN(e)?t:e)}var Dn=function e(t){var n=Nn(t);function r(e,t){var r=n((e=vn(e)).r,(t=vn(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=In(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function zn(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=vn(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}var Un=zn(Ln),kn=zn(Cn),Fn=function(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Jn(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}},Bn=function(e,t){var n=new Date;return t-=e=+e,function(r){return n.setTime(e+t*r),n}},jn=function(e,t){return t-=e=+e,function(n){return e+t*n}},Hn=function(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Jn(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}},Gn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Vn=new RegExp(Gn.source,"g");var Wn,qn,Xn,Yn,Zn=function(e,t){var n,r,i,o=Gn.lastIndex=Vn.lastIndex=0,a=-1,s=[],c=[];for(e+="",t+="";(n=Gn.exec(e))&&(r=Vn.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,c.push({i:a,x:jn(n,r)})),o=Vn.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?c[0]?function(e){return function(t){return e(t)+""}}(c[0].x):function(e){return function(){return e}}(t):(t=c.length,function(e){for(var n,r=0;r<t;++r)s[(n=c[r]).i]=n.x(e);return s.join("")})},Jn=function(e,t){var n,r=typeof t;return null==t||"boolean"===r?Rn(t):("number"===r?jn:"string"===r?(n=dn(t))?(t=n,Dn):Zn:t instanceof dn?Dn:t instanceof Date?Bn:Array.isArray(t)?Fn:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Hn:jn)(e,t)},$n=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},Kn=function(e,t){var n=On(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},Qn=function(e,t){return t-=e=+e,function(n){return Math.round(e+t*n)}},er=180/Math.PI,tr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},nr=function(e,t,n,r,i,o){var a,s,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*er,skewX:Math.atan(c)*er,scaleX:a,scaleY:s}};function rr(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],c=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var c=a.push("translate(",null,t,null,n);s.push({i:c-4,x:jn(e,i)},{i:c-2,x:jn(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,c),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:jn(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,c),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:jn(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,c),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:jn(e,n)},{i:s-2,x:jn(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,c),o=a=null,function(e){for(var t,n=-1,r=c.length;++n<r;)s[(t=c[n]).i]=t.x(e);return s.join("")}}}var ir=rr((function(e){return"none"===e?tr:(Wn||(Wn=document.createElement("DIV"),qn=document.documentElement,Xn=document.defaultView),Wn.style.transform=e,e=Xn.getComputedStyle(qn.appendChild(Wn),null).getPropertyValue("transform"),qn.removeChild(Wn),e=e.slice(7,-1).split(","),nr(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}),"px, ","px)","deg)"),or=rr((function(e){return null==e?tr:(Yn||(Yn=document.createElementNS("http://www.w3.org/2000/svg","g")),Yn.setAttribute("transform",e),(e=Yn.transform.baseVal.consolidate())?(e=e.matrix,nr(e.a,e.b,e.c,e.d,e.e,e.f)):tr)}),", ",")",")"),ar=Math.SQRT2;function sr(e){return((e=Math.exp(e))+1/e)/2}var cr=function(e,t){var n,r,i=e[0],o=e[1],a=e[2],s=t[0],c=t[1],u=t[2],l=s-i,h=c-o,f=l*l+h*h;if(f<1e-12)r=Math.log(u/a)/ar,n=function(e){return[i+e*l,o+e*h,a*Math.exp(ar*e*r)]};else{var d=Math.sqrt(f),p=(u*u-a*a+4*f)/(2*a*2*d),m=(u*u-a*a-4*f)/(2*u*2*d),g=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(m*m+1)-m);r=(v-g)/ar,n=function(e){var t,n=e*r,s=sr(g),c=a/(2*d)*(s*(t=ar*n+g,((t=Math.exp(2*t))-1)/(t+1))-function(e){return((e=Math.exp(e))-1/e)/2}(g));return[i+c*l,o+c*h,a*s/sr(ar*n+g)]}}return n.duration=1e3*r,n};function ur(e){return function(t,n){var r=e((t=Mn(t)).h,(n=Mn(n)).h),i=In(t.s,n.s),o=In(t.l,n.l),a=In(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=o(e),t.opacity=a(e),t+""}}}var lr=ur(On),hr=ur(In),fr=Math.PI/180,dr=180/Math.PI,pr=.96422,mr=1,gr=.82521,vr=4/29,_r=6/29,yr=3*_r*_r,xr=_r*_r*_r;function br(e){if(e instanceof Mr)return new Mr(e.l,e.a,e.b,e.opacity);if(e instanceof Or)return Nr(e);e instanceof _n||(e=gn(e));var t,n,r=Lr(e.r),i=Lr(e.g),o=Lr(e.b),a=Sr((.2225045*r+.7168786*i+.0606169*o)/mr);return r===i&&i===o?t=n=a:(t=Sr((.4360747*r+.3850649*i+.1430804*o)/pr),n=Sr((.0139322*r+.0971045*i+.7141733*o)/gr)),new Mr(116*a-16,500*(t-a),200*(a-n),e.opacity)}function wr(e,t){return new Mr(e,0,0,null==t?1:t)}function Er(e,t,n,r){return 1===arguments.length?br(e):new Mr(e,t,n,null==r?1:r)}function Mr(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function Sr(e){return e>xr?Math.pow(e,1/3):e/yr+vr}function Tr(e){return e>_r?e*e*e:yr*(e-vr)}function Ar(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Lr(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Cr(e){if(e instanceof Or)return new Or(e.h,e.c,e.l,e.opacity);if(e instanceof Mr||(e=br(e)),0===e.a&&0===e.b)return new Or(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*dr;return new Or(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Rr(e,t,n,r){return 1===arguments.length?Cr(e):new Or(n,t,e,null==r?1:r)}function Pr(e,t,n,r){return 1===arguments.length?Cr(e):new Or(e,t,n,null==r?1:r)}function Or(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Nr(e){if(isNaN(e.h))return new Mr(e.l,0,0,e.opacity);var t=e.h*fr;return new Mr(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function Ir(e,t){var n=In((e=Er(e)).l,(t=Er(t)).l),r=In(e.a,t.a),i=In(e.b,t.b),o=In(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}}function Dr(e){return function(t,n){var r=e((t=Pr(t)).h,(n=Pr(n)).h),i=In(t.c,n.c),o=In(t.l,n.l),a=In(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=o(e),t.opacity=a(e),t+""}}}Jt(Mr,Er,$t(Kt,{brighter:function(e){return new Mr(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Mr(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new _n(Ar(3.1338561*(t=pr*Tr(t))-1.6168667*(e=mr*Tr(e))-.4906146*(n=gr*Tr(n))),Ar(-.9787684*t+1.9161415*e+.033454*n),Ar(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Jt(Or,Pr,$t(Kt,{brighter:function(e){return new Or(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Or(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Nr(this).rgb()}}));var zr=Dr(On),Ur=Dr(In),kr=-.29227,Fr=-.90649,Br=1.97294,jr=Br*Fr,Hr=1.78277*Br,Gr=1.78277*kr- -.14861*Fr;function Vr(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Wr)return new Wr(e.h,e.s,e.l,e.opacity);e instanceof _n||(e=gn(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Gr*r+jr*t-Hr*n)/(Gr+jr-Hr),o=r-i,a=(Br*(n-i)-kr*o)/Fr,s=Math.sqrt(a*a+o*o)/(Br*i*(1-i)),c=s?Math.atan2(a,o)*dr-120:NaN;return new Wr(c<0?c+360:c,s,i,e.opacity)}(e):new Wr(e,t,n,null==r?1:r)}function Wr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function qr(e){return function t(n){function r(t,r){var i=e((t=Vr(t)).h,(r=Vr(r)).h),o=In(t.s,r.s),a=In(t.l,r.l),s=In(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}Jt(Wr,Vr,$t(Kt,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Wr(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Wr(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*fr,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new _n(255*(t+n*(-.14861*r+1.78277*i)),255*(t+n*(kr*r+Fr*i)),255*(t+n*(Br*r)),this.opacity)}}));var Xr=qr(On),Yr=qr(In);function Zr(e,t){for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}var Jr,$r,Kr=function(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n},Qr=0,ei=0,ti=0,ni=1e3,ri=0,ii=0,oi=0,ai="object"==typeof performance&&performance.now?performance:Date,si="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ci(){return ii||(si(ui),ii=ai.now()+oi)}function ui(){ii=0}function li(){this._call=this._time=this._next=null}function hi(e,t,n){var r=new li;return r.restart(e,t,n),r}function fi(){ci(),++Qr;for(var e,t=Jr;t;)(e=ii-t._time)>=0&&t._call.call(null,e),t=t._next;--Qr}function di(){ii=(ri=ai.now())+oi,Qr=ei=0;try{fi()}finally{Qr=0,function(){var e,t,n=Jr,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Jr=t);$r=e,mi(r)}(),ii=0}}function pi(){var e=ai.now(),t=e-ri;t>ni&&(oi-=t,ri=e)}function mi(e){Qr||(ei&&(ei=clearTimeout(ei)),e-ii>24?(e<1/0&&(ei=setTimeout(di,e-ai.now()-oi)),ti&&(ti=clearInterval(ti))):(ti||(ri=ai.now(),ti=setInterval(pi,ni)),Qr=1,si(di)))}li.prototype=hi.prototype={constructor:li,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?ci():+n)+(null==t?0:+t),this._next||$r===this||($r?$r._next=this:Jr=this,$r=this),this._call=e,this._time=n,mi()},stop:function(){this._call&&(this._call=null,this._time=1/0,mi())}};var gi=function(e,t,n){var r=new li;return t=null==t?0:+t,r.restart((function(n){r.stop(),e(n+t)}),t,n),r},vi=function(e,t,n){var r=new li,i=t;return null==t?(r.restart(e,t,n),r):(t=+t,n=null==n?ci():+n,r.restart((function o(a){a+=i,r.restart(o,i+=t,n),e(a)}),t,n),r)},_i=me("start","end","cancel","interrupt"),yi=[],xi=0,bi=1,wi=2,Ei=3,Mi=4,Si=5,Ti=6,Ai=function(e,t,n,r,i,o){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function o(c){var u,l,h,f;if(n.state!==bi)return s();for(u in i)if((f=i[u]).name===n.name){if(f.state===Ei)return gi(o);f.state===Mi?(f.state=Ti,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete i[u]):+u<t&&(f.state=Ti,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete i[u])}if(gi((function(){n.state===Ei&&(n.state=Mi,n.timer.restart(a,n.delay,n.time),a(c))})),n.state=wi,n.on.call("start",e,e.__data__,n.index,n.group),n.state===wi){for(n.state=Ei,r=new Array(h=n.tween.length),u=0,l=-1;u<h;++u)(f=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++l]=f);r.length=l+1}}function a(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=Si,1),o=-1,a=r.length;++o<a;)r[o].call(e,i);n.state===Si&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var r in n.state=Ti,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=hi((function(e){n.state=bi,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}),0,n.time)}(e,n,{name:t,index:r,group:i,on:_i,tween:yi,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:xi})};function Li(e,t){var n=Ri(e,t);if(n.state>xi)throw new Error("too late; already scheduled");return n}function Ci(e,t){var n=Ri(e,t);if(n.state>Ei)throw new Error("too late; already running");return n}function Ri(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}var Pi=function(e,t){var n,r,i,o=e.__transition,a=!0;if(o){for(i in t=null==t?null:t+"",o)(n=o[i]).name===t?(r=n.state>wi&&n.state<Si,n.state=Ti,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete e.__transition}};function Oi(e,t){var n,r;return function(){var i=Ci(this,e),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===t){(r=r.slice()).splice(a,1);break}i.tween=r}}function Ni(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Ci(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},c=0,u=i.length;c<u;++c)if(i[c].name===t){i[c]=s;break}c===u&&i.push(s)}o.tween=i}}function Ii(e,t,n){var r=e._id;return e.each((function(){var e=Ci(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return Ri(e,r).value[t]}}var Di=function(e,t){var n;return("number"==typeof t?jn:t instanceof dn?Dn:(n=dn(t))?(t=n,Dn):Zn)(e,t)};function zi(e){return function(){this.removeAttribute(e)}}function Ui(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ki(e,t,n){var r,i,o=n+"";return function(){var a=this.getAttribute(e);return a===o?null:a===r?i:i=t(r=a,n)}}function Fi(e,t,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===o?null:a===r?i:i=t(r=a,n)}}function Bi(e,t,n){var r,i,o;return function(){var a,s,c=n(this);if(null!=c)return(a=this.getAttribute(e))===(s=c+"")?null:a===r&&s===i?o:(i=s,o=t(r=a,c));this.removeAttribute(e)}}function ji(e,t,n){var r,i,o;return function(){var a,s,c=n(this);if(null!=c)return(a=this.getAttributeNS(e.space,e.local))===(s=c+"")?null:a===r&&s===i?o:(i=s,o=t(r=a,c));this.removeAttributeNS(e.space,e.local)}}function Hi(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t(n))}}(e,i)),n}return i._value=t,i}function Gi(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttribute(e,t(n))}}(e,i)),n}return i._value=t,i}function Vi(e,t){return function(){Li(this,e).delay=+t.apply(this,arguments)}}function Wi(e,t){return t=+t,function(){Li(this,e).delay=t}}function qi(e,t){return function(){Ci(this,e).duration=+t.apply(this,arguments)}}function Xi(e,t){return t=+t,function(){Ci(this,e).duration=t}}function Yi(e,t){if("function"!=typeof t)throw new Error;return function(){Ci(this,e).ease=t}}function Zi(e,t,n){var r,i,o=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?Li:Ci;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}var Ji=At.prototype.constructor;function $i(e){return function(){this.style.removeProperty(e)}}function Ki(e,t,n){var r,i;function o(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&function(e,t,n){return function(r){this.style.setProperty(e,t(r),n)}}(e,o,n)),r}return o._value=t,o}var Qi=0;function eo(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function to(e){return At().transition(e)}function no(){return++Qi}var ro=At.prototype;function io(e){return+e}function oo(e){return e*e}function ao(e){return e*(2-e)}function so(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function co(e){return e*e*e}function uo(e){return--e*e*e+1}function lo(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}eo.prototype=to.prototype={constructor:eo,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Ee(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,c,u=r[a],l=u.length,h=o[a]=new Array(l),f=0;f<l;++f)(s=u[f])&&(c=e.call(s,s.__data__,f,u))&&("__data__"in s&&(c.__data__=s.__data__),h[f]=c,Ai(h[f],t,n,f,h,Ri(s,n)));return new eo(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Se(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var c,u=r[s],l=u.length,h=0;h<l;++h)if(c=u[h]){for(var f,d=e.call(c,c.__data__,h,u),p=Ri(c,n),m=0,g=d.length;m<g;++m)(f=d[m])&&Ai(f,t,n,m,d,p);o.push(d),a.push(c)}return new eo(o,a,t,n)},filter:function(e){"function"!=typeof e&&(e=Te(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,c=r[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&c.push(o);return new eo(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var c,u=t[s],l=n[s],h=u.length,f=a[s]=new Array(h),d=0;d<h;++d)(c=u[d]||l[d])&&(f[d]=c);for(;s<r;++s)a[s]=t[s];return new eo(a,this._parents,this._name,this._id)},selection:function(){return new Ji(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=no(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],c=s.length,u=0;u<c;++u)if(a=s[u]){var l=Ri(a,t);Ai(a,e,n,u,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new eo(r,this._parents,e,n)},call:ro.call,nodes:ro.nodes,node:ro.node,size:ro.size,empty:ro.empty,each:ro.each,on:function(e,t){var n=this._id;return arguments.length<2?Ri(this.node(),n).on.on(e):this.each(Zi(n,e,t))},attr:function(e,t){var n=_e(e),r="transform"===n?or:Di;return this.attrTween(e,"function"==typeof t?(n.local?ji:Bi)(n,r,Ii(this,"attr."+e,t)):null==t?(n.local?Ui:zi)(n):(n.local?Fi:ki)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=_e(e);return this.tween(n,(r.local?Hi:Gi)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?ir:Di;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var o=Ge(this,e),a=(this.style.removeProperty(e),Ge(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}(e,r)).on("end.style."+e,$i(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,i,o;return function(){var a=Ge(this,e),s=n(this),c=s+"";return null==s&&(this.style.removeProperty(e),c=s=Ge(this,e)),a===c?null:a===r&&c===i?o:(i=c,o=t(r=a,s))}}(e,r,Ii(this,"style."+e,t))).each(function(e,t){var n,r,i,o,a="style."+t,s="end."+a;return function(){var c=Ci(this,e),u=c.on,l=null==c.value[a]?o||(o=$i(t)):void 0;u===n&&i===l||(r=(n=u).copy()).on(s,i=l),c.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,o=n+"";return function(){var a=Ge(this,e);return a===o?null:a===r?i:i=t(r=a,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,Ki(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Ii(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}));var e},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=Ri(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===e)return r.value;return null}return this.each((null==t?Oi:Ni)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Vi:Wi)(t,e)):Ri(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?qi:Xi)(t,e)):Ri(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(Yi(t,e)):Ri(this.node(),t).ease},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},c={value:function(){0==--i&&o()}};n.each((function(){var n=Ci(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),n.on=t}))}))}};var ho=function e(t){function n(e){return Math.pow(e,t)}return t=+t,n.exponent=e,n}(3),fo=function e(t){function n(e){return 1-Math.pow(1-e,t)}return t=+t,n.exponent=e,n}(3),po=function e(t){function n(e){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}return t=+t,n.exponent=e,n}(3),mo=Math.PI,go=mo/2;function vo(e){return 1-Math.cos(e*go)}function _o(e){return Math.sin(e*go)}function yo(e){return(1-Math.cos(mo*e))/2}function xo(e){return Math.pow(2,10*e-10)}function bo(e){return 1-Math.pow(2,-10*e)}function wo(e){return((e*=2)<=1?Math.pow(2,10*e-10):2-Math.pow(2,10-10*e))/2}function Eo(e){return 1-Math.sqrt(1-e*e)}function Mo(e){return Math.sqrt(1- --e*e)}function So(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var To=4/11,Ao=6/11,Lo=8/11,Co=.75,Ro=9/11,Po=10/11,Oo=.9375,No=21/22,Io=63/64,Do=1/To/To;function zo(e){return 1-Uo(1-e)}function Uo(e){return(e=+e)<To?Do*e*e:e<Lo?Do*(e-=Ao)*e+Co:e<Po?Do*(e-=Ro)*e+Oo:Do*(e-=No)*e+Io}function ko(e){return((e*=2)<=1?1-Uo(1-e):Uo(e-1)+1)/2}var Fo=function e(t){function n(e){return e*e*((t+1)*e-t)}return t=+t,n.overshoot=e,n}(1.70158),Bo=function e(t){function n(e){return--e*e*((t+1)*e+t)+1}return t=+t,n.overshoot=e,n}(1.70158),jo=function e(t){function n(e){return((e*=2)<1?e*e*((t+1)*e-t):(e-=2)*e*((t+1)*e+t)+2)/2}return t=+t,n.overshoot=e,n}(1.70158),Ho=2*Math.PI,Go=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Ho);function i(e){return t*Math.pow(2,10*--e)*Math.sin((r-e)/n)}return i.amplitude=function(t){return e(t,n*Ho)},i.period=function(n){return e(t,n)},i}(1,.3),Vo=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Ho);function i(e){return 1-t*Math.pow(2,-10*(e=+e))*Math.sin((e+r)/n)}return i.amplitude=function(t){return e(t,n*Ho)},i.period=function(n){return e(t,n)},i}(1,.3),Wo=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Ho);function i(e){return((e=2*e-1)<0?t*Math.pow(2,10*e)*Math.sin((r-e)/n):2-t*Math.pow(2,-10*e)*Math.sin((r+e)/n))/2}return i.amplitude=function(t){return e(t,n*Ho)},i.period=function(n){return e(t,n)},i}(1,.3),qo={time:null,delay:0,duration:250,ease:lo};function Xo(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))return qo.time=ci(),qo;return n}At.prototype.interrupt=function(e){return this.each((function(){Pi(this,e)}))},At.prototype.transition=function(e){var t,n;e instanceof eo?(t=e._id,e=e._name):(t=no(),(n=qo).time=ci(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],c=s.length,u=0;u<c;++u)(a=s[u])&&Ai(a,e,t,u,s,n||Xo(a,t));return new eo(r,this._parents,e,t)};var Yo=[null],Zo=function(e,t){var n,r,i=e.__transition;if(i)for(r in t=null==t?null:t+"",i)if((n=i[r]).state>bi&&n.name===t)return new eo([[e]],Yo,t,+r);return null},Jo=function(e){return function(){return e}},$o=function(e,t,n){this.target=e,this.type=t,this.selection=n};function Ko(){pt.stopImmediatePropagation()}var Qo=function(){pt.preventDefault(),pt.stopImmediatePropagation()},ea={name:"drag"},ta={name:"space"},na={name:"handle"},ra={name:"center"};function ia(e){return[+e[0],+e[1]]}function oa(e){return[ia(e[0]),ia(e[1])]}var aa={name:"x",handles:["w","e"].map(pa),input:function(e,t){return null==e?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},sa={name:"y",handles:["n","s"].map(pa),input:function(e,t){return null==e?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},ca={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(pa),input:function(e){return null==e?null:oa(e)},output:function(e){return e}},ua={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},la={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},ha={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},fa={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},da={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function pa(e){return{type:e}}function ma(){return!pt.ctrlKey&&!pt.button}function ga(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function va(){return navigator.maxTouchPoints||"ontouchstart"in this}function _a(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function ya(e){var t=e.__brush;return t?t.dim.output(t.selection):null}function xa(){return Ea(aa)}function ba(){return Ea(sa)}var wa=function(){return Ea(ca)};function Ea(e){var t,n=ga,r=ma,i=va,o=!0,a=me(c,"start","brush","end"),s=6;function c(t){var n=t.property("__brush",m).selectAll(".overlay").data([pa("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",ua.overlay).merge(n).each((function(){var e=_a(this).extent;Lt(this).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1])})),t.selectAll(".selection").data([pa("selection")]).enter().append("rect").attr("class","selection").attr("cursor",ua.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=t.selectAll(".handle").data(e.handles,(function(e){return e.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(e){return"handle handle--"+e.type})).attr("cursor",(function(e){return ua[e.type]})),t.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(i).on("touchstart.brush",f).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function u(){var e=Lt(this),t=_a(this).selection;t?(e.selectAll(".selection").style("display",null).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1]),e.selectAll(".handle").style("display",null).attr("x",(function(e){return"e"===e.type[e.type.length-1]?t[1][0]-s/2:t[0][0]-s/2})).attr("y",(function(e){return"s"===e.type[0]?t[1][1]-s/2:t[0][1]-s/2})).attr("width",(function(e){return"n"===e.type||"s"===e.type?t[1][0]-t[0][0]+s:s})).attr("height",(function(e){return"e"===e.type||"w"===e.type?t[1][1]-t[0][1]+s:s}))):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function l(e,t,n){return!n&&e.__brush.emitter||new h(e,t)}function h(e,t){this.that=e,this.args=t,this.state=e.__brush,this.active=0}function f(){if((!t||pt.touches)&&r.apply(this,arguments)){var n,i,a,s,c,h,f,d,p,m,g,v,_=this,y=pt.target.__data__.type,x="selection"===(o&&pt.metaKey?y="overlay":y)?ea:o&&pt.altKey?ra:na,b=e===sa?null:fa[y],w=e===aa?null:da[y],E=_a(_),M=E.extent,S=E.selection,T=M[0][0],A=M[0][1],L=M[1][0],C=M[1][1],R=0,P=0,O=b&&w&&o&&pt.shiftKey,N=pt.touches?(v=pt.changedTouches[0].identifier,function(e){return Ut(e,pt.touches,v)}):Dt,I=N(_),D=I,z=l(_,arguments,!0).beforestart();"overlay"===y?(S&&(p=!0),E.selection=S=[[n=e===sa?T:I[0],a=e===aa?A:I[1]],[c=e===sa?L:n,f=e===aa?C:a]]):(n=S[0][0],a=S[0][1],c=S[1][0],f=S[1][1]),i=n,s=a,h=c,d=f;var U=Lt(_).attr("pointer-events","none"),k=U.selectAll(".overlay").attr("cursor",ua[y]);if(pt.touches)z.moved=B,z.ended=H;else{var F=Lt(pt.view).on("mousemove.brush",B,!0).on("mouseup.brush",H,!0);o&&F.on("keydown.brush",(function(){switch(pt.keyCode){case 16:O=b&&w;break;case 18:x===na&&(b&&(c=h-R*b,n=i+R*b),w&&(f=d-P*w,a=s+P*w),x=ra,j());break;case 32:x!==na&&x!==ra||(b<0?c=h-R:b>0&&(n=i-R),w<0?f=d-P:w>0&&(a=s-P),x=ta,k.attr("cursor",ua.selection),j());break;default:return}Qo()}),!0).on("keyup.brush",(function(){switch(pt.keyCode){case 16:O&&(m=g=O=!1,j());break;case 18:x===ra&&(b<0?c=h:b>0&&(n=i),w<0?f=d:w>0&&(a=s),x=na,j());break;case 32:x===ta&&(pt.altKey?(b&&(c=h-R*b,n=i+R*b),w&&(f=d-P*w,a=s+P*w),x=ra):(b<0?c=h:b>0&&(n=i),w<0?f=d:w>0&&(a=s),x=na),k.attr("cursor",ua[y]),j());break;default:return}Qo()}),!0),jt(pt.view)}Ko(),Pi(_),u.call(_),z.start()}function B(){var e=N(_);!O||m||g||(Math.abs(e[0]-D[0])>Math.abs(e[1]-D[1])?g=!0:m=!0),D=e,p=!0,Qo(),j()}function j(){var e;switch(R=D[0]-I[0],P=D[1]-I[1],x){case ta:case ea:b&&(R=Math.max(T-n,Math.min(L-c,R)),i=n+R,h=c+R),w&&(P=Math.max(A-a,Math.min(C-f,P)),s=a+P,d=f+P);break;case na:b<0?(R=Math.max(T-n,Math.min(L-n,R)),i=n+R,h=c):b>0&&(R=Math.max(T-c,Math.min(L-c,R)),i=n,h=c+R),w<0?(P=Math.max(A-a,Math.min(C-a,P)),s=a+P,d=f):w>0&&(P=Math.max(A-f,Math.min(C-f,P)),s=a,d=f+P);break;case ra:b&&(i=Math.max(T,Math.min(L,n-R*b)),h=Math.max(T,Math.min(L,c+R*b))),w&&(s=Math.max(A,Math.min(C,a-P*w)),d=Math.max(A,Math.min(C,f+P*w)))}h<i&&(b*=-1,e=n,n=c,c=e,e=i,i=h,h=e,y in la&&k.attr("cursor",ua[y=la[y]])),d<s&&(w*=-1,e=a,a=f,f=e,e=s,s=d,d=e,y in ha&&k.attr("cursor",ua[y=ha[y]])),E.selection&&(S=E.selection),m&&(i=S[0][0],h=S[1][0]),g&&(s=S[0][1],d=S[1][1]),S[0][0]===i&&S[0][1]===s&&S[1][0]===h&&S[1][1]===d||(E.selection=[[i,s],[h,d]],u.call(_),z.brush())}function H(){if(Ko(),pt.touches){if(pt.touches.length)return;t&&clearTimeout(t),t=setTimeout((function(){t=null}),500)}else Ht(pt.view,p),F.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);U.attr("pointer-events","all"),k.attr("cursor",ua.overlay),E.selection&&(S=E.selection),function(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}(S)&&(E.selection=null,u.call(_)),z.end()}}function d(){l(this,arguments).moved()}function p(){l(this,arguments).ended()}function m(){var t=this.__brush||{selection:null};return t.extent=oa(n.apply(this,arguments)),t.dim=e,t}return c.move=function(t,n){t.selection?t.on("start.brush",(function(){l(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){l(this,arguments).end()})).tween("brush",(function(){var t=this,r=t.__brush,i=l(t,arguments),o=r.selection,a=e.input("function"==typeof n?n.apply(this,arguments):n,r.extent),s=Jn(o,a);function c(e){r.selection=1===e&&null===a?null:s(e),u.call(t),i.brush()}return null!==o&&null!==a?c:c(1)})):t.each((function(){var t=this,r=arguments,i=t.__brush,o=e.input("function"==typeof n?n.apply(t,r):n,i.extent),a=l(t,r).beforestart();Pi(t),i.selection=null===o?null:o,u.call(t),a.start().brush().end()}))},c.clear=function(e){c.move(e,null)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){xt(new $o(c,t,e.output(this.state.selection)),a.apply,a,[t,this.that,this.args])}},c.extent=function(e){return arguments.length?(n="function"==typeof e?e:Jo(oa(e)),c):n},c.filter=function(e){return arguments.length?(r="function"==typeof e?e:Jo(!!e),c):r},c.handleSize=function(e){return arguments.length?(s=+e,c):s},c.keyModifiers=function(e){return arguments.length?(o=!!e,c):o},c.on=function(){var e=a.on.apply(a,arguments);return e===a?c:e},c}var Ma=Math.cos,Sa=Math.sin,Ta=Math.PI,Aa=Ta/2,La=2*Ta,Ca=Math.max;function Ra(e){return function(t,n){return e(t.source.value+t.target.value,n.source.value+n.target.value)}}var Pa=function(){var e=0,t=null,n=null,r=null;function i(i){var o,a,s,c,u,l,h=i.length,f=[],d=w(h),p=[],m=[],g=m.groups=new Array(h),v=new Array(h*h);for(o=0,u=-1;++u<h;){for(a=0,l=-1;++l<h;)a+=i[u][l];f.push(a),p.push(w(h)),o+=a}for(t&&d.sort((function(e,n){return t(f[e],f[n])})),n&&p.forEach((function(e,t){e.sort((function(e,r){return n(i[t][e],i[t][r])}))})),c=(o=Ca(0,La-e*h)/o)?e:La/h,a=0,u=-1;++u<h;){for(s=a,l=-1;++l<h;){var _=d[u],y=p[_][l],x=i[_][y],b=a,E=a+=x*o;v[y*h+_]={index:_,subindex:y,startAngle:b,endAngle:E,value:x}}g[_]={index:_,startAngle:s,endAngle:a,value:f[_]},a+=c}for(u=-1;++u<h;)for(l=u-1;++l<h;){var M=v[l*h+u],S=v[u*h+l];(M.value||S.value)&&m.push(M.value<S.value?{source:S,target:M}:{source:M,target:S})}return r?m.sort(r):m}return i.padAngle=function(t){return arguments.length?(e=Ca(0,t),i):e},i.sortGroups=function(e){return arguments.length?(t=e,i):t},i.sortSubgroups=function(e){return arguments.length?(n=e,i):n},i.sortChords=function(e){return arguments.length?(null==e?r=null:(r=Ra(e))._=e,i):r&&r._},i},Oa=Array.prototype.slice,Na=function(e){return function(){return e}},Ia=Math.PI,Da=2*Ia,za=Da-1e-6;function Ua(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ka(){return new Ua}Ua.prototype=ka.prototype={constructor:Ua,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-e,c=r-t,u=o-e,l=a-t,h=u*u+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(h>1e-6)if(Math.abs(l*s-c*u)>1e-6&&i){var f=n-o,d=r-a,p=s*s+c*c,m=f*f+d*d,g=Math.sqrt(p),v=Math.sqrt(h),_=i*Math.tan((Ia-Math.acos((p+h-m)/(2*g*v)))/2),y=_/v,x=_/g;Math.abs(y-1)>1e-6&&(this._+="L"+(e+y*u)+","+(t+y*l)),this._+="A"+i+","+i+",0,0,"+ +(l*f>u*d)+","+(this._x1=e+x*s)+","+(this._y1=t+x*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,r,i,o){e=+e,t=+t,o=!!o;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=e+a,u=t+s,l=1^o,h=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+u:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-u)>1e-6)&&(this._+="L"+c+","+u),n&&(h<0&&(h=h%Da+Da),h>za?this._+="A"+n+","+n+",0,1,"+l+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=c)+","+(this._y1=u):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Ia)+","+l+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Fa=ka;function Ba(e){return e.source}function ja(e){return e.target}function Ha(e){return e.radius}function Ga(e){return e.startAngle}function Va(e){return e.endAngle}var Wa=function(){var e=Ba,t=ja,n=Ha,r=Ga,i=Va,o=null;function a(){var a,s=Oa.call(arguments),c=e.apply(this,s),u=t.apply(this,s),l=+n.apply(this,(s[0]=c,s)),h=r.apply(this,s)-Aa,f=i.apply(this,s)-Aa,d=l*Ma(h),p=l*Sa(h),m=+n.apply(this,(s[0]=u,s)),g=r.apply(this,s)-Aa,v=i.apply(this,s)-Aa;if(o||(o=a=Fa()),o.moveTo(d,p),o.arc(0,0,l,h,f),h===g&&f===v||(o.quadraticCurveTo(0,0,m*Ma(g),m*Sa(g)),o.arc(0,0,m,g,v)),o.quadraticCurveTo(0,0,d,p),o.closePath(),a)return o=null,a+""||null}return a.radius=function(e){return arguments.length?(n="function"==typeof e?e:Na(+e),a):n},a.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:Na(+e),a):r},a.endAngle=function(e){return arguments.length?(i="function"==typeof e?e:Na(+e),a):i},a.source=function(t){return arguments.length?(e=t,a):e},a.target=function(e){return arguments.length?(t=e,a):t},a.context=function(e){return arguments.length?(o=null==e?null:e,a):o},a};function qa(){}function Xa(e,t){var n=new qa;if(e instanceof qa)e.each((function(e,t){n.set(t,e)}));else if(Array.isArray(e)){var r,i=-1,o=e.length;if(null==t)for(;++i<o;)n.set(i,e[i]);else for(;++i<o;)n.set(t(r=e[i],i,e),r)}else if(e)for(var a in e)n.set(a,e[a]);return n}qa.prototype=Xa.prototype={constructor:qa,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if("$"===e[0])return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var Ya=Xa,Za=function(){var e,t,n,r=[],i=[];function o(n,i,a,s){if(i>=r.length)return null!=e&&n.sort(e),null!=t?t(n):n;for(var c,u,l,h=-1,f=n.length,d=r[i++],p=Ya(),m=a();++h<f;)(l=p.get(c=d(u=n[h])+""))?l.push(u):p.set(c,[u]);return p.each((function(e,t){s(m,t,o(e,i,a,s))})),m}return n={object:function(e){return o(e,0,Ja,$a)},map:function(e){return o(e,0,Ka,Qa)},entries:function(e){return function e(n,o){if(++o>r.length)return n;var a,s=i[o-1];return null!=t&&o>=r.length?a=n.entries():(a=[],n.each((function(t,n){a.push({key:n,values:e(t,o)})}))),null!=s?a.sort((function(e,t){return s(e.key,t.key)})):a}(o(e,0,Ka,Qa),0)},key:function(e){return r.push(e),n},sortKeys:function(e){return i[r.length-1]=e,n},sortValues:function(t){return e=t,n},rollup:function(e){return t=e,n}}};function Ja(){return{}}function $a(e,t,n){e[t]=n}function Ka(){return Ya()}function Qa(e,t,n){e.set(t,n)}function es(){}var ts=Ya.prototype;function ns(e,t){var n=new es;if(e instanceof es)e.each((function(e){n.add(e)}));else if(e){var r=-1,i=e.length;if(null==t)for(;++r<i;)n.add(e[r]);else for(;++r<i;)n.add(t(e[r],r,e))}return n}es.prototype=ns.prototype={constructor:es,has:ts.has,add:function(e){return this["$"+(e+="")]=e,this},remove:ts.remove,clear:ts.clear,values:ts.keys,size:ts.size,empty:ts.empty,each:ts.each};var rs=ns,is=function(e){var t=[];for(var n in e)t.push(n);return t},os=function(e){var t=[];for(var n in e)t.push(e[n]);return t},as=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},ss=Array.prototype.slice,cs=function(e,t){return e-t},us=function(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r},ls=function(e){return function(){return e}},hs=function(e,t){for(var n,r=-1,i=t.length;++r<i;)if(n=fs(e,t[r]))return n;return 0};function fs(e,t){for(var n=t[0],r=t[1],i=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var c=e[o],u=c[0],l=c[1],h=e[s],f=h[0],d=h[1];if(ds(c,h,t))return 0;l>r!=d>r&&n<(f-u)*(r-l)/(d-l)+u&&(i=-i)}return i}function ds(e,t,n){var r,i,o,a;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(i=e[r=+(e[0]===t[0])],o=n[r],a=t[r],i<=o&&o<=a||a<=o&&o<=i)}var ps=function(){},ms=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],gs=function(){var e=1,t=1,n=C,r=s;function i(e){var t=n(e);if(Array.isArray(t))t=t.slice().sort(cs);else{var r=g(e),i=r[0],a=r[1];t=L(i,a,t),t=w(Math.floor(i/t)*t,Math.floor(a/t)*t,t)}return t.map((function(t){return o(e,t)}))}function o(n,i){var o=[],s=[];return function(n,r,i){var o,s,c,u,l,h,f=new Array,d=new Array;o=s=-1,u=n[0]>=r,ms[u<<1].forEach(p);for(;++o<e-1;)c=u,u=n[o+1]>=r,ms[c|u<<1].forEach(p);ms[u<<0].forEach(p);for(;++s<t-1;){for(o=-1,u=n[s*e+e]>=r,l=n[s*e]>=r,ms[u<<1|l<<2].forEach(p);++o<e-1;)c=u,u=n[s*e+e+o+1]>=r,h=l,l=n[s*e+o+1]>=r,ms[c|u<<1|l<<2|h<<3].forEach(p);ms[u|l<<3].forEach(p)}o=-1,l=n[s*e]>=r,ms[l<<2].forEach(p);for(;++o<e-1;)h=l,l=n[s*e+o+1]>=r,ms[l<<2|h<<3].forEach(p);function p(e){var t,n,r=[e[0][0]+o,e[0][1]+s],c=[e[1][0]+o,e[1][1]+s],u=a(r),l=a(c);(t=d[u])?(n=f[l])?(delete d[t.end],delete f[n.start],t===n?(t.ring.push(c),i(t.ring)):f[t.start]=d[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete d[t.end],t.ring.push(c),d[t.end=l]=t):(t=f[l])?(n=d[u])?(delete f[t.start],delete d[n.end],t===n?(t.ring.push(c),i(t.ring)):f[n.start]=d[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete f[t.start],t.ring.unshift(r),f[t.start=u]=t):f[u]=d[l]={start:u,end:l,ring:[r,c]}}ms[l<<3].forEach(p)}(n,i,(function(e){r(e,n,i),us(e)>0?o.push([e]):s.push(e)})),s.forEach((function(e){for(var t,n=0,r=o.length;n<r;++n)if(-1!==hs((t=o[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:i,coordinates:o}}function a(t){return 2*t[0]+t[1]*(e+1)*4}function s(n,r,i){n.forEach((function(n){var o,a=n[0],s=n[1],c=0|a,u=0|s,l=r[u*e+c];a>0&&a<e&&c===a&&(o=r[u*e+c-1],n[0]=a+(i-o)/(l-o)-.5),s>0&&s<t&&u===s&&(o=r[(u-1)*e+c],n[1]=s+(i-o)/(l-o)-.5)}))}return i.contour=o,i.size=function(n){if(!arguments.length)return[e,t];var r=Math.ceil(n[0]),o=Math.ceil(n[1]);if(!(r>0&&o>0))throw new Error("invalid size");return e=r,t=o,i},i.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?ls(ss.call(e)):ls(e),i):n},i.smooth=function(e){return arguments.length?(r=e?s:ps,i):r===s},i};function vs(e,t,n){for(var r=e.width,i=e.height,o=1+(n<<1),a=0;a<i;++a)for(var s=0,c=0;s<r+n;++s)s<r&&(c+=e.data[s+a*r]),s>=n&&(s>=o&&(c-=e.data[s-o+a*r]),t.data[s-n+a*r]=c/Math.min(s+1,r-1+o-s,o))}function _s(e,t,n){for(var r=e.width,i=e.height,o=1+(n<<1),a=0;a<r;++a)for(var s=0,c=0;s<i+n;++s)s<i&&(c+=e.data[a+s*r]),s>=n&&(s>=o&&(c-=e.data[a+(s-o)*r]),t.data[a+(s-n)*r]=c/Math.min(s+1,i-1+o-s,o))}function ys(e){return e[0]}function xs(e){return e[1]}function bs(){return 1}var ws=function(){var e=ys,t=xs,n=bs,r=960,i=500,o=20,a=2,s=3*o,c=r+2*s>>a,u=i+2*s>>a,l=ls(20);function h(r){var i=new Float32Array(c*u),h=new Float32Array(c*u);r.forEach((function(r,o,l){var h=+e(r,o,l)+s>>a,f=+t(r,o,l)+s>>a,d=+n(r,o,l);h>=0&&h<c&&f>=0&&f<u&&(i[h+f*c]+=d)})),vs({width:c,height:u,data:i},{width:c,height:u,data:h},o>>a),_s({width:c,height:u,data:h},{width:c,height:u,data:i},o>>a),vs({width:c,height:u,data:i},{width:c,height:u,data:h},o>>a),_s({width:c,height:u,data:h},{width:c,height:u,data:i},o>>a),vs({width:c,height:u,data:i},{width:c,height:u,data:h},o>>a),_s({width:c,height:u,data:h},{width:c,height:u,data:i},o>>a);var d=l(i);if(!Array.isArray(d)){var p=I(i);d=L(0,p,d),(d=w(0,Math.floor(p/d)*d,d)).shift()}return gs().thresholds(d).size([c,u])(i).map(f)}function f(e){return e.value*=Math.pow(2,-2*a),e.coordinates.forEach(d),e}function d(e){e.forEach(p)}function p(e){e.forEach(m)}function m(e){e[0]=e[0]*Math.pow(2,a)-s,e[1]=e[1]*Math.pow(2,a)-s}function g(){return c=r+2*(s=3*o)>>a,u=i+2*s>>a,h}return h.x=function(t){return arguments.length?(e="function"==typeof t?t:ls(+t),h):e},h.y=function(e){return arguments.length?(t="function"==typeof e?e:ls(+e),h):t},h.weight=function(e){return arguments.length?(n="function"==typeof e?e:ls(+e),h):n},h.size=function(e){if(!arguments.length)return[r,i];var t=Math.ceil(e[0]),n=Math.ceil(e[1]);if(!(t>=0||t>=0))throw new Error("invalid size");return r=t,i=n,g()},h.cellSize=function(e){if(!arguments.length)return 1<<a;if(!((e=+e)>=1))throw new Error("invalid cell size");return a=Math.floor(Math.log(e)/Math.LN2),g()},h.thresholds=function(e){return arguments.length?(l="function"==typeof e?e:Array.isArray(e)?ls(ss.call(e)):ls(e),h):l},h.bandwidth=function(e){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((e=+e)>=0))throw new Error("invalid bandwidth");return o=Math.round((Math.sqrt(4*e*e+1)-1)/2),g()},h},Es={},Ms={},Ss=34,Ts=10,As=13;function Ls(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+"]"})).join(",")+"}")}function Cs(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function Rs(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function Ps(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),o=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+Rs(-t,6):t>9999?"+"+Rs(t,6):Rs(t,4))+"-"+Rs(e.getUTCMonth()+1,2)+"-"+Rs(e.getUTCDate(),2)+(o?"T"+Rs(n,2)+":"+Rs(r,2)+":"+Rs(i,2)+"."+Rs(o,3)+"Z":i?"T"+Rs(n,2)+":"+Rs(r,2)+":"+Rs(i,2)+"Z":r||n?"T"+Rs(n,2)+":"+Rs(r,2)+"Z":"")}var Os=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],o=e.length,a=0,s=0,c=o<=0,u=!1;function l(){if(c)return Ms;if(u)return u=!1,Es;var t,r,i=a;if(e.charCodeAt(i)===Ss){for(;a++<o&&e.charCodeAt(a)!==Ss||e.charCodeAt(++a)===Ss;);return(t=a)>=o?c=!0:(r=e.charCodeAt(a++))===Ts?u=!0:r===As&&(u=!0,e.charCodeAt(a)===Ts&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if((r=e.charCodeAt(t=a++))===Ts)u=!0;else if(r===As)u=!0,e.charCodeAt(a)===Ts&&++a;else if(r!==n)continue;return e.slice(i,t)}return c=!0,e.slice(i,o)}for(e.charCodeAt(o-1)===Ts&&--o,e.charCodeAt(o-1)===As&&--o;(r=l())!==Ms;){for(var h=[];r!==Es&&r!==Ms;)h.push(r),r=l();t&&null==(h=t(h,s++))||i.push(h)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return a(t[e])})).join(e)}))}function o(t){return t.map(a).join(e)}function a(e){return null==e?"":e instanceof Date?Ps(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,o=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=Ls(e);return function(r,i){return t(n(r),i,e)}}(e,t):Ls(e)}));return o.columns=i||[],o},parseRows:r,format:function(t,n){return null==n&&(n=Cs(t)),[n.map(a).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=Cs(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")}}},Ns=Os(","),Is=Ns.parse,Ds=Ns.parseRows,zs=Ns.format,Us=Ns.formatBody,ks=Ns.formatRows,Fs=Os("\t"),Bs=Fs.parse,js=Fs.parseRows,Hs=Fs.format,Gs=Fs.formatBody,Vs=Fs.formatRows;function Ws(e){for(var t in e){var n,r=e[t].trim();if(r)if("true"===r)r=!0;else if("false"===r)r=!1;else if("NaN"===r)r=NaN;else if(isNaN(n=+r)){if(!/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/.test(r))continue;r=new Date(r)}else r=n;else r=null;e[t]=r}return e}function qs(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.blob()}var Xs=function(e,t){return fetch(e,t).then(qs)};function Ys(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.arrayBuffer()}var Zs=function(e,t){return fetch(e,t).then(Ys)};function Js(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}var $s=function(e,t){return fetch(e,t).then(Js)};function Ks(e){return function(t,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),$s(t,n).then((function(t){return e(t,r)}))}}function Qs(e,t,n,r){3===arguments.length&&"function"==typeof n&&(r=n,n=void 0);var i=Os(e);return $s(t,n).then((function(e){return i.parse(e,r)}))}var ec=Ks(Is),tc=Ks(Bs),nc=function(e,t){return new Promise((function(n,r){var i=new Image;for(var o in t)i[o]=t[o];i.onerror=r,i.onload=function(){n(i)},i.src=e}))};function rc(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.json()}var ic=function(e,t){return fetch(e,t).then(rc)};function oc(e){return function(t,n){return $s(t,n).then((function(t){return(new DOMParser).parseFromString(t,e)}))}}var ac=oc("application/xml"),sc=oc("text/html"),cc=oc("image/svg+xml"),uc=function(e,t){var n;function r(){var r,i,o=n.length,a=0,s=0;for(r=0;r<o;++r)a+=(i=n[r]).x,s+=i.y;for(a=a/o-e,s=s/o-t,r=0;r<o;++r)(i=n[r]).x-=a,i.y-=s}return null==e&&(e=0),null==t&&(t=0),r.initialize=function(e){n=e},r.x=function(t){return arguments.length?(e=+t,r):e},r.y=function(e){return arguments.length?(t=+e,r):t},r},lc=function(e){return function(){return e}},hc=function(){return 1e-6*(Math.random()-.5)};function fc(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,a,s,c,u,l,h,f,d=e._root,p={data:r},m=e._x0,g=e._y0,v=e._x1,_=e._y1;if(!d)return e._root=p,e;for(;d.length;)if((u=t>=(o=(m+v)/2))?m=o:v=o,(l=n>=(a=(g+_)/2))?g=a:_=a,i=d,!(d=d[h=l<<1|u]))return i[h]=p,e;if(s=+e._x.call(null,d.data),c=+e._y.call(null,d.data),t===s&&n===c)return p.next=d,i?i[h]=p:e._root=p,e;do{i=i?i[h]=new Array(4):e._root=new Array(4),(u=t>=(o=(m+v)/2))?m=o:v=o,(l=n>=(a=(g+_)/2))?g=a:_=a}while((h=l<<1|u)==(f=(c>=a)<<1|s>=o));return i[f]=d,i[h]=p,e}var dc=function(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i};function pc(e){return e[0]}function mc(e){return e[1]}function gc(e,t,n){var r=new vc(null==t?pc:t,null==n?mc:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function vc(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function _c(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var yc=gc.prototype=vc.prototype;function xc(e){return e.x+e.vx}function bc(e){return e.y+e.vy}yc.copy=function(){var e,t,n=new vc(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=_c(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=_c(t));return n},yc.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return fc(this.cover(t,n),t,n,e)},yc.addAll=function(e){var t,n,r,i,o=e.length,a=new Array(o),s=new Array(o),c=1/0,u=1/0,l=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(a[n]=r,s[n]=i,r<c&&(c=r),r>l&&(l=r),i<u&&(u=i),i>h&&(h=i));if(c>l||u>h)return this;for(this.cover(c,u).cover(l,h),n=0;n<o;++n)fc(this,a[n],s[n],e[n]);return this},yc.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var a,s,c=i-n,u=this._root;n>e||e>=i||r>t||t>=o;)switch(s=(t<r)<<1|e<n,(a=new Array(4))[s]=u,u=a,c*=2,s){case 0:i=n+c,o=r+c;break;case 1:n=i-c,o=r+c;break;case 2:i=n+c,r=o-c;break;case 3:n=i-c,r=o-c}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},yc.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},yc.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},yc.find=function(e,t,n){var r,i,o,a,s,c,u,l=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],m=this._root;for(m&&p.push(new dc(m,l,h,f,d)),null==n?n=1/0:(l=e-n,h=t-n,f=e+n,d=t+n,n*=n);c=p.pop();)if(!(!(m=c.node)||(i=c.x0)>f||(o=c.y0)>d||(a=c.x1)<l||(s=c.y1)<h))if(m.length){var g=(i+a)/2,v=(o+s)/2;p.push(new dc(m[3],g,v,a,s),new dc(m[2],i,v,g,s),new dc(m[1],g,o,a,v),new dc(m[0],i,o,g,v)),(u=(t>=v)<<1|e>=g)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=c)}else{var _=e-+this._x.call(null,m.data),y=t-+this._y.call(null,m.data),x=_*_+y*y;if(x<n){var b=Math.sqrt(n=x);l=e-b,h=t-b,f=e+b,d=t+b,r=m.data}}return r},yc.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,n,r,i,o,a,s,c,u,l,h,f,d=this._root,p=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((u=o>=(s=(p+g)/2))?p=s:g=s,(l=a>=(c=(m+v)/2))?m=c:v=c,t=d,!(d=d[h=l<<1|u]))return this;if(!d.length)break;(t[h+1&3]||t[h+2&3]||t[h+3&3])&&(n=t,f=h)}for(;d.data!==e;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):t?(i?t[h]=i:delete t[h],(d=t[0]||t[1]||t[2]||t[3])&&d===(t[3]||t[2]||t[1]||t[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=i,this)},yc.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},yc.root=function(){return this._root},yc.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},yc.visit=function(e){var t,n,r,i,o,a,s=[],c=this._root;for(c&&s.push(new dc(c,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(c=t.node,r=t.x0,i=t.y0,o=t.x1,a=t.y1)&&c.length){var u=(r+o)/2,l=(i+a)/2;(n=c[3])&&s.push(new dc(n,u,l,o,a)),(n=c[2])&&s.push(new dc(n,r,l,u,a)),(n=c[1])&&s.push(new dc(n,u,i,o,l)),(n=c[0])&&s.push(new dc(n,r,i,u,l))}return this},yc.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new dc(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,c=t.x1,u=t.y1,l=(a+c)/2,h=(s+u)/2;(o=i[0])&&n.push(new dc(o,a,s,l,h)),(o=i[1])&&n.push(new dc(o,l,s,c,h)),(o=i[2])&&n.push(new dc(o,a,h,l,u)),(o=i[3])&&n.push(new dc(o,l,h,c,u))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},yc.x=function(e){return arguments.length?(this._x=e,this):this._x},yc.y=function(e){return arguments.length?(this._y=e,this):this._y};var wc=function(e){var t,n,r=1,i=1;function o(){for(var e,o,s,c,u,l,h,f=t.length,d=0;d<i;++d)for(o=gc(t,xc,bc).visitAfter(a),e=0;e<f;++e)s=t[e],l=n[s.index],h=l*l,c=s.x+s.vx,u=s.y+s.vy,o.visit(p);function p(e,t,n,i,o){var a=e.data,f=e.r,d=l+f;if(!a)return t>c+d||i<c-d||n>u+d||o<u-d;if(a.index>s.index){var p=c-a.x-a.vx,m=u-a.y-a.vy,g=p*p+m*m;g<d*d&&(0===p&&(g+=(p=hc())*p),0===m&&(g+=(m=hc())*m),g=(d-(g=Math.sqrt(g)))/g*r,s.vx+=(p*=g)*(d=(f*=f)/(h+f)),s.vy+=(m*=g)*d,a.vx-=p*(d=1-d),a.vy-=m*d)}}}function a(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function s(){if(t){var r,i,o=t.length;for(n=new Array(o),r=0;r<o;++r)i=t[r],n[i.index]=+e(i,r,t)}}return"function"!=typeof e&&(e=lc(null==e?1:+e)),o.initialize=function(e){t=e,s()},o.iterations=function(e){return arguments.length?(i=+e,o):i},o.strength=function(e){return arguments.length?(r=+e,o):r},o.radius=function(t){return arguments.length?(e="function"==typeof t?t:lc(+t),s(),o):e},o};function Ec(e){return e.index}function Mc(e,t){var n=e.get(t);if(!n)throw new Error("missing: "+t);return n}var Sc=function(e){var t,n,r,i,o,a=Ec,s=function(e){return 1/Math.min(i[e.source.index],i[e.target.index])},c=lc(30),u=1;function l(r){for(var i=0,a=e.length;i<u;++i)for(var s,c,l,h,f,d,p,m=0;m<a;++m)c=(s=e[m]).source,h=(l=s.target).x+l.vx-c.x-c.vx||hc(),f=l.y+l.vy-c.y-c.vy||hc(),h*=d=((d=Math.sqrt(h*h+f*f))-n[m])/d*r*t[m],f*=d,l.vx-=h*(p=o[m]),l.vy-=f*p,c.vx+=h*(p=1-p),c.vy+=f*p}function h(){if(r){var s,c,u=r.length,l=e.length,h=Ya(r,a);for(s=0,i=new Array(u);s<l;++s)(c=e[s]).index=s,"object"!=typeof c.source&&(c.source=Mc(h,c.source)),"object"!=typeof c.target&&(c.target=Mc(h,c.target)),i[c.source.index]=(i[c.source.index]||0)+1,i[c.target.index]=(i[c.target.index]||0)+1;for(s=0,o=new Array(l);s<l;++s)c=e[s],o[s]=i[c.source.index]/(i[c.source.index]+i[c.target.index]);t=new Array(l),f(),n=new Array(l),d()}}function f(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+s(e[n],n,e)}function d(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),l.initialize=function(e){r=e,h()},l.links=function(t){return arguments.length?(e=t,h(),l):e},l.id=function(e){return arguments.length?(a=e,l):a},l.iterations=function(e){return arguments.length?(u=+e,l):u},l.strength=function(e){return arguments.length?(s="function"==typeof e?e:lc(+e),f(),l):s},l.distance=function(e){return arguments.length?(c="function"==typeof e?e:lc(+e),d(),l):c},l};function Tc(e){return e.x}function Ac(e){return e.y}var Lc=10,Cc=Math.PI*(3-Math.sqrt(5)),Rc=function(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=Ya(),c=hi(l),u=me("tick","end");function l(){h(),u.call("tick",t),n<r&&(c.stop(),u.call("end",t))}function h(r){var c,u,l=e.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(o-n)*i,s.each((function(e){e(n)})),c=0;c<l;++c)null==(u=e[c]).fx?u.x+=u.vx*=a:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=a:(u.y=u.fy,u.vy=0);return t}function f(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=Lc*Math.sqrt(n),o=n*Cc;t.x=i*Math.cos(o),t.y=i*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function d(t){return t.initialize&&t.initialize(e),t}return null==e&&(e=[]),f(),t={tick:h,restart:function(){return c.restart(l),t},stop:function(){return c.stop(),t},nodes:function(n){return arguments.length?(e=n,f(),s.each(d),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(a=1-e,t):1-a},force:function(e,n){return arguments.length>1?(null==n?s.remove(e):s.set(e,d(n)),t):s.get(e)},find:function(t,n,r){var i,o,a,s,c,u=0,l=e.length;for(null==r?r=1/0:r*=r,u=0;u<l;++u)(a=(i=t-(s=e[u]).x)*i+(o=n-s.y)*o)<r&&(c=s,r=a);return c},on:function(e,n){return arguments.length>1?(u.on(e,n),t):u.on(e)}}},Pc=function(){var e,t,n,r,i=lc(-30),o=1,a=1/0,s=.81;function c(r){var i,o=e.length,a=gc(e,Tc,Ac).visitAfter(l);for(n=r,i=0;i<o;++i)t=e[i],a.visit(h)}function u(){if(e){var t,n,o=e.length;for(r=new Array(o),t=0;t<o;++t)n=e[t],r[n.index]=+i(n,t,e)}}function l(e){var t,n,i,o,a,s=0,c=0;if(e.length){for(i=o=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(s+=t.value,c+=n,i+=n*t.x,o+=n*t.y);e.x=i/c,e.y=o/c}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=r[t.data.index]}while(t=t.next)}e.value=s}function h(e,i,c,u){if(!e.value)return!0;var l=e.x-t.x,h=e.y-t.y,f=u-i,d=l*l+h*h;if(f*f/s<d)return d<a&&(0===l&&(d+=(l=hc())*l),0===h&&(d+=(h=hc())*h),d<o&&(d=Math.sqrt(o*d)),t.vx+=l*e.value*n/d,t.vy+=h*e.value*n/d),!0;if(!(e.length||d>=a)){(e.data!==t||e.next)&&(0===l&&(d+=(l=hc())*l),0===h&&(d+=(h=hc())*h),d<o&&(d=Math.sqrt(o*d)));do{e.data!==t&&(f=r[e.data.index]*n/d,t.vx+=l*f,t.vy+=h*f)}while(e=e.next)}}return c.initialize=function(t){e=t,u()},c.strength=function(e){return arguments.length?(i="function"==typeof e?e:lc(+e),u(),c):i},c.distanceMin=function(e){return arguments.length?(o=e*e,c):Math.sqrt(o)},c.distanceMax=function(e){return arguments.length?(a=e*e,c):Math.sqrt(a)},c.theta=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c},Oc=function(e,t,n){var r,i,o,a=lc(.1);function s(e){for(var a=0,s=r.length;a<s;++a){var c=r[a],u=c.x-t||1e-6,l=c.y-n||1e-6,h=Math.sqrt(u*u+l*l),f=(o[a]-h)*i[a]*e/h;c.vx+=u*f,c.vy+=l*f}}function c(){if(r){var t,n=r.length;for(i=new Array(n),o=new Array(n),t=0;t<n;++t)o[t]=+e(r[t],t,r),i[t]=isNaN(o[t])?0:+a(r[t],t,r)}}return"function"!=typeof e&&(e=lc(+e)),null==t&&(t=0),null==n&&(n=0),s.initialize=function(e){r=e,c()},s.strength=function(e){return arguments.length?(a="function"==typeof e?e:lc(+e),c(),s):a},s.radius=function(t){return arguments.length?(e="function"==typeof t?t:lc(+t),c(),s):e},s.x=function(e){return arguments.length?(t=+e,s):t},s.y=function(e){return arguments.length?(n=+e,s):n},s},Nc=function(e){var t,n,r,i=lc(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vx+=(r[o]-i.x)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=lc(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:lc(+e),a(),o):i},o.x=function(t){return arguments.length?(e="function"==typeof t?t:lc(+t),a(),o):e},o},Ic=function(e){var t,n,r,i=lc(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vy+=(r[o]-i.y)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=lc(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:lc(+e),a(),o):i},o.y=function(t){return arguments.length?(e="function"==typeof t?t:lc(+t),a(),o):e},o},Dc=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]},zc=function(e){return(e=Dc(Math.abs(e)))?e[1]:NaN},Uc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function kc(e){if(!(t=Uc.exec(e)))throw new Error("invalid format: "+e);var t;return new Fc({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Fc(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}kc.prototype=Fc.prototype,Fc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Bc,jc,Hc,Gc,Vc=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(i>0){if(!+e[r])break e;i=0}}return i>0?e.slice(0,i)+e.slice(t+1):e},Wc=function(e,t){var n=Dc(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},qc={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Wc(100*e,t)},r:Wc,s:function(e,t){var n=Dc(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(Bc=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Dc(e,Math.max(0,t+o-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},Xc=function(e){return e},Yc=Array.prototype.map,Zc=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],Jc=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Xc:(t=Yc.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(e.substring(i-=s,i+s)),!((c+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Xc:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Yc.call(e.numerals,String)),c=void 0===e.percent?"%":e.percent+"",u=void 0===e.minus?"-":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=kc(e)).fill,n=e.align,h=e.sign,f=e.symbol,d=e.zero,p=e.width,m=e.comma,g=e.precision,v=e.trim,_=e.type;"n"===_?(m=!0,_="g"):qc[_]||(void 0===g&&(g=12),v=!0,_="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var y="$"===f?i:"#"===f&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",x="$"===f?o:/[%p]/.test(_)?c:"",b=qc[_],w=/[defgprs%]/.test(_);function E(e){var i,o,c,f=y,E=x;if("c"===_)E=b(e)+E,e="";else{var M=(e=+e)<0;if(e=isNaN(e)?l:b(Math.abs(e),g),v&&(e=Vc(e)),M&&0==+e&&(M=!1),f=(M?"("===h?h:u:"-"===h||"("===h?"":h)+f,E=("s"===_?Zc[8+Bc/3]:"")+E+(M&&"("===h?")":""),w)for(i=-1,o=e.length;++i<o;)if(48>(c=e.charCodeAt(i))||c>57){E=(46===c?a+e.slice(i+1):e.slice(i))+E,e=e.slice(0,i);break}}m&&!d&&(e=r(e,1/0));var S=f.length+e.length+E.length,T=S<p?new Array(p-S+1).join(t):"";switch(m&&d&&(e=r(T+e,T.length?p-E.length:1/0),T=""),n){case"<":e=f+e+E+T;break;case"=":e=f+T+e+E;break;case"^":e=T.slice(0,S=T.length>>1)+f+e+E+T.slice(S);break;default:e=T+f+e+E}return s(e)}return g=void 0===g?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),E.toString=function(){return e+""},E}return{format:h,formatPrefix:function(e,t){var n=h(((e=kc(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(zc(t)/3))),i=Math.pow(10,-r),o=Zc[8+r/3];return function(e){return n(i*e)+o}}}};function $c(e){return jc=Jc(e),Hc=jc.format,Gc=jc.formatPrefix,jc}$c({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var Kc=function(e){return Math.max(0,-zc(Math.abs(e)))},Qc=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(zc(t)/3)))-zc(Math.abs(e)))},eu=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,zc(t)-zc(e))+1},tu=function(){return new nu};function nu(){this.reset()}nu.prototype={constructor:nu,reset:function(){this.s=this.t=0},add:function(e){iu(ru,e,this.t),iu(this,ru.s,this.s),this.s?this.t+=ru.t:this.s=ru.t},valueOf:function(){return this.s}};var ru=new nu;function iu(e,t,n){var r=e.s=t+n,i=r-t,o=r-i;e.t=t-o+(n-i)}var ou=1e-6,au=1e-12,su=Math.PI,cu=su/2,uu=su/4,lu=2*su,hu=180/su,fu=su/180,du=Math.abs,pu=Math.atan,mu=Math.atan2,gu=Math.cos,vu=Math.ceil,_u=Math.exp,yu=(Math.floor,Math.log),xu=Math.pow,bu=Math.sin,wu=Math.sign||function(e){return e>0?1:e<0?-1:0},Eu=Math.sqrt,Mu=Math.tan;function Su(e){return e>1?0:e<-1?su:Math.acos(e)}function Tu(e){return e>1?cu:e<-1?-cu:Math.asin(e)}function Au(e){return(e=bu(e/2))*e}function Lu(){}function Cu(e,t){e&&Pu.hasOwnProperty(e.type)&&Pu[e.type](e,t)}var Ru={Feature:function(e,t){Cu(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Cu(n[r].geometry,t)}},Pu={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ou(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Ou(n[r],t,0)},Polygon:function(e,t){Nu(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Nu(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Cu(n[r],t)}};function Ou(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function Nu(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Ou(e[n],t,1);t.polygonEnd()}var Iu,Du,zu,Uu,ku,Fu=function(e,t){e&&Ru.hasOwnProperty(e.type)?Ru[e.type](e,t):Cu(e,t)},Bu=tu(),ju=tu(),Hu={point:Lu,lineStart:Lu,lineEnd:Lu,polygonStart:function(){Bu.reset(),Hu.lineStart=Gu,Hu.lineEnd=Vu},polygonEnd:function(){var e=+Bu;ju.add(e<0?lu+e:e),this.lineStart=this.lineEnd=this.point=Lu},sphere:function(){ju.add(lu)}};function Gu(){Hu.point=Wu}function Vu(){qu(Iu,Du)}function Wu(e,t){Hu.point=qu,Iu=e,Du=t,zu=e*=fu,Uu=gu(t=(t*=fu)/2+uu),ku=bu(t)}function qu(e,t){var n=(e*=fu)-zu,r=n>=0?1:-1,i=r*n,o=gu(t=(t*=fu)/2+uu),a=bu(t),s=ku*a,c=Uu*o+s*gu(i),u=s*r*bu(i);Bu.add(mu(u,c)),zu=e,Uu=o,ku=a}var Xu=function(e){return ju.reset(),Fu(e,Hu),2*ju};function Yu(e){return[mu(e[1],e[0]),Tu(e[2])]}function Zu(e){var t=e[0],n=e[1],r=gu(n);return[r*gu(t),r*bu(t),bu(n)]}function Ju(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function $u(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ku(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Qu(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function el(e){var t=Eu(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var tl,nl,rl,il,ol,al,sl,cl,ul,ll,hl=tu(),fl={point:dl,lineStart:ml,lineEnd:gl,polygonStart:function(){fl.point=vl,fl.lineStart=_l,fl.lineEnd=yl,hl.reset(),Hu.polygonStart()},polygonEnd:function(){Hu.polygonEnd(),fl.point=dl,fl.lineStart=ml,fl.lineEnd=gl,Bu<0?(tl=-(rl=180),nl=-(il=90)):hl>ou?il=90:hl<-ou&&(nl=-90),ll[0]=tl,ll[1]=rl},sphere:function(){tl=-(rl=180),nl=-(il=90)}};function dl(e,t){ul.push(ll=[tl=e,rl=e]),t<nl&&(nl=t),t>il&&(il=t)}function pl(e,t){var n=Zu([e*fu,t*fu]);if(cl){var r=$u(cl,n),i=$u([r[1],-r[0],0],r);el(i),i=Yu(i);var o,a=e-ol,s=a>0?1:-1,c=i[0]*hu*s,u=du(a)>180;u^(s*ol<c&&c<s*e)?(o=i[1]*hu)>il&&(il=o):u^(s*ol<(c=(c+360)%360-180)&&c<s*e)?(o=-i[1]*hu)<nl&&(nl=o):(t<nl&&(nl=t),t>il&&(il=t)),u?e<ol?xl(tl,e)>xl(tl,rl)&&(rl=e):xl(e,rl)>xl(tl,rl)&&(tl=e):rl>=tl?(e<tl&&(tl=e),e>rl&&(rl=e)):e>ol?xl(tl,e)>xl(tl,rl)&&(rl=e):xl(e,rl)>xl(tl,rl)&&(tl=e)}else ul.push(ll=[tl=e,rl=e]);t<nl&&(nl=t),t>il&&(il=t),cl=n,ol=e}function ml(){fl.point=pl}function gl(){ll[0]=tl,ll[1]=rl,fl.point=dl,cl=null}function vl(e,t){if(cl){var n=e-ol;hl.add(du(n)>180?n+(n>0?360:-360):n)}else al=e,sl=t;Hu.point(e,t),pl(e,t)}function _l(){Hu.lineStart()}function yl(){vl(al,sl),Hu.lineEnd(),du(hl)>ou&&(tl=-(rl=180)),ll[0]=tl,ll[1]=rl,cl=null}function xl(e,t){return(t-=e)<0?t+360:t}function bl(e,t){return e[0]-t[0]}function wl(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var El,Ml,Sl,Tl,Al,Ll,Cl,Rl,Pl,Ol,Nl,Il,Dl,zl,Ul,kl,Fl=function(e){var t,n,r,i,o,a,s;if(il=rl=-(tl=nl=1/0),ul=[],Fu(e,fl),n=ul.length){for(ul.sort(bl),t=1,o=[r=ul[0]];t<n;++t)wl(r,(i=ul[t])[0])||wl(r,i[1])?(xl(r[0],i[1])>xl(r[0],r[1])&&(r[1]=i[1]),xl(i[0],r[1])>xl(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,t=0,r=o[n=o.length-1];t<=n;r=i,++t)i=o[t],(s=xl(r[1],i[0]))>a&&(a=s,tl=i[0],rl=r[1])}return ul=ll=null,tl===1/0||nl===1/0?[[NaN,NaN],[NaN,NaN]]:[[tl,nl],[rl,il]]},Bl={sphere:Lu,point:jl,lineStart:Gl,lineEnd:ql,polygonStart:function(){Bl.lineStart=Xl,Bl.lineEnd=Yl},polygonEnd:function(){Bl.lineStart=Gl,Bl.lineEnd=ql}};function jl(e,t){e*=fu;var n=gu(t*=fu);Hl(n*gu(e),n*bu(e),bu(t))}function Hl(e,t,n){Sl+=(e-Sl)/++El,Tl+=(t-Tl)/El,Al+=(n-Al)/El}function Gl(){Bl.point=Vl}function Vl(e,t){e*=fu;var n=gu(t*=fu);zl=n*gu(e),Ul=n*bu(e),kl=bu(t),Bl.point=Wl,Hl(zl,Ul,kl)}function Wl(e,t){e*=fu;var n=gu(t*=fu),r=n*gu(e),i=n*bu(e),o=bu(t),a=mu(Eu((a=Ul*o-kl*i)*a+(a=kl*r-zl*o)*a+(a=zl*i-Ul*r)*a),zl*r+Ul*i+kl*o);Ml+=a,Ll+=a*(zl+(zl=r)),Cl+=a*(Ul+(Ul=i)),Rl+=a*(kl+(kl=o)),Hl(zl,Ul,kl)}function ql(){Bl.point=jl}function Xl(){Bl.point=Zl}function Yl(){Jl(Il,Dl),Bl.point=jl}function Zl(e,t){Il=e,Dl=t,e*=fu,t*=fu,Bl.point=Jl;var n=gu(t);zl=n*gu(e),Ul=n*bu(e),kl=bu(t),Hl(zl,Ul,kl)}function Jl(e,t){e*=fu;var n=gu(t*=fu),r=n*gu(e),i=n*bu(e),o=bu(t),a=Ul*o-kl*i,s=kl*r-zl*o,c=zl*i-Ul*r,u=Eu(a*a+s*s+c*c),l=Tu(u),h=u&&-l/u;Pl+=h*a,Ol+=h*s,Nl+=h*c,Ml+=l,Ll+=l*(zl+(zl=r)),Cl+=l*(Ul+(Ul=i)),Rl+=l*(kl+(kl=o)),Hl(zl,Ul,kl)}var $l=function(e){El=Ml=Sl=Tl=Al=Ll=Cl=Rl=Pl=Ol=Nl=0,Fu(e,Bl);var t=Pl,n=Ol,r=Nl,i=t*t+n*n+r*r;return i<au&&(t=Ll,n=Cl,r=Rl,Ml<ou&&(t=Sl,n=Tl,r=Al),(i=t*t+n*n+r*r)<au)?[NaN,NaN]:[mu(n,t)*hu,Tu(r/Eu(i))*hu]},Kl=function(e){return function(){return e}},Ql=function(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n};function eh(e,t){return[du(e)>su?e+Math.round(-e/lu)*lu:e,t]}function th(e,t,n){return(e%=lu)?t||n?Ql(rh(e),ih(t,n)):rh(e):t||n?ih(t,n):eh}function nh(e){return function(t,n){return[(t+=e)>su?t-lu:t<-su?t+lu:t,n]}}function rh(e){var t=nh(e);return t.invert=nh(-e),t}function ih(e,t){var n=gu(e),r=bu(e),i=gu(t),o=bu(t);function a(e,t){var a=gu(t),s=gu(e)*a,c=bu(e)*a,u=bu(t),l=u*n+s*r;return[mu(c*i-l*o,s*n-u*r),Tu(l*i+c*o)]}return a.invert=function(e,t){var a=gu(t),s=gu(e)*a,c=bu(e)*a,u=bu(t),l=u*i-c*o;return[mu(c*i+u*o,s*n+l*r),Tu(l*n-s*r)]},a}eh.invert=eh;var oh=function(e){function t(t){return(t=e(t[0]*fu,t[1]*fu))[0]*=hu,t[1]*=hu,t}return e=th(e[0]*fu,e[1]*fu,e.length>2?e[2]*fu:0),t.invert=function(t){return(t=e.invert(t[0]*fu,t[1]*fu))[0]*=hu,t[1]*=hu,t},t};function ah(e,t,n,r,i,o){if(n){var a=gu(t),s=bu(t),c=r*n;null==i?(i=t+r*lu,o=t-c/2):(i=sh(a,i),o=sh(a,o),(r>0?i<o:i>o)&&(i+=r*lu));for(var u,l=i;r>0?l>o:l<o;l-=c)u=Yu([a,-s*gu(l),-s*bu(l)]),e.point(u[0],u[1])}}function sh(e,t){(t=Zu(t))[0]-=e,el(t);var n=Su(-t[1]);return((-t[2]<0?-n:n)+lu-ou)%lu}var ch=function(){var e,t,n=Kl([0,0]),r=Kl(90),i=Kl(6),o={point:function(n,r){e.push(n=t(n,r)),n[0]*=hu,n[1]*=hu}};function a(){var a=n.apply(this,arguments),s=r.apply(this,arguments)*fu,c=i.apply(this,arguments)*fu;return e=[],t=th(-a[0]*fu,-a[1]*fu,0).invert,ah(o,s,c,1),a={type:"Polygon",coordinates:[e]},e=t=null,a}return a.center=function(e){return arguments.length?(n="function"==typeof e?e:Kl([+e[0],+e[1]]),a):n},a.radius=function(e){return arguments.length?(r="function"==typeof e?e:Kl(+e),a):r},a.precision=function(e){return arguments.length?(i="function"==typeof e?e:Kl(+e),a):i},a},uh=function(){var e,t=[];return{point:function(t,n){e.push([t,n])},lineStart:function(){t.push(e=[])},lineEnd:Lu,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}},lh=function(e,t){return du(e[0]-t[0])<ou&&du(e[1]-t[1])<ou};function hh(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var fh=function(e,t,n,r,i){var o,a,s=[],c=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],a=e[t];if(lh(r,a)){for(i.lineStart(),o=0;o<t;++o)i.point((r=e[o])[0],r[1]);i.lineEnd()}else s.push(n=new hh(r,e,null,!0)),c.push(n.o=new hh(r,null,n,!1)),s.push(n=new hh(a,e,null,!1)),c.push(n.o=new hh(a,null,n,!0))}})),s.length){for(c.sort(t),dh(s),dh(c),o=0,a=c.length;o<a;++o)c[o].e=n=!n;for(var u,l,h=s[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;u=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(o=0,a=u.length;o<a;++o)i.point((l=u[o])[0],l[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(u=f.p.z,o=u.length-1;o>=0;--o)i.point((l=u[o])[0],l[1]);else r(f.x,f.p.x,-1,i);f=f.p}u=(f=f.o).z,d=!d}while(!f.v);i.lineEnd()}}};function dh(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}var ph=tu();function mh(e){return du(e[0])<=su?e[0]:wu(e[0])*((du(e[0])+su)%lu-su)}var gh=function(e,t){var n=mh(t),r=t[1],i=bu(r),o=[bu(n),-gu(n),0],a=0,s=0;ph.reset(),1===i?r=cu+ou:-1===i&&(r=-cu-ou);for(var c=0,u=e.length;c<u;++c)if(h=(l=e[c]).length)for(var l,h,f=l[h-1],d=mh(f),p=f[1]/2+uu,m=bu(p),g=gu(p),v=0;v<h;++v,d=y,m=b,g=w,f=_){var _=l[v],y=mh(_),x=_[1]/2+uu,b=bu(x),w=gu(x),E=y-d,M=E>=0?1:-1,S=M*E,T=S>su,A=m*b;if(ph.add(mu(A*M*bu(S),g*w+A*gu(S))),a+=T?E+M*lu:E,T^d>=n^y>=n){var L=$u(Zu(f),Zu(_));el(L);var C=$u(o,L);el(C);var R=(T^E>=0?-1:1)*Tu(C[2]);(r>R||r===R&&(L[0]||L[1]))&&(s+=T^E>=0?1:-1)}}return(a<-ou||a<ou&&ph<-ou)^1&s},vh=function(e,t,n,r){return function(i){var o,a,s,c=t(i),u=uh(),l=t(u),h=!1,f={point:d,lineStart:m,lineEnd:g,polygonStart:function(){f.point=v,f.lineStart=_,f.lineEnd=y,a=[],o=[]},polygonEnd:function(){f.point=d,f.lineStart=m,f.lineEnd=g,a=U(a);var e=gh(o,r);a.length?(h||(i.polygonStart(),h=!0),fh(a,yh,e,n,i)):e&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(t,n){e(t,n)&&i.point(t,n)}function p(e,t){c.point(e,t)}function m(){f.point=p,c.lineStart()}function g(){f.point=d,c.lineEnd()}function v(e,t){s.push([e,t]),l.point(e,t)}function _(){l.lineStart(),s=[]}function y(){v(s[0][0],s[0][1]),l.lineEnd();var e,t,n,r,c=l.clean(),f=u.result(),d=f.length;if(s.pop(),o.push(s),s=null,d)if(1&c){if((t=(n=f[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else d>1&&2&c&&f.push(f.pop().concat(f.shift())),a.push(f.filter(_h))}return f}};function _h(e){return e.length>1}function yh(e,t){return((e=e.x)[0]<0?e[1]-cu-ou:cu-e[1])-((t=t.x)[0]<0?t[1]-cu-ou:cu-t[1])}var xh=vh((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?su:-su,c=du(o-n);du(c-su)<ou?(e.point(n,r=(r+a)/2>0?cu:-cu),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(o,r),t=0):i!==s&&c>=su&&(du(n-i)<ou&&(n-=i*ou),du(o-s)<ou&&(o-=s*ou),r=function(e,t,n,r){var i,o,a=bu(e-n);return du(a)>ou?pu((bu(t)*(o=gu(r))*bu(n)-bu(r)*(i=gu(t))*bu(e))/(i*o*a)):(t+r)/2}(n,r,o,a),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=o,r=a),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*cu,r.point(-su,i),r.point(0,i),r.point(su,i),r.point(su,0),r.point(su,-i),r.point(0,-i),r.point(-su,-i),r.point(-su,0),r.point(-su,i);else if(du(e[0]-t[0])>ou){var o=e[0]<t[0]?su:-su;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}),[-su,-cu]);var bh=function(e){var t=gu(e),n=6*fu,r=t>0,i=du(t)>ou;function o(e,n){return gu(e)*gu(n)>t}function a(e,n,r){var i=[1,0,0],o=$u(Zu(e),Zu(n)),a=Ju(o,o),s=o[0],c=a-s*s;if(!c)return!r&&e;var u=t*a/c,l=-t*s/c,h=$u(i,o),f=Qu(i,u);Ku(f,Qu(o,l));var d=h,p=Ju(f,d),m=Ju(d,d),g=p*p-m*(Ju(f,f)-1);if(!(g<0)){var v=Eu(g),_=Qu(d,(-p-v)/m);if(Ku(_,f),_=Yu(_),!r)return _;var y,x=e[0],b=n[0],w=e[1],E=n[1];b<x&&(y=x,x=b,b=y);var M=b-x,S=du(M-su)<ou;if(!S&&E<w&&(y=w,w=E,E=y),S||M<ou?S?w+E>0^_[1]<(du(_[0]-x)<ou?w:E):w<=_[1]&&_[1]<=E:M>su^(x<=_[0]&&_[0]<=b)){var T=Qu(d,(-p+v)/m);return Ku(T,f),[_,Yu(T)]}}}function s(t,n){var i=r?e:su-e,o=0;return t<-i?o|=1:t>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return vh(o,(function(e){var t,n,c,u,l;return{lineStart:function(){u=c=!1,l=1},point:function(h,f){var d,p=[h,f],m=o(h,f),g=r?m?0:s(h,f):m?s(h+(h<0?su:-su),f):0;if(!t&&(u=c=m)&&e.lineStart(),m!==c&&(!(d=a(t,p))||lh(t,d)||lh(p,d))&&(p[0]+=ou,p[1]+=ou,m=o(p[0],p[1])),m!==c)l=0,m?(e.lineStart(),d=a(p,t),e.point(d[0],d[1])):(d=a(t,p),e.point(d[0],d[1]),e.lineEnd()),t=d;else if(i&&t&&r^m){var v;g&n||!(v=a(p,t,!0))||(l=0,r?(e.lineStart(),e.point(v[0][0],v[0][1]),e.point(v[1][0],v[1][1]),e.lineEnd()):(e.point(v[1][0],v[1][1]),e.lineEnd(),e.lineStart(),e.point(v[0][0],v[0][1])))}!m||t&&lh(t,p)||e.point(p[0],p[1]),t=p,c=m,n=g},lineEnd:function(){c&&e.lineEnd(),t=null},clean:function(){return l|(u&&c)<<1}}}),(function(t,r,i,o){ah(o,e,n,i,t,r)}),r?[0,-e]:[-su,e-su])},wh=function(e,t,n,r,i,o){var a,s=e[0],c=e[1],u=0,l=1,h=t[0]-s,f=t[1]-c;if(a=n-s,h||!(a>0)){if(a/=h,h<0){if(a<u)return;a<l&&(l=a)}else if(h>0){if(a>l)return;a>u&&(u=a)}if(a=i-s,h||!(a<0)){if(a/=h,h<0){if(a>l)return;a>u&&(u=a)}else if(h>0){if(a<u)return;a<l&&(l=a)}if(a=r-c,f||!(a>0)){if(a/=f,f<0){if(a<u)return;a<l&&(l=a)}else if(f>0){if(a>l)return;a>u&&(u=a)}if(a=o-c,f||!(a<0)){if(a/=f,f<0){if(a>l)return;a>u&&(u=a)}else if(f>0){if(a<u)return;a<l&&(l=a)}return u>0&&(e[0]=s+u*h,e[1]=c+u*f),l<1&&(t[0]=s+l*h,t[1]=c+l*f),!0}}}}},Eh=1e9,Mh=-Eh;function Sh(e,t,n,r){function i(i,o){return e<=i&&i<=n&&t<=o&&o<=r}function o(i,o,s,u){var l=0,h=0;if(null==i||(l=a(i,s))!==(h=a(o,s))||c(i,o)<0^s>0)do{u.point(0===l||3===l?e:n,l>1?r:t)}while((l=(l+s+4)%4)!==h);else u.point(o[0],o[1])}function a(r,i){return du(r[0]-e)<ou?i>0?0:3:du(r[0]-n)<ou?i>0?2:1:du(r[1]-t)<ou?i>0?1:0:i>0?3:2}function s(e,t){return c(e.x,t.x)}function c(e,t){var n=a(e,1),r=a(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(a){var c,u,l,h,f,d,p,m,g,v,_,y=a,x=uh(),b={point:w,lineStart:function(){b.point=E,u&&u.push(l=[]);v=!0,g=!1,p=m=NaN},lineEnd:function(){c&&(E(h,f),d&&g&&x.rejoin(),c.push(x.result()));b.point=w,g&&y.lineEnd()},polygonStart:function(){y=x,c=[],u=[],_=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=u.length;n<i;++n)for(var o,a,s=u[n],c=1,l=s.length,h=s[0],f=h[0],d=h[1];c<l;++c)o=f,a=d,h=s[c],f=h[0],d=h[1],a<=r?d>r&&(f-o)*(r-a)>(d-a)*(e-o)&&++t:d<=r&&(f-o)*(r-a)<(d-a)*(e-o)&&--t;return t}(),n=_&&t,i=(c=U(c)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&fh(c,s,t,o,a),a.polygonEnd());y=a,c=u=l=null}};function w(e,t){i(e,t)&&y.point(e,t)}function E(o,a){var s=i(o,a);if(u&&l.push([o,a]),v)h=o,f=a,d=s,v=!1,s&&(y.lineStart(),y.point(o,a));else if(s&&g)y.point(o,a);else{var c=[p=Math.max(Mh,Math.min(Eh,p)),m=Math.max(Mh,Math.min(Eh,m))],x=[o=Math.max(Mh,Math.min(Eh,o)),a=Math.max(Mh,Math.min(Eh,a))];wh(c,x,e,t,n,r)?(g||(y.lineStart(),y.point(c[0],c[1])),y.point(x[0],x[1]),s||y.lineEnd(),_=!1):s&&(y.lineStart(),y.point(o,a),_=!1)}p=o,m=a,g=s}return b}}var Th,Ah,Lh,Ch=function(){var e,t,n,r=0,i=0,o=960,a=500;return n={stream:function(n){return e&&t===n?e:e=Sh(r,i,o,a)(t=n)},extent:function(s){return arguments.length?(r=+s[0][0],i=+s[0][1],o=+s[1][0],a=+s[1][1],e=t=null,n):[[r,i],[o,a]]}}},Rh=tu(),Ph={sphere:Lu,point:Lu,lineStart:function(){Ph.point=Nh,Ph.lineEnd=Oh},lineEnd:Lu,polygonStart:Lu,polygonEnd:Lu};function Oh(){Ph.point=Ph.lineEnd=Lu}function Nh(e,t){Th=e*=fu,Ah=bu(t*=fu),Lh=gu(t),Ph.point=Ih}function Ih(e,t){e*=fu;var n=bu(t*=fu),r=gu(t),i=du(e-Th),o=gu(i),a=r*bu(i),s=Lh*n-Ah*r*o,c=Ah*n+Lh*r*o;Rh.add(mu(Eu(a*a+s*s),c)),Th=e,Ah=n,Lh=r}var Dh=function(e){return Rh.reset(),Fu(e,Ph),+Rh},zh=[null,null],Uh={type:"LineString",coordinates:zh},kh=function(e,t){return zh[0]=e,zh[1]=t,Dh(Uh)},Fh={Feature:function(e,t){return jh(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)if(jh(n[r].geometry,t))return!0;return!1}},Bh={Sphere:function(){return!0},Point:function(e,t){return Hh(e.coordinates,t)},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Hh(n[r],t))return!0;return!1},LineString:function(e,t){return Gh(e.coordinates,t)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Gh(n[r],t))return!0;return!1},Polygon:function(e,t){return Vh(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Vh(n[r],t))return!0;return!1},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)if(jh(n[r],t))return!0;return!1}};function jh(e,t){return!(!e||!Bh.hasOwnProperty(e.type))&&Bh[e.type](e,t)}function Hh(e,t){return 0===kh(e,t)}function Gh(e,t){for(var n,r,i,o=0,a=e.length;o<a;o++){if(0===(r=kh(e[o],t)))return!0;if(o>0&&(i=kh(e[o],e[o-1]))>0&&n<=i&&r<=i&&(n+r-i)*(1-Math.pow((n-r)/i,2))<au*i)return!0;n=r}return!1}function Vh(e,t){return!!gh(e.map(Wh),qh(t))}function Wh(e){return(e=e.map(qh)).pop(),e}function qh(e){return[e[0]*fu,e[1]*fu]}var Xh=function(e,t){return(e&&Fh.hasOwnProperty(e.type)?Fh[e.type]:jh)(e,t)};function Yh(e,t,n){var r=w(e,t-ou,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function Zh(e,t,n){var r=w(e,t-ou,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function Jh(){var e,t,n,r,i,o,a,s,c,u,l,h,f=10,d=f,p=90,m=360,g=2.5;function v(){return{type:"MultiLineString",coordinates:_()}}function _(){return w(vu(r/p)*p,n,p).map(l).concat(w(vu(s/m)*m,a,m).map(h)).concat(w(vu(t/f)*f,e,f).filter((function(e){return du(e%p)>ou})).map(c)).concat(w(vu(o/d)*d,i,d).filter((function(e){return du(e%m)>ou})).map(u))}return v.lines=function(){return _().map((function(e){return{type:"LineString",coordinates:e}}))},v.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(h(a).slice(1),l(n).reverse().slice(1),h(s).reverse().slice(1))]}},v.extent=function(e){return arguments.length?v.extentMajor(e).extentMinor(e):v.extentMinor()},v.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],r>n&&(e=r,r=n,n=e),s>a&&(e=s,s=a,a=e),v.precision(g)):[[r,s],[n,a]]},v.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],o=+n[0][1],i=+n[1][1],t>e&&(n=t,t=e,e=n),o>i&&(n=o,o=i,i=n),v.precision(g)):[[t,o],[e,i]]},v.step=function(e){return arguments.length?v.stepMajor(e).stepMinor(e):v.stepMinor()},v.stepMajor=function(e){return arguments.length?(p=+e[0],m=+e[1],v):[p,m]},v.stepMinor=function(e){return arguments.length?(f=+e[0],d=+e[1],v):[f,d]},v.precision=function(f){return arguments.length?(g=+f,c=Yh(o,i,90),u=Zh(t,e,g),l=Yh(s,a,90),h=Zh(r,n,g),v):g},v.extentMajor([[-180,-90+ou],[180,90-ou]]).extentMinor([[-180,-80-ou],[180,80+ou]])}function $h(){return Jh()()}var Kh,Qh,ef,tf,nf=function(e,t){var n=e[0]*fu,r=e[1]*fu,i=t[0]*fu,o=t[1]*fu,a=gu(r),s=bu(r),c=gu(o),u=bu(o),l=a*gu(n),h=a*bu(n),f=c*gu(i),d=c*bu(i),p=2*Tu(Eu(Au(o-r)+a*c*Au(i-n))),m=bu(p),g=p?function(e){var t=bu(e*=p)/m,n=bu(p-e)/m,r=n*l+t*f,i=n*h+t*d,o=n*s+t*u;return[mu(i,r)*hu,mu(o,Eu(r*r+i*i))*hu]}:function(){return[n*hu,r*hu]};return g.distance=p,g},rf=function(e){return e},of=tu(),af=tu(),sf={point:Lu,lineStart:Lu,lineEnd:Lu,polygonStart:function(){sf.lineStart=cf,sf.lineEnd=hf},polygonEnd:function(){sf.lineStart=sf.lineEnd=sf.point=Lu,of.add(du(af)),af.reset()},result:function(){var e=of/2;return of.reset(),e}};function cf(){sf.point=uf}function uf(e,t){sf.point=lf,Kh=ef=e,Qh=tf=t}function lf(e,t){af.add(tf*e-ef*t),ef=e,tf=t}function hf(){lf(Kh,Qh)}var ff=sf,df=1/0,pf=df,mf=-df,gf=mf;var vf,_f,yf,xf,bf={point:function(e,t){e<df&&(df=e);e>mf&&(mf=e);t<pf&&(pf=t);t>gf&&(gf=t)},lineStart:Lu,lineEnd:Lu,polygonStart:Lu,polygonEnd:Lu,result:function(){var e=[[df,pf],[mf,gf]];return mf=gf=-(pf=df=1/0),e}},wf=0,Ef=0,Mf=0,Sf=0,Tf=0,Af=0,Lf=0,Cf=0,Rf=0,Pf={point:Of,lineStart:Nf,lineEnd:zf,polygonStart:function(){Pf.lineStart=Uf,Pf.lineEnd=kf},polygonEnd:function(){Pf.point=Of,Pf.lineStart=Nf,Pf.lineEnd=zf},result:function(){var e=Rf?[Lf/Rf,Cf/Rf]:Af?[Sf/Af,Tf/Af]:Mf?[wf/Mf,Ef/Mf]:[NaN,NaN];return wf=Ef=Mf=Sf=Tf=Af=Lf=Cf=Rf=0,e}};function Of(e,t){wf+=e,Ef+=t,++Mf}function Nf(){Pf.point=If}function If(e,t){Pf.point=Df,Of(yf=e,xf=t)}function Df(e,t){var n=e-yf,r=t-xf,i=Eu(n*n+r*r);Sf+=i*(yf+e)/2,Tf+=i*(xf+t)/2,Af+=i,Of(yf=e,xf=t)}function zf(){Pf.point=Of}function Uf(){Pf.point=Ff}function kf(){Bf(vf,_f)}function Ff(e,t){Pf.point=Bf,Of(vf=yf=e,_f=xf=t)}function Bf(e,t){var n=e-yf,r=t-xf,i=Eu(n*n+r*r);Sf+=i*(yf+e)/2,Tf+=i*(xf+t)/2,Af+=i,Lf+=(i=xf*e-yf*t)*(yf+e),Cf+=i*(xf+t),Rf+=3*i,Of(yf=e,xf=t)}var jf=Pf;function Hf(e){this._context=e}Hf.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,lu)}},result:Lu};var Gf,Vf,Wf,qf,Xf,Yf=tu(),Zf={point:Lu,lineStart:function(){Zf.point=Jf},lineEnd:function(){Gf&&$f(Vf,Wf),Zf.point=Lu},polygonStart:function(){Gf=!0},polygonEnd:function(){Gf=null},result:function(){var e=+Yf;return Yf.reset(),e}};function Jf(e,t){Zf.point=$f,Vf=qf=e,Wf=Xf=t}function $f(e,t){qf-=e,Xf-=t,Yf.add(Eu(qf*qf+Xf*Xf)),qf=e,Xf=t}var Kf=Zf;function Qf(){this._string=[]}function ed(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}Qf.prototype={_radius:4.5,_circle:ed(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=ed(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var td=function(e,t){var n,r,i=4.5;function o(e){return e&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),Fu(e,n(r))),r.result()}return o.area=function(e){return Fu(e,n(ff)),ff.result()},o.measure=function(e){return Fu(e,n(Kf)),Kf.result()},o.bounds=function(e){return Fu(e,n(bf)),bf.result()},o.centroid=function(e){return Fu(e,n(jf)),jf.result()},o.projection=function(t){return arguments.length?(n=null==t?(e=null,rf):(e=t).stream,o):e},o.context=function(e){return arguments.length?(r=null==e?(t=null,new Qf):new Hf(t=e),"function"!=typeof i&&r.pointRadius(i),o):t},o.pointRadius=function(e){return arguments.length?(i="function"==typeof e?e:(r.pointRadius(+e),+e),o):i},o.projection(e).context(t)},nd=function(e){return{stream:rd(e)}};function rd(e){return function(t){var n=new id;for(var r in e)n[r]=e[r];return n.stream=t,n}}function id(){}function od(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),Fu(n,e.stream(bf)),t(bf.result()),null!=r&&e.clipExtent(r),e}function ad(e,t,n){return od(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+t[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([a,s])}),n)}function sd(e,t,n){return ad(e,[[0,0],t],n)}function cd(e,t,n){return od(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];e.scale(150*i).translate([o,a])}),n)}function ud(e,t,n){return od(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,a])}),n)}id.prototype={constructor:id,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ld=16,hd=gu(30*fu),fd=function(e,t){return+t?function(e,t){function n(r,i,o,a,s,c,u,l,h,f,d,p,m,g){var v=u-r,_=l-i,y=v*v+_*_;if(y>4*t&&m--){var x=a+f,b=s+d,w=c+p,E=Eu(x*x+b*b+w*w),M=Tu(w/=E),S=du(du(w)-1)<ou||du(o-h)<ou?(o+h)/2:mu(b,x),T=e(S,M),A=T[0],L=T[1],C=A-r,R=L-i,P=_*C-v*R;(P*P/y>t||du((v*C+_*R)/y-.5)>.3||a*f+s*d+c*p<hd)&&(n(r,i,o,a,s,c,A,L,S,x/=E,b/=E,w,m,g),g.point(A,L),n(A,L,S,x,b,w,u,l,h,f,d,p,m,g))}}return function(t){var r,i,o,a,s,c,u,l,h,f,d,p,m={point:g,lineStart:v,lineEnd:y,polygonStart:function(){t.polygonStart(),m.lineStart=x},polygonEnd:function(){t.polygonEnd(),m.lineStart=v}};function g(n,r){n=e(n,r),t.point(n[0],n[1])}function v(){l=NaN,m.point=_,t.lineStart()}function _(r,i){var o=Zu([r,i]),a=e(r,i);n(l,h,u,f,d,p,l=a[0],h=a[1],u=r,f=o[0],d=o[1],p=o[2],ld,t),t.point(l,h)}function y(){m.point=g,t.lineEnd()}function x(){v(),m.point=b,m.lineEnd=w}function b(e,t){_(r=e,t),i=l,o=h,a=f,s=d,c=p,m.point=_}function w(){n(l,h,u,f,d,p,i,o,r,a,s,c,ld,t),m.lineEnd=y,y()}return m}}(e,t):function(e){return rd({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)};var dd=rd({point:function(e,t){this.stream.point(e*fu,t*fu)}});function pd(e,t,n){function r(r,i){return[t+e*r,n-e*i]}return r.invert=function(r,i){return[(r-t)/e,(n-i)/e]},r}function md(e,t,n,r){var i=gu(r),o=bu(r),a=i*e,s=o*e,c=i/e,u=o/e,l=(o*n-i*t)/e,h=(o*t+i*n)/e;function f(e,r){return[a*e-s*r+t,n-s*e-a*r]}return f.invert=function(e,t){return[c*e-u*t+l,h-u*e-c*t]},f}function gd(e){return vd((function(){return e}))()}function vd(e){var t,n,r,i,o,a,s,c,u,l,h=150,f=480,d=250,p=0,m=0,g=0,v=0,_=0,y=0,x=null,b=xh,w=null,E=rf,M=.5;function S(e){return c(e[0]*fu,e[1]*fu)}function T(e){return(e=c.invert(e[0],e[1]))&&[e[0]*hu,e[1]*hu]}function A(){var e=md(h,0,0,y).apply(null,t(p,m)),r=(y?md:pd)(h,f-e[0],d-e[1],y);return n=th(g,v,_),s=Ql(t,r),c=Ql(n,s),a=fd(s,M),L()}function L(){return u=l=null,S}return S.stream=function(e){return u&&l===e?u:u=dd(function(e){return rd({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(b(a(E(l=e)))))},S.preclip=function(e){return arguments.length?(b=e,x=void 0,L()):b},S.postclip=function(e){return arguments.length?(E=e,w=r=i=o=null,L()):E},S.clipAngle=function(e){return arguments.length?(b=+e?bh(x=e*fu):(x=null,xh),L()):x*hu},S.clipExtent=function(e){return arguments.length?(E=null==e?(w=r=i=o=null,rf):Sh(w=+e[0][0],r=+e[0][1],i=+e[1][0],o=+e[1][1]),L()):null==w?null:[[w,r],[i,o]]},S.scale=function(e){return arguments.length?(h=+e,A()):h},S.translate=function(e){return arguments.length?(f=+e[0],d=+e[1],A()):[f,d]},S.center=function(e){return arguments.length?(p=e[0]%360*fu,m=e[1]%360*fu,A()):[p*hu,m*hu]},S.rotate=function(e){return arguments.length?(g=e[0]%360*fu,v=e[1]%360*fu,_=e.length>2?e[2]%360*fu:0,A()):[g*hu,v*hu,_*hu]},S.angle=function(e){return arguments.length?(y=e%360*fu,A()):y*hu},S.precision=function(e){return arguments.length?(a=fd(s,M=e*e),L()):Eu(M)},S.fitExtent=function(e,t){return ad(S,e,t)},S.fitSize=function(e,t){return sd(S,e,t)},S.fitWidth=function(e,t){return cd(S,e,t)},S.fitHeight=function(e,t){return ud(S,e,t)},function(){return t=e.apply(this,arguments),S.invert=t.invert&&T,A()}}function _d(e){var t=0,n=su/3,r=vd(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*fu,n=e[1]*fu):[t*hu,n*hu]},i}function yd(e,t){var n=bu(e),r=(n+bu(t))/2;if(du(r)<ou)return function(e){var t=gu(e);function n(e,n){return[e*t,bu(n)/t]}return n.invert=function(e,n){return[e/t,Tu(n*t)]},n}(e);var i=1+n*(2*r-n),o=Eu(i)/r;function a(e,t){var n=Eu(i-2*r*bu(t))/r;return[n*bu(e*=r),o-n*gu(e)]}return a.invert=function(e,t){var n=o-t;return[mu(e,du(n))/r*wu(n),Tu((i-(e*e+n*n)*r*r)/(2*r))]},a}var xd=function(){return _d(yd).scale(155.424).center([0,33.6442])},bd=function(){return xd().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};var wd=function(){var e,t,n,r,i,o,a=bd(),s=xd().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=xd().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(e,t){o=[e,t]}};function l(e){var t=e[0],a=e[1];return o=null,n.point(t,a),o||(r.point(t,a),o)||(i.point(t,a),o)}function h(){return e=t=null,l}return l.invert=function(e){var t=a.scale(),n=a.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:a).invert(e)},l.stream=function(n){return e&&t===n?e:(r=[a.stream(t=n),s.stream(n),c.stream(n)],i=r.length,e={point:function(e,t){for(var n=-1;++n<i;)r[n].point(e,t)},sphere:function(){for(var e=-1;++e<i;)r[e].sphere()},lineStart:function(){for(var e=-1;++e<i;)r[e].lineStart()},lineEnd:function(){for(var e=-1;++e<i;)r[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<i;)r[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<i;)r[e].polygonEnd()}});var r,i},l.precision=function(e){return arguments.length?(a.precision(e),s.precision(e),c.precision(e),h()):a.precision()},l.scale=function(e){return arguments.length?(a.scale(e),s.scale(.35*e),c.scale(e),l.translate(a.translate())):a.scale()},l.translate=function(e){if(!arguments.length)return a.translate();var t=a.scale(),o=+e[0],l=+e[1];return n=a.translate(e).clipExtent([[o-.455*t,l-.238*t],[o+.455*t,l+.238*t]]).stream(u),r=s.translate([o-.307*t,l+.201*t]).clipExtent([[o-.425*t+ou,l+.12*t+ou],[o-.214*t-ou,l+.234*t-ou]]).stream(u),i=c.translate([o-.205*t,l+.212*t]).clipExtent([[o-.214*t+ou,l+.166*t+ou],[o-.115*t-ou,l+.234*t-ou]]).stream(u),h()},l.fitExtent=function(e,t){return ad(l,e,t)},l.fitSize=function(e,t){return sd(l,e,t)},l.fitWidth=function(e,t){return cd(l,e,t)},l.fitHeight=function(e,t){return ud(l,e,t)},l.scale(1070)};function Ed(e){return function(t,n){var r=gu(t),i=gu(n),o=e(r*i);return[o*i*bu(t),o*bu(n)]}}function Md(e){return function(t,n){var r=Eu(t*t+n*n),i=e(r),o=bu(i),a=gu(i);return[mu(t*o,r*a),Tu(r&&n*o/r)]}}var Sd=Ed((function(e){return Eu(2/(1+e))}));Sd.invert=Md((function(e){return 2*Tu(e/2)}));var Td=function(){return gd(Sd).scale(124.75).clipAngle(179.999)},Ad=Ed((function(e){return(e=Su(e))&&e/bu(e)}));Ad.invert=Md((function(e){return e}));var Ld=function(){return gd(Ad).scale(79.4188).clipAngle(179.999)};function Cd(e,t){return[e,yu(Mu((cu+t)/2))]}Cd.invert=function(e,t){return[e,2*pu(_u(t))-cu]};var Rd=function(){return Pd(Cd).scale(961/lu)};function Pd(e){var t,n,r,i=gd(e),o=i.center,a=i.scale,s=i.translate,c=i.clipExtent,u=null;function l(){var o=su*a(),s=i(oh(i.rotate()).invert([0,0]));return c(null==u?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:e===Cd?[[Math.max(s[0]-o,u),t],[Math.min(s[0]+o,n),r]]:[[u,Math.max(s[1]-o,t)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(e){return arguments.length?(a(e),l()):a()},i.translate=function(e){return arguments.length?(s(e),l()):s()},i.center=function(e){return arguments.length?(o(e),l()):o()},i.clipExtent=function(e){return arguments.length?(null==e?u=t=n=r=null:(u=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),l()):null==u?null:[[u,t],[n,r]]},l()}function Od(e){return Mu((cu+e)/2)}function Nd(e,t){var n=gu(e),r=e===t?bu(e):yu(n/gu(t))/yu(Od(t)/Od(e)),i=n*xu(Od(e),r)/r;if(!r)return Cd;function o(e,t){i>0?t<-cu+ou&&(t=-cu+ou):t>cu-ou&&(t=cu-ou);var n=i/xu(Od(t),r);return[n*bu(r*e),i-n*gu(r*e)]}return o.invert=function(e,t){var n=i-t,o=wu(r)*Eu(e*e+n*n);return[mu(e,du(n))/r*wu(n),2*pu(xu(i/o,1/r))-cu]},o}var Id=function(){return _d(Nd).scale(109.5).parallels([30,30])};function Dd(e,t){return[e,t]}Dd.invert=Dd;var zd=function(){return gd(Dd).scale(152.63)};function Ud(e,t){var n=gu(e),r=e===t?bu(e):(n-gu(t))/(t-e),i=n/r+e;if(du(r)<ou)return Dd;function o(e,t){var n=i-t,o=r*e;return[n*bu(o),i-n*gu(o)]}return o.invert=function(e,t){var n=i-t;return[mu(e,du(n))/r*wu(n),i-wu(r)*Eu(e*e+n*n)]},o}var kd=function(){return _d(Ud).scale(131.154).center([0,13.9389])},Fd=1.340264,Bd=-.081106,jd=893e-6,Hd=.003796,Gd=Eu(3)/2;function Vd(e,t){var n=Tu(Gd*bu(t)),r=n*n,i=r*r*r;return[e*gu(n)/(Gd*(Fd+3*Bd*r+i*(7*jd+9*Hd*r))),n*(Fd+Bd*r+i*(jd+Hd*r))]}Vd.invert=function(e,t){for(var n,r=t,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(Fd+Bd*i+o*(jd+Hd*i))-t)/(Fd+3*Bd*i+o*(7*jd+9*Hd*i)))*r)*i*i,!(du(n)<au));++a);return[Gd*e*(Fd+3*Bd*i+o*(7*jd+9*Hd*i))/gu(r),Tu(bu(r)/Gd)]};var Wd=function(){return gd(Vd).scale(177.158)};function qd(e,t){var n=gu(t),r=gu(e)*n;return[n*bu(e)/r,bu(t)/r]}qd.invert=Md(pu);var Xd=function(){return gd(qd).scale(144.049).clipAngle(60)};function Yd(e,t,n,r){return 1===e&&1===t&&0===n&&0===r?rf:rd({point:function(i,o){this.stream.point(i*e+n,o*t+r)}})}var Zd=function(){var e,t,n,r,i,o,a=1,s=0,c=0,u=1,l=1,h=rf,f=null,d=rf;function p(){return r=i=null,o}return o={stream:function(e){return r&&i===e?r:r=h(d(i=e))},postclip:function(r){return arguments.length?(d=r,f=e=t=n=null,p()):d},clipExtent:function(r){return arguments.length?(d=null==r?(f=e=t=n=null,rf):Sh(f=+r[0][0],e=+r[0][1],t=+r[1][0],n=+r[1][1]),p()):null==f?null:[[f,e],[t,n]]},scale:function(e){return arguments.length?(h=Yd((a=+e)*u,a*l,s,c),p()):a},translate:function(e){return arguments.length?(h=Yd(a*u,a*l,s=+e[0],c=+e[1]),p()):[s,c]},reflectX:function(e){return arguments.length?(h=Yd(a*(u=e?-1:1),a*l,s,c),p()):u<0},reflectY:function(e){return arguments.length?(h=Yd(a*u,a*(l=e?-1:1),s,c),p()):l<0},fitExtent:function(e,t){return ad(o,e,t)},fitSize:function(e,t){return sd(o,e,t)},fitWidth:function(e,t){return cd(o,e,t)},fitHeight:function(e,t){return ud(o,e,t)}}};function Jd(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}Jd.invert=function(e,t){var n,r=t,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-t)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(du(n)>ou&&--i>0);return[e/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]};var $d=function(){return gd(Jd).scale(175.295)};function Kd(e,t){return[gu(t)*bu(e),bu(t)]}Kd.invert=Md(Tu);var Qd=function(){return gd(Kd).scale(249.5).clipAngle(90+ou)};function ep(e,t){var n=gu(t),r=1+gu(e)*n;return[n*bu(e)/r,bu(t)/r]}ep.invert=Md((function(e){return 2*pu(e)}));var tp=function(){return gd(ep).scale(250).clipAngle(142)};function np(e,t){return[yu(Mu((cu+t)/2)),-e]}np.invert=function(e,t){return[-t,2*pu(_u(e))-cu]};var rp=function(){var e=Pd(np),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)};function ip(e,t){return e.parent===t.parent?1:2}function op(e,t){return e+t.x}function ap(e,t){return Math.max(e,t.y)}var sp=function(){var e=ip,t=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(op,0)/e.length}(n),t.y=function(e){return 1+e.reduce(ap,0)}(n)):(t.x=o?a+=e(t,o):0,t.y=0,o=t)}));var s=function(e){for(var t;t=e.children;)e=t[0];return e}(i),c=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(i),u=s.x-e(s,c)/2,l=c.x+e(c,s)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t,e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-u)/(l-u)*t,e.y=(1-(i.y?e.y/i.y:1))*n})}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i};function cp(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function up(e,t){var n,r,i,o,a,s=new dp(e),c=+e.value&&(s.value=e.value),u=[s];for(null==t&&(t=lp);n=u.pop();)if(c&&(n.value=+n.data.value),(i=t(n.data))&&(a=i.length))for(n.children=new Array(a),o=a-1;o>=0;--o)u.push(r=n.children[o]=new dp(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(fp)}function lp(e){return e.children}function hp(e){e.data=e.data.data}function fp(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function dp(e){this.data=e,this.depth=this.height=0,this.parent=null}dp.prototype=up.prototype={constructor:dp,count:function(){return this.eachAfter(cp)},each:function(e){var t,n,r,i,o=this,a=[o];do{for(t=a.reverse(),a=[];o=t.pop();)if(e(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r])}while(a.length);return this},eachAfter:function(e){for(var t,n,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),t=i.children)for(n=0,r=t.length;n<r;++n)o.push(t[n]);for(;i=a.pop();)e(i);return this},eachBefore:function(e){for(var t,n,r=this,i=[r];r=i.pop();)if(e(r),t=r.children)for(n=t.length-1;n>=0;--n)i.push(t[n]);return this},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop(),t=r.pop();for(;e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){var e=[];return this.each((function(t){e.push(t)})),e},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return up(this).eachBefore(hp)}};var pp=Array.prototype.slice;var mp=function(e){for(var t,n,r=0,i=(e=function(e){for(var t,n,r=e.length;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e}(pp.call(e))).length,o=[];r<i;)t=e[r],n&&_p(n,t)?++r:(n=xp(o=gp(o,t)),r=0);return n};function gp(e,t){var n,r;if(yp(t,e))return[t];for(n=0;n<e.length;++n)if(vp(t,e[n])&&yp(bp(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(vp(bp(e[n],e[r]),t)&&vp(bp(e[n],t),e[r])&&vp(bp(e[r],t),e[n])&&yp(wp(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function vp(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function _p(e,t){var n=e.r-t.r+1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function yp(e,t){for(var n=0;n<t.length;++n)if(!_p(e,t[n]))return!1;return!0}function xp(e){switch(e.length){case 1:return{x:(t=e[0]).x,y:t.y,r:t.r};case 2:return bp(e[0],e[1]);case 3:return wp(e[0],e[1],e[2])}var t}function bp(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,a=t.y,s=t.r,c=o-n,u=a-r,l=s-i,h=Math.sqrt(c*c+u*u);return{x:(n+o+c/h*l)/2,y:(r+a+u/h*l)/2,r:(h+i+s)/2}}function wp(e,t,n){var r=e.x,i=e.y,o=e.r,a=t.x,s=t.y,c=t.r,u=n.x,l=n.y,h=n.r,f=r-a,d=r-u,p=i-s,m=i-l,g=c-o,v=h-o,_=r*r+i*i-o*o,y=_-a*a-s*s+c*c,x=_-u*u-l*l+h*h,b=d*p-f*m,w=(p*x-m*y)/(2*b)-r,E=(m*g-p*v)/b,M=(d*y-f*x)/(2*b)-i,S=(f*v-d*g)/b,T=E*E+S*S-1,A=2*(o+w*E+M*S),L=w*w+M*M-o*o,C=-(T?(A+Math.sqrt(A*A-4*T*L))/(2*T):L/A);return{x:r+w+E*C,y:i+M+S*C,r:C}}function Ep(e,t,n){var r,i,o,a,s=e.x-t.x,c=e.y-t.y,u=s*s+c*c;u?(i=t.r+n.r,i*=i,a=e.r+n.r,i>(a*=a)?(r=(u+a-i)/(2*u),o=Math.sqrt(Math.max(0,a/u-r*r)),n.x=e.x-r*s-o*c,n.y=e.y-r*c+o*s):(r=(u+i-a)/(2*u),o=Math.sqrt(Math.max(0,i/u-r*r)),n.x=t.x+r*s-o*c,n.y=t.y+r*c+o*s)):(n.x=t.x+n.r,n.y=t.y)}function Mp(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function Sp(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function Tp(e){this._=e,this.next=null,this.previous=null}function Ap(e){if(!(i=e.length))return 0;var t,n,r,i,o,a,s,c,u,l,h;if((t=e[0]).x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;Ep(n,t,r=e[2]),t=new Tp(t),n=new Tp(n),r=new Tp(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(s=3;s<i;++s){Ep(t._,n._,r=e[s]),r=new Tp(r),c=n.next,u=t.previous,l=n._.r,h=t._.r;do{if(l<=h){if(Mp(c._,r._)){n=c,t.next=n,n.previous=t,--s;continue e}l+=c._.r,c=c.next}else{if(Mp(u._,r._)){(t=u).next=n,n.previous=t,--s;continue e}h+=u._.r,u=u.previous}}while(c!==u.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,o=Sp(t);(r=r.next)!==n;)(a=Sp(r))<o&&(t=r,o=a);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=mp(t),s=0;s<i;++s)(t=e[s]).x-=r.x,t.y-=r.y;return r.r}var Lp=function(e){return Ap(e),e};function Cp(e){return null==e?null:Rp(e)}function Rp(e){if("function"!=typeof e)throw new Error;return e}function Pp(){return 0}var Op=function(e){return function(){return e}};function Np(e){return Math.sqrt(e.value)}var Ip=function(){var e=null,t=1,n=1,r=Pp;function i(i){return i.x=t/2,i.y=n/2,e?i.eachBefore(Dp(e)).eachAfter(zp(r,.5)).eachBefore(Up(1)):i.eachBefore(Dp(Np)).eachAfter(zp(Pp,1)).eachAfter(zp(r,i.r/Math.min(t,n))).eachBefore(Up(Math.min(t,n)/(2*i.r))),i}return i.radius=function(t){return arguments.length?(e=Cp(t),i):e},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(e){return arguments.length?(r="function"==typeof e?e:Op(+e),i):r},i};function Dp(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function zp(e,t){return function(n){if(r=n.children){var r,i,o,a=r.length,s=e(n)*t||0;if(s)for(i=0;i<a;++i)r[i].r+=s;if(o=Ap(r),s)for(i=0;i<a;++i)r[i].r-=s;n.r=o+s}}}function Up(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}var kp=function(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)},Fp=function(e,t,n,r,i){for(var o,a=e.children,s=-1,c=a.length,u=e.value&&(r-t)/e.value;++s<c;)(o=a[s]).y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*u},Bp=function(){var e=1,t=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=e,i.y1=t/o,i.eachBefore(function(e,t){return function(r){r.children&&Fp(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(t,o)),r&&i.eachBefore(kp),i}return i.round=function(e){return arguments.length?(r=!!e,i):r},i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]},i.padding=function(e){return arguments.length?(n=+e,i):n},i},jp="$",Hp={depth:-1},Gp={};function Vp(e){return e.id}function Wp(e){return e.parentId}var qp=function(){var e=Vp,t=Wp;function n(n){var r,i,o,a,s,c,u,l=n.length,h=new Array(l),f={};for(i=0;i<l;++i)r=n[i],s=h[i]=new dp(r),null!=(c=e(r,i,n))&&(c+="")&&(f[u=jp+(s.id=c)]=u in f?Gp:s);for(i=0;i<l;++i)if(s=h[i],null!=(c=t(n[i],i,n))&&(c+="")){if(!(a=f[jp+c]))throw new Error("missing: "+c);if(a===Gp)throw new Error("ambiguous: "+c);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error("multiple roots");o=s}if(!o)throw new Error("no root");if(o.parent=Hp,o.eachBefore((function(e){e.depth=e.parent.depth+1,--l})).eachBefore(fp),o.parent=null,l>0)throw new Error("cycle");return o}return n.id=function(t){return arguments.length?(e=Rp(t),n):e},n.parentId=function(e){return arguments.length?(t=Rp(e),n):t},n};function Xp(e,t){return e.parent===t.parent?1:2}function Yp(e){var t=e.children;return t?t[0]:e.t}function Zp(e){var t=e.children;return t?t[t.length-1]:e.t}function Jp(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function $p(e,t,n){return e.a.parent===t.parent?e.a:n}function Kp(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Kp.prototype=Object.create(dp.prototype);var Qp=function(){var e=Xp,t=1,n=1,r=null;function i(i){var c=function(e){for(var t,n,r,i,o,a=new Kp(e,0),s=[a];t=s.pop();)if(r=t._.children)for(t.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=t.children[i]=new Kp(r[i],i)),n.parent=t;return(a.parent=new Kp(null,0)).children=[a],a}(i);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),r)i.eachBefore(s);else{var u=i,l=i,h=i;i.eachBefore((function(e){e.x<u.x&&(u=e),e.x>l.x&&(l=e),e.depth>h.depth&&(h=e)}));var f=u===l?1:e(u,l)/2,d=f-u.x,p=t/(l.x+f+d),m=n/(h.depth||1);i.eachBefore((function(e){e.x=(e.x+d)*p,e.y=e.depth*m}))}return i}function o(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,i=e.children,o=i.length;--o>=0;)(t=i[o]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var o=(n[0].z+n[n.length-1].z)/2;i?(t.z=i.z+e(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+e(t._,i._));t.parent.A=function(t,n,r){if(n){for(var i,o=t,a=t,s=n,c=o.parent.children[0],u=o.m,l=a.m,h=s.m,f=c.m;s=Zp(s),o=Yp(o),s&&o;)c=Yp(c),(a=Zp(a)).a=t,(i=s.z+h-o.z-u+e(s._,o._))>0&&(Jp($p(s,t,r),t,i),u+=i,l+=i),h+=s.m,u+=o.m,f+=c.m,l+=a.m;s&&!Zp(a)&&(a.t=s,a.m+=h-l),o&&!Yp(c)&&(c.t=o,c.m+=u-f,r=t)}return r}(t,i,t.parent.A||r[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i},em=function(e,t,n,r,i){for(var o,a=e.children,s=-1,c=a.length,u=e.value&&(i-n)/e.value;++s<c;)(o=a[s]).x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*u},tm=(1+Math.sqrt(5))/2;function nm(e,t,n,r,i,o){for(var a,s,c,u,l,h,f,d,p,m,g,v=[],_=t.children,y=0,x=0,b=_.length,w=t.value;y<b;){c=i-n,u=o-r;do{l=_[x++].value}while(!l&&x<b);for(h=f=l,g=l*l*(m=Math.max(u/c,c/u)/(w*e)),p=Math.max(f/g,g/h);x<b;++x){if(l+=s=_[x].value,s<h&&(h=s),s>f&&(f=s),g=l*l*m,(d=Math.max(f/g,g/h))>p){l-=s;break}p=d}v.push(a={value:l,dice:c<u,children:_.slice(y,x)}),a.dice?Fp(a,n,r,i,w?r+=u*l/w:o):em(a,n,r,w?n+=c*l/w:i,o),w-=l,y=x}return v}var rm=function e(t){function n(e,n,r,i,o){nm(t,e,n,r,i,o)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(tm),im=function(){var e=rm,t=!1,n=1,r=1,i=[0],o=Pp,a=Pp,s=Pp,c=Pp,u=Pp;function l(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(h),i=[0],t&&e.eachBefore(kp),e}function h(t){var n=i[t.depth],r=t.x0+n,l=t.y0+n,h=t.x1-n,f=t.y1-n;h<r&&(r=h=(r+h)/2),f<l&&(l=f=(l+f)/2),t.x0=r,t.y0=l,t.x1=h,t.y1=f,t.children&&(n=i[t.depth+1]=o(t)/2,r+=u(t)-n,l+=a(t)-n,(h-=s(t)-n)<r&&(r=h=(r+h)/2),(f-=c(t)-n)<l&&(l=f=(l+f)/2),e(t,r,l,h,f))}return l.round=function(e){return arguments.length?(t=!!e,l):t},l.size=function(e){return arguments.length?(n=+e[0],r=+e[1],l):[n,r]},l.tile=function(t){return arguments.length?(e=Rp(t),l):e},l.padding=function(e){return arguments.length?l.paddingInner(e).paddingOuter(e):l.paddingInner()},l.paddingInner=function(e){return arguments.length?(o="function"==typeof e?e:Op(+e),l):o},l.paddingOuter=function(e){return arguments.length?l.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):l.paddingTop()},l.paddingTop=function(e){return arguments.length?(a="function"==typeof e?e:Op(+e),l):a},l.paddingRight=function(e){return arguments.length?(s="function"==typeof e?e:Op(+e),l):s},l.paddingBottom=function(e){return arguments.length?(c="function"==typeof e?e:Op(+e),l):c},l.paddingLeft=function(e){return arguments.length?(u="function"==typeof e?e:Op(+e),l):u},l},om=function(e,t,n,r,i){var o,a,s=e.children,c=s.length,u=new Array(c+1);for(u[0]=a=o=0;o<c;++o)u[o+1]=a+=s[o].value;!function e(t,n,r,i,o,a,c){if(t>=n-1){var l=s[t];return l.x0=i,l.y0=o,l.x1=a,void(l.y1=c)}var h=u[t],f=r/2+h,d=t+1,p=n-1;for(;d<p;){var m=d+p>>>1;u[m]<f?d=m+1:p=m}f-u[d-1]<u[d]-f&&t+1<d&&--d;var g=u[d]-h,v=r-g;if(a-i>c-o){var _=(i*v+a*g)/r;e(t,d,g,i,o,_,c),e(d,n,v,_,o,a,c)}else{var y=(o*v+c*g)/r;e(t,d,g,i,o,a,y),e(d,n,v,i,y,a,c)}}(0,c,e.value,t,n,r,i)},am=function(e,t,n,r,i){(1&e.depth?em:Fp)(e,t,n,r,i)},sm=function e(t){function n(e,n,r,i,o){if((a=e._squarify)&&a.ratio===t)for(var a,s,c,u,l,h=-1,f=a.length,d=e.value;++h<f;){for(c=(s=a[h]).children,u=s.value=0,l=c.length;u<l;++u)s.value+=c[u].value;s.dice?Fp(s,n,r,i,r+=(o-r)*s.value/d):em(s,n,r,n+=(i-n)*s.value/d,o),d-=s.value}else e._squarify=a=nm(t,e,n,r,i,o),a.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(tm),cm=function(e){for(var t,n=-1,r=e.length,i=e[r-1],o=0;++n<r;)t=i,i=e[n],o+=t[1]*i[0]-t[0]*i[1];return o/2},um=function(e){for(var t,n,r=-1,i=e.length,o=0,a=0,s=e[i-1],c=0;++r<i;)t=s,s=e[r],c+=n=t[0]*s[1]-s[0]*t[1],o+=(t[0]+s[0])*n,a+=(t[1]+s[1])*n;return[o/(c*=3),a/c]},lm=function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])};function hm(e,t){return e[0]-t[0]||e[1]-t[1]}function fm(e){for(var t=e.length,n=[0,1],r=2,i=2;i<t;++i){for(;r>1&&lm(e[n[r-2]],e[n[r-1]],e[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}var dm=function(e){if((n=e.length)<3)return null;var t,n,r=new Array(n),i=new Array(n);for(t=0;t<n;++t)r[t]=[+e[t][0],+e[t][1],t];for(r.sort(hm),t=0;t<n;++t)i[t]=[r[t][0],-r[t][1]];var o=fm(r),a=fm(i),s=a[0]===o[0],c=a[a.length-1]===o[o.length-1],u=[];for(t=o.length-1;t>=0;--t)u.push(e[r[o[t]][2]]);for(t=+s;t<a.length-c;++t)u.push(e[r[a[t]][2]]);return u},pm=function(e,t){for(var n,r,i=e.length,o=e[i-1],a=t[0],s=t[1],c=o[0],u=o[1],l=!1,h=0;h<i;++h)n=(o=e[h])[0],(r=o[1])>s!=u>s&&a<(c-n)*(s-r)/(u-r)+n&&(l=!l),c=n,u=r;return l},mm=function(e){for(var t,n,r=-1,i=e.length,o=e[i-1],a=o[0],s=o[1],c=0;++r<i;)t=a,n=s,t-=a=(o=e[r])[0],n-=s=o[1],c+=Math.sqrt(t*t+n*n);return c},gm=function(){return Math.random()},vm=function e(t){function n(e,n){return e=null==e?0:+e,n=null==n?1:+n,1===arguments.length?(n=e,e=0):n-=e,function(){return t()*n+e}}return n.source=e,n}(gm),_m=function e(t){function n(e,n){var r,i;return e=null==e?0:+e,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*t()-1,o=2*t()-1,i=r*r+o*o}while(!i||i>1);return e+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=e,n}(gm),ym=function e(t){function n(){var e=_m.source(t).apply(this,arguments);return function(){return Math.exp(e())}}return n.source=e,n}(gm),xm=function e(t){function n(e){return function(){for(var n=0,r=0;r<e;++r)n+=t();return n}}return n.source=e,n}(gm),bm=function e(t){function n(e){var n=xm.source(t)(e);return function(){return n()/e}}return n.source=e,n}(gm),wm=function e(t){function n(e){return function(){return-Math.log(1-t())/e}}return n.source=e,n}(gm);function Em(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function Mm(e,t){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(t).domain(e)}return this}var Sm=Array.prototype,Tm=Sm.map,Am=Sm.slice,Lm={name:"implicit"};function Cm(){var e=Ya(),t=[],n=[],r=Lm;function i(i){var o=i+"",a=e.get(o);if(!a){if(r!==Lm)return r;e.set(o,a=t.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=Ya();for(var r,o,a=-1,s=n.length;++a<s;)e.has(o=(r=n[a])+"")||e.set(o,t.push(r));return i},i.range=function(e){return arguments.length?(n=Am.call(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return Cm(t,n).unknown(r)},Em.apply(i,arguments),i}function Rm(){var e,t,n=Cm().unknown(void 0),r=n.domain,i=n.range,o=[0,1],a=!1,s=0,c=0,u=.5;function l(){var n=r().length,l=o[1]<o[0],h=o[l-0],f=o[1-l];e=(f-h)/Math.max(1,n-s+2*c),a&&(e=Math.floor(e)),h+=(f-h-e*(n-s))*u,t=e*(1-s),a&&(h=Math.round(h),t=Math.round(t));var d=w(n).map((function(t){return h+e*t}));return i(l?d.reverse():d)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),l()):r()},n.range=function(e){return arguments.length?(o=[+e[0],+e[1]],l()):o.slice()},n.rangeRound=function(e){return o=[+e[0],+e[1]],a=!0,l()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(a=!!e,l()):a},n.padding=function(e){return arguments.length?(s=Math.min(1,c=+e),l()):s},n.paddingInner=function(e){return arguments.length?(s=Math.min(1,e),l()):s},n.paddingOuter=function(e){return arguments.length?(c=+e,l()):c},n.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),l()):u},n.copy=function(){return Rm(r(),o).round(a).paddingInner(s).paddingOuter(c).align(u)},Em.apply(l(),arguments)}function Pm(){return function e(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return e(n())},t}(Rm.apply(null,arguments).paddingInner(1))}var Om=function(e){return function(){return e}},Nm=function(e){return+e},Im=[0,1];function Dm(e){return e}function zm(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Om(isNaN(t)?NaN:.5)}function Um(e){var t,n=e[0],r=e[e.length-1];return n>r&&(t=n,n=r,r=t),function(e){return Math.max(n,Math.min(r,e))}}function km(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=zm(i,r),o=n(a,o)):(r=zm(r,i),o=n(o,a)),function(e){return o(r(e))}}function Fm(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=zm(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=c(e,t,1,r)-1;return o[n](i[n](t))}}function Bm(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function jm(){var e,t,n,r,i,o,a=Im,s=Im,c=Jn,u=Dm;function l(){return r=Math.min(a.length,s.length)>2?Fm:km,i=o=null,h}function h(t){return isNaN(t=+t)?n:(i||(i=r(a.map(e),s,c)))(e(u(t)))}return h.invert=function(n){return u(t((o||(o=r(s,a.map(e),jn)))(n)))},h.domain=function(e){return arguments.length?(a=Tm.call(e,Nm),u===Dm||(u=Um(a)),l()):a.slice()},h.range=function(e){return arguments.length?(s=Am.call(e),l()):s.slice()},h.rangeRound=function(e){return s=Am.call(e),c=Qn,l()},h.clamp=function(e){return arguments.length?(u=e?Um(a):Dm,h):u!==Dm},h.interpolate=function(e){return arguments.length?(c=e,l()):c},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,l()}}function Hm(e,t){return jm()(e,t)}var Gm=function(e,t,n,r){var i,o=L(e,t,n);switch((r=kc(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=Qc(o,a))||(r.precision=i),Gc(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=eu(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Kc(o))||(r.precision=i-2*("%"===r.type))}return Hc(r)};function Vm(e){var t=e.domain;return e.ticks=function(e){var n=t();return T(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Gm(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i=t(),o=0,a=i.length-1,s=i[o],c=i[a];return c<s&&(r=s,s=c,c=r,r=o,o=a,a=r),(r=A(s,c,n))>0?r=A(s=Math.floor(s/r)*r,c=Math.ceil(c/r)*r,n):r<0&&(r=A(s=Math.ceil(s*r)/r,c=Math.floor(c*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(c/r)*r,t(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(c*r)/r,t(i)),e},e}function Wm(){var e=Hm(Dm,Dm);return e.copy=function(){return Bm(e,Wm())},Em.apply(e,arguments),Vm(e)}function qm(e){var t;function n(e){return isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Tm.call(t,Nm),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return qm(e).unknown(t)},e=arguments.length?Tm.call(e,Nm):[0,1],Vm(n)}var Xm=function(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e};function Ym(e){return Math.log(e)}function Zm(e){return Math.exp(e)}function Jm(e){return-Math.log(-e)}function $m(e){return-Math.exp(-e)}function Km(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Qm(e){return function(t){return-e(-t)}}function eg(e){var t,n,r=e(Ym,Zm),i=r.domain,o=10;function a(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(o),n=function(e){return 10===e?Km:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(o),i()[0]<0?(t=Qm(t),n=Qm(n),e(Jm,$m)):e(Ym,Zm),r}return r.base=function(e){return arguments.length?(o=+e,a()):o},r.domain=function(e){return arguments.length?(i(e),a()):i()},r.ticks=function(e){var r,a=i(),s=a[0],c=a[a.length-1];(r=c<s)&&(f=s,s=c,c=f);var u,l,h,f=t(s),d=t(c),p=null==e?10:+e,m=[];if(!(o%1)&&d-f<p){if(f=Math.round(f)-1,d=Math.round(d)+1,s>0){for(;f<d;++f)for(l=1,u=n(f);l<o;++l)if(!((h=u*l)<s)){if(h>c)break;m.push(h)}}else for(;f<d;++f)for(l=o-1,u=n(f);l>=1;--l)if(!((h=u*l)<s)){if(h>c)break;m.push(h)}}else m=T(f,d,Math.min(d-f,p)).map(n);return r?m.reverse():m},r.tickFormat=function(e,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=Hc(i)),e===1/0)return i;null==e&&(e=10);var a=Math.max(1,o*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*o<o-.5&&(r*=o),r<=a?i(e):""}},r.nice=function(){return i(Xm(i(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function tg(){var e=eg(jm()).domain([1,10]);return e.copy=function(){return Bm(e,tg()).base(e.base())},Em.apply(e,arguments),e}function ng(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function rg(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ig(e){var t=1,n=e(ng(t),rg(t));return n.constant=function(n){return arguments.length?e(ng(t=+n),rg(t)):t},Vm(n)}function og(){var e=ig(jm());return e.copy=function(){return Bm(e,og()).constant(e.constant())},Em.apply(e,arguments)}function ag(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function sg(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function cg(e){return e<0?-e*e:e*e}function ug(e){var t=e(Dm,Dm),n=1;function r(){return 1===n?e(Dm,Dm):.5===n?e(sg,cg):e(ag(n),ag(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},Vm(t)}function lg(){var e=ug(jm());return e.copy=function(){return Bm(e,lg()).exponent(e.exponent())},Em.apply(e,arguments),e}function hg(){return lg.apply(null,arguments).exponent(.5)}function fg(){var e,t=[],n=[],i=[];function o(){var e=0,r=Math.max(1,n.length);for(i=new Array(r-1);++e<r;)i[e-1]=P(t,e/r);return a}function a(t){return isNaN(t=+t)?e:n[c(i,t)]}return a.invertExtent=function(e){var r=n.indexOf(e);return r<0?[NaN,NaN]:[r>0?i[r-1]:t[0],r<i.length?i[r]:t[t.length-1]]},a.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var n,i=0,a=e.length;i<a;++i)null==(n=e[i])||isNaN(n=+n)||t.push(n);return t.sort(r),o()},a.range=function(e){return arguments.length?(n=Am.call(e),o()):n.slice()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.quantiles=function(){return i.slice()},a.copy=function(){return fg().domain(t).range(n).unknown(e)},Em.apply(a,arguments)}function dg(){var e,t=0,n=1,r=1,i=[.5],o=[0,1];function a(t){return t<=t?o[c(i,t,0,r)]:e}function s(){var e=-1;for(i=new Array(r);++e<r;)i[e]=((e+1)*n-(e-r)*t)/(r+1);return a}return a.domain=function(e){return arguments.length?(t=+e[0],n=+e[1],s()):[t,n]},a.range=function(e){return arguments.length?(r=(o=Am.call(e)).length-1,s()):o.slice()},a.invertExtent=function(e){var a=o.indexOf(e);return a<0?[NaN,NaN]:a<1?[t,i[0]]:a>=r?[i[r-1],n]:[i[a-1],i[a]]},a.unknown=function(t){return arguments.length?(e=t,a):a},a.thresholds=function(){return i.slice()},a.copy=function(){return dg().domain([t,n]).range(o).unknown(e)},Em.apply(Vm(a),arguments)}function pg(){var e,t=[.5],n=[0,1],r=1;function i(i){return i<=i?n[c(t,i,0,r)]:e}return i.domain=function(e){return arguments.length?(t=Am.call(e),r=Math.min(t.length,n.length-1),i):t.slice()},i.range=function(e){return arguments.length?(n=Am.call(e),r=Math.min(t.length,n.length-1),i):n.slice()},i.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return pg().domain(t).range(n).unknown(e)},Em.apply(i,arguments)}var mg=new Date,gg=new Date;function vg(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=function(t){return e(t=new Date(+t)),t},i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),t(n,o),e(n)}while(a<n&&n<r);return s},i.filter=function(n){return vg((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(i.count=function(t,r){return mg.setTime(+t),gg.setTime(+r),e(mg),e(gg),Math.floor(n(mg,gg))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?function(t){return r(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}var _g=vg((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));_g.every=function(e){return isFinite(e=Math.floor(e))&&e>0?vg((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var yg=_g,xg=_g.range,bg=vg((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),wg=bg,Eg=bg.range,Mg=6e4,Sg=6048e5;function Tg(e){return vg((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Mg)/Sg}))}var Ag=Tg(0),Lg=Tg(1),Cg=Tg(2),Rg=Tg(3),Pg=Tg(4),Og=Tg(5),Ng=Tg(6),Ig=Ag.range,Dg=Lg.range,zg=Cg.range,Ug=Rg.range,kg=Pg.range,Fg=Og.range,Bg=Ng.range,jg=vg((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Mg)/864e5}),(function(e){return e.getDate()-1})),Hg=jg,Gg=jg.range,Vg=vg((function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-e.getMinutes()*Mg)}),(function(e,t){e.setTime(+e+36e5*t)}),(function(e,t){return(t-e)/36e5}),(function(e){return e.getHours()})),Wg=Vg,qg=Vg.range,Xg=vg((function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())}),(function(e,t){e.setTime(+e+t*Mg)}),(function(e,t){return(t-e)/Mg}),(function(e){return e.getMinutes()})),Yg=Xg,Zg=Xg.range,Jg=vg((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+1e3*t)}),(function(e,t){return(t-e)/1e3}),(function(e){return e.getUTCSeconds()})),$g=Jg,Kg=Jg.range,Qg=vg((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));Qg.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?vg((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):Qg:null};var ev=Qg,tv=Qg.range;function nv(e){return vg((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/Sg}))}var rv=nv(0),iv=nv(1),ov=nv(2),av=nv(3),sv=nv(4),cv=nv(5),uv=nv(6),lv=rv.range,hv=iv.range,fv=ov.range,dv=av.range,pv=sv.range,mv=cv.range,gv=uv.range,vv=vg((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/864e5}),(function(e){return e.getUTCDate()-1})),_v=vv,yv=vv.range,xv=vg((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));xv.every=function(e){return isFinite(e=Math.floor(e))&&e>0?vg((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var bv=xv,wv=xv.range;function Ev(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Mv(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Sv(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Tv(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,c=e.shortMonths,u=kv(i),l=Fv(i),h=kv(o),f=Fv(o),d=kv(a),p=Fv(a),m=kv(s),g=Fv(s),v=kv(c),_=Fv(c),y={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return c[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:a_,e:a_,f:h_,H:s_,I:c_,j:u_,L:l_,m:f_,M:d_,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:j_,s:H_,S:p_,u:m_,U:g_,V:v_,w:__,W:y_,x:null,X:null,y:x_,Y:b_,Z:w_,"%":B_},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return c[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:E_,e:E_,f:L_,H:M_,I:S_,j:T_,L:A_,m:C_,M:R_,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:j_,s:H_,S:P_,u:O_,U:N_,V:I_,w:D_,W:z_,x:null,X:null,y:U_,Y:k_,Z:F_,"%":B_},b={a:function(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=f[r[0].toLowerCase()],n+r[0].length):-1},b:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=_[r[0].toLowerCase()],n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(e,n,r){return M(e,t,n,r)},d:Jv,e:Jv,f:n_,H:Kv,I:Kv,j:$v,L:t_,m:Zv,M:Qv,p:function(e,t,n){var r=u.exec(t.slice(n));return r?(e.p=l[r[0].toLowerCase()],n+r[0].length):-1},q:Yv,Q:i_,s:o_,S:e_,u:jv,U:Hv,V:Gv,w:Bv,W:Vv,x:function(e,t,r){return M(e,n,t,r)},X:function(e,t,n){return M(e,r,t,n)},y:qv,Y:Wv,Z:Xv,"%":r_};function w(e,t){return function(n){var r,i,o,a=[],s=-1,c=0,u=e.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===e.charCodeAt(s)&&(a.push(e.slice(c,s)),null!=(i=Ov[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),c=s+1);return a.push(e.slice(c,s)),a.join("")}}function E(e,t){return function(n){var r,i,o=Sv(1900,void 0,1);if(M(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(!t||"Z"in o||(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Mv(Sv(o.y,0,1))).getUTCDay(),r=i>4||0===i?iv.ceil(r):iv(r),r=_v.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=Ev(Sv(o.y,0,1))).getDay(),r=i>4||0===i?Lg.ceil(r):Lg(r),r=Hg.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Mv(Sv(o.y,0,1)).getUTCDay():Ev(Sv(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Mv(o)):Ev(o)}}function M(e,t,n,r){for(var i,o,a=0,s=t.length,c=n.length;a<s;){if(r>=c)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=b[i in Ov?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return(y.x=w(n,y),y.X=w(r,y),y.c=w(t,y),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",y);return t.toString=function(){return e},t},parse:function(e){var t=E(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=E(e+="",!0);return t.toString=function(){return e},t}})}var Av,Lv,Cv,Rv,Pv,Ov={"-":"",_:" ",0:"0"},Nv=/^\s*\d+/,Iv=/^%/,Dv=/[\\^$*+?|[\]().{}]/g;function zv(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function Uv(e){return e.replace(Dv,"\\$&")}function kv(e){return new RegExp("^(?:"+e.map(Uv).join("|")+")","i")}function Fv(e){for(var t={},n=-1,r=e.length;++n<r;)t[e[n].toLowerCase()]=n;return t}function Bv(e,t,n){var r=Nv.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function jv(e,t,n){var r=Nv.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Hv(e,t,n){var r=Nv.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Gv(e,t,n){var r=Nv.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Vv(e,t,n){var r=Nv.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Wv(e,t,n){var r=Nv.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function qv(e,t,n){var r=Nv.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Xv(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Yv(e,t,n){var r=Nv.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function Zv(e,t,n){var r=Nv.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Jv(e,t,n){var r=Nv.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function $v(e,t,n){var r=Nv.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Kv(e,t,n){var r=Nv.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Qv(e,t,n){var r=Nv.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function e_(e,t,n){var r=Nv.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function t_(e,t,n){var r=Nv.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function n_(e,t,n){var r=Nv.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function r_(e,t,n){var r=Iv.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function i_(e,t,n){var r=Nv.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function o_(e,t,n){var r=Nv.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function a_(e,t){return zv(e.getDate(),t,2)}function s_(e,t){return zv(e.getHours(),t,2)}function c_(e,t){return zv(e.getHours()%12||12,t,2)}function u_(e,t){return zv(1+Hg.count(yg(e),e),t,3)}function l_(e,t){return zv(e.getMilliseconds(),t,3)}function h_(e,t){return l_(e,t)+"000"}function f_(e,t){return zv(e.getMonth()+1,t,2)}function d_(e,t){return zv(e.getMinutes(),t,2)}function p_(e,t){return zv(e.getSeconds(),t,2)}function m_(e){var t=e.getDay();return 0===t?7:t}function g_(e,t){return zv(Ag.count(yg(e)-1,e),t,2)}function v_(e,t){var n=e.getDay();return e=n>=4||0===n?Pg(e):Pg.ceil(e),zv(Pg.count(yg(e),e)+(4===yg(e).getDay()),t,2)}function __(e){return e.getDay()}function y_(e,t){return zv(Lg.count(yg(e)-1,e),t,2)}function x_(e,t){return zv(e.getFullYear()%100,t,2)}function b_(e,t){return zv(e.getFullYear()%1e4,t,4)}function w_(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+zv(t/60|0,"0",2)+zv(t%60,"0",2)}function E_(e,t){return zv(e.getUTCDate(),t,2)}function M_(e,t){return zv(e.getUTCHours(),t,2)}function S_(e,t){return zv(e.getUTCHours()%12||12,t,2)}function T_(e,t){return zv(1+_v.count(bv(e),e),t,3)}function A_(e,t){return zv(e.getUTCMilliseconds(),t,3)}function L_(e,t){return A_(e,t)+"000"}function C_(e,t){return zv(e.getUTCMonth()+1,t,2)}function R_(e,t){return zv(e.getUTCMinutes(),t,2)}function P_(e,t){return zv(e.getUTCSeconds(),t,2)}function O_(e){var t=e.getUTCDay();return 0===t?7:t}function N_(e,t){return zv(rv.count(bv(e)-1,e),t,2)}function I_(e,t){var n=e.getUTCDay();return e=n>=4||0===n?sv(e):sv.ceil(e),zv(sv.count(bv(e),e)+(4===bv(e).getUTCDay()),t,2)}function D_(e){return e.getUTCDay()}function z_(e,t){return zv(iv.count(bv(e)-1,e),t,2)}function U_(e,t){return zv(e.getUTCFullYear()%100,t,2)}function k_(e,t){return zv(e.getUTCFullYear()%1e4,t,4)}function F_(){return"+0000"}function B_(){return"%"}function j_(e){return+e}function H_(e){return Math.floor(+e/1e3)}function G_(e){return Av=Tv(e),Lv=Av.format,Cv=Av.parse,Rv=Av.utcFormat,Pv=Av.utcParse,Av}G_({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var V_=1e3,W_=60*V_,q_=60*W_,X_=24*q_,Y_=7*X_,Z_=30*X_,J_=365*X_;function $_(e){return new Date(e)}function K_(e){return e instanceof Date?+e:+new Date(+e)}function Q_(e,t,n,r,o,a,s,c,u){var l=Hm(Dm,Dm),h=l.invert,f=l.domain,d=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),v=u("%a %d"),_=u("%b %d"),y=u("%B"),x=u("%Y"),b=[[s,1,V_],[s,5,5*V_],[s,15,15*V_],[s,30,30*V_],[a,1,W_],[a,5,5*W_],[a,15,15*W_],[a,30,30*W_],[o,1,q_],[o,3,3*q_],[o,6,6*q_],[o,12,12*q_],[r,1,X_],[r,2,2*X_],[n,1,Y_],[t,1,Z_],[t,3,3*Z_],[e,1,J_]];function w(i){return(s(i)<i?d:a(i)<i?p:o(i)<i?m:r(i)<i?g:t(i)<i?n(i)<i?v:_:e(i)<i?y:x)(i)}function E(t,n,r,o){if(null==t&&(t=10),"number"==typeof t){var a=Math.abs(r-n)/t,s=i((function(e){return e[2]})).right(b,a);s===b.length?(o=L(n/J_,r/J_,t),t=e):s?(o=(s=b[a/b[s-1][2]<b[s][2]/a?s-1:s])[1],t=s[0]):(o=Math.max(L(n,r,t),1),t=c)}return null==o?t:t.every(o)}return l.invert=function(e){return new Date(h(e))},l.domain=function(e){return arguments.length?f(Tm.call(e,K_)):f().map($_)},l.ticks=function(e,t){var n,r=f(),i=r[0],o=r[r.length-1],a=o<i;return a&&(n=i,i=o,o=n),n=(n=E(e,i,o,t))?n.range(i,o+1):[],a?n.reverse():n},l.tickFormat=function(e,t){return null==t?w:u(t)},l.nice=function(e,t){var n=f();return(e=E(e,n[0],n[n.length-1],t))?f(Xm(n,e)):l},l.copy=function(){return Bm(l,Q_(e,t,n,r,o,a,s,c,u))},l}var ey=function(){return Em.apply(Q_(yg,wg,Ag,Hg,Wg,Yg,$g,ev,Lv).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},ty=vg((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),ny=ty,ry=ty.range,iy=vg((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+36e5*t)}),(function(e,t){return(t-e)/36e5}),(function(e){return e.getUTCHours()})),oy=iy,ay=iy.range,sy=vg((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*Mg)}),(function(e,t){return(t-e)/Mg}),(function(e){return e.getUTCMinutes()})),cy=sy,uy=sy.range,ly=function(){return Em.apply(Q_(bv,ny,rv,_v,oy,cy,$g,ev,Rv).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function hy(){var e,t,n,r,i,o=0,a=1,s=Dm,c=!1;function u(t){return isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,c?Math.max(0,Math.min(1,t)):t))}return u.domain=function(i){return arguments.length?(e=r(o=+i[0]),t=r(a=+i[1]),n=e===t?0:1/(t-e),u):[o,a]},u.clamp=function(e){return arguments.length?(c=!!e,u):c},u.interpolator=function(e){return arguments.length?(s=e,u):s},u.unknown=function(e){return arguments.length?(i=e,u):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),u}}function fy(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function dy(){var e=Vm(hy()(Dm));return e.copy=function(){return fy(e,dy())},Mm.apply(e,arguments)}function py(){var e=eg(hy()).domain([1,10]);return e.copy=function(){return fy(e,py()).base(e.base())},Mm.apply(e,arguments)}function my(){var e=ig(hy());return e.copy=function(){return fy(e,my()).constant(e.constant())},Mm.apply(e,arguments)}function gy(){var e=ug(hy());return e.copy=function(){return fy(e,gy()).exponent(e.exponent())},Mm.apply(e,arguments)}function vy(){return gy.apply(null,arguments).exponent(.5)}function _y(){var e=[],t=Dm;function n(n){if(!isNaN(n=+n))return t((c(e,n)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var i,o=0,a=t.length;o<a;++o)null==(i=t[o])||isNaN(i=+i)||e.push(i);return e.sort(r),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return _y(t).domain(e)},Mm.apply(n,arguments)}function yy(){var e,t,n,r,i,o,a,s=0,c=.5,u=1,l=Dm,h=!1;function f(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(e<t?r:i),l(h?Math.max(0,Math.min(1,e)):e))}return f.domain=function(a){return arguments.length?(e=o(s=+a[0]),t=o(c=+a[1]),n=o(u=+a[2]),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),f):[s,c,u]},f.clamp=function(e){return arguments.length?(h=!!e,f):h},f.interpolator=function(e){return arguments.length?(l=e,f):l},f.unknown=function(e){return arguments.length?(a=e,f):a},function(a){return o=a,e=a(s),t=a(c),n=a(u),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),f}}function xy(){var e=Vm(yy()(Dm));return e.copy=function(){return fy(e,xy())},Mm.apply(e,arguments)}function by(){var e=eg(yy()).domain([.1,1,10]);return e.copy=function(){return fy(e,by()).base(e.base())},Mm.apply(e,arguments)}function wy(){var e=ig(yy());return e.copy=function(){return fy(e,wy()).constant(e.constant())},Mm.apply(e,arguments)}function Ey(){var e=ug(yy());return e.copy=function(){return fy(e,Ey()).exponent(e.exponent())},Mm.apply(e,arguments)}function My(){return Ey.apply(null,arguments).exponent(.5)}var Sy=function(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n},Ty=Sy("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Ay=Sy("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Ly=Sy("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Cy=Sy("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Ry=Sy("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Py=Sy("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Oy=Sy("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Ny=Sy("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Iy=Sy("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Dy=Sy("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),zy=function(e){return Un(e[e.length-1])},Uy=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Sy),ky=zy(Uy),Fy=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Sy),By=zy(Fy),jy=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Sy),Hy=zy(jy),Gy=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Sy),Vy=zy(Gy),Wy=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Sy),qy=zy(Wy),Xy=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Sy),Yy=zy(Xy),Zy=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Sy),Jy=zy(Zy),$y=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Sy),Ky=zy($y),Qy=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Sy),ex=zy(Qy),tx=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Sy),nx=zy(tx),rx=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Sy),ix=zy(rx),ox=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Sy),ax=zy(ox),sx=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Sy),cx=zy(sx),ux=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Sy),lx=zy(ux),hx=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Sy),fx=zy(hx),dx=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Sy),px=zy(dx),mx=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Sy),gx=zy(mx),vx=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Sy),_x=zy(vx),yx=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Sy),xx=zy(yx),bx=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Sy),wx=zy(bx),Ex=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Sy),Mx=zy(Ex),Sx=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Sy),Tx=zy(Sx),Ax=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Sy),Lx=zy(Ax),Cx=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Sy),Rx=zy(Cx),Px=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Sy),Ox=zy(Px),Nx=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Sy),Ix=zy(Nx),Dx=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Sy),zx=zy(Dx),Ux=function(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-2710.57*e)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-67.37*e)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-2475.67*e)))))))+")"},kx=Yr(Vr(300,.5,0),Vr(-240,.5,1)),Fx=Yr(Vr(-100,.75,.35),Vr(80,1.5,.8)),Bx=Yr(Vr(260,.75,.35),Vr(80,1.5,.8)),jx=Vr(),Hx=function(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return jx.h=360*e-100,jx.s=1.5-1.5*t,jx.l=.8-.9*t,jx+""},Gx=vn(),Vx=Math.PI/3,Wx=2*Math.PI/3,qx=function(e){var t;return e=(.5-e)*Math.PI,Gx.r=255*(t=Math.sin(e))*t,Gx.g=255*(t=Math.sin(e+Vx))*t,Gx.b=255*(t=Math.sin(e+Wx))*t,Gx+""},Xx=function(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-14825.05*e)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+707.56*e)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-6838.66*e)))))))+")"};function Yx(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var Zx=Yx(Sy("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Jx=Yx(Sy("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),$x=Yx(Sy("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Kx=Yx(Sy("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Qx=function(e){return function(){return e}},eb=Math.abs,tb=Math.atan2,nb=Math.cos,rb=Math.max,ib=Math.min,ob=Math.sin,ab=Math.sqrt,sb=1e-12,cb=Math.PI,ub=cb/2,lb=2*cb;function hb(e){return e>=1?ub:e<=-1?-ub:Math.asin(e)}function fb(e){return e.innerRadius}function db(e){return e.outerRadius}function pb(e){return e.startAngle}function mb(e){return e.endAngle}function gb(e){return e&&e.padAngle}function vb(e,t,n,r,i,o,a){var s=e-n,c=t-r,u=(a?o:-o)/ab(s*s+c*c),l=u*c,h=-u*s,f=e+l,d=t+h,p=n+l,m=r+h,g=(f+p)/2,v=(d+m)/2,_=p-f,y=m-d,x=_*_+y*y,b=i-o,w=f*m-p*d,E=(y<0?-1:1)*ab(rb(0,b*b*x-w*w)),M=(w*y-_*E)/x,S=(-w*_-y*E)/x,T=(w*y+_*E)/x,A=(-w*_+y*E)/x,L=M-g,C=S-v,R=T-g,P=A-v;return L*L+C*C>R*R+P*P&&(M=T,S=A),{cx:M,cy:S,x01:-l,y01:-h,x11:M*(i/b-1),y11:S*(i/b-1)}}var _b=function(){var e=fb,t=db,n=Qx(0),r=null,i=pb,o=mb,a=gb,s=null;function c(){var c,u,l,h=+e.apply(this,arguments),f=+t.apply(this,arguments),d=i.apply(this,arguments)-ub,p=o.apply(this,arguments)-ub,m=eb(p-d),g=p>d;if(s||(s=c=Fa()),f<h&&(u=f,f=h,h=u),f>sb)if(m>lb-sb)s.moveTo(f*nb(d),f*ob(d)),s.arc(0,0,f,d,p,!g),h>sb&&(s.moveTo(h*nb(p),h*ob(p)),s.arc(0,0,h,p,d,g));else{var v,_,y=d,x=p,b=d,w=p,E=m,M=m,S=a.apply(this,arguments)/2,T=S>sb&&(r?+r.apply(this,arguments):ab(h*h+f*f)),A=ib(eb(f-h)/2,+n.apply(this,arguments)),L=A,C=A;if(T>sb){var R=hb(T/h*ob(S)),P=hb(T/f*ob(S));(E-=2*R)>sb?(b+=R*=g?1:-1,w-=R):(E=0,b=w=(d+p)/2),(M-=2*P)>sb?(y+=P*=g?1:-1,x-=P):(M=0,y=x=(d+p)/2)}var O=f*nb(y),N=f*ob(y),I=h*nb(w),D=h*ob(w);if(A>sb){var z,U=f*nb(x),k=f*ob(x),F=h*nb(b),B=h*ob(b);if(m<cb&&(z=function(e,t,n,r,i,o,a,s){var c=n-e,u=r-t,l=a-i,h=s-o,f=h*c-l*u;if(!(f*f<sb))return[e+(f=(l*(t-o)-h*(e-i))/f)*c,t+f*u]}(O,N,F,B,U,k,I,D))){var j=O-z[0],H=N-z[1],G=U-z[0],V=k-z[1],W=1/ob(((l=(j*G+H*V)/(ab(j*j+H*H)*ab(G*G+V*V)))>1?0:l<-1?cb:Math.acos(l))/2),q=ab(z[0]*z[0]+z[1]*z[1]);L=ib(A,(h-q)/(W-1)),C=ib(A,(f-q)/(W+1))}}M>sb?C>sb?(v=vb(F,B,O,N,f,C,g),_=vb(U,k,I,D,f,C,g),s.moveTo(v.cx+v.x01,v.cy+v.y01),C<A?s.arc(v.cx,v.cy,C,tb(v.y01,v.x01),tb(_.y01,_.x01),!g):(s.arc(v.cx,v.cy,C,tb(v.y01,v.x01),tb(v.y11,v.x11),!g),s.arc(0,0,f,tb(v.cy+v.y11,v.cx+v.x11),tb(_.cy+_.y11,_.cx+_.x11),!g),s.arc(_.cx,_.cy,C,tb(_.y11,_.x11),tb(_.y01,_.x01),!g))):(s.moveTo(O,N),s.arc(0,0,f,y,x,!g)):s.moveTo(O,N),h>sb&&E>sb?L>sb?(v=vb(I,D,U,k,h,-L,g),_=vb(O,N,F,B,h,-L,g),s.lineTo(v.cx+v.x01,v.cy+v.y01),L<A?s.arc(v.cx,v.cy,L,tb(v.y01,v.x01),tb(_.y01,_.x01),!g):(s.arc(v.cx,v.cy,L,tb(v.y01,v.x01),tb(v.y11,v.x11),!g),s.arc(0,0,h,tb(v.cy+v.y11,v.cx+v.x11),tb(_.cy+_.y11,_.cx+_.x11),g),s.arc(_.cx,_.cy,L,tb(_.y11,_.x11),tb(_.y01,_.x01),!g))):s.arc(0,0,h,w,b,g):s.lineTo(I,D)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+""||null}return c.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-cb/2;return[nb(r)*n,ob(r)*n]},c.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Qx(+t),c):e},c.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:Qx(+e),c):t},c.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:Qx(+e),c):n},c.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:Qx(+e),c):r},c.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:Qx(+e),c):i},c.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:Qx(+e),c):o},c.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:Qx(+e),c):a},c.context=function(e){return arguments.length?(s=null==e?null:e,c):s},c};function yb(e){this._context=e}yb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var xb=function(e){return new yb(e)};function bb(e){return e[0]}function wb(e){return e[1]}var Eb=function(){var e=bb,t=wb,n=Qx(!0),r=null,i=xb,o=null;function a(a){var s,c,u,l=a.length,h=!1;for(null==r&&(o=i(u=Fa())),s=0;s<=l;++s)!(s<l&&n(c=a[s],s,a))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+e(c,s,a),+t(c,s,a));if(u)return o=null,u+""||null}return a.x=function(t){return arguments.length?(e="function"==typeof t?t:Qx(+t),a):e},a.y=function(e){return arguments.length?(t="function"==typeof e?e:Qx(+e),a):t},a.defined=function(e){return arguments.length?(n="function"==typeof e?e:Qx(!!e),a):n},a.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),a):i},a.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),a):r},a},Mb=function(){var e=bb,t=null,n=Qx(0),r=wb,i=Qx(!0),o=null,a=xb,s=null;function c(c){var u,l,h,f,d,p=c.length,m=!1,g=new Array(p),v=new Array(p);for(null==o&&(s=a(d=Fa())),u=0;u<=p;++u){if(!(u<p&&i(f=c[u],u,c))===m)if(m=!m)l=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=u-1;h>=l;--h)s.point(g[h],v[h]);s.lineEnd(),s.areaEnd()}m&&(g[u]=+e(f,u,c),v[u]=+n(f,u,c),s.point(t?+t(f,u,c):g[u],r?+r(f,u,c):v[u]))}if(d)return s=null,d+""||null}function u(){return Eb().defined(i).curve(a).context(o)}return c.x=function(n){return arguments.length?(e="function"==typeof n?n:Qx(+n),t=null,c):e},c.x0=function(t){return arguments.length?(e="function"==typeof t?t:Qx(+t),c):e},c.x1=function(e){return arguments.length?(t=null==e?null:"function"==typeof e?e:Qx(+e),c):t},c.y=function(e){return arguments.length?(n="function"==typeof e?e:Qx(+e),r=null,c):n},c.y0=function(e){return arguments.length?(n="function"==typeof e?e:Qx(+e),c):n},c.y1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:Qx(+e),c):r},c.lineX0=c.lineY0=function(){return u().x(e).y(n)},c.lineY1=function(){return u().x(e).y(r)},c.lineX1=function(){return u().x(t).y(n)},c.defined=function(e){return arguments.length?(i="function"==typeof e?e:Qx(!!e),c):i},c.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),c):a},c.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),c):o},c},Sb=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},Tb=function(e){return e},Ab=function(){var e=Tb,t=Sb,n=null,r=Qx(0),i=Qx(lb),o=Qx(0);function a(a){var s,c,u,l,h,f=a.length,d=0,p=new Array(f),m=new Array(f),g=+r.apply(this,arguments),v=Math.min(lb,Math.max(-lb,i.apply(this,arguments)-g)),_=Math.min(Math.abs(v)/f,o.apply(this,arguments)),y=_*(v<0?-1:1);for(s=0;s<f;++s)(h=m[p[s]=s]=+e(a[s],s,a))>0&&(d+=h);for(null!=t?p.sort((function(e,n){return t(m[e],m[n])})):null!=n&&p.sort((function(e,t){return n(a[e],a[t])})),s=0,u=d?(v-f*y)/d:0;s<f;++s,g=l)c=p[s],l=g+((h=m[c])>0?h*u:0)+y,m[c]={data:a[c],index:s,value:h,startAngle:g,endAngle:l,padAngle:_};return m}return a.value=function(t){return arguments.length?(e="function"==typeof t?t:Qx(+t),a):e},a.sortValues=function(e){return arguments.length?(t=e,n=null,a):t},a.sort=function(e){return arguments.length?(n=e,t=null,a):n},a.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:Qx(+e),a):r},a.endAngle=function(e){return arguments.length?(i="function"==typeof e?e:Qx(+e),a):i},a.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:Qx(+e),a):o},a},Lb=Rb(xb);function Cb(e){this._curve=e}function Rb(e){function t(t){return new Cb(e(t))}return t._curve=e,t}function Pb(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(e){return arguments.length?t(Rb(e)):t()._curve},e}Cb.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};var Ob=function(){return Pb(Eb().curve(Lb))},Nb=function(){var e=Mb().curve(Lb),t=e.curve,n=e.lineX0,r=e.lineX1,i=e.lineY0,o=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return Pb(n())},delete e.lineX0,e.lineEndAngle=function(){return Pb(r())},delete e.lineX1,e.lineInnerRadius=function(){return Pb(i())},delete e.lineY0,e.lineOuterRadius=function(){return Pb(o())},delete e.lineY1,e.curve=function(e){return arguments.length?t(Rb(e)):t()._curve},e},Ib=function(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]},Db=Array.prototype.slice;function zb(e){return e.source}function Ub(e){return e.target}function kb(e){var t=zb,n=Ub,r=bb,i=wb,o=null;function a(){var a,s=Db.call(arguments),c=t.apply(this,s),u=n.apply(this,s);if(o||(o=a=Fa()),e(o,+r.apply(this,(s[0]=c,s)),+i.apply(this,s),+r.apply(this,(s[0]=u,s)),+i.apply(this,s)),a)return o=null,a+""||null}return a.source=function(e){return arguments.length?(t=e,a):t},a.target=function(e){return arguments.length?(n=e,a):n},a.x=function(e){return arguments.length?(r="function"==typeof e?e:Qx(+e),a):r},a.y=function(e){return arguments.length?(i="function"==typeof e?e:Qx(+e),a):i},a.context=function(e){return arguments.length?(o=null==e?null:e,a):o},a}function Fb(e,t,n,r,i){e.moveTo(t,n),e.bezierCurveTo(t=(t+r)/2,n,t,i,r,i)}function Bb(e,t,n,r,i){e.moveTo(t,n),e.bezierCurveTo(t,n=(n+i)/2,r,n,r,i)}function jb(e,t,n,r,i){var o=Ib(t,n),a=Ib(t,n=(n+i)/2),s=Ib(r,n),c=Ib(r,i);e.moveTo(o[0],o[1]),e.bezierCurveTo(a[0],a[1],s[0],s[1],c[0],c[1])}function Hb(){return kb(Fb)}function Gb(){return kb(Bb)}function Vb(){var e=kb(jb);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}var Wb={draw:function(e,t){var n=Math.sqrt(t/cb);e.moveTo(n,0),e.arc(0,0,n,0,lb)}},qb={draw:function(e,t){var n=Math.sqrt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},Xb=Math.sqrt(1/3),Yb=2*Xb,Zb={draw:function(e,t){var n=Math.sqrt(t/Yb),r=n*Xb;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},Jb=Math.sin(cb/10)/Math.sin(7*cb/10),$b=Math.sin(lb/10)*Jb,Kb=-Math.cos(lb/10)*Jb,Qb={draw:function(e,t){var n=Math.sqrt(.8908130915292852*t),r=$b*n,i=Kb*n;e.moveTo(0,-n),e.lineTo(r,i);for(var o=1;o<5;++o){var a=lb*o/5,s=Math.cos(a),c=Math.sin(a);e.lineTo(c*n,-s*n),e.lineTo(s*r-c*i,c*r+s*i)}e.closePath()}},ew={draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},tw=Math.sqrt(3),nw={draw:function(e,t){var n=-Math.sqrt(t/(3*tw));e.moveTo(0,2*n),e.lineTo(-tw*n,-n),e.lineTo(tw*n,-n),e.closePath()}},rw=Math.sqrt(3)/2,iw=1/Math.sqrt(12),ow=3*(iw/2+1),aw={draw:function(e,t){var n=Math.sqrt(t/ow),r=n/2,i=n*iw,o=r,a=n*iw+n,s=-o,c=a;e.moveTo(r,i),e.lineTo(o,a),e.lineTo(s,c),e.lineTo(-.5*r-rw*i,rw*r+-.5*i),e.lineTo(-.5*o-rw*a,rw*o+-.5*a),e.lineTo(-.5*s-rw*c,rw*s+-.5*c),e.lineTo(-.5*r+rw*i,-.5*i-rw*r),e.lineTo(-.5*o+rw*a,-.5*a-rw*o),e.lineTo(-.5*s+rw*c,-.5*c-rw*s),e.closePath()}},sw=[Wb,qb,Zb,ew,Qb,nw,aw],cw=function(){var e=Qx(Wb),t=Qx(64),n=null;function r(){var r;if(n||(n=r=Fa()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(t){return arguments.length?(e="function"==typeof t?t:Qx(t),r):e},r.size=function(e){return arguments.length?(t="function"==typeof e?e:Qx(+e),r):t},r.context=function(e){return arguments.length?(n=null==e?null:e,r):n},r},uw=function(){};function lw(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function hw(e){this._context=e}hw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:lw(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:lw(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var fw=function(e){return new hw(e)};function dw(e){this._context=e}dw.prototype={areaStart:uw,areaEnd:uw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:lw(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var pw=function(e){return new dw(e)};function mw(e){this._context=e}mw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:lw(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var gw=function(e){return new mw(e)};function vw(e,t){this._basis=new hw(e),this._beta=t}vw.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],o=t[0],a=e[n]-i,s=t[n]-o,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*e[c]+(1-this._beta)*(i+r*a),this._beta*t[c]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var _w=function e(t){function n(e){return 1===t?new hw(e):new vw(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function yw(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function xw(e,t){this._context=e,this._k=(1-t)/6}xw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:yw(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:yw(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var bw=function e(t){function n(e){return new xw(e,t)}return n.tension=function(t){return e(+t)},n}(0);function ww(e,t){this._context=e,this._k=(1-t)/6}ww.prototype={areaStart:uw,areaEnd:uw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:yw(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ew=function e(t){function n(e){return new ww(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Mw(e,t){this._context=e,this._k=(1-t)/6}Mw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:yw(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Sw=function e(t){function n(e){return new Mw(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Tw(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>sb){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>sb){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,l=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*u+e._x1*e._l23_2a-t*e._l12_2a)/l,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/l}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function Aw(e,t){this._context=e,this._alpha=t}Aw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Tw(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Lw=function e(t){function n(e){return t?new Aw(e,t):new xw(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Cw(e,t){this._context=e,this._alpha=t}Cw.prototype={areaStart:uw,areaEnd:uw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Tw(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Rw=function e(t){function n(e){return t?new Cw(e,t):new ww(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Pw(e,t){this._context=e,this._alpha=t}Pw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Tw(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ow=function e(t){function n(e){return t?new Pw(e,t):new Mw(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Nw(e){this._context=e}Nw.prototype={areaStart:uw,areaEnd:uw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};var Iw=function(e){return new Nw(e)};function Dw(e){return e<0?-1:1}function zw(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(Dw(o)+Dw(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Uw(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function kw(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function Fw(e){this._context=e}function Bw(e){this._context=new jw(e)}function jw(e){this._context=e}function Hw(e){return new Fw(e)}function Gw(e){return new Bw(e)}function Vw(e){this._context=e}function Ww(e){var t,n,r=e.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}Fw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:kw(this,this._t0,Uw(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,kw(this,Uw(this,n=zw(this,e,t)),n);break;default:kw(this,this._t0,n=zw(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Bw.prototype=Object.create(Fw.prototype)).point=function(e,t){Fw.prototype.point.call(this,t,e)},jw.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},Vw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=Ww(e),i=Ww(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var qw=function(e){return new Vw(e)};function Xw(e,t){this._context=e,this._t=t}Xw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var Yw=function(e){return new Xw(e,.5)};function Zw(e){return new Xw(e,0)}function Jw(e){return new Xw(e,1)}var $w=function(e,t){if((i=e.length)>1)for(var n,r,i,o=1,a=e[t[0]],s=a.length;o<i;++o)for(r=a,a=e[t[o]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]},Kw=function(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n};function Qw(e,t){return e[t]}var eE=function(){var e=Qx([]),t=Kw,n=$w,r=Qw;function i(i){var o,a,s=e.apply(this,arguments),c=i.length,u=s.length,l=new Array(u);for(o=0;o<u;++o){for(var h,f=s[o],d=l[o]=new Array(c),p=0;p<c;++p)d[p]=h=[0,+r(i[p],f,p,i)],h.data=i[p];d.key=f}for(o=0,a=t(l);o<u;++o)l[a[o]].index=o;return n(l,a),l}return i.keys=function(t){return arguments.length?(e="function"==typeof t?t:Qx(Db.call(t)),i):e},i.value=function(e){return arguments.length?(r="function"==typeof e?e:Qx(+e),i):r},i.order=function(e){return arguments.length?(t=null==e?Kw:"function"==typeof e?e:Qx(Db.call(e)),i):t},i.offset=function(e){return arguments.length?(n=null==e?$w:e,i):n},i},tE=function(e,t){if((r=e.length)>0){for(var n,r,i,o=0,a=e[0].length;o<a;++o){for(i=n=0;n<r;++n)i+=e[n][o][1]||0;if(i)for(n=0;n<r;++n)e[n][o][1]/=i}$w(e,t)}},nE=function(e,t){if((s=e.length)>0)for(var n,r,i,o,a,s,c=0,u=e[t[0]].length;c<u;++c)for(o=a=0,n=0;n<s;++n)(i=(r=e[t[n]][c])[1]-r[0])>=0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=a,r[0]=a+=i):r[0]=o},rE=function(e,t){if((n=e.length)>0){for(var n,r=0,i=e[t[0]],o=i.length;r<o;++r){for(var a=0,s=0;a<n;++a)s+=e[a][r][1]||0;i[r][1]+=i[r][0]=-s/2}$w(e,t)}},iE=function(e,t){if((i=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,i,o=0,a=1;a<r;++a){for(var s=0,c=0,u=0;s<i;++s){for(var l=e[t[s]],h=l[a][1]||0,f=(h-(l[a-1][1]||0))/2,d=0;d<s;++d){var p=e[t[d]];f+=(p[a][1]||0)-(p[a-1][1]||0)}c+=h,u+=f*h}n[a-1][1]+=n[a-1][0]=o,c&&(o-=u/c)}n[a-1][1]+=n[a-1][0]=o,$w(e,t)}},oE=function(e){var t=e.map(aE);return Kw(e).sort((function(e,n){return t[e]-t[n]}))};function aE(e){for(var t,n=-1,r=0,i=e.length,o=-1/0;++n<i;)(t=+e[n][1])>o&&(o=t,r=n);return r}var sE=function(e){var t=e.map(cE);return Kw(e).sort((function(e,n){return t[e]-t[n]}))};function cE(e){for(var t,n=0,r=-1,i=e.length;++r<i;)(t=+e[r][1])&&(n+=t);return n}var uE=function(e){return sE(e).reverse()},lE=function(e){var t,n,r=e.length,i=e.map(cE),o=oE(e),a=0,s=0,c=[],u=[];for(t=0;t<r;++t)n=o[t],a<s?(a+=i[n],c.push(n)):(s+=i[n],u.push(n));return u.reverse().concat(c)},hE=function(e){return Kw(e).reverse()};var fE=Date.prototype.toISOString?function(e){return e.toISOString()}:Rv("%Y-%m-%dT%H:%M:%S.%LZ");var dE=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:Pv("%Y-%m-%dT%H:%M:%S.%LZ"),pE=function(e){return function(){return e}};function mE(e){return e[0]}function gE(e){return e[1]}function vE(){this._=null}function _E(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function yE(e,t){var n=t,r=t.R,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function xE(e,t){var n=t,r=t.L,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function bE(e){for(;e.L;)e=e.L;return e}vE.prototype={constructor:vE,insert:function(e,t){var n,r,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=bE(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.R&&(yE(this,n),n=(e=n).U),n.C=!1,r.C=!0,xE(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.L&&(xE(this,n),n=(e=n).U),n.C=!1,r.C=!0,yE(this,r)),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,n,r,i=e.U,o=e.L,a=e.R;if(n=o?a?bE(a):o:a,i?i.L===e?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=e.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=e.U,e=n.R,i.L=e,n.R=a,a.U=n):(n.U=i,i=n,e=n.R)):(r=e.C,e=n),e&&(e.U=i),!r)if(e&&e.C)e.C=!1;else{do{if(e===this._)break;if(e===i.L){if((t=i.R).C&&(t.C=!1,i.C=!0,yE(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,xE(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,yE(this,i),e=this._;break}}else if((t=i.L).C&&(t.C=!1,i.C=!0,xE(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,yE(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,xE(this,i),e=this._;break}t.C=!0,e=i,i=i.U}while(!e.C);e&&(e.C=!1)}}};var wE=vE;function EE(e,t,n,r){var i=[null,null],o=XE.push(i)-1;return i.left=e,i.right=t,n&&SE(i,e,t,n),r&&SE(i,t,e,r),WE[e.index].halfedges.push(o),WE[t.index].halfedges.push(o),i}function ME(e,t,n){var r=[t,n];return r.left=e,r}function SE(e,t,n,r){e[0]||e[1]?e.left===n?e[1]=r:e[0]=r:(e[0]=r,e.left=t,e.right=n)}function TE(e,t,n,r,i){var o,a=e[0],s=e[1],c=a[0],u=a[1],l=0,h=1,f=s[0]-c,d=s[1]-u;if(o=t-c,f||!(o>0)){if(o/=f,f<0){if(o<l)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>l&&(l=o)}if(o=r-c,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>l&&(l=o)}else if(f>0){if(o<l)return;o<h&&(h=o)}if(o=n-u,d||!(o>0)){if(o/=d,d<0){if(o<l)return;o<h&&(h=o)}else if(d>0){if(o>h)return;o>l&&(l=o)}if(o=i-u,d||!(o<0)){if(o/=d,d<0){if(o>h)return;o>l&&(l=o)}else if(d>0){if(o<l)return;o<h&&(h=o)}return!(l>0||h<1)||(l>0&&(e[0]=[c+l*f,u+l*d]),h<1&&(e[1]=[c+h*f,u+h*d]),!0)}}}}}function AE(e,t,n,r,i){var o=e[1];if(o)return!0;var a,s,c=e[0],u=e.left,l=e.right,h=u[0],f=u[1],d=l[0],p=l[1],m=(h+d)/2,g=(f+p)/2;if(p===f){if(m<t||m>=r)return;if(h>d){if(c){if(c[1]>=i)return}else c=[m,n];o=[m,i]}else{if(c){if(c[1]<n)return}else c=[m,i];o=[m,n]}}else if(s=g-(a=(h-d)/(p-f))*m,a<-1||a>1)if(h>d){if(c){if(c[1]>=i)return}else c=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(c){if(c[1]<n)return}else c=[(i-s)/a,i];o=[(n-s)/a,n]}else if(f<p){if(c){if(c[0]>=r)return}else c=[t,a*t+s];o=[r,a*r+s]}else{if(c){if(c[0]<t)return}else c=[r,a*r+s];o=[t,a*t+s]}return e[0]=c,e[1]=o,!0}function LE(e,t){var n=e.site,r=t.left,i=t.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=t[1],i=t[0]):(r=t[0],i=t[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function CE(e,t){return t[+(t.left!==e.site)]}function RE(e,t){return t[+(t.left===e.site)]}var PE,OE=[];function NE(){_E(this),this.x=this.y=this.arc=this.site=this.cy=null}function IE(e){var t=e.P,n=e.N;if(t&&n){var r=t.site,i=e.site,o=n.site;if(r!==o){var a=i[0],s=i[1],c=r[0]-a,u=r[1]-s,l=o[0]-a,h=o[1]-s,f=2*(c*h-u*l);if(!(f>=-ZE)){var d=c*c+u*u,p=l*l+h*h,m=(h*d-u*p)/f,g=(c*p-l*d)/f,v=OE.pop()||new NE;v.arc=e,v.site=i,v.x=m+a,v.y=(v.cy=g+s)+Math.sqrt(m*m+g*g),e.circle=v;for(var _=null,y=qE._;y;)if(v.y<y.y||v.y===y.y&&v.x<=y.x){if(!y.L){_=y.P;break}y=y.L}else{if(!y.R){_=y;break}y=y.R}qE.insert(_,v),_||(PE=v)}}}}function DE(e){var t=e.circle;t&&(t.P||(PE=t.N),qE.remove(t),OE.push(t),_E(t),e.circle=null)}var zE=[];function UE(){_E(this),this.edge=this.site=this.circle=null}function kE(e){var t=zE.pop()||new UE;return t.site=e,t}function FE(e){DE(e),VE.remove(e),zE.push(e),_E(e)}function BE(e){var t=e.circle,n=t.x,r=t.cy,i=[n,r],o=e.P,a=e.N,s=[e];FE(e);for(var c=o;c.circle&&Math.abs(n-c.circle.x)<YE&&Math.abs(r-c.circle.cy)<YE;)o=c.P,s.unshift(c),FE(c),c=o;s.unshift(c),DE(c);for(var u=a;u.circle&&Math.abs(n-u.circle.x)<YE&&Math.abs(r-u.circle.cy)<YE;)a=u.N,s.push(u),FE(u),u=a;s.push(u),DE(u);var l,h=s.length;for(l=1;l<h;++l)u=s[l],c=s[l-1],SE(u.edge,c.site,u.site,i);c=s[0],(u=s[h-1]).edge=EE(c.site,u.site,null,i),IE(c),IE(u)}function jE(e){for(var t,n,r,i,o=e[0],a=e[1],s=VE._;s;)if((r=HE(s,a)-o)>YE)s=s.L;else{if(!((i=o-GE(s,a))>YE)){r>-YE?(t=s.P,n=s):i>-YE?(t=s,n=s.N):t=n=s;break}if(!s.R){t=s;break}s=s.R}!function(e){WE[e.index]={site:e,halfedges:[]}}(e);var c=kE(e);if(VE.insert(t,c),t||n){if(t===n)return DE(t),n=kE(t.site),VE.insert(c,n),c.edge=n.edge=EE(t.site,c.site),IE(t),void IE(n);if(n){DE(t),DE(n);var u=t.site,l=u[0],h=u[1],f=e[0]-l,d=e[1]-h,p=n.site,m=p[0]-l,g=p[1]-h,v=2*(f*g-d*m),_=f*f+d*d,y=m*m+g*g,x=[(g*_-d*y)/v+l,(f*y-m*_)/v+h];SE(n.edge,u,p,x),c.edge=EE(u,e,null,x),n.edge=EE(e,p,null,x),IE(t),IE(n)}else c.edge=EE(t.site,c.site)}}function HE(e,t){var n=e.site,r=n[0],i=n[1],o=i-t;if(!o)return r;var a=e.P;if(!a)return-1/0;var s=(n=a.site)[0],c=n[1],u=c-t;if(!u)return s;var l=s-r,h=1/o-1/u,f=l/u;return h?(-f+Math.sqrt(f*f-2*h*(l*l/(-2*u)-c+u/2+i-o/2)))/h+r:(r+s)/2}function GE(e,t){var n=e.N;if(n)return HE(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var VE,WE,qE,XE,YE=1e-6,ZE=1e-12;function JE(e,t){return t[1]-e[1]||t[0]-e[0]}function $E(e,t){var n,r,i,o=e.sort(JE).pop();for(XE=[],WE=new Array(e.length),VE=new wE,qE=new wE;;)if(i=PE,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(jE(o),n=o[0],r=o[1]),o=e.pop();else{if(!i)break;BE(i.arc)}if(function(){for(var e,t,n,r,i=0,o=WE.length;i<o;++i)if((e=WE[i])&&(r=(t=e.halfedges).length)){var a=new Array(r),s=new Array(r);for(n=0;n<r;++n)a[n]=n,s[n]=LE(e,XE[t[n]]);for(a.sort((function(e,t){return s[t]-s[e]})),n=0;n<r;++n)s[n]=t[a[n]];for(n=0;n<r;++n)t[n]=s[n]}}(),t){var a=+t[0][0],s=+t[0][1],c=+t[1][0],u=+t[1][1];!function(e,t,n,r){for(var i,o=XE.length;o--;)AE(i=XE[o],e,t,n,r)&&TE(i,e,t,n,r)&&(Math.abs(i[0][0]-i[1][0])>YE||Math.abs(i[0][1]-i[1][1])>YE)||delete XE[o]}(a,s,c,u),function(e,t,n,r){var i,o,a,s,c,u,l,h,f,d,p,m,g=WE.length,v=!0;for(i=0;i<g;++i)if(o=WE[i]){for(a=o.site,s=(c=o.halfedges).length;s--;)XE[c[s]]||c.splice(s,1);for(s=0,u=c.length;s<u;)p=(d=RE(o,XE[c[s]]))[0],m=d[1],h=(l=CE(o,XE[c[++s%u]]))[0],f=l[1],(Math.abs(p-h)>YE||Math.abs(m-f)>YE)&&(c.splice(s,0,XE.push(ME(a,d,Math.abs(p-e)<YE&&r-m>YE?[e,Math.abs(h-e)<YE?f:r]:Math.abs(m-r)<YE&&n-p>YE?[Math.abs(f-r)<YE?h:n,r]:Math.abs(p-n)<YE&&m-t>YE?[n,Math.abs(h-n)<YE?f:t]:Math.abs(m-t)<YE&&p-e>YE?[Math.abs(f-t)<YE?h:e,t]:null))-1),++u);u&&(v=!1)}if(v){var _,y,x,b=1/0;for(i=0,v=null;i<g;++i)(o=WE[i])&&(x=(_=(a=o.site)[0]-e)*_+(y=a[1]-t)*y)<b&&(b=x,v=o);if(v){var w=[e,t],E=[e,r],M=[n,r],S=[n,t];v.halfedges.push(XE.push(ME(a=v.site,w,E))-1,XE.push(ME(a,E,M))-1,XE.push(ME(a,M,S))-1,XE.push(ME(a,S,w))-1)}}for(i=0;i<g;++i)(o=WE[i])&&(o.halfedges.length||delete WE[i])}(a,s,c,u)}this.edges=XE,this.cells=WE,VE=qE=XE=WE=null}$E.prototype={constructor:$E,polygons:function(){var e=this.edges;return this.cells.map((function(t){var n=t.halfedges.map((function(n){return CE(t,e[n])}));return n.data=t.site.data,n}))},triangles:function(){var e=[],t=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,s,c,u,l=n.site,h=-1,f=t[i[o-1]],d=f.left===l?f.right:f.left;++h<o;)a=d,d=(f=t[i[h]]).left===l?f.right:f.left,a&&d&&r<a.index&&r<d.index&&(c=a,u=d,((s=l)[0]-u[0])*(c[1]-s[1])-(s[0]-c[0])*(u[1]-s[1])<0)&&e.push([l.data,a.data,d.data])})),e},links:function(){return this.edges.filter((function(e){return e.right})).map((function(e){return{source:e.left.data,target:e.right.data}}))},find:function(e,t,n){for(var r,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var c=e-i.site[0],u=t-i.site[1],l=c*c+u*u;do{i=o.cells[r=a],a=null,i.halfedges.forEach((function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var c=e-s[0],u=t-s[1],h=c*c+u*u;h<l&&(l=h,a=s.index)}}))}while(null!==a);return o._found=r,null==n||l<=n*n?i.site:null}};var KE=function(){var e=mE,t=gE,n=null;function r(r){return new $E(r.map((function(n,i){var o=[Math.round(e(n,i,r)/YE)*YE,Math.round(t(n,i,r)/YE)*YE];return o.index=i,o.data=n,o})),n)}return r.polygons=function(e){return r(e).polygons()},r.links=function(e){return r(e).links()},r.triangles=function(e){return r(e).triangles()},r.x=function(t){return arguments.length?(e="function"==typeof t?t:pE(+t),r):e},r.y=function(e){return arguments.length?(t="function"==typeof e?e:pE(+e),r):t},r.extent=function(e){return arguments.length?(n=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(e){return arguments.length?(n=null==e?null:[[0,0],[+e[0],+e[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r},QE=function(e){return function(){return e}};function eM(e,t,n){this.target=e,this.type=t,this.transform=n}function tM(e,t,n){this.k=e,this.x=t,this.y=n}tM.prototype={constructor:tM,scale:function(e){return 1===e?this:new tM(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new tM(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var nM=new tM(1,0,0);function rM(e){for(;!e.__zoom;)if(!(e=e.parentNode))return nM;return e.__zoom}function iM(){pt.stopImmediatePropagation()}rM.prototype=tM.prototype;var oM=function(){pt.preventDefault(),pt.stopImmediatePropagation()};function aM(){return!pt.ctrlKey&&!pt.button}function sM(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function cM(){return this.__zoom||nM}function uM(){return-pt.deltaY*(1===pt.deltaMode?.05:pt.deltaMode?1:.002)}function lM(){return navigator.maxTouchPoints||"ontouchstart"in this}function hM(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}var fM=function(){var e,t,n=aM,r=sM,i=hM,o=uM,a=lM,s=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,l=cr,h=me("start","zoom","end"),f=500,d=150,p=0;function m(e){e.property("__zoom",cM).on("wheel.zoom",w).on("mousedown.zoom",E).on("dblclick.zoom",M).filter(a).on("touchstart.zoom",S).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",A).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(e,t){return(t=Math.max(s[0],Math.min(s[1],t)))===e.k?e:new tM(t,e.x,e.y)}function v(e,t,n){var r=t[0]-n[0]*e.k,i=t[1]-n[1]*e.k;return r===e.x&&i===e.y?e:new tM(e.k,r,i)}function _(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function y(e,t,n){e.on("start.zoom",(function(){x(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).end()})).tween("zoom",(function(){var e=this,i=arguments,o=x(e,i),a=r.apply(e,i),s=null==n?_(a):"function"==typeof n?n.apply(e,i):n,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=e.__zoom,h="function"==typeof t?t.apply(e,i):t,f=l(u.invert(s).concat(c/u.k),h.invert(s).concat(c/h.k));return function(e){if(1===e)e=h;else{var t=f(e),n=c/t[2];e=new tM(n,s[0]-t[0]*n,s[1]-t[1]*n)}o.zoom(null,e)}}))}function x(e,t,n){return!n&&e.__zooming||new b(e,t)}function b(e,t){this.that=e,this.args=t,this.active=0,this.extent=r.apply(e,t),this.taps=0}function w(){if(n.apply(this,arguments)){var e=x(this,arguments),t=this.__zoom,r=Math.max(s[0],Math.min(s[1],t.k*Math.pow(2,o.apply(this,arguments)))),a=Dt(this);if(e.wheel)e.mouse[0][0]===a[0]&&e.mouse[0][1]===a[1]||(e.mouse[1]=t.invert(e.mouse[0]=a)),clearTimeout(e.wheel);else{if(t.k===r)return;e.mouse=[a,t.invert(a)],Pi(this),e.start()}oM(),e.wheel=setTimeout((function(){e.wheel=null,e.end()}),d),e.zoom("mouse",i(v(g(t,r),e.mouse[0],e.mouse[1]),e.extent,c))}}function E(){if(!t&&n.apply(this,arguments)){var e=x(this,arguments,!0),r=Lt(pt.view).on("mousemove.zoom",(function(){if(oM(),!e.moved){var t=pt.clientX-a,n=pt.clientY-s;e.moved=t*t+n*n>p}e.zoom("mouse",i(v(e.that.__zoom,e.mouse[0]=Dt(e.that),e.mouse[1]),e.extent,c))}),!0).on("mouseup.zoom",(function(){r.on("mousemove.zoom mouseup.zoom",null),Ht(pt.view,e.moved),oM(),e.end()}),!0),o=Dt(this),a=pt.clientX,s=pt.clientY;jt(pt.view),iM(),e.mouse=[o,this.__zoom.invert(o)],Pi(this),e.start()}}function M(){if(n.apply(this,arguments)){var e=this.__zoom,t=Dt(this),o=e.invert(t),a=e.k*(pt.shiftKey?.5:2),s=i(v(g(e,a),t,o),r.apply(this,arguments),c);oM(),u>0?Lt(this).transition().duration(u).call(y,s,t):Lt(this).call(m.transform,s)}}function S(){if(n.apply(this,arguments)){var t,r,i,o,a=pt.touches,s=a.length,c=x(this,arguments,pt.changedTouches.length===s);for(iM(),r=0;r<s;++r)i=a[r],o=[o=Ut(this,a,i.identifier),this.__zoom.invert(o),i.identifier],c.touch0?c.touch1||c.touch0[2]===o[2]||(c.touch1=o,c.taps=0):(c.touch0=o,t=!0,c.taps=1+!!e);e&&(e=clearTimeout(e)),t&&(c.taps<2&&(e=setTimeout((function(){e=null}),f)),Pi(this),c.start())}}function T(){if(this.__zooming){var t,n,r,o,a=x(this,arguments),s=pt.changedTouches,u=s.length;for(oM(),e&&(e=clearTimeout(e)),a.taps=0,t=0;t<u;++t)n=s[t],r=Ut(this,s,n.identifier),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=r);if(n=a.that.__zoom,a.touch1){var l=a.touch0[0],h=a.touch0[1],f=a.touch1[0],d=a.touch1[1],p=(p=f[0]-l[0])*p+(p=f[1]-l[1])*p,m=(m=d[0]-h[0])*m+(m=d[1]-h[1])*m;n=g(n,Math.sqrt(p/m)),r=[(l[0]+f[0])/2,(l[1]+f[1])/2],o=[(h[0]+d[0])/2,(h[1]+d[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],o=a.touch0[1]}a.zoom("touch",i(v(n,r,o),a.extent,c))}}function A(){if(this.__zooming){var e,n,r=x(this,arguments),i=pt.changedTouches,o=i.length;for(iM(),t&&clearTimeout(t),t=setTimeout((function(){t=null}),f),e=0;e<o;++e)n=i[e],r.touch0&&r.touch0[2]===n.identifier?delete r.touch0:r.touch1&&r.touch1[2]===n.identifier&&delete r.touch1;if(r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0)r.touch0[1]=this.__zoom.invert(r.touch0[0]);else if(r.end(),2===r.taps){var a=Lt(this).on("dblclick.zoom");a&&a.apply(this,arguments)}}}return m.transform=function(e,t,n){var r=e.selection?e.selection():e;r.property("__zoom",cM),e!==r?y(e,t,n):r.interrupt().each((function(){x(this,arguments).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()}))},m.scaleBy=function(e,t,n){m.scaleTo(e,(function(){var e=this.__zoom.k,n="function"==typeof t?t.apply(this,arguments):t;return e*n}),n)},m.scaleTo=function(e,t,n){m.transform(e,(function(){var e=r.apply(this,arguments),o=this.__zoom,a=null==n?_(e):"function"==typeof n?n.apply(this,arguments):n,s=o.invert(a),u="function"==typeof t?t.apply(this,arguments):t;return i(v(g(o,u),a,s),e,c)}),n)},m.translateBy=function(e,t,n){m.transform(e,(function(){return i(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),c)}))},m.translateTo=function(e,t,n,o){m.transform(e,(function(){var e=r.apply(this,arguments),a=this.__zoom,s=null==o?_(e):"function"==typeof o?o.apply(this,arguments):o;return i(nM.translate(s[0],s[1]).scale(a.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,c)}),o)},b.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){xt(new eM(m,e,this.that.__zoom),h.apply,h,[e,this.that,this.args])}},m.wheelDelta=function(e){return arguments.length?(o="function"==typeof e?e:QE(+e),m):o},m.filter=function(e){return arguments.length?(n="function"==typeof e?e:QE(!!e),m):n},m.touchable=function(e){return arguments.length?(a="function"==typeof e?e:QE(!!e),m):a},m.extent=function(e){return arguments.length?(r="function"==typeof e?e:QE([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),m):r},m.scaleExtent=function(e){return arguments.length?(s[0]=+e[0],s[1]=+e[1],m):[s[0],s[1]]},m.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],m):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},m.constrain=function(e){return arguments.length?(i=e,m):i},m.duration=function(e){return arguments.length?(u=+e,m):u},m.interpolate=function(e){return arguments.length?(l=e,m):l},m.on=function(){var e=h.on.apply(h,arguments);return e===h?m:e},m.clickDistance=function(e){return arguments.length?(p=(e=+e)*e,m):Math.sqrt(p)},m};n.d(t,"version",(function(){return"5.12.0"})),n.d(t,"bisect",(function(){return c})),n.d(t,"bisectRight",(function(){return a})),n.d(t,"bisectLeft",(function(){return s})),n.d(t,"ascending",(function(){return r})),n.d(t,"bisector",(function(){return i})),n.d(t,"cross",(function(){return h})),n.d(t,"descending",(function(){return f})),n.d(t,"deviation",(function(){return m})),n.d(t,"extent",(function(){return g})),n.d(t,"histogram",(function(){return R})),n.d(t,"thresholdFreedmanDiaconis",(function(){return O})),n.d(t,"thresholdScott",(function(){return N})),n.d(t,"thresholdSturges",(function(){return C})),n.d(t,"max",(function(){return I})),n.d(t,"mean",(function(){return D})),n.d(t,"median",(function(){return z})),n.d(t,"merge",(function(){return U})),n.d(t,"min",(function(){return k})),n.d(t,"pairs",(function(){return u})),n.d(t,"permute",(function(){return F})),n.d(t,"quantile",(function(){return P})),n.d(t,"range",(function(){return w})),n.d(t,"scan",(function(){return B})),n.d(t,"shuffle",(function(){return j})),n.d(t,"sum",(function(){return H})),n.d(t,"ticks",(function(){return T})),n.d(t,"tickIncrement",(function(){return A})),n.d(t,"tickStep",(function(){return L})),n.d(t,"transpose",(function(){return G})),n.d(t,"variance",(function(){return p})),n.d(t,"zip",(function(){return W})),n.d(t,"axisTop",(function(){return oe})),n.d(t,"axisRight",(function(){return ae})),n.d(t,"axisBottom",(function(){return se})),n.d(t,"axisLeft",(function(){return ce})),n.d(t,"brush",(function(){return wa})),n.d(t,"brushX",(function(){return xa})),n.d(t,"brushY",(function(){return ba})),n.d(t,"brushSelection",(function(){return ya})),n.d(t,"chord",(function(){return Pa})),n.d(t,"ribbon",(function(){return Wa})),n.d(t,"nest",(function(){return Za})),n.d(t,"set",(function(){return rs})),n.d(t,"map",(function(){return Ya})),n.d(t,"keys",(function(){return is})),n.d(t,"values",(function(){return os})),n.d(t,"entries",(function(){return as})),n.d(t,"color",(function(){return dn})),n.d(t,"rgb",(function(){return vn})),n.d(t,"hsl",(function(){return Mn})),n.d(t,"lab",(function(){return Er})),n.d(t,"hcl",(function(){return Pr})),n.d(t,"lch",(function(){return Rr})),n.d(t,"gray",(function(){return wr})),n.d(t,"cubehelix",(function(){return Vr})),n.d(t,"contours",(function(){return gs})),n.d(t,"contourDensity",(function(){return ws})),n.d(t,"dispatch",(function(){return me})),n.d(t,"drag",(function(){return Zt})),n.d(t,"dragDisable",(function(){return jt})),n.d(t,"dragEnable",(function(){return Ht})),n.d(t,"dsvFormat",(function(){return Os})),n.d(t,"csvParse",(function(){return Is})),n.d(t,"csvParseRows",(function(){return Ds})),n.d(t,"csvFormat",(function(){return zs})),n.d(t,"csvFormatBody",(function(){return Us})),n.d(t,"csvFormatRows",(function(){return ks})),n.d(t,"tsvParse",(function(){return Bs})),n.d(t,"tsvParseRows",(function(){return js})),n.d(t,"tsvFormat",(function(){return Hs})),n.d(t,"tsvFormatBody",(function(){return Gs})),n.d(t,"tsvFormatRows",(function(){return Vs})),n.d(t,"autoType",(function(){return Ws})),n.d(t,"easeLinear",(function(){return io})),n.d(t,"easeQuad",(function(){return so})),n.d(t,"easeQuadIn",(function(){return oo})),n.d(t,"easeQuadOut",(function(){return ao})),n.d(t,"easeQuadInOut",(function(){return so})),n.d(t,"easeCubic",(function(){return lo})),n.d(t,"easeCubicIn",(function(){return co})),n.d(t,"easeCubicOut",(function(){return uo})),n.d(t,"easeCubicInOut",(function(){return lo})),n.d(t,"easePoly",(function(){return po})),n.d(t,"easePolyIn",(function(){return ho})),n.d(t,"easePolyOut",(function(){return fo})),n.d(t,"easePolyInOut",(function(){return po})),n.d(t,"easeSin",(function(){return yo})),n.d(t,"easeSinIn",(function(){return vo})),n.d(t,"easeSinOut",(function(){return _o})),n.d(t,"easeSinInOut",(function(){return yo})),n.d(t,"easeExp",(function(){return wo})),n.d(t,"easeExpIn",(function(){return xo})),n.d(t,"easeExpOut",(function(){return bo})),n.d(t,"easeExpInOut",(function(){return wo})),n.d(t,"easeCircle",(function(){return So})),n.d(t,"easeCircleIn",(function(){return Eo})),n.d(t,"easeCircleOut",(function(){return Mo})),n.d(t,"easeCircleInOut",(function(){return So})),n.d(t,"easeBounce",(function(){return Uo})),n.d(t,"easeBounceIn",(function(){return zo})),n.d(t,"easeBounceOut",(function(){return Uo})),n.d(t,"easeBounceInOut",(function(){return ko})),n.d(t,"easeBack",(function(){return jo})),n.d(t,"easeBackIn",(function(){return Fo})),n.d(t,"easeBackOut",(function(){return Bo})),n.d(t,"easeBackInOut",(function(){return jo})),n.d(t,"easeElastic",(function(){return Vo})),n.d(t,"easeElasticIn",(function(){return Go})),n.d(t,"easeElasticOut",(function(){return Vo})),n.d(t,"easeElasticInOut",(function(){return Wo})),n.d(t,"blob",(function(){return Xs})),n.d(t,"buffer",(function(){return Zs})),n.d(t,"dsv",(function(){return Qs})),n.d(t,"csv",(function(){return ec})),n.d(t,"tsv",(function(){return tc})),n.d(t,"image",(function(){return nc})),n.d(t,"json",(function(){return ic})),n.d(t,"text",(function(){return $s})),n.d(t,"xml",(function(){return ac})),n.d(t,"html",(function(){return sc})),n.d(t,"svg",(function(){return cc})),n.d(t,"forceCenter",(function(){return uc})),n.d(t,"forceCollide",(function(){return wc})),n.d(t,"forceLink",(function(){return Sc})),n.d(t,"forceManyBody",(function(){return Pc})),n.d(t,"forceRadial",(function(){return Oc})),n.d(t,"forceSimulation",(function(){return Rc})),n.d(t,"forceX",(function(){return Nc})),n.d(t,"forceY",(function(){return Ic})),n.d(t,"formatDefaultLocale",(function(){return $c})),n.d(t,"format",(function(){return Hc})),n.d(t,"formatPrefix",(function(){return Gc})),n.d(t,"formatLocale",(function(){return Jc})),n.d(t,"formatSpecifier",(function(){return kc})),n.d(t,"FormatSpecifier",(function(){return Fc})),n.d(t,"precisionFixed",(function(){return Kc})),n.d(t,"precisionPrefix",(function(){return Qc})),n.d(t,"precisionRound",(function(){return eu})),n.d(t,"geoArea",(function(){return Xu})),n.d(t,"geoBounds",(function(){return Fl})),n.d(t,"geoCentroid",(function(){return $l})),n.d(t,"geoCircle",(function(){return ch})),n.d(t,"geoClipAntimeridian",(function(){return xh})),n.d(t,"geoClipCircle",(function(){return bh})),n.d(t,"geoClipExtent",(function(){return Ch})),n.d(t,"geoClipRectangle",(function(){return Sh})),n.d(t,"geoContains",(function(){return Xh})),n.d(t,"geoDistance",(function(){return kh})),n.d(t,"geoGraticule",(function(){return Jh})),n.d(t,"geoGraticule10",(function(){return $h})),n.d(t,"geoInterpolate",(function(){return nf})),n.d(t,"geoLength",(function(){return Dh})),n.d(t,"geoPath",(function(){return td})),n.d(t,"geoAlbers",(function(){return bd})),n.d(t,"geoAlbersUsa",(function(){return wd})),n.d(t,"geoAzimuthalEqualArea",(function(){return Td})),n.d(t,"geoAzimuthalEqualAreaRaw",(function(){return Sd})),n.d(t,"geoAzimuthalEquidistant",(function(){return Ld})),n.d(t,"geoAzimuthalEquidistantRaw",(function(){return Ad})),n.d(t,"geoConicConformal",(function(){return Id})),n.d(t,"geoConicConformalRaw",(function(){return Nd})),n.d(t,"geoConicEqualArea",(function(){return xd})),n.d(t,"geoConicEqualAreaRaw",(function(){return yd})),n.d(t,"geoConicEquidistant",(function(){return kd})),n.d(t,"geoConicEquidistantRaw",(function(){return Ud})),n.d(t,"geoEqualEarth",(function(){return Wd})),n.d(t,"geoEqualEarthRaw",(function(){return Vd})),n.d(t,"geoEquirectangular",(function(){return zd})),n.d(t,"geoEquirectangularRaw",(function(){return Dd})),n.d(t,"geoGnomonic",(function(){return Xd})),n.d(t,"geoGnomonicRaw",(function(){return qd})),n.d(t,"geoIdentity",(function(){return Zd})),n.d(t,"geoProjection",(function(){return gd})),n.d(t,"geoProjectionMutator",(function(){return vd})),n.d(t,"geoMercator",(function(){return Rd})),n.d(t,"geoMercatorRaw",(function(){return Cd})),n.d(t,"geoNaturalEarth1",(function(){return $d})),n.d(t,"geoNaturalEarth1Raw",(function(){return Jd})),n.d(t,"geoOrthographic",(function(){return Qd})),n.d(t,"geoOrthographicRaw",(function(){return Kd})),n.d(t,"geoStereographic",(function(){return tp})),n.d(t,"geoStereographicRaw",(function(){return ep})),n.d(t,"geoTransverseMercator",(function(){return rp})),n.d(t,"geoTransverseMercatorRaw",(function(){return np})),n.d(t,"geoRotation",(function(){return oh})),n.d(t,"geoStream",(function(){return Fu})),n.d(t,"geoTransform",(function(){return nd})),n.d(t,"cluster",(function(){return sp})),n.d(t,"hierarchy",(function(){return up})),n.d(t,"pack",(function(){return Ip})),n.d(t,"packSiblings",(function(){return Lp})),n.d(t,"packEnclose",(function(){return mp})),n.d(t,"partition",(function(){return Bp})),n.d(t,"stratify",(function(){return qp})),n.d(t,"tree",(function(){return Qp})),n.d(t,"treemap",(function(){return im})),n.d(t,"treemapBinary",(function(){return om})),n.d(t,"treemapDice",(function(){return Fp})),n.d(t,"treemapSlice",(function(){return em})),n.d(t,"treemapSliceDice",(function(){return am})),n.d(t,"treemapSquarify",(function(){return rm})),n.d(t,"treemapResquarify",(function(){return sm})),n.d(t,"interpolate",(function(){return Jn})),n.d(t,"interpolateArray",(function(){return Fn})),n.d(t,"interpolateBasis",(function(){return Ln})),n.d(t,"interpolateBasisClosed",(function(){return Cn})),n.d(t,"interpolateDate",(function(){return Bn})),n.d(t,"interpolateDiscrete",(function(){return $n})),n.d(t,"interpolateHue",(function(){return Kn})),n.d(t,"interpolateNumber",(function(){return jn})),n.d(t,"interpolateObject",(function(){return Hn})),n.d(t,"interpolateRound",(function(){return Qn})),n.d(t,"interpolateString",(function(){return Zn})),n.d(t,"interpolateTransformCss",(function(){return ir})),n.d(t,"interpolateTransformSvg",(function(){return or})),n.d(t,"interpolateZoom",(function(){return cr})),n.d(t,"interpolateRgb",(function(){return Dn})),n.d(t,"interpolateRgbBasis",(function(){return Un})),n.d(t,"interpolateRgbBasisClosed",(function(){return kn})),n.d(t,"interpolateHsl",(function(){return lr})),n.d(t,"interpolateHslLong",(function(){return hr})),n.d(t,"interpolateLab",(function(){return Ir})),n.d(t,"interpolateHcl",(function(){return zr})),n.d(t,"interpolateHclLong",(function(){return Ur})),n.d(t,"interpolateCubehelix",(function(){return Xr})),n.d(t,"interpolateCubehelixLong",(function(){return Yr})),n.d(t,"piecewise",(function(){return Zr})),n.d(t,"quantize",(function(){return Kr})),n.d(t,"path",(function(){return Fa})),n.d(t,"polygonArea",(function(){return cm})),n.d(t,"polygonCentroid",(function(){return um})),n.d(t,"polygonHull",(function(){return dm})),n.d(t,"polygonContains",(function(){return pm})),n.d(t,"polygonLength",(function(){return mm})),n.d(t,"quadtree",(function(){return gc})),n.d(t,"randomUniform",(function(){return vm})),n.d(t,"randomNormal",(function(){return _m})),n.d(t,"randomLogNormal",(function(){return ym})),n.d(t,"randomBates",(function(){return bm})),n.d(t,"randomIrwinHall",(function(){return xm})),n.d(t,"randomExponential",(function(){return wm})),n.d(t,"scaleBand",(function(){return Rm})),n.d(t,"scalePoint",(function(){return Pm})),n.d(t,"scaleIdentity",(function(){return qm})),n.d(t,"scaleLinear",(function(){return Wm})),n.d(t,"scaleLog",(function(){return tg})),n.d(t,"scaleSymlog",(function(){return og})),n.d(t,"scaleOrdinal",(function(){return Cm})),n.d(t,"scaleImplicit",(function(){return Lm})),n.d(t,"scalePow",(function(){return lg})),n.d(t,"scaleSqrt",(function(){return hg})),n.d(t,"scaleQuantile",(function(){return fg})),n.d(t,"scaleQuantize",(function(){return dg})),n.d(t,"scaleThreshold",(function(){return pg})),n.d(t,"scaleTime",(function(){return ey})),n.d(t,"scaleUtc",(function(){return ly})),n.d(t,"scaleSequential",(function(){return dy})),n.d(t,"scaleSequentialLog",(function(){return py})),n.d(t,"scaleSequentialPow",(function(){return gy})),n.d(t,"scaleSequentialSqrt",(function(){return vy})),n.d(t,"scaleSequentialSymlog",(function(){return my})),n.d(t,"scaleSequentialQuantile",(function(){return _y})),n.d(t,"scaleDiverging",(function(){return xy})),n.d(t,"scaleDivergingLog",(function(){return by})),n.d(t,"scaleDivergingPow",(function(){return Ey})),n.d(t,"scaleDivergingSqrt",(function(){return My})),n.d(t,"scaleDivergingSymlog",(function(){return wy})),n.d(t,"tickFormat",(function(){return Gm})),n.d(t,"schemeCategory10",(function(){return Ty})),n.d(t,"schemeAccent",(function(){return Ay})),n.d(t,"schemeDark2",(function(){return Ly})),n.d(t,"schemePaired",(function(){return Cy})),n.d(t,"schemePastel1",(function(){return Ry})),n.d(t,"schemePastel2",(function(){return Py})),n.d(t,"schemeSet1",(function(){return Oy})),n.d(t,"schemeSet2",(function(){return Ny})),n.d(t,"schemeSet3",(function(){return Iy})),n.d(t,"schemeTableau10",(function(){return Dy})),n.d(t,"interpolateBrBG",(function(){return ky})),n.d(t,"schemeBrBG",(function(){return Uy})),n.d(t,"interpolatePRGn",(function(){return By})),n.d(t,"schemePRGn",(function(){return Fy})),n.d(t,"interpolatePiYG",(function(){return Hy})),n.d(t,"schemePiYG",(function(){return jy})),n.d(t,"interpolatePuOr",(function(){return Vy})),n.d(t,"schemePuOr",(function(){return Gy})),n.d(t,"interpolateRdBu",(function(){return qy})),n.d(t,"schemeRdBu",(function(){return Wy})),n.d(t,"interpolateRdGy",(function(){return Yy})),n.d(t,"schemeRdGy",(function(){return Xy})),n.d(t,"interpolateRdYlBu",(function(){return Jy})),n.d(t,"schemeRdYlBu",(function(){return Zy})),n.d(t,"interpolateRdYlGn",(function(){return Ky})),n.d(t,"schemeRdYlGn",(function(){return $y})),n.d(t,"interpolateSpectral",(function(){return ex})),n.d(t,"schemeSpectral",(function(){return Qy})),n.d(t,"interpolateBuGn",(function(){return nx})),n.d(t,"schemeBuGn",(function(){return tx})),n.d(t,"interpolateBuPu",(function(){return ix})),n.d(t,"schemeBuPu",(function(){return rx})),n.d(t,"interpolateGnBu",(function(){return ax})),n.d(t,"schemeGnBu",(function(){return ox})),n.d(t,"interpolateOrRd",(function(){return cx})),n.d(t,"schemeOrRd",(function(){return sx})),n.d(t,"interpolatePuBuGn",(function(){return lx})),n.d(t,"schemePuBuGn",(function(){return ux})),n.d(t,"interpolatePuBu",(function(){return fx})),n.d(t,"schemePuBu",(function(){return hx})),n.d(t,"interpolatePuRd",(function(){return px})),n.d(t,"schemePuRd",(function(){return dx})),n.d(t,"interpolateRdPu",(function(){return gx})),n.d(t,"schemeRdPu",(function(){return mx})),n.d(t,"interpolateYlGnBu",(function(){return _x})),n.d(t,"schemeYlGnBu",(function(){return vx})),n.d(t,"interpolateYlGn",(function(){return xx})),n.d(t,"schemeYlGn",(function(){return yx})),n.d(t,"interpolateYlOrBr",(function(){return wx})),n.d(t,"schemeYlOrBr",(function(){return bx})),n.d(t,"interpolateYlOrRd",(function(){return Mx})),n.d(t,"schemeYlOrRd",(function(){return Ex})),n.d(t,"interpolateBlues",(function(){return Tx})),n.d(t,"schemeBlues",(function(){return Sx})),n.d(t,"interpolateGreens",(function(){return Lx})),n.d(t,"schemeGreens",(function(){return Ax})),n.d(t,"interpolateGreys",(function(){return Rx})),n.d(t,"schemeGreys",(function(){return Cx})),n.d(t,"interpolatePurples",(function(){return Ox})),n.d(t,"schemePurples",(function(){return Px})),n.d(t,"interpolateReds",(function(){return Ix})),n.d(t,"schemeReds",(function(){return Nx})),n.d(t,"interpolateOranges",(function(){return zx})),n.d(t,"schemeOranges",(function(){return Dx})),n.d(t,"interpolateCividis",(function(){return Ux})),n.d(t,"interpolateCubehelixDefault",(function(){return kx})),n.d(t,"interpolateRainbow",(function(){return Hx})),n.d(t,"interpolateWarm",(function(){return Fx})),n.d(t,"interpolateCool",(function(){return Bx})),n.d(t,"interpolateSinebow",(function(){return qx})),n.d(t,"interpolateTurbo",(function(){return Xx})),n.d(t,"interpolateViridis",(function(){return Zx})),n.d(t,"interpolateMagma",(function(){return Jx})),n.d(t,"interpolateInferno",(function(){return $x})),n.d(t,"interpolatePlasma",(function(){return Kx})),n.d(t,"create",(function(){return Ct})),n.d(t,"creator",(function(){return be})),n.d(t,"local",(function(){return Pt})),n.d(t,"matcher",(function(){return Te})),n.d(t,"mouse",(function(){return Dt})),n.d(t,"namespace",(function(){return _e})),n.d(t,"namespaces",(function(){return ve})),n.d(t,"clientPoint",(function(){return It})),n.d(t,"select",(function(){return Lt})),n.d(t,"selectAll",(function(){return zt})),n.d(t,"selection",(function(){return At})),n.d(t,"selector",(function(){return Ee})),n.d(t,"selectorAll",(function(){return Se})),n.d(t,"style",(function(){return Ge})),n.d(t,"touch",(function(){return Ut})),n.d(t,"touches",(function(){return kt})),n.d(t,"window",(function(){return Fe})),n.d(t,"event",(function(){return pt})),n.d(t,"customEvent",(function(){return xt})),n.d(t,"arc",(function(){return _b})),n.d(t,"area",(function(){return Mb})),n.d(t,"line",(function(){return Eb})),n.d(t,"pie",(function(){return Ab})),n.d(t,"areaRadial",(function(){return Nb})),n.d(t,"radialArea",(function(){return Nb})),n.d(t,"lineRadial",(function(){return Ob})),n.d(t,"radialLine",(function(){return Ob})),n.d(t,"pointRadial",(function(){return Ib})),n.d(t,"linkHorizontal",(function(){return Hb})),n.d(t,"linkVertical",(function(){return Gb})),n.d(t,"linkRadial",(function(){return Vb})),n.d(t,"symbol",(function(){return cw})),n.d(t,"symbols",(function(){return sw})),n.d(t,"symbolCircle",(function(){return Wb})),n.d(t,"symbolCross",(function(){return qb})),n.d(t,"symbolDiamond",(function(){return Zb})),n.d(t,"symbolSquare",(function(){return ew})),n.d(t,"symbolStar",(function(){return Qb})),n.d(t,"symbolTriangle",(function(){return nw})),n.d(t,"symbolWye",(function(){return aw})),n.d(t,"curveBasisClosed",(function(){return pw})),n.d(t,"curveBasisOpen",(function(){return gw})),n.d(t,"curveBasis",(function(){return fw})),n.d(t,"curveBundle",(function(){return _w})),n.d(t,"curveCardinalClosed",(function(){return Ew})),n.d(t,"curveCardinalOpen",(function(){return Sw})),n.d(t,"curveCardinal",(function(){return bw})),n.d(t,"curveCatmullRomClosed",(function(){return Rw})),n.d(t,"curveCatmullRomOpen",(function(){return Ow})),n.d(t,"curveCatmullRom",(function(){return Lw})),n.d(t,"curveLinearClosed",(function(){return Iw})),n.d(t,"curveLinear",(function(){return xb})),n.d(t,"curveMonotoneX",(function(){return Hw})),n.d(t,"curveMonotoneY",(function(){return Gw})),n.d(t,"curveNatural",(function(){return qw})),n.d(t,"curveStep",(function(){return Yw})),n.d(t,"curveStepAfter",(function(){return Jw})),n.d(t,"curveStepBefore",(function(){return Zw})),n.d(t,"stack",(function(){return eE})),n.d(t,"stackOffsetExpand",(function(){return tE})),n.d(t,"stackOffsetDiverging",(function(){return nE})),n.d(t,"stackOffsetNone",(function(){return $w})),n.d(t,"stackOffsetSilhouette",(function(){return rE})),n.d(t,"stackOffsetWiggle",(function(){return iE})),n.d(t,"stackOrderAppearance",(function(){return oE})),n.d(t,"stackOrderAscending",(function(){return sE})),n.d(t,"stackOrderDescending",(function(){return uE})),n.d(t,"stackOrderInsideOut",(function(){return lE})),n.d(t,"stackOrderNone",(function(){return Kw})),n.d(t,"stackOrderReverse",(function(){return hE})),n.d(t,"timeInterval",(function(){return vg})),n.d(t,"timeMillisecond",(function(){return ev})),n.d(t,"timeMilliseconds",(function(){return tv})),n.d(t,"utcMillisecond",(function(){return ev})),n.d(t,"utcMilliseconds",(function(){return tv})),n.d(t,"timeSecond",(function(){return $g})),n.d(t,"timeSeconds",(function(){return Kg})),n.d(t,"utcSecond",(function(){return $g})),n.d(t,"utcSeconds",(function(){return Kg})),n.d(t,"timeMinute",(function(){return Yg})),n.d(t,"timeMinutes",(function(){return Zg})),n.d(t,"timeHour",(function(){return Wg})),n.d(t,"timeHours",(function(){return qg})),n.d(t,"timeDay",(function(){return Hg})),n.d(t,"timeDays",(function(){return Gg})),n.d(t,"timeWeek",(function(){return Ag})),n.d(t,"timeWeeks",(function(){return Ig})),n.d(t,"timeSunday",(function(){return Ag})),n.d(t,"timeSundays",(function(){return Ig})),n.d(t,"timeMonday",(function(){return Lg})),n.d(t,"timeMondays",(function(){return Dg})),n.d(t,"timeTuesday",(function(){return Cg})),n.d(t,"timeTuesdays",(function(){return zg})),n.d(t,"timeWednesday",(function(){return Rg})),n.d(t,"timeWednesdays",(function(){return Ug})),n.d(t,"timeThursday",(function(){return Pg})),n.d(t,"timeThursdays",(function(){return kg})),n.d(t,"timeFriday",(function(){return Og})),n.d(t,"timeFridays",(function(){return Fg})),n.d(t,"timeSaturday",(function(){return Ng})),n.d(t,"timeSaturdays",(function(){return Bg})),n.d(t,"timeMonth",(function(){return wg})),n.d(t,"timeMonths",(function(){return Eg})),n.d(t,"timeYear",(function(){return yg})),n.d(t,"timeYears",(function(){return xg})),n.d(t,"utcMinute",(function(){return cy})),n.d(t,"utcMinutes",(function(){return uy})),n.d(t,"utcHour",(function(){return oy})),n.d(t,"utcHours",(function(){return ay})),n.d(t,"utcDay",(function(){return _v})),n.d(t,"utcDays",(function(){return yv})),n.d(t,"utcWeek",(function(){return rv})),n.d(t,"utcWeeks",(function(){return lv})),n.d(t,"utcSunday",(function(){return rv})),n.d(t,"utcSundays",(function(){return lv})),n.d(t,"utcMonday",(function(){return iv})),n.d(t,"utcMondays",(function(){return hv})),n.d(t,"utcTuesday",(function(){return ov})),n.d(t,"utcTuesdays",(function(){return fv})),n.d(t,"utcWednesday",(function(){return av})),n.d(t,"utcWednesdays",(function(){return dv})),n.d(t,"utcThursday",(function(){return sv})),n.d(t,"utcThursdays",(function(){return pv})),n.d(t,"utcFriday",(function(){return cv})),n.d(t,"utcFridays",(function(){return mv})),n.d(t,"utcSaturday",(function(){return uv})),n.d(t,"utcSaturdays",(function(){return gv})),n.d(t,"utcMonth",(function(){return ny})),n.d(t,"utcMonths",(function(){return ry})),n.d(t,"utcYear",(function(){return bv})),n.d(t,"utcYears",(function(){return wv})),n.d(t,"timeFormatDefaultLocale",(function(){return G_})),n.d(t,"timeFormat",(function(){return Lv})),n.d(t,"timeParse",(function(){return Cv})),n.d(t,"utcFormat",(function(){return Rv})),n.d(t,"utcParse",(function(){return Pv})),n.d(t,"timeFormatLocale",(function(){return Tv})),n.d(t,"isoFormat",(function(){return fE})),n.d(t,"isoParse",(function(){return dE})),n.d(t,"now",(function(){return ci})),n.d(t,"timer",(function(){return hi})),n.d(t,"timerFlush",(function(){return fi})),n.d(t,"timeout",(function(){return gi})),n.d(t,"interval",(function(){return vi})),n.d(t,"transition",(function(){return to})),n.d(t,"active",(function(){return Zo})),n.d(t,"interrupt",(function(){return Pi})),n.d(t,"voronoi",(function(){return KE})),n.d(t,"zoom",(function(){return fM})),n.d(t,"zoomTransform",(function(){return rM})),n.d(t,"zoomIdentity",(function(){return nM}))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(22)),r(n(65)),r(n(15)),r(n(16)),r(n(9)),r(n(1)),r(n(19)),r(n(7));var i=n(1);t.version=i.semver_range},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(2)),o=r(n(20)),a=r(n(23)),s=r(n(24)),c=r(n(0)),u=r(n(25)),l=n(9),h=n(15),f=n(1),d=n(1),p=n(16),m=n(3),g=n(19),v=n(46);n(47);const _=n(52);window.THREE=c;const y=n(4);n(53),n(54),n(55),n(56),n(57),n(58);const x={"screen-fragment":n(59).default,"screen-vertex":n(60).default,"volr-fragment":n(61).default,"volr-vertex":n(62).default,"shadow-fragment":n(63).default,"shadow-vertex":n(64).default,"box-fragment":n(17).default,"box-vertex":n(18).default};function b(e,t){return function(){const n=[this].concat([].slice.call(arguments));e.apply(t,n)}}class w{constructor(e,t){this.a=document.createElement("a"),this.a.className="ipyvolume-toolicon",this.a.setAttribute("href","javascript:void(0)"),this.li=document.createElement("li"),this.li.className="fa "+e,this.sub=document.createElement("div"),this.sub.className="ipyvolume-toolicon-dropdown-container",this.a.appendChild(this.li),this.a.appendChild(this.sub),t.appendChild(this.a)}active(e){e?this.li.classList.remove("fa-inactive"):this.li.classList.add("fa-inactive")}}class E{constructor(e,t,n){this.a=document.createElement("a"),this.a.className="ipyvolume-toolicon-dropdown",this.a.setAttribute("href","javascript:void(0)"),this.li=document.createElement("li"),this.li.className="fa "+e,this.span_text=document.createElement("span"),this.span_text.innerText=n,this.a.appendChild(this.li),this.li.appendChild(this.span_text),t.appendChild(this.a)}active(e){e?this.a.classList.remove("ipyvolume-toolicon-inactive"):this.a.classList.add("ipyvolume-toolicon-inactive")}}class M extends i.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"FigureModel",_view_name:"FigureView",_model_module:"ipyvolume",_view_module:"ipyvolume",_model_module_version:d.semver_range,_view_module_version:d.semver_range,eye_separation:6.4,stereo:!1,camera_control:"trackball",camera_fov:45,camera_center:[0,0,0],ambient_coefficient:.5,diffuse_coefficient:.8,specular_coefficient:.5,specular_exponent:5,width:500,height:400,pixel_ratio:null,displayscale:1,scatters:null,meshes:null,lights:[],volumes:null,show:"render",scales:{},xlabel:"x",ylabel:"y",zlabel:"z",animation:1e3,animation_exponent:1,style:_.light,render_continuous:!1,selector:"lasso",selection_mode:"replace",mouse_mode:"normal",panorama_mode:"no",capture_fps:null,cube_resolution:512,box_center:[.5,.5,.5],box_size:[1,1,1],popup_debouce:100,slice_x:0,slice_y:0,slice_z:0,_shaders:{}})}}t.FigureModel=M,M.serializers=Object.assign(Object.assign({},i.DOMWidgetModel.serializers),{scatters:{deserialize:i.unpack_models},meshes:{deserialize:i.unpack_models},lights:{deserialize:i.unpack_models},volumes:{deserialize:i.unpack_models},camera:{deserialize:i.unpack_models},scene:{deserialize:i.unpack_models},controls:{deserialize:i.unpack_models},scales:{deserialize:i.unpack_models}});class S extends i.DOMWidgetView{constructor(){super(...arguments),this.control_external=null,this.rootObject=null}readPixel(e,t){return this.readPixelFrom(this.screen_texture,e,t)}readId(e,t){const[n,r,i,o]=this.readPixelFrom(this.id_pass_target,e,t);return n+256*r+256*i*256}readPixelFrom(e,t,n){const r=new Uint8Array(4),i=this.renderer.domElement.clientHeight,o=this.model.get("pixel_ratio")||window.devicePixelRatio;return this.renderer.readRenderTargetPixels(e,t*o,(i-n)*o,1,1,r),r}render(){this.transitions=[],this._update_requested=!1,this.update_counter=0;const e=this.model.get("width"),t=this.model.get("height");this.toolbar_div=document.createElement("div"),this.el.appendChild(this.toolbar_div);const n=this._special_keys_down.bind(this),r=this._special_keys_up.bind(this);document.addEventListener("keydown",n),document.addEventListener("keyup",r),this.once("remove",()=>{document.removeEventListener("keydown",n),document.removeEventListener("keyup",r)}),this.fullscreen_icon=new w("fa-arrows-alt",this.toolbar_div),this.fullscreen_icon.a.title="Fullscreen",this.fullscreen_icon.a.onclick=()=>{const e=this.renderer.domElement,t=e.style.width,n=e.style.height,r=()=>{s.isFullscreen?(e.style.width="100vw",e.style.height="100vh"):(e.style.width=t,e.style.height=n,s.off("change",r)),this.update_size()};s.onchange(r),s.request(e)},this.stereo_icon=new w("fa-eye",this.toolbar_div),this.stereo_icon.a.title="Stereoscopic view",this.stereo_icon.a.onclick=()=>{this.model.set("stereo",!this.model.get("stereo")),this.model.save_changes()},this.stereo_icon.active(this.model.get("stereo")),this.model.on("change:stereo",()=>{this.stereo_icon.active(this.model.get("stereo"))}),this.screenshot_icon=new w("fa-picture-o",this.toolbar_div),this.screenshot_icon.a.title="Take a screenshot (hold shift to copy to clipboard)",this.screenshot_icon.a.onclick=e=>{try{const t=this.screenshot();e.shiftKey?f.copy_image_to_clipboard(t):f.download_image(t)}finally{e.preventDefault()}return!1},window.ipvss=()=>{return this.screenshot()},this.camera_control_icon=new w("fa-arrow-up",this.toolbar_div),this.camera_control_icon.a.title="Camera locked to 'up' axis (orbit), instead of trackball mode",this.camera_control_icon.a.onclick=()=>{"trackball"===this.model.get("camera_control")?(this.model.set("camera_control","orbit"),this.camera_control_icon.active(!0)):(this.model.set("camera_control","trackball"),this.camera_control_icon.active(!1)),this.touch()},this.camera_control_icon.active(!1),this.select_icon=new w("fa-pencil-square-o",this.toolbar_div),this.select_icon.a.title="Select mode (auto when control key is pressed)",this.select_icon.a.onclick=()=>{"select"===this.model.get("mouse_mode")?this.model.set("mouse_mode","normal"):this.model.set("mouse_mode","select"),this.update_icons(),this.touch()},this.select_icon.active(!1),this.select_icon_lasso=new E("fa-vine",this.select_icon.sub,"Lasso selector"),this.select_icon_circle=new E("fa-circle",this.select_icon.sub,"Circle selector"),this.select_icon_rectangle=new E("fa-square",this.select_icon.sub,"Rectangle selector"),this.select_icon_lasso.a.onclick=e=>{e.stopPropagation(),this.model.set("mouse_mode","select"),this.model.set("selector","lasso"),this.touch()},this.select_icon_circle.a.onclick=e=>{e.stopPropagation(),this.model.set("mouse_mode","select"),this.model.set("selector","circle"),this.touch()},this.select_icon_rectangle.a.onclick=e=>{e.stopPropagation(),this.model.set("mouse_mode","select"),this.model.set("selector","rectangle"),this.touch()},this.zoom_icon=new w("fa-search-plus",this.toolbar_div),this.zoom_icon.a.title="Zoom mode (auto when control key is pressed, use scrolling)",this.zoom_icon.a.onclick=()=>{"zoom"===this.model.get("mouse_mode")?this.model.set("mouse_mode","normal"):this.model.set("mouse_mode","zoom"),this.touch()},this.slice_icon=new w("fa-cut",this.toolbar_div),this.slice_icon.a.title="Set slice coordinate by hovering or clicking the edges of the bounding box",this.slice_icon.a.onclick=()=>{"slice"===this.model.get("mouse_mode")?this.model.set("mouse_mode","normal"):this.model.set("mouse_mode","slice"),this.touch()},this.quick_mouse_mode_change=!1,this.quick_mouse_previous_mode=this.model.get("mouse_mode"),this.update_icons(),this.model.on("change:mouse_mode change:selector",this.update_icons,this),this.model.on("change:mouse_mode change:selector",this.update_mouse_mode,this),this.reset_icon=new w("fa-home",this.toolbar_div),this.reset_icon.a.title="Reset view";this.model.get("camera_fov");this.reset_icon.a.onclick=()=>{this.camera.copy(this.camera_initial),this.camera.ipymodel&&this.camera.ipymodel.syncToModel(!0)},this.setting_icon=new w("fa-cog",this.toolbar_div),this.setting_icon_180=new E("fa-circle",this.setting_icon.sub,"180 degrees"),this.setting_icon_360=new E("fa-circle",this.setting_icon.sub,"360 degrees");const i=(e,t,n)=>{new E("fa-cogs",this.setting_icon.sub,e+" ("+t+"x"+n+")").a.onclick=e=>{this.model.set("width",t),this.model.set("height",n),this.touch()}};i("default",this.model.get("width"),this.model.get("height")),i("small",500,400),i("medium",640,480),i("large",800,600),i("HD 720",1280,720),i("HD",1920,1080),i("2k",2048,1080),i("2k x 2k",2048,2048),i("4k UHD ",3840,2160),i("4k",4096,2160),i("4k x 4k",4096,4096);const o=e=>{new E("fa-compress",this.setting_icon.sub,"Scale canvas (down) by "+e).a.onclick=t=>{this.model.set("displayscale",1/e),this.touch()}};o(1),o(2),o(4),o(8),this.setting_icon_180.a.onclick=e=>{e.stopPropagation(),"180"===this.model.get("panorama_mode")?this.model.set("panorama_mode","no"):this.model.set("panorama_mode","180"),this.touch()},this.setting_icon_360.a.onclick=e=>{e.stopPropagation(),"360"===this.model.get("panorama_mode")?this.model.set("panorama_mode","no"):this.model.set("panorama_mode","360"),this.touch()},this.setting_icon_360.active("360"===this.model.get("panorama_mode")),this.setting_icon_180.active("180"===this.model.get("panorama_mode")),this.model.on("change:panorama_mode",()=>{this.setting_icon_360.active("360"===this.model.get("panorama_mode")),this.setting_icon_180.active("180"===this.model.get("panorama_mode")),this.update_panorama()}),this.el.classList.add("jupyter-widgets"),this.canvas_container=document.createElement("div"),this.canvas_overlay_container=document.createElement("div"),this.canvas_overlay=document.createElement("canvas"),this.canvas_overlay_container.appendChild(this.canvas_overlay),this.canvas_container.appendChild(this.canvas_overlay_container),this.renderer=new c.WebGLRenderer({alpha:!0,antialias:!0});this.renderer.setPixelRatio(this.model.get("pixel_ratio")||window.devicePixelRatio),this.listenTo(this.model,"change:pixel_ratio",()=>{this.renderer.setPixelRatio(this.model.get("pixel_ratio")||window.devicePixelRatio),this._update_size()}),this.canvas_renderer_container=document.createElement("div"),this.canvas_renderer_container.appendChild(this.renderer.domElement),this.popup_container=document.createElement("div"),this.popup_container.classList.add("ipyvolume-popup-container"),this.canvas_container.appendChild(this.canvas_renderer_container),this.canvas_container.appendChild(this.canvas_overlay_container),this.canvas_container.appendChild(this.popup_container),this.canvas_overlay_container.style.position="absolute",this.canvas_overlay_container.style.zIndex="2",this.canvas_overlay_container.style.pointerEvents="none",this.canvas_renderer_container.style.position="absolute",this.canvas_renderer_container.style.zIndex="1",this.canvas_container.classList.add("ipyvolume-canvas-container"),this.el.appendChild(this.canvas_container),this.el.setAttribute("tabindex","1"),this.el_mirror=document.createElement("div"),this.el.appendChild(this.el_mirror),this.el_axes=document.createElement("div"),this.el_mirror.appendChild(this.el_axes),this.renderer.domElement.addEventListener("wheel",this.mousewheel.bind(this),!1);if(this.model.get("camera"))this.camera=this.model.get("camera").obj,this.model.get("camera").on("change",()=>{if(!this.control_external){const e=new c.Vector3(0,1,0);e.applyQuaternion(this.camera.quaternion),this.camera.up=e,this.camera.lookAt(0,0,0),this.control_trackball.position0=this.camera.position.clone(),this.control_trackball.up0=this.camera.up.clone(),this.update()}});else{this.camera=new c.PerspectiveCamera(46,1,.01,1e4);const e=2*Math.tan(22.5*Math.PI/180)/Math.tan(this.model.get("camera_fov")/2*Math.PI/180);this.camera.position.z=e}this.camera_initial=this.camera.clone(),this.cube_camera=new c.CubeCamera(this.camera.near,this.camera.far,this.model.get("cube_resolution")),this.camera_stereo=new c.StereoCamera,this.renderer.setSize(e,t),this.renderer_stereo=new c.StereoEffect(this.renderer),this.renderer_selected=this.renderer_stereo;const a=(e,t,n,r,i,o,a)=>{const s=new c.Geometry;return s.vertices.push(new c.Vector3(e,t,n),new c.Vector3(r,i,o)),new c.Line(s,a)},u=(e,t,n,r)=>a(-.5,-.5,-.5,-.5+e,-.5+t,-.5+n,r);this.axes_material=new c.LineBasicMaterial({color:"cyan",linewidth:1}),this.xaxes_material=new c.LineBasicMaterial({color:"red",linewidth:1}),this.yaxes_material=new c.LineBasicMaterial({color:"green",linewidth:1}),this.zaxes_material=new c.LineBasicMaterial({color:"blue",linewidth:1}),this.x_axis=u(1,0,0,this.xaxes_material),this.y_axis=u(0,1,0,this.yaxes_material),this.z_axis=u(0,0,1,this.zaxes_material),this.axes=new c.Object3D,this.axes.add(this.x_axis),this.axes.add(this.y_axis),this.axes.add(this.z_axis),this.wire_box=new c.Object3D,this.wire_box_x_line=a(-.5,-.5,-.5,.5,-.5,-.5,this.axes_material),this.wire_box.add(this.wire_box_x_line),this.wire_box.add(a(-.5,.5,-.5,.5,.5,-.5,this.axes_material)),this.wire_box.add(a(-.5,-.5,.5,.5,-.5,.5,this.axes_material)),this.wire_box.add(a(-.5,.5,.5,.5,.5,.5,this.axes_material)),this.wire_box_y_line=a(-.5,-.5,-.5,-.5,.5,-.5,this.axes_material),this.wire_box.add(this.wire_box_y_line),this.wire_box.add(a(.5,-.5,-.5,.5,.5,-.5,this.axes_material)),this.wire_box.add(a(-.5,-.5,.5,-.5,.5,.5,this.axes_material)),this.wire_box.add(a(.5,-.5,.5,.5,.5,.5,this.axes_material)),this.wire_box_z_line=a(-.5,-.5,-.5,-.5,-.5,.5,this.axes_material),this.wire_box.add(this.wire_box_z_line),this.wire_box.add(a(.5,-.5,-.5,.5,-.5,.5,this.axes_material)),this.wire_box.add(a(-.5,.5,-.5,-.5,.5,.5,this.axes_material)),this.wire_box.add(a(.5,.5,-.5,.5,.5,.5,this.axes_material)),this.axes_data=[{name:"x",label:"x",object:null,object_label:null,translate:[0,-.5,-.5],rotate:[Math.PI/4,0,0],rotation_order:"XYZ",fillStyle:"#00FF00"},{name:"y",label:"y",object:null,object_label:null,translate:[-.5,0,-.5],rotate:[3*Math.PI/4,0,Math.PI/2],rotation_order:"ZXY",fillStyle:"#00FF00"},{name:"z",label:"z",object:null,object_label:null,translate:[-.5,-.5,0],rotate:[-Math.PI/8,-Math.PI/2,0],rotation_order:"YZX",fillStyle:"#00FF00"}],this.ticks=5,this.model.get("scene")?this.scene=this.model.get("scene").obj:this.scene=new c.Scene,this.scene.background=null,this.model.get("scene")&&this.model.get("scene").on("rerender",()=>this.update()),this.rootObject=new c.Object3D,this.rootObject.name="rootObject",this.scene.add(this.rootObject),this.scene.add(this.camera),this.scene_opaque=new c.Scene,this.scene_opaque.add(this.wire_box),this.scene_opaque.add(this.axes);const l=()=>{const e=new c.Vector3;e.fromArray(this.model.get("box_center")),e.sub(new c.Vector3(.5,.5,.5));const t=new c.Vector3;t.fromArray(this.model.get("box_size")),this.scene_opaque.scale.copy(t),this.scene_opaque.position.copy(e),this.rootObject.scale.copy(t),this.rootObject.position.copy(e),this.update()};this.model.on("change:box_center change:box_size",l),l(),this.front_box_material=new c.ShaderMaterial({uniforms:{offset:{type:"3f",value:[0,0,0]},scale:{type:"3f",value:[1,1,1]}},fragmentShader:x["box-fragment"],vertexShader:x["box-vertex"],side:c.BackSide}),this.front_box_geo=new c.BoxBufferGeometry(1,1,1),this.front_box_mesh=new c.Mesh(this.front_box_geo,this.front_box_material),this.front_box_mesh.name="Front object",this.rootObject.add(this.front_box_mesh),this.mesh_views={},this.scatter_views={},this.volume_views={};let h=e;const d=t;this.model.get("stereo")&&(h/=2),this.volume_back_target=new c.WebGLRenderTarget(h,d,{minFilter:c.LinearFilter,magFilter:c.LinearFilter,type:c.FloatType,format:c.RGBAFormat,generateMipmaps:!1}),this.volume_front_target=new c.WebGLRenderTarget(h,d,{minFilter:c.LinearFilter,magFilter:c.NearestFilter}),this.geometry_depth_target=new c.WebGLRenderTarget(h,d,{minFilter:c.LinearFilter,magFilter:c.LinearFilter,format:c.RGBAFormat,generateMipmaps:!1}),this.geometry_depth_target.depthTexture=new c.DepthTexture(1,1),this.geometry_depth_target.depthTexture.type=c.UnsignedShortType,this.id_pass_target=new c.WebGLRenderTarget(h,d,{minFilter:c.LinearFilter,magFilter:c.NearestFilter}),this.color_pass_target=new c.WebGLRenderTarget(h,d,{minFilter:c.LinearFilter,magFilter:c.LinearFilter}),this.screen_pass_target=new c.WebGLRenderTarget(h,d,{minFilter:c.LinearFilter,magFilter:c.LinearFilter}),this.coordinate_target=new c.WebGLRenderTarget(h,d,{minFilter:c.LinearFilter,magFilter:c.NearestFilter}),this.screen_texture=this.color_pass_target.texture,this.screen_scene=new c.Scene,this.screen_scene_cube=new c.Scene,this.screen_plane=new c.PlaneBufferGeometry(1,1),this.screen_material=new c.ShaderMaterial({uniforms:{tex:{type:"t",value:this.screen_pass_target.texture}},vertexShader:x["screen-vertex"],fragmentShader:x["screen-fragment"],depthWrite:!1}),this.screen_material_cube=new c.ShaderMaterial({uniforms:{tex:{type:"t",value:this.cube_camera.renderTarget.texture}},vertexShader:x["screen-vertex"],fragmentShader:x["screen-fragment"],defines:{},depthWrite:!1}),this.screen_mesh=new c.Mesh(this.screen_plane,this.screen_material),this.screen_mesh_cube=new c.Mesh(this.screen_plane,this.screen_material_cube),this.screen_scene.add(this.screen_mesh),this.screen_scene_cube.add(this.screen_mesh_cube),this.screen_camera=new c.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),this.screen_camera.position.z=10,this.update_panorama(),this.on("change:panorama_mode",this.update_panorama,this),this.renderer.domElement.addEventListener("touchstart",this._touch_start.bind(this),!1),this.renderer.domElement.addEventListener("touchmove",this._touch_move.bind(this),!1),this.renderer.domElement.addEventListener("touchcancel",this._touch_cancel.bind(this),!1),this.renderer.domElement.addEventListener("mousedown",this._mouse_down.bind(this),!1),this.renderer.domElement.addEventListener("mousemove",this._mouse_move.bind(this),!1),this.renderer.domElement.addEventListener("dblclick",this._mouse_dbl_click.bind(this),!1),this.renderer.domElement.addEventListener("contextmenu",e=>{e.preventDefault(),e.stopPropagation()},!1),window.addEventListener("mouseup",this._mouse_up.bind(this),!1),this.mouse_inside=!1,this.mouse_trail=[],this.select_overlay=null,this.control_trackball=new c.TrackballControls(this.camera,this.renderer.domElement),this.control_orbit=new c.OrbitControls(this.camera,this.renderer.domElement),this.control_trackball.dynamicDampingFactor=1,this.control_trackball.noPan=!0,this.control_orbit.enablePan=!1,this.control_orbit.dampingFactor=1,this.update_mouse_mode(),this.control_orbit.rotateSpeed=.5,this.control_trackball.rotateSpeed=.5,this.control_trackball.zoomSpeed=3;const p=this.update_angles.bind(this),m=this.update.bind(this);this.control_trackball.addEventListener("end",p),this.control_orbit.addEventListener("end",p),this.control_trackball.addEventListener("change",m),this.control_orbit.addEventListener("change",m);const g=()=>{const e=this.model.get("controls"),t=this.model.previousAttributes.controls;if(t){const e=t.obj;e.removeEventListener("end",p),e.removeEventListener("change",m),e.dispose()}e?(this.control_external=e.obj,this.control_external.addEventListener("end",p),this.control_external.addEventListener("change",m),this.control_external.connectEvents(this.el)):this.control_external=null,this.update_mouse_mode()};g(),this.model.on("change:controls",()=>{g()}),window.addEventListener("deviceorientation",this.on_orientationchange.bind(this),!1);const v=this.getRenderSize();this.material_multivolume=new c.ShaderMaterial({uniforms:{back_tex:{type:"t",value:this.volume_back_target.texture},geometry_depth_tex:{type:"t",value:this.geometry_depth_target.depthTexture},volumes:{type:"tv",value:[{}]},data:{type:"tv",value:[]},transfer_function:{type:"tv",value:[]},volumes_max_int:{type:"tv",value:[{}]},data_max_int:{type:"tv",value:[]},transfer_function_max_int:{type:"tv",value:[]},ambient_coefficient:{type:"f",value:this.model.get("ambient_coefficient")},diffuse_coefficient:{type:"f",value:this.model.get("diffuse_coefficient")},specular_coefficient:{type:"f",value:this.model.get("specular_coefficient")},specular_exponent:{type:"f",value:this.model.get("specular_exponent")},brightness:{type:"f",value:2},render_size:{type:"2f",value:v},steps:{type:"f",value:10}},blending:c.CustomBlending,blendSrc:c.OneFactor,blendDst:c.OneMinusSrcAlphaFactor,blendEquation:c.AddEquation,transparent:!0,defines:{},side:c.FrontSide}),this.material_multivolume.uniforms=Object.assign(Object.assign({},c.UniformsUtils.merge([c.UniformsLib.common,c.UniformsLib.specularmap,c.UniformsLib.envmap,c.UniformsLib.aomap,c.UniformsLib.lightmap,c.UniformsLib.emissivemap,c.UniformsLib.bumpmap,c.UniformsLib.normalmap,c.UniformsLib.displacementmap,c.UniformsLib.gradientmap,c.UniformsLib.fog,c.UniformsLib.lights,{emissive:{value:new c.Color(0)},specular:{value:new c.Color(1118481)},shininess:{value:30}}])),this.material_multivolume.uniforms),this.material_multivolume_depth=new c.ShaderMaterial({uniforms:this.material_multivolume.uniforms,blending:c.NoBlending,defines:{COORDINATE:!0},side:c.FrontSide}),this.model.on("change:scatters",this.update_scatters,this),this.update_scatters(),this.model.on("change:meshes",this.update_meshes,this),this.update_meshes(),this.model.on("change:volumes",this.update_volumes,this),this.update_volumes(),this.model.on("change:lights",this.update_lights,this),this.update_lights(),this.update_size();this.el.addEventListener("change",this.update.bind(this));const _=()=>{this.model.set("matrix_world",this._get_view_matrix().elements.slice()),this.touch()};if(this.model.on("change:xlim change:ylim change:zlim",()=>{_()}),this.model.get("camera")){this.model.get("camera").on("change:matrixWorld",()=>{_()}),_();const e=()=>{this.model.set("matrix_projection",this.camera.projectionMatrix.elements.slice())};e(),this.model.get("camera").on("change:projectionMatrix",()=>{e()}),e()}this.model.on("change:camera_control",this.update_mouse_mode,this),this.model.on("change:xlabel change:ylabel change:zlabel",this.update,this),this.model.on("change:render_continuous",this.update,this),this.model.on("change:style",this.update,this);const y=this.model.get("scales");for(const e of["x","y","z"])y[e].on("change",this.update,this);this.model.on("change:xlim change:ylim change:zlim ",this.update,this),this.model.on("change:stereo",this.update_size,this),this.model.on("change:eye_separation",this.update,this),this.model.on("change:camera_fov",this.update_current_control,this),this.model.on("change:width",this.update_size,this),this.model.on("change:height",this.update_size,this),this.model.on("change:displayscale",this.update_size,this),this.model.on("change:ambient_coefficient",this.update_light,this),this.model.on("change:diffuse_coefficient",this.update_light,this),this.model.on("change:specular_coefficient",this.update_light,this),this.model.on("change:specular_exponent",this.update_light,this);this.model.on("change:_shaders",()=>{this.rebuild_multivolume_rendering_material(),this.update()},this);const b=()=>{for(const e of[this.scene,this.scene_opaque]){const t=this.model.get("camera_center");e.position.set(-t[0],-t[1],-t[2])}this.update()};let M;this.model.on("change:camera_center",b),b(),this.model.on("change:tf",this.tf_set,this),this.listenTo(this.model,"msg:custom",this.custom_msg.bind(this)),this.renderer.domElement.addEventListener("resize",this.on_canvas_resize.bind(this),!1),this.update(),this.update_current_control(),this.update_light(),M=this.model.get("capture_fps")?this.renderer.domElement.captureStream(this.model.get("capture_fps")):this.renderer.domElement.captureStream(),this.model.stream=Promise.resolve(M),window.last_figure_stream=M,window.last_figure=this,this.renderer.domElement.onmouseover=()=>{this.hover=!0},this.renderer.domElement.onmouseleave=()=>{this.hover=!1}}camera_initial(e){throw new Error("Method not implemented.")}_save_matrices(e,t,n){throw new Error("Method not implemented.")}tf_set(e,t,n){throw new Error("Method not implemented.")}setStyle(){}update_icons(){const e="select"===this.model.get("mouse_mode");this.select_icon_lasso.active("lasso"===this.model.get("selector")&&e),this.select_icon_circle.active("circle"===this.model.get("selector")&&e),this.select_icon_rectangle.active("rectangle"===this.model.get("selector")&&e),this.select_icon.active(e);const t="zoom"===this.model.get("mouse_mode");this.zoom_icon.active(t);const n="slice"===this.model.get("mouse_mode");this.slice_icon.active(n)}update_mouse_mode(){const e="normal"===this.model.get("mouse_mode");this.model.get("controls")?(this.control_trackball.enabled=!1,this.control_orbit.enabled=!1):(this.control_trackball.enabled="trackball"===this.model.get("camera_control")&&e,this.control_orbit.enabled="orbit"===this.model.get("camera_control")&&e)}mousewheel(e){if("zoom"!==this.model.get("mouse_mode"))return;e.preventDefault(),e.stopPropagation();let t,n,r=25e-5*e.deltaY;2===e.deltaMode&&(r=.025*e.deltaY),1===e.deltaMode&&(r-=.01*e.deltaY),e.offsetX?(t=e.offsetX,n=e.offsetY):e.layerX&&(t=e.layerX,n=e.layerY),r*=10;const i=Math.pow(10,r);this.renderer.domElement.clientHeight;if(!this.last_zoom_coordinate){const[e,r,i,o]=this.readPixelFrom(this.coordinate_target,t,n);if(o>1){const t=new c.Vector3(e,r,i);t.multiplyScalar(1/255),this.last_zoom_coordinate=t}}if(this.last_zoom_coordinate){this.renderer.setRenderTarget(this.coordinate_target),this.renderer.clear(!0,!0,!0);const e=this.last_zoom_coordinate,t=e.clone().sub(e.clone().multiplyScalar(i)),n=e.clone().add(e.clone().negate().addScalar(1).multiplyScalar(i)),r=this.model.get("scales"),o=m.mapValues(r,y.createD3Scale);o.x.range([0,1]),o.y.range([0,1]),o.z.range([0,1]),r.x.set("min",o.x.invert(t.x)),r.x.set("max",o.x.invert(n.x)),r.y.set("min",o.y.invert(t.y)),r.y.set("max",o.y.invert(n.y)),r.z.set("min",o.z.invert(t.z)),r.z.set("max",o.z.invert(n.z)),r.x.save_changes(),r.y.save_changes(),r.z.save_changes()}return!1}_mouse_down(e){let t,n;window.last_event=e,e.offsetX?(t=e.offsetX,n=e.offsetY):e.layerX&&(t=e.layerX,n=e.layerY),this.mouseDown(t,n)}mouseDown(e,t,n){this.mouse_down_position={x:e,y:t};const r=this.model.get("scales");this.mouse_down_domain={x:r.x.domain.slice(),y:r.y.domain.slice(),z:r.z.domain.slice()};this.renderer.domElement.clientHeight;const[i,o,a,s]=this.readPixelFrom(this.coordinate_target,e,t);if(s>1){const e=new c.Vector3(i,o,a);e.multiplyScalar(1/255),this.last_pan_coordinate=e}if("select"===this.model.get("mouse_mode")){const e=g.selectors[this.model.get("selector")];this.selector=new e(this.canvas_overlay),n&&(n.preventDefault(),n.stopPropagation())}if("slice"===this.model.get("mouse_mode")){let[n,r,i,o]=this.readPixelFrom(this.volume_front_target,e,t);o>0&&(n/=255,r/=255,i/=255,this._set_slice(n,r,i))}const u=this.readId(e,t);this.on_id_click(u,e,t)}_mouse_move(e){let t,n;e||(e=event),e.offsetX?(t=e.offsetX,n=e.offsetY):e.layerX&&(t=e.layerX,n=e.layerY);const r=t,i=n,o=this.readId(t,n);if(this.on_id_hover(o,t,n),this.last_zoom_coordinate=null,this.selector&&(this.mouse_trail.push([t,n]),this.selector.mouseMove(t,n),this.selector.draw()),"zoom"===this.model.get("mouse_mode")&&this.last_pan_coordinate&&1===e.buttons){const e=r-this.mouse_down_position.x,t=-(i-this.mouse_down_position.y);this.mouseDrag(e,t)}if("slice"===this.model.get("mouse_mode")){let[e,r,i,o]=this.readPixelFrom(this.volume_front_target,t,n);o>0&&(e/=255,r/=255,i/=255,this._set_slice(e,r,i))}}_touch_start(e){}_touch_cancel(e){}_touch_move(e){const t=e.targetTouches[0].clientX,n=e.targetTouches[0].clientY;if(console.log("move",t,n),"slice"===this.model.get("mouse_mode")){let[e,r,i,o]=this.readPixelFrom(this.volume_front_target,t,n);return o>0&&(e/=255,r/=255,i/=255,this._set_slice(e,r,i)),!1}}_set_slice(e,t,n){const r=this.model.get("scales"),i=m.mapValues(r,y.createD3Scale),o=i.x.range([0,1]).invert(e),a=i.y.range([0,1]).invert(t),s=i.z.range([0,1]).invert(n),[c,u]=i.x.domain(),[l,h]=i.y.domain(),[f,d]=i.z.domain(),p=Math.abs(c-u),g=Math.abs(l-h),v=Math.abs(f-d),_=Math.abs(o-c)/p<.001||Math.abs(o-u)/p<.001,x=Math.abs(a-l)/g<.001||Math.abs(a-h)/g<.001,b=Math.abs(s-f)/v<.001||Math.abs(s-d)/v<.001;(_||x)&&this.model.set("slice_z",s),(_||b)&&this.model.set("slice_y",a),(x||b)&&this.model.set("slice_x",o),(_||x||b)&&this.model.save_changes()}on_id_click(e,t,n){Object.values(this.scatter_views).forEach(r=>{r.onClick(e),r.popup(e,t,n,this.popup_container)}),Object.values(this.mesh_views).forEach(r=>{r.onClick(e),r.popup(e,t,n,this.popup_container)})}on_id_hover(e,t,n){this._wantsPopup=!0;this.lastId=e,setTimeout(()=>{this._wantsPopup&&e==this.lastId&&(this._wantsPopup=!1,this._on_id_hover(e,t,n))},this.model.get("popup_debouce"))}_on_id_hover(e,t,n){Object.values(this.scatter_views).forEach(r=>{r.onHover(e),this.popup_container.style.left=`${t}px`;const i=this.renderer.domElement.clientHeight;this.popup_container.style.bottom=`${i-n}px`,r.popup(e,t,n,this.popup_container)}),Object.values(this.mesh_views).forEach(r=>{r.onHover(e),this.popup_container.style.left=`${t}px`;const i=this.renderer.domElement.clientHeight;this.popup_container.style.bottom=`${i-n}px`,r.popup(e,t,n,this.popup_container)})}mouseDrag(e,t){const n=this.renderer.domElement,r=e/n.clientWidth*2,i=t/n.clientHeight*2,o=this.camera.projectionMatrix,a=this.camera.matrixWorldInverse,s=o.clone().multiply(a),u=new c.Matrix4,l=this.model.get("box_size");u.makeScale(l[0],l[1],l[2]),s.multiply(u);const h=s.clone().getInverse(s),f=this.model.get("scales"),d=m.mapValues(f,y.createD3Scale);d.x.domain(this.mouse_down_domain.x).range([0,1]),d.y.domain(this.mouse_down_domain.y).range([0,1]),d.z.domain(this.mouse_down_domain.z).range([0,1]);let p=this.last_pan_coordinate.clone();const g=p.clone().applyMatrix4(s),v=g.clone();v.x+=r,v.y+=i,p=g.clone().applyMatrix4(h);const _=v.clone().applyMatrix4(h).clone().sub(p),x=new c.Vector3(0,0,0),b=new c.Vector3(1,1,1);x.sub(_),b.sub(_),f.x.set("min",d.x.invert(x.x)),f.x.set("max",d.x.invert(b.x)),f.y.set("min",d.y.invert(x.y)),f.y.set("max",d.y.invert(b.y)),f.z.set("min",d.z.invert(x.z)),f.z.set("max",d.z.invert(b.z)),f.x.save_changes(),f.y.save_changes(),f.z.save_changes()}_mouse_dbl_click(e){if("zoom"===this.model.get("mouse_mode")&&this.last_pan_coordinate){const e=this.mouse_down_domain.x,t=this.mouse_down_domain.y,n=this.mouse_down_domain.z;let r=new c.Vector3(e[0],t[0],n[0]),i=new c.Vector3(e[1],t[1],n[1]);const o=i.clone().sub(r),a=this.last_pan_coordinate.clone().multiply(o).add(r),s=o.clone().multiplyScalar(.5);r=a.clone().sub(s),i=a.clone().add(s);const u=this.model.get("scales");u.x.set("min",r.x),u.x.set("max",i.x),u.y.set("min",r.y),u.y.set("max",i.y),u.z.set("min",r.z),u.z.set("max",i.z),u.x.save_changes(),u.y.save_changes(),u.z.save_changes()}}_mouse_up(e){if(this.selector){const t=this.renderer.domElement;this.send({event:"selection",data:this.selector.getData(t.clientWidth,t.clientHeight)}),this.mouse_trail=[],this.selector.close(),this.selector=null,e.preventDefault(),e.stopPropagation()}}_special_keys_down(e){if(!this.hover)return;const t=window.event?event:e;t.altKey;let n=!1;return"="===t.key&&(this.model.set("selection_mode","replace"),n=!0),"|"===t.key&&(this.model.set("selection_mode","or"),n=!0),"&"===t.key&&(this.model.set("selection_mode","and"),n=!0),"-"===t.key&&(this.model.set("selection_mode","subtract"),n=!0),76===t.keyCode&&(this.model.set("selector","lasso"),n=!0),67===t.keyCode&&(this.model.set("selector","circle"),n=!0),82===t.keyCode&&(this.model.set("selector","rectangle"),n=!0),16===t.keyCode&&(this.quick_mouse_mode_change||(this.quick_mouse_mode_change=!0,this.quick_mouse_previous_mode=this.model.get("mouse_mode"),this.model.set("mouse_mode","slice"),n=!0)),18===t.keyCode&&(this.quick_mouse_mode_change||(this.quick_mouse_mode_change=!0,this.quick_mouse_previous_mode=this.model.get("mouse_mode"),this.model.set("mouse_mode","zoom"),n=!0)),17===t.keyCode&&(this.quick_mouse_mode_change||(this.quick_mouse_mode_change=!0,this.quick_mouse_previous_mode=this.model.get("mouse_mode"),this.model.set("mouse_mode","select"),n=!0)),n?(this.touch(),e.preventDefault(),e.stopPropagation(),!1):void 0}_special_keys_up(e){const t=window.event?event:e;t.altKey,16!==t.keyCode&&17!==t.keyCode&&18!==t.keyCode||this.quick_mouse_mode_change&&(this.quick_mouse_mode_change=!1,this.model.set("mouse_mode",this.quick_mouse_previous_mode),this.touch())}custom_msg(e){if("screenshot"===e.msg){const t=this.screenshot(void 0,e.width,e.height);this.send({event:"screenshot",data:t})}}screenshot(e="image/png",t,n){const r=t&&n;try{r&&this._update_size(!0,t,n),this._real_update();const i=this.renderer.domElement.toDataURL(e);return console.info("captured screenshot"),i}finally{r&&this._update_size(!1)}}_d3_add_axis(e,t,n){const r=new c.Object3D;r.matrixAutoUpdate=!1;const i=new c.Matrix4;i.makeTranslation(t.translate[0],t.translate[1],t.translate[2]),o.select(e).attr("translate-x",t.translate[0]),o.select(e).attr("translate-y",t.translate[1]),o.select(e).attr("translate-z",t.translate[2]);const a=new c.Matrix4;a.makeRotationFromEuler(new c.Euler(t.rotate[0],t.rotate[1],t.rotate[2],t.rotation_order));const s={x:u.textAlign.topRight,y:u.textAlign.topRight,z:u.textAlign.center},l=new u.SpriteText2D(t.label,{align:s[t.name],font:"100px Arial",fillStyle:"#00FF00",antialias:!0});l.material.transparent=!0,l.material.alphaTest=.3,r.matrix.multiply(i),r.matrix.multiply(a),this.axes.add(r),r.add(l),t.object_label=l,t.object=r;const h=this.model.get("scales")[t.name];t.scale=y.createD3Scale(h).range([-.5,.5]),t.ticks=null,this._d3_update_axis(e,t,n)}_d3_update_axis(e,t,n){t.object_label.text=t.label,t.object_label.fillStyle=t.fillStyle;const r=t.name,i=this.model.get("scales")[t.name];t.scale=y.createD3Scale(i).range([-.5,.5]),t.object_label.fillStyle=this.get_style("axes."+r+".label.color axes."+r+".color axes.label.color axes.color"),t.object_label.visible=this.get_style("axes."+r+".label.visible axes."+r+".visible axes.label.visible axes.visible");const o=new c.Matrix4;o.makeRotationFromEuler(new c.Euler(t.rotate[0],t.rotate[1],t.rotate[2],t.rotation_order));const a=new c.Matrix4;a.getInverse(o);const s=new c.Vector3;s.fromArray(this.model.get("box_size"));const u=new c.Vector3(1,1,1);u.divide(s);const l=new c.Matrix4;l.makeScale(u.x,u.y,u.z);const h=.004/3,f=new c.Matrix4;f.makeScale(h,h,h),l.multiply(f);const d=t.object_label;d.matrixAutoUpdate=!1,d.matrix.identity(),d.matrix.multiply(a),d.matrix.multiply(l),d.matrix.multiply(o)}_d3_add_axis_tick(e,t,n){const r=o.select(o.select(e).node().parentNode).datum(),i=r.scale.tickFormat(this.ticks,".1f")(t.value),a={x:u.textAlign.topRight,y:u.textAlign.topRight,z:u.textAlign.center},s=new u.SpriteText2D(i,{align:a[r.name],font:"100px Arial",fillStyle:"#00FF00",antialias:!0});s.material.transparent=!0,s.material.alphaTest=.3;const c=r.name;return s.fillStyle=this.get_style("axes."+c+".ticklabel.color axes.ticklabel.color axes."+c+".color axes.color"),i&&r.object.add(s),t.object_ticklabel=s,this._d3_update_axis_tick(e,t,n),s}_d3_update_axis_tick(e,t,n){const r=o.select(o.select(e).node().parentNode).datum(),i=r.scale,a=i.tickFormat(this.ticks,".1f")(t.value);a&&!t.object_ticklabel.text&&r.object.add(t.object_ticklabel),!a&&t.object_ticklabel.text&&r.object.remove(t.object_ticklabel),t.object_ticklabel.text=a;const s=r.name;t.object_ticklabel.fillStyle=this.get_style("axes."+s+".ticklabel.color axes.ticklabel.color axes."+s+".color axes.color"),t.object_ticklabel.visible=this.get_style("axes."+s+".ticklabel.visible axes."+s+".visible axes.visible");const u=new c.Matrix4;u.makeRotationFromEuler(new c.Euler(r.rotate[0],r.rotate[1],r.rotate[2],r.rotation_order));const l=new c.Matrix4;l.getInverse(u);const h=new c.Vector3;h.fromArray(this.model.get("box_size"));const f=new c.Vector3(1,1,1);f.divide(h);const d=new c.Matrix4;d.makeScale(f.x,f.y,f.z);const p=.001/3,m=new c.Matrix4;m.makeScale(p,p,p),d.multiply(m);const g=new c.Matrix4;g.makeTranslation(i(t.value),0,0);const v=t.object_ticklabel;v.matrixAutoUpdate=!1,v.matrix.identity(),v.matrix.multiply(g),v.matrix.multiply(l),v.matrix.multiply(d),v.matrix.multiply(u)}_d3_remove_axis_tick(e,t,n){t.object_ticklabel.text&&t.object_ticklabel.parent.remove(t.object_ticklabel)}update_scatters(){const e=this.model.get("scatters");if(0!==e.length){const t=[];e.forEach(e=>{if(t.push(e.cid),!(e.cid in this.scatter_views)){const t={parent:this},n=new h.ScatterView({options:t,model:e});n.render(),this.scatter_views[e.cid]=n}});for(const e of Object.keys(this.scatter_views)){const n=this.scatter_views[e];-1===t.indexOf(e)&&(n.remove_from_scene(),delete this.scatter_views[e])}}else this.scatter_views={};this._update_id_offsets()}update_meshes(){const e=this.model.get("meshes");if(0!==e.length){const t=[];e.forEach(e=>{if(t.push(e.cid),!(e.cid in this.mesh_views)){const t={parent:this},n=new l.MeshView({options:t,model:e});n.render(),this.mesh_views[e.cid]=n}});for(const e of Object.keys(this.mesh_views)){const n=this.mesh_views[e];-1===t.indexOf(e)&&(n.remove_from_scene(),delete this.mesh_views[e])}}else this.mesh_views={};this._update_id_offsets()}update_volumes(){const e=this.model.get("volumes"),t=this.model.previous("volumes");if(0!==e.length){const t=[];e.forEach(e=>{if(t.push(e.cid),!(e.cid in this.volume_views)){const t={parent:this},n=new p.VolumeView({options:t,model:e});e.add_to_scene(this.rootObject),this.volume_views[e.cid]=n,n.render()}});for(const e of Object.keys(this.volume_views)){this.volume_views[e];-1===t.indexOf(e)&&delete this.volume_views[e]}}else this.volume_views={};if(t)for(let n of t)e.includes(n)||n.remove_from_scene(this.rootObject);this._update_id_offsets()}_update_id_offsets(){let e=1;for(const t of Object.values(this.scatter_views))t.uniforms.id_offset.value=e,e+=t.length;for(const t of Object.values(this.mesh_views))t.uniforms.id_offset.value=e,e+=t.length}async update_lights(){this.model.previous("lights")&&this.model.previous("lights").forEach(e=>{const t=e.obj;this.scene.remove(t)}),this.model.get("lights").forEach(e=>{const t=e.obj;t.castShadow&&this.update_shadows();const n=()=>{t.castShadow&&this.update_shadows(),this.update()};t.target&&this.scene.add(t.target),e.on("change",n),e.on("childchange",n),this.scene.add(t)});const e=[...Object.values(this.mesh_views),...Object.values(this.scatter_views)];for(const t of e)t._update_materials();this.update()}update_shadows(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=c.PCFSoftShadowMap}transition(e,t,n){const r=this.model.get("animation_exponent");this.transitions.push(new v.Transition(e,t,this.model.get("animation"),r))}on_orientationchange(e){if(this.model.get("orientation_control")){for(const t of[this.scene,this.scene_opaque])t.rotation.reorder("XYZ"),t.rotation.x=e.gamma*Math.PI/180+2*Math.PI,t.rotation.y=-(e.beta*Math.PI/180+2*Math.PI),t.rotation.z=-e.alpha*Math.PI/180;this.update()}}on_canvas_resize(e){}keypress(e){}update_angles(){this.camera.ipymodel&&this.camera.ipymodel.syncToModel(!0),this.update()}_get_scale_matrix(){const e=new c.Matrix4;e.makeTranslation(-.5,-.5,-.5);const t=new c.Matrix4,n=this.model.get("scales"),r=n.x.domain,i=n.y.domain,o=n.z.domain,a=1/(r[1]-r[0]),s=1/(i[1]-i[0]),u=1/(o[1]-o[0]);t.makeScale(a,s,u);const l=new c.Matrix4;return l.makeTranslation(-r[0],-i[0],-o[0]),e.multiply(t),e.multiply(l),e}_get_view_matrix(){this.camera.updateMatrixWorld(),this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld);const e=this.camera.matrixWorldInverse.clone();return e.multiply(this._get_scale_matrix().clone()),e}update_current_control(){this.camera.ipymodel&&this.camera.ipymodel.syncToModel(!0),this.control_trackball.position0=this.camera.position.clone(),this.control_trackball.up0=this.camera.up.clone()}update_panorama(){const e=this.screen_material_cube;"360"===this.model.get("panorama_mode")&&(e.defines={PANORAMA_360:!0}),"180"===this.model.get("panorama_mode")&&(e.defines={PANORAMA_180:!0}),e.needsUpdate=!0,this.update()}update(){this._update_requested||(this._update_requested=!0,requestAnimationFrame(this._real_update.bind(this)))}_real_update(){this.control_trackball.handleResize(),this.control_external&&(this.control_external.update(),this.camera.ipymodel.syncToModel(!0)),this._update_requested=!1,this.control_external||this.camera.lookAt(0,0,0);for(const e of Object.values(this.scatter_views))e.uniforms.aspect.value=this.model.get("box_size");this.renderer.setClearColor(this.get_style_color("background-color")),this.x_axis.visible=this.get_style("axes.x.visible axes.visible"),this.y_axis.visible=this.get_style("axes.y.visible axes.visible"),this.z_axis.visible=this.get_style("axes.z.visible axes.visible"),this.axes_material.color=this.get_style_color("axes.color"),this.xaxes_material.color=this.get_style_color("axes.x.color axes.color"),this.yaxes_material.color=this.get_style_color("axes.y.color axes.color"),this.zaxes_material.color=this.get_style_color("axes.z.color axes.color"),this.axes_data[0].fillStyle=this.get_style("axes.x.color axes.color"),this.axes_data[1].fillStyle=this.get_style("axes.y.color axes.color"),this.axes_data[2].fillStyle=this.get_style("axes.z.color axes.color"),this.axes_data[0].label=this.model.get("xlabel"),this.axes_data[1].label=this.model.get("ylabel"),this.axes_data[2].label=this.model.get("zlabel"),this.wire_box.visible=this.get_style("box.visible"),this.wire_box_x_line.visible=!this.x_axis.visible&&this.wire_box.visible,this.wire_box_y_line.visible=!this.y_axis.visible&&this.wire_box.visible,this.wire_box_z_line.visible=!this.z_axis.visible&&this.wire_box.visible,o.select(this.el_axes).selectAll(".ipyvol-axis").data(this.axes_data).each(b(this._d3_update_axis,this)).enter().append("div").attr("class","ipyvol-axis").each(b(this._d3_add_axis,this));const e=this;this.ticks=5,this.last_tick_selection=o.select(this.el_axes).selectAll(".ipyvol-axis").data(this.axes_data).selectAll(".ipyvol-tick").data((function(t,n,r){let i=t.ticks;if(i){i=t.ticks=i.slice();const n=t.scale.ticks(e.ticks);for(;i.length<n.length;)i.push({});for(;i.length>n.length;)i.pop();for(let e=0;e<n.length;e++)i[e].value=n[e];return i}return i=t.scale.ticks(e.ticks).map(e=>({value:e})),t.ticks=i,i})),this.last_tick_selection.each(b(this._d3_update_axis_tick,this)).enter().append("div").attr("class","ipyvol-tick").each(b(this._d3_add_axis_tick,this)),this.last_tick_selection.exit().remove().each(b(this._d3_remove_axis_tick,this));const t=[];for(const e of this.transitions)e.is_done()||t.push(e),e.update();if(this.renderer.clear(),this.model.get("stereo")){const e=this.renderer.getSize();null===this.camera.parent&&this.camera.updateMatrixWorld(),this.camera_stereo.eyeSep=this.model.get("eye_separation")/100,this.camera.focus=this.camera.focus,this.camera_stereo.update(this.camera),this.camera_stereo.cameraL.position.copy(this.camera.position),this.camera_stereo.cameraR.position.copy(this.camera.position),this.camera_stereo.cameraL.quaternion.copy(this.camera.quaternion),this.camera_stereo.cameraR.quaternion.copy(this.camera.quaternion),this.camera_stereo.cameraL.up.copy(this.camera.up),this.camera_stereo.cameraR.up.copy(this.camera.up);const t="no"!==this.model.get("panorama_mode");this.renderer.setScissorTest(!0),t?(this.renderer.setScissor(0,0,e.width,e.height/2),this.renderer.setViewport(0,0,e.width,e.height/2)):(this.renderer.setScissor(0,0,e.width/2,e.height),this.renderer.setViewport(0,0,e.width/2,e.height)),this._render_eye(this.camera_stereo.cameraL),t?(this.renderer.setScissor(0,e.height/2,e.width,e.height/2),this.renderer.setViewport(0,e.height/2,e.width,e.height/2)):(this.renderer.setScissor(e.width/2,0,e.width/2,e.height),this.renderer.setViewport(e.width/2,0,e.width/2,e.height)),this._render_eye(this.camera_stereo.cameraR),this.renderer.setScissorTest(!1),this.renderer.setViewport(0,0,e.width,e.height)}else this._render_eye(this.camera);this.selector&&this.selector.draw(),this.transitions=t,this.transitions.length>0&&this.update(),this.model.get("render_continuous")&&this.update(),this.model.get("scene")&&this.model.get("scene").trigger("afterRender",this.scene,this.renderer,this.camera)}get_style_color(e){const t=this.get_style(e);if(t)return new c.Color(t);console.error("could not find color for",e)}get_style(e){const t=[null];return e.split(" ").forEach(e=>{const n=e.split(".").reduce((e,t)=>null!==e&&void 0!==e[t]?e[t]:null,this.model.get("style"));null!==n&&null===t[0]&&(t[0]=n)},this),t[0]}_render_eye(e){this.camera.updateMatrixWorld();let t=this.model.get("volumes");const n=0!==(t=t.filter(e=>e.get("visible"))).length,r="no"!==this.model.get("panorama_mode"),i=this.rootObject.children.reduce((e,t)=>(e[t.id]=t.visible,e),{}),o=({volumes:e})=>{this.rootObject.children.forEach(t=>{t.visible=e?Boolean(t.isVolume)||Boolean(t.isLight)||Boolean(t.isCamera):!Boolean(t.isVolume),t===this.front_box_mesh&&(this.front_box_mesh.visible=!1)})};for(const e of Object.values(this.scatter_views))e.set_scales(this.model.get("scales"));for(const e of Object.values(this.mesh_views))e.set_scales(this.model.get("scales"));if(r){if(this.cube_camera.clear(this.renderer,!0,!0,!0),this.renderer.autoClear=!1,this.cube_camera.position.copy(e.position),this.cube_camera.rotation.copy(e.rotation),this.cube_camera.quaternion.copy(this.camera.quaternion),this.model.get("stereo")){const t=new c.Vector3(0,0,0);e===this.camera_stereo.cameraR&&(t.x+=.032),e===this.camera_stereo.cameraL&&(t.x-=.032),t.applyQuaternion(e.quaternion),this.cube_camera.position.add(t);const n=new c.Vector3(0,0,1*this.camera.focus);n.applyQuaternion(e.quaternion),this.cube_camera.lookAt(n)}return this.cube_camera.update(this.renderer,this.scene),this.cube_camera.update(this.renderer,this.scene_opaque),this.screen_texture=this.cube_camera.renderTarget,void this.renderer.render(this.screen_scene_cube,this.screen_camera)}if(this.rootObject.children.forEach(e=>{e.visible=!1}),this.front_box_mesh.visible=!0,this.front_box_mesh.material.side=c.FrontSide,this.renderer.setRenderTarget(this.volume_front_target),this.renderer.clear(!0,!0,!0),this.renderer.render(this.scene,e,this.volume_front_target),this.front_box_mesh.visible=!1,n){this.renderer.state.buffers.depth.setClear(0);for(const e of t)e.box_material.side=c.BackSide,e.box_material.depthFunc=c.GreaterDepth,e.vol_box_mesh.material=e.box_material,e.set_scales(this.model.get("scales"));this.renderer.setRenderTarget(this.volume_back_target),this.renderer.clear(!0,!0,!0),o({volumes:!0}),this.renderer.render(this.scene,e,this.volume_back_target),this.renderer.state.buffers.depth.setClear(1),this.renderer.autoClear=!1,this.renderer.setRenderTarget(this.geometry_depth_target),this.renderer.clear(!0,!0,!0),o({volumes:!1}),this.renderer.render(this.scene,e,this.geometry_depth_target),this.renderer.render(this.scene_opaque,e,this.geometry_depth_target),this.renderer.autoClear=!0}if(this.renderer.autoClear=!1,this.renderer.setRenderTarget(this.color_pass_target),this.renderer.clear(!0,!0,!0),o({volumes:!1}),this.renderer.render(this.scene,e,this.color_pass_target),this.renderer.render(this.scene_opaque,e,this.color_pass_target),this.renderer.autoClear=!0,n){this.renderer.context.colorMask(0,0,0,0);for(const e of t)e.box_material.side=c.FrontSide,e.box_material.depthFunc=c.LessEqualDepth;this.renderer.autoClear=!1,this.renderer.setRenderTarget(this.color_pass_target),this.renderer.clear(!1,!0,!1),o({volumes:!0}),this.renderer.render(this.scene,e,this.color_pass_target),this.renderer.autoClear=!0,this.renderer.context.colorMask(!0,!0,!0,!0);for(const e of t)e.vol_box_mesh.material=this.material_multivolume;this.renderer.autoClear=!1,this.renderer.setRenderTarget(this.color_pass_target),o({volumes:!0}),this.renderer.render(this.scene,e,this.color_pass_target),this.renderer.autoClear=!0}for(const e of Object.values(this.scatter_views))e.mesh.material=e.mesh.material_rgb;for(const e of Object.values(this.mesh_views))e.meshes.forEach(e=>{e.material=e.material_rgb});this.renderer.autoClear=!1,this.renderer.setClearAlpha(0),this.renderer.setRenderTarget(this.coordinate_target),this.renderer.clear(!0,!0,!0),o({volumes:!1}),this.renderer.render(this.scene,e,this.coordinate_target),this.renderer.autoClear=!0;for(const e of Object.values(this.scatter_views))e.mesh.material=e.mesh.material_id;for(const e of Object.values(this.mesh_views))e.meshes.forEach(e=>{e.material=e.material_id});if(this.renderer.autoClear=!1,this.renderer.setClearAlpha(0),this.renderer.setRenderTarget(this.id_pass_target),this.renderer.clear(!0,!0,!0),o({volumes:!1}),this.renderer.render(this.scene,e,this.id_pass_target),this.renderer.autoClear=!0,n){this.renderer.context.colorMask(0,0,0,0);for(const e of t)e.box_material.side=c.FrontSide,e.box_material.depthFunc=c.LessEqualDepth;this.renderer.autoClear=!1,this.renderer.setRenderTarget(this.color_pass_target),this.renderer.clear(!1,!0,!1),o({volumes:!0}),this.renderer.render(this.scene,e,this.color_pass_target),this.renderer.autoClear=!0,this.renderer.context.colorMask(!0,!0,!0,!0);for(const e of t)e.vol_box_mesh.material=this.material_multivolume_depth;this.renderer.autoClear=!1,this.renderer.setRenderTarget(this.color_pass_target),o({volumes:!0}),this.renderer.render(this.scene,e,this.coordinate_target),this.renderer.autoClear=!0}for(const e of Object.values(this.scatter_views))e.mesh.material=e.mesh.material_normal;for(const e of Object.values(this.mesh_views))e.meshes.forEach(e=>{e.material=e.material_normal});"Shadow"==this.model.get("show")?this._render_shadow():(this.screen_texture={render:this.color_pass_target,front:this.volume_front_target,back:this.volume_back_target,coordinate:this.coordinate_target,id:this.id_pass_target}[this.model.get("show")],this.screen_material.uniforms.tex.value=this.screen_texture.texture,this.renderer.setRenderTarget(null),this.renderer.clear(!0,!0,!0),this.renderer.render(this.screen_scene,this.screen_camera)),(()=>{this.rootObject.children.forEach(e=>{e.visible=i[e.id]})})()}_render_shadow(){const e=this.model.get("lights").map(e=>e.obj).filter(e=>Boolean(e.shadow)&&Boolean(e.shadow.map));if(0==e.length)throw"No light with a shadow map found.";const t=e[0].shadow.map.texture,n=t.width,r=t.height,i=new c.OrthographicCamera(n/-2,r/2,n/2,r/-2,-1e3,1e3);i.position.z=100;var o=new c.Scene;const a=this.model.get("_shaders"),s=a["shadow-fragment"]||x["shadow-fragment"],u=a["shadow-vertex"]||x["shadow-vertex"],l=new c.ShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:u,fragmentShader:s,depthTest:!1,depthWrite:!1});o.add(new c.Mesh(new c.PlaneGeometry(n,r),l)),l.uniforms.map.value=t,this.renderer.render(o,i)}rebuild_multivolume_rendering_material(){let e=this.model.get("volumes");e=e.filter(e=>e.get("visible"));const t=this.material_multivolume,n=this.material_multivolume_depth;let r=0,i=0;if(t.uniforms.volumes.value=[],t.uniforms.volumes_max_int.value=[],t.uniforms.data.value=[],t.uniforms.data_max_int.value=[],t.uniforms.transfer_function.value=[],t.uniforms.transfer_function_max_int.value=[],t.uniforms.steps.value=e.map(e=>{const t=this.volume_views[e.cid];return t?t.get_ray_steps():0}),0===e.length)return;for(const n of e)n.is_normal()?(r++,t.uniforms.volumes.value.push(n.uniform_volumes_values),t.uniforms.data.value.push(n.uniform_data.value[0]),t.uniforms.transfer_function.value.push(n.uniform_transfer_function.value[0])):(i++,t.uniforms.volumes_max_int.value.push(n.uniform_volumes_values),t.uniforms.data_max_int.value.push(n.uniform_data.value[0]),t.uniforms.transfer_function_max_int.value.push(n.uniform_transfer_function.value[0]));t.defines.VOLUME_COUNT=r,t.defines.VOLUME_COUNT_MAX_INT=i,t.lights=!0,n.defines.VOLUME_COUNT=r,n.defines.VOLUME_COUNT_MAX_INT=i;const o=this.model.get("_shaders");n.fragmentShader=t.fragmentShader=y.patchShader((e=>{const t={volumes:m.range(r),volumes_max_int:m.range(i)};return a.render(e,t)})(o["volr-fragment"]||x["volr-fragment"])),n.vertexShader=t.vertexShader=y.patchShader(o["volr-vertex"]||x["volr-vertex"]),n.needsUpdate=t.needsUpdate=!0}update_light(){this.material_multivolume.uniforms.ambient_coefficient.value=this.model.get("ambient_coefficient"),this.material_multivolume.uniforms.diffuse_coefficient.value=this.model.get("diffuse_coefficient"),this.material_multivolume.uniforms.specular_coefficient.value=this.model.get("specular_coefficient"),this.material_multivolume.uniforms.specular_exponent.value=this.model.get("specular_exponent"),this.update()}update_size(){this._update_size()}_update_size(e,t,n){let r,i;const o=this.renderer.domElement;this.is_fullscreen()?(r=t||o.clientWidth,i=n||o.clientHeight):(r=t||this.model.get("width"),i=n||this.model.get("height"));let a=r*this.renderer.getPixelRatio(),s=i*this.renderer.getPixelRatio();const c=r*this.model.get("displayscale"),u=i*this.model.get("displayscale");this.is_fullscreen()&&0!==this.model.get("volumes")&&(a=t||this.model.get("width"),s=n||this.model.get("height")),this.renderer.setSize(r,i,!1);const l=this.renderer.context.drawingBufferWidth,h=this.renderer.context.drawingBufferHeight;(l<r||h<i)&&console.info("could not set resolution to",r,i,", resolution is",l,h),this.renderer.domElement.style.width=c+"px",this.renderer.domElement.style.height=u+"px",this.canvas_container.style.width=c+"px",this.canvas_container.style.height=u+"px",this.canvas_overlay.style.width=c+"px",this.canvas_overlay.style.height=u+"px",this.canvas_overlay.width=r,this.canvas_overlay.height=i,this.model.get("stereo")&&(a/=2);const f=a/s;this.camera.aspect=f,this.camera.updateProjectionMatrix(),this.material_multivolume.uniforms.render_size.value=[a,s],this.volume_back_target.setSize(a,s),this.volume_front_target.setSize(a,s),this.geometry_depth_target.setSize(a,s),this.color_pass_target.setSize(a,s),this.screen_pass_target.setSize(a,s),this.coordinate_target.setSize(a,s),this.id_pass_target.setSize(a,s),this.screen_texture=this.color_pass_target.texture,e||this.update()}getRenderSize(){const e=this.renderer.getSize();return[e.width,e.width]}fullscreen(){s.request(this.el)}is_fullscreen(){return s.element===this.renderer.domElement}}t.FigureView=S;class T extends i.WidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"WidgetManagerHackModel",_model_module:"ipyvolume",_model_module_version:d.semver_range})}initialize(e,t){console.log(this),super.initialize(e,t),console.info("get reference to widget manager"),window.jupyter_widget_manager=this.widget_manager,window.jupyter_widgets=i}}t.WidgetManagerHackModel=T},function(e,t,n){var r,i,o,a;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */a=function(e){var t=Object.prototype.toString,n=Array.isArray||function(e){return"[object Array]"===t.call(e)};function r(e){return"function"==typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(e,t){return null!=e&&"object"==typeof e&&t in e}var a=RegExp.prototype.test,s=/\S/;function c(e){return!function(e,t){return a.call(e,t)}(s,e)}var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},l=/\s*/,h=/\s+/,f=/\s*=/,d=/\s*\}/,p=/#|\^|\/|>|\{|&|=|!/;function m(e){this.string=e,this.tail=e,this.pos=0}function g(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function v(){this.cache={}}m.prototype.eos=function(){return""===this.tail},m.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},m.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},g.prototype.push=function(e){return new g(e,this)},g.prototype.lookup=function(e){var t,n=this.cache;if(n.hasOwnProperty(e))t=n[e];else{for(var i,a,s=this,c=!1;s;){if(e.indexOf(".")>0)for(t=s.view,i=e.split("."),a=0;null!=t&&a<i.length;)a===i.length-1&&(c=o(t,i[a])),t=t[i[a++]];else t=s.view[e],c=o(s.view,e);if(c)break;s=s.parent}n[e]=t}return r(t)&&(t=t.call(this.view)),t},v.prototype.clearCache=function(){this.cache={}},v.prototype.parse=function(t,r){var o=this.cache,a=o[t];return null==a&&(a=o[t]=function(t,r){if(!t)return[];var o,a,s,u=[],g=[],v=[],_=!1,y=!1;function x(){if(_&&!y)for(;v.length;)delete g[v.pop()];else v=[];_=!1,y=!1}function b(e){if("string"==typeof e&&(e=e.split(h,2)),!n(e)||2!==e.length)throw new Error("Invalid tags: "+e);o=new RegExp(i(e[0])+"\\s*"),a=new RegExp("\\s*"+i(e[1])),s=new RegExp("\\s*"+i("}"+e[1]))}b(r||e.tags);for(var w,E,M,S,T,A,L=new m(t);!L.eos();){if(w=L.pos,M=L.scanUntil(o))for(var C=0,R=M.length;C<R;++C)c(S=M.charAt(C))?v.push(g.length):y=!0,g.push(["text",S,w,w+1]),w+=1,"\n"===S&&x();if(!L.scan(o))break;if(_=!0,E=L.scan(p)||"name",L.scan(l),"="===E?(M=L.scanUntil(f),L.scan(f),L.scanUntil(a)):"{"===E?(M=L.scanUntil(s),L.scan(d),L.scanUntil(a),E="&"):M=L.scanUntil(a),!L.scan(a))throw new Error("Unclosed tag at "+L.pos);if(T=[E,M,w,L.pos],g.push(T),"#"===E||"^"===E)u.push(T);else if("/"===E){if(!(A=u.pop()))throw new Error('Unopened section "'+M+'" at '+w);if(A[1]!==M)throw new Error('Unclosed section "'+A[1]+'" at '+w)}else"name"===E||"{"===E||"&"===E?y=!0:"="===E&&b(M)}if(A=u.pop())throw new Error('Unclosed section "'+A[1]+'" at '+L.pos);return function(e){for(var t,n=[],r=n,i=[],o=0,a=e.length;o<a;++o)switch((t=e[o])[0]){case"#":case"^":r.push(t),i.push(t),r=t[4]=[];break;case"/":i.pop()[5]=t[2],r=i.length>0?i[i.length-1][4]:n;break;default:r.push(t)}return n}(function(e){for(var t,n,r=[],i=0,o=e.length;i<o;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}(g))}(t,r)),a},v.prototype.render=function(e,t,n){var r=this.parse(e),i=t instanceof g?t:new g(t);return this.renderTokens(r,i,n,e)},v.prototype.renderTokens=function(e,t,n,r){for(var i,o,a,s="",c=0,u=e.length;c<u;++c)a=void 0,"#"===(o=(i=e[c])[0])?a=this.renderSection(i,t,n,r):"^"===o?a=this.renderInverted(i,t,n,r):">"===o?a=this.renderPartial(i,t,n,r):"&"===o?a=this.unescapedValue(i,t):"name"===o?a=this.escapedValue(i,t):"text"===o&&(a=this.rawValue(i)),void 0!==a&&(s+=a);return s},v.prototype.renderSection=function(e,t,i,o){var a=this,s="",c=t.lookup(e[1]);if(c){if(n(c))for(var u=0,l=c.length;u<l;++u)s+=this.renderTokens(e[4],t.push(c[u]),i,o);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)s+=this.renderTokens(e[4],t.push(c),i,o);else if(r(c)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(t.view,o.slice(e[3],e[5]),(function(e){return a.render(e,t,i)})))&&(s+=c)}else s+=this.renderTokens(e[4],t,i,o);return s}},v.prototype.renderInverted=function(e,t,r,i){var o=t.lookup(e[1]);if(!o||n(o)&&0===o.length)return this.renderTokens(e[4],t,r,i)},v.prototype.renderPartial=function(e,t,n){if(n){var i=r(n)?n(e[1]):n[e[1]];return null!=i?this.renderTokens(this.parse(i),t,n,i):void 0}},v.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},v.prototype.escapedValue=function(t,n){var r=n.lookup(t[1]);if(null!=r)return e.escape(r)},v.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var _=new v;return e.clearCache=function(){return _.clearCache()},e.parse=function(e,t){return _.parse(e,t)},e.render=function(e,t,r){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(n(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return _.render(e,t,r)},e.to_html=function(t,n,i,o){var a=e.render(t,n,i);if(!r(o))return a;o(a)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return u[e]}))},e.Scanner=m,e.Context=g,e.Writer=v,e},t&&"string"!=typeof t.nodeName?a(t):(i=[t],void 0===(o="function"==typeof(r=a)?r.apply(t,i):r)||(e.exports=o))},function(e,t,n){
/*!
* screenfull
* v3.3.3 - 2018-09-04
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,r="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,i=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=n.length,o={};r<i;r++)if((e=n[r])&&e[1]in t){for(r=0;r<e.length;r++)o[n[0][r]]=e[r];return o}return!1}(),o={change:i.fullscreenchange,error:i.fullscreenerror},a={request:function(e){var n=i.requestFullscreen;e=e||t.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?e[n]():e[n](r?Element.ALLOW_KEYBOARD_INPUT:{})},exit:function(){t[i.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var r=o[e];r&&t.addEventListener(r,n,!1)},off:function(e,n){var r=o[e];r&&t.removeEventListener(r,n,!1)},raw:i};i?(Object.defineProperties(a,{isFullscreen:{get:function(){return Boolean(t[i.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[i.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(t[i.fullscreenEnabled])}}}),n?e.exports=a:window.screenfull=a):n?e.exports=!1:window.screenfull=!1}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26);t.SpriteText2D=r.SpriteText2D;var i=n(28);t.MeshText2D=i.MeshText2D;var o=n(5);t.textAlign=o.textAlign},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.raycast=function(){return this.sprite.raycast.apply(this.sprite,arguments)},t.prototype.updateText=function(){this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle}),this.cleanUp(),this.texture=new o.Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:this.material=new o.SpriteMaterial({map:this.texture}),this.sprite||(this.sprite=new o.Sprite(this.material),this.geometry=this.sprite.geometry,this.add(this.sprite)),this.sprite.scale.set(this.canvas.width,this.canvas.height,1),this.sprite.position.x=this.canvas.width/2-this.canvas.textWidth/2+this.canvas.textWidth/2*this.align.x,this.sprite.position.y=-this.canvas.height/2+this.canvas.textHeight/2*this.align.y},t}(n(8).Text2D);t.SpriteText2D=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(5),o=function(){function e(){this.textWidth=null,this.textHeight=null,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}return Object.defineProperty(e.prototype,"width",{get:function(){return this.canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvas.height},enumerable:!0,configurable:!0}),e.prototype.drawText=function(e,t){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.font=t.font,this.textWidth=Math.ceil(this.ctx.measureText(e).width),this.textHeight=i.getFontHeight(this.ctx.font),this.canvas.width=r.Math.ceilPowerOfTwo(this.textWidth),this.canvas.height=r.Math.ceilPowerOfTwo(this.textHeight),this.ctx.font=t.font,this.ctx.fillStyle=t.fillStyle,this.ctx.textAlign="left",this.ctx.textBaseline="top",this.ctx.shadowColor=t.shadowColor,this.ctx.shadowBlur=t.shadowBlur,this.ctx.shadowOffsetX=t.shadowOffsetX,this.ctx.shadowOffsetY=t.shadowOffsetY,this.ctx.fillText(e,0,0),this.canvas},e}();t.CanvasText=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=function(e){function t(t,n){return void 0===t&&(t=""),void 0===n&&(n={}),e.call(this,t,n)||this}return i(t,e),t.prototype.raycast=function(){this.mesh.raycast.apply(this.mesh,arguments)},t.prototype.updateText=function(){this.cleanUp(),this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle,shadowBlur:this._shadowBlur,shadowColor:this._shadowColor,shadowOffsetX:this._shadowOffsetX,shadowOffsetY:this._shadowOffsetY}),this.texture=new o.Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:(this.material=new o.MeshBasicMaterial({map:this.texture,side:this.side}),this.material.transparent=!0),this.mesh||(this.geometry=new o.PlaneGeometry(this.canvas.width,this.canvas.height),this.mesh=new o.Mesh(this.geometry,this.material),this.add(this.mesh)),this.mesh.position.x=this.canvas.width/2-this.canvas.textWidth/2+this.canvas.textWidth/2*this.align.x,this.mesh.position.y=-this.canvas.height/2+this.canvas.textHeight/2*this.align.y,this.geometry.vertices[0].x=this.geometry.vertices[2].x=-this.canvas.width/2,this.geometry.vertices[1].x=this.geometry.vertices[3].x=this.canvas.width/2,this.geometry.vertices[0].y=this.geometry.vertices[1].y=this.canvas.height/2,this.geometry.vertices[2].y=this.geometry.vertices[3].y=-this.canvas.height/2,this.geometry.verticesNeedUpdate=!0},t}(n(8).Text2D);t.MeshText2D=a},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";n.r(t),t.default="struct Volume\n{\n    float opacity_scale;\n    float brightness;\n    vec2 data_range;\n    vec2 show_range;\n    float rows;\n    float columns;\n    float slices;\n    vec2 size;\n    vec2 slice_size;\n    bool clamp_min;\n    bool clamp_max;\n    vec3 scale;\n    vec3 offset;\n    bool lighting;\n\n    // phong lighting models parameters\n    vec3 diffuseColor;\n    vec3 specular;\n    vec3 emissive;\n    float shininess;\n};\n\nvec2 compute_slice_offset(float slice, float columns, vec2 uv_slice_spacing) {\n    float column = floor((slice+0.5) / (columns));\n    float row = slice - column * columns;\n    return uv_slice_spacing * vec2(row, column);\n}\n\nvec4 sample_as_3d_texture(sampler2D tex, vec2 tex_size, vec3 texCoord, vec2 slice_size, float slices, float rows, float columns) {\n  float slice   = texCoord.z*slices*(slices-1.)/slices ;\n  float slice_z  = floor(slice);\n  float slice_z_offset = fract(slice);\n\n  vec2 pixel = 1./tex_size;\n  vec2 uv_slice_spacing = slice_size/tex_size;\n\n  vec2 coord = vec2(texCoord.x, texCoord.y);\n  vec2 uv = pixel * 0.5 + coord * (uv_slice_spacing - pixel);\n\n  vec2 slice0_offset = compute_slice_offset(slice_z, columns, uv_slice_spacing);\n  vec2 slice1_offset = compute_slice_offset(slice_z + 1.0, columns, uv_slice_spacing);\n\n  vec4 slice0_color = texture2D(tex, slice0_offset + uv);\n  vec4 slice1_color = texture2D(tex, slice1_offset + uv);\n  return mix(slice0_color, slice1_color, slice_z_offset);\n}"},function(e,t,n){"use strict";e.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t){e.exports=i,i.strict=o,i.loose=a;var n=Object.prototype.toString,r={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function i(e){return o(e)||a(e)}function o(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function a(e){return r[n.call(e)]}},function(e){e.exports=JSON.parse('{"name":"ipyvolume","version":"0.6.3","description":"IPython widget for rendering 3d volumes","author":"Maarten A. Breddels","main":"lib/index.js","repository":{"type":"git","url":"https://github.com/maartenbreddels/ipyvolume.git"},"keywords":["jupyter","widgets","ipython","ipywidgets"],"license":"MIT","scripts":{"install-test":"npm install && karma start --single-run","test":"karma start --single-run","build":"npm run build:lib && npm run build:labextension && webpack --mode=production","build:lib":"tsc --project .","build:labextension":"jupyter labextension build .","prepare":"npm run build","watch":"npm-run-all -p watch:*","watch:lib":"tsc -w --project .","watch:nbextension":"webpack --watch --mode=development","watch:labextension":"jupyter labextension watch .","watch:dev":"npm-run-all -p watch:lib watch:nbextension"},"jupyterlab":{"extension":"lib/labplugin","outputDir":"../share/jupyter/labextensions/ipyvolume","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}},"devDependencies":{"@jupyterlab/builder":"^3.0.0","@types/chai":"^4.1.4","@types/d3":"^5.7.2","@types/expect.js":"^0.3.29","@types/mocha":"^2.2.48","@types/node":"^12.0.2","@types/requirejs":"^2.1.31","@types/three":"^0.93.4","bqplot":"^0.5.0","chai":"^4.1.2","eslint":"^5.13.0","eslint-config-standard":"^12.0.0","eslint-plugin-import":"^2.16.0","eslint-plugin-node":"^8.0.1","eslint-plugin-promise":"^4.0.1","eslint-plugin-standard":"^4.0.0","json-loader":"^0.5.4","jupyter-threejs":"^2.3.0","karma":"^4.0.0","karma-chai":"^0.1.0","karma-chrome-launcher":"^2.0.0","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^3.0.5","mocha":"^3.5.3","npm-run-all":"^4.1.3","raw-loader":"~3.0.0","sinon":"^2.4.1","sinon-chai":"^2.11.0","source-map-loader":"^0.2.4","typescript":"^3.5.2","url-loader":"^0.5.7","webpack":"^4.29.1","webpack-cli":"^3.2.3"},"dependencies":{"@jupyter-widgets/base":"^1 || ^2.0.2 || ^3 || ^4 || ^5 || ^6","@jupyter-widgets/controls":"^1 || ^2","css-loader":"^0.28.4","d3":"^5.7.0","gl-matrix":"^2.0.0","is-typedarray":"~1.0.0","jquery":"^3.1.1","jslink":"^1.1.3","lodash":"^4.17.15","mustache":"^2.3.1","ndarray":"~1.0.18","ndarray-pack":"^1.2.1","screenfull":"^3.3.1","style-loader":"^0.18.2","three":"^0.97.0","three-text2d":"~0.4.1","tslint":"^5.20.0","underscore":"^1.8.3","webrtc-adapter":"^4.2.2"},"files":["dist/","css/","src/","lib/*.js","lib/three/*.js","data/","glsl/"]}')},function(e,t,n){e.exports=n(37)({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},function(e,t,n){"use strict";var r=n(38);function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}e.exports=function(e){var t=new i;t.pre=e.pre,t.body=e.body,t.post=e.post;var n=e.args.slice(0);t.argTypes=n;for(var o=0;o<n.length;++o){var a=n[o];if("array"===a||"object"==typeof a&&a.blockIndices){if(t.argTypes[o]="array",t.arrayArgs.push(o),t.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),t.shimArgs.push("array"+o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)t.scalarArgs.push(o),t.shimArgs.push("scalar"+o);else if("index"===a){if(t.indexArgs.push(o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(t.shapeArgs.push(o),o<t.pre.args.length&&t.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<t.post.args.length&&t.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof a||!a.offset)throw new Error("cwise: Unknown argument type "+n[o]);t.argTypes[o]="offset",t.offsetArgs.push({array:a.array,offset:a.offset}),t.offsetArgIndex.push(o)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,r(t)}},function(e,t,n){"use strict";var r=n(39);e.exports=function(e){var t=["'use strict'","var CACHED={}"],n=[],i=e.funcName+"_cwise_thunk";t.push(["return function ",i,"(",e.shimArgs.join(","),"){"].join(""));for(var o=[],a=[],s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],c=[],u=[],l=0;l<e.arrayArgs.length;++l){var h=e.arrayArgs[l];n.push(["t",h,"=array",h,".dtype,","r",h,"=array",h,".order"].join("")),o.push("t"+h),o.push("r"+h),a.push("t"+h),a.push("r"+h+".join()"),s.push("array"+h+".data"),s.push("array"+h+".stride"),s.push("array"+h+".offset|0"),l>0&&(c.push("array"+e.arrayArgs[0]+".shape.length===array"+h+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[l]))),u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+h+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[l])+"]"))}for(e.arrayArgs.length>1&&(t.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),l=0;l<e.scalarArgs.length;++l)s.push("scalar"+e.scalarArgs[l]);return n.push(["type=[",a.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(r.bind(void 0,e))}},function(e,t,n){"use strict";var r=n(40);function i(e,t,n){var r,i,o=e.length,a=t.arrayArgs.length,s=t.indexArgs.length>0,c=[],u=[],l=0,h=0;for(r=0;r<o;++r)u.push(["i",r,"=0"].join(""));for(i=0;i<a;++i)for(r=0;r<o;++r)h=l,l=e[r],0===r?u.push(["d",i,"s",r,"=t",i,"p",l].join("")):u.push(["d",i,"s",r,"=(t",i,"p",l,"-s",h,"*t",i,"p",h,")"].join(""));for(u.length>0&&c.push("var "+u.join(",")),r=o-1;r>=0;--r)l=e[r],c.push(["for(i",r,"=0;i",r,"<s",l,";++i",r,"){"].join(""));for(c.push(n),r=0;r<o;++r){for(h=l,l=e[r],i=0;i<a;++i)c.push(["p",i,"+=d",i,"s",r].join(""));s&&(r>0&&c.push(["index[",h,"]-=s",h].join("")),c.push(["++index[",l,"]"].join(""))),c.push("}")}return c.join("\n")}function o(e,t,n){for(var r=e.body,i=[],o=[],a=0;a<e.args.length;++a){var s=e.args[a];if(!(s.count<=0)){var c=new RegExp(s.name,"g"),u="",l=t.arrayArgs.indexOf(a);switch(t.argTypes[a]){case"offset":var h=t.offsetArgIndex.indexOf(a);l=t.offsetArgs[h].array,u="+q"+h;case"array":u="p"+l+u;var f="l"+a,d="a"+l;if(0===t.arrayBlockIndices[l])1===s.count?"generic"===n[l]?s.lvalue?(i.push(["var ",f,"=",d,".get(",u,")"].join("")),r=r.replace(c,f),o.push([d,".set(",u,",",f,")"].join(""))):r=r.replace(c,[d,".get(",u,")"].join("")):r=r.replace(c,[d,"[",u,"]"].join("")):"generic"===n[l]?(i.push(["var ",f,"=",d,".get(",u,")"].join("")),r=r.replace(c,f),s.lvalue&&o.push([d,".set(",u,",",f,")"].join(""))):(i.push(["var ",f,"=",d,"[",u,"]"].join("")),r=r.replace(c,f),s.lvalue&&o.push([d,"[",u,"]=",f].join("")));else{for(var p=[s.name],m=[u],g=0;g<Math.abs(t.arrayBlockIndices[l]);g++)p.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(g+1)+"*t"+l+"b"+g);if(c=new RegExp(p.join(""),"g"),u=m.join("+"),"generic"===n[l])throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(c,[d,"[",u,"]"].join(""))}break;case"scalar":r=r.replace(c,"Y"+t.scalarArgs.indexOf(a));break;case"index":r=r.replace(c,"index");break;case"shape":r=r.replace(c,"shape")}}}return[i.join("\n"),r,o.join("\n")].join("\n").trim()}function a(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var i=e[r],o=i.match(/\d+/);o=o?o[0]:"",0===i.charAt(0)?t[r]="u"+i.charAt(1)+o:t[r]=i.charAt(0)+o,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}e.exports=function(e,t){for(var n=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,s=new Array(e.arrayArgs.length),c=new Array(e.arrayArgs.length),u=0;u<e.arrayArgs.length;++u)c[u]=t[2*u],s[u]=t[2*u+1];var l=[],h=[],f=[],d=[],p=[];for(u=0;u<e.arrayArgs.length;++u){e.arrayBlockIndices[u]<0?(f.push(0),d.push(n),l.push(n),h.push(n+e.arrayBlockIndices[u])):(f.push(e.arrayBlockIndices[u]),d.push(e.arrayBlockIndices[u]+n),l.push(0),h.push(e.arrayBlockIndices[u]));for(var m=[],g=0;g<s[u].length;g++)f[u]<=s[u][g]&&s[u][g]<d[u]&&m.push(s[u][g]-f[u]);p.push(m)}var v=["SS"],_=["'use strict'"],y=[];for(g=0;g<n;++g)y.push(["s",g,"=SS[",g,"]"].join(""));for(u=0;u<e.arrayArgs.length;++u){v.push("a"+u),v.push("t"+u),v.push("p"+u);for(g=0;g<n;++g)y.push(["t",u,"p",g,"=t",u,"[",f[u]+g,"]"].join(""));for(g=0;g<Math.abs(e.arrayBlockIndices[u]);++g)y.push(["t",u,"b",g,"=t",u,"[",l[u]+g,"]"].join(""))}for(u=0;u<e.scalarArgs.length;++u)v.push("Y"+u);if(e.shapeArgs.length>0&&y.push("shape=SS.slice(0)"),e.indexArgs.length>0){var x=new Array(n);for(u=0;u<n;++u)x[u]="0";y.push(["index=[",x.join(","),"]"].join(""))}for(u=0;u<e.offsetArgs.length;++u){var b=e.offsetArgs[u],w=[];for(g=0;g<b.offset.length;++g)0!==b.offset[g]&&(1===b.offset[g]?w.push(["t",b.array,"p",g].join("")):w.push([b.offset[g],"*t",b.array,"p",g].join("")));0===w.length?y.push("q"+u+"=0"):y.push(["q",u,"=",w.join("+")].join(""))}var E=r([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for((y=y.concat(E)).length>0&&_.push("var "+y.join(",")),u=0;u<e.arrayArgs.length;++u)_.push("p"+u+"|=0");e.pre.body.length>3&&_.push(o(e.pre,e,c));var M=o(e.body,e,c),S=function(e){for(var t=0,n=e[0].length;t<n;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}(p);S<n?_.push(function(e,t,n,r){for(var o=t.length,a=n.arrayArgs.length,s=n.blockSize,c=n.indexArgs.length>0,u=[],l=0;l<a;++l)u.push(["var offset",l,"=p",l].join(""));for(l=e;l<o;++l)u.push(["for(var j"+l+"=SS[",t[l],"]|0;j",l,">0;){"].join("")),u.push(["if(j",l,"<",s,"){"].join("")),u.push(["s",t[l],"=j",l].join("")),u.push(["j",l,"=0"].join("")),u.push(["}else{s",t[l],"=",s].join("")),u.push(["j",l,"-=",s,"}"].join("")),c&&u.push(["index[",t[l],"]=j",l].join(""));for(l=0;l<a;++l){for(var h=["offset"+l],f=e;f<o;++f)h.push(["j",f,"*t",l,"p",t[f]].join(""));u.push(["p",l,"=(",h.join("+"),")"].join(""))}for(u.push(i(t,n,r)),l=e;l<o;++l)u.push("}");return u.join("\n")}(S,p[0],e,M)):_.push(i(p[0],e,M)),e.post.body.length>3&&_.push(o(e.post,e,c)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+_.join("\n")+"\n----------");var T=[e.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",S,a(c)].join("");return new Function(["function ",T,"(",v.join(","),"){",_.join("\n"),"} return ",T].join(""))()}},function(e,t,n){"use strict";e.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,i=e[0],o=e[0],a=1;a<r;++a)if(o=i,t(i=e[a],o)){if(a===n){n++;continue}e[n++]=i}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],i=e[0],o=1;o<n;++o,i=r)if(i=r,(r=e[o])!==i){if(o===t){t++;continue}e[t++]=r}return e.length=t,e}(e))}},function(e,t,n){"use strict";n.r(t),t.default="// mesh-vertex shader\n#define USE_SCALE_X\n#define USE_SCALE_Y\n#define USE_SCALE_Z\n#include <scales>\n#include <ipyvolume>\n\n\n // for animation, all between 0 and 1\nuniform float animation_time_x;\nuniform float animation_time_y;\nuniform float animation_time_z;\nuniform float animation_time_u;\nuniform float animation_time_v;\nuniform float animation_time_color;\n\nuniform vec2 domain_x;\nuniform vec2 domain_y;\nuniform vec2 domain_z;\n\nvarying vec4 vertex_color;\nvarying vec3 vertex_position;\nvarying vec3 vPositionEye;\n\nattribute vec3 position_previous;\nuniform vec3 position_offset;\n\n#ifdef USE_TEXTURE\n    attribute float u;\n    attribute float v;\n    attribute float u_previous;\n    attribute float v_previous;\n    varying vec2 vertex_uv;\n#endif\n\n#ifdef USE_COLORMAP\n    attribute float color_current;\n    attribute float color_previous;\n    uniform vec2 domain_color;\n#else\n    attribute vec4 color_current;\n    attribute vec4 color_previous;\n#endif\nuniform sampler2D colormap;\n\nuniform float id_offset;\n\nvec4 encodeId(float v) {\n    vec4 color;\n    // matches Figure.readId\n    color.b = floor(v / 256.0 / 256.0);\n    color.g = floor((v - color.b * 256.0 * 256.0) / 256.0);\n    color.r = floor(v - color.b * 256.0 * 256.0 - color.g * 256.0);\n    color.a = 255.0;\n    // normalize\n    return color / 255.0;\n}\n\n#if defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n    // similar to phong\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <uv2_pars_vertex>\n    #include <envmap_pars_vertex>\n    #include <bsdfs>\n    #include <lights_pars_begin>\n    #include <color_pars_vertex>\n    #include <fog_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <shadowmap_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n\n#ifdef AS_LAMBERT\n    #define LAMBERT\n    varying vec3 vLightFront;\n\n    #ifdef DOUBLE_SIDED\n        varying vec3 vLightBack;\n    #endif\n\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <uv2_pars_vertex>\n    #include <envmap_pars_vertex>\n    #include <bsdfs>\n    #include <lights_pars_begin>\n    #include <color_pars_vertex>\n    #include <fog_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <shadowmap_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //AS_LAMBERT\n\n#ifdef AS_PHONG\n    #define PHONG\n    varying vec3 vViewPosition;\n\n    #ifndef FLAT_SHADED\n        varying vec3 vNormal;\n    #endif\n\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <uv2_pars_vertex>\n    #include <displacementmap_pars_vertex>\n    #include <envmap_pars_vertex>\n    #include <color_pars_vertex>\n    #include <fog_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <shadowmap_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //AS_PHONG\n\n#ifdef AS_PHYSICAL\n    #define PHYSICAL\n    varying vec3 vViewPosition;\n\n    #ifndef FLAT_SHADED\n        varying vec3 vNormal;\n    #endif\n\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <uv2_pars_vertex>\n    #include <displacementmap_pars_vertex>\n    #include <color_pars_vertex>\n    #include <fog_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <shadowmap_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //AS_PHYSICAL\n#ifdef AS_DEPTH\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <displacementmap_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //AS_DEPTH\n#ifdef AS_DISTANCE\n    #define DISTANCE\n\n    varying vec3 vWorldPosition;\n\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <displacementmap_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //AS_DISTANCE\n\nvoid main(void) {\n#if defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n    #include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n#endif //defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n#ifdef AS_LAMBERT\n    #include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n#endif //AS_LAMBERT\n#ifdef AS_PHONG\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n    #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\t    vNormal = normalize( transformedNormal );\n    #endif\n\n\t#include <begin_vertex>\n#endif //AS_PHONG\n#ifdef AS_PHYSICAL\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n    #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\t    vNormal = normalize( transformedNormal );\n    #endif\n\n\t#include <begin_vertex>\n#endif //AS_PHYSICAL\n#ifdef AS_DEPTH\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n#endif //AS_DEPTH\n#ifdef AS_DISTANCE\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n#endif //AS_DISTANCE\n\n    vec3 animation_time = vec3(animation_time_x, animation_time_y, animation_time_z);\n    vec3 animated_position = mix(position_previous, position, animation_time) + position_offset;\n\n    transformed = vec3(SCALE_X(animated_position.x), SCALE_Y(animated_position.y), SCALE_Z(animated_position.z));\n    vertex_position = transformed;\n    // gl_Position = projectionMatrix *\n    //             modelViewMatrix *\n    //             vec4(model_pos, 1.0);\n    // vec3 positionEye = ( modelViewMatrix * vec4(model_pos, 1.0 ) ).xyz;\n    // vertex_position = positionEye;\n\n    #if defined( AS_COORDINATE )\n        // vertex_color = vec4(model_pos + vec3(0.5, 0.5, 0.5), 1.0);\n        vertex_color = vec4(transformed + vec3(0.5, 0.5, 0.5), 1.0);\n    #elif defined( AS_ID )\n        vertex_color = encodeId(id_offset);\n    #else\n        #ifdef USE_COLORMAP\n            float color_animated = mix(color_previous, color_current, animation_time_color);\n            float color_index = scale_transform_linear(color_animated, vec2(0.0, 1.0), domain_color);\n            vertex_color = texture2D(colormap, vec2(color_index, 0));\n        #else\n            vertex_color = mix(color_previous, color_current, animation_time_color);\n        #endif\n    #endif\n\n\n#if defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );;\n    // vec3 model_pos = vec3(SCALE_X(animated_position.x), SCALE_Y(animated_position.y), SCALE_Z(animated_position.z));\n    // gl_Position = projectionMatrix *\n    //             modelViewMatrix *\n    //             vec4(model_pos, 1.0);\n    // vec3 positionEye = ( modelViewMatrix * vec4(model_pos, 1.0 ) ).xyz;\n    // vertex_position = positionEye;\n#endif //defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n\n#ifdef USE_TEXTURE\n    vertex_uv = vec2(mix(u_previous, u, animation_time_u), mix(v_previous, v, animation_time_v));\n#endif\n\n    #if defined(USE_COLOR) && !(defined(AS_DEPTH) || defined(AS_DISTANCE))\n        vColor = vertex_color.rgb;\n    #endif\n\n\n#if defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n    vec3 positionEye = ( modelViewMatrix * vec4(transformed, 1.0 ) ).xyz;\n    vPositionEye = positionEye;\n\t// #include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#endif //defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n#ifdef AS_LAMBERT\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#endif //AS_LAMBERT\n#ifdef AS_PHONG\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#endif //AS_PHONG\n#ifdef AS_PHYSICAL\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#endif //AS_PHYSICAL\n#ifdef AS_DISTANCE\n    #include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvWorldPosition = worldPosition.xyz;\n#endif //AS_DISTANCE\n#ifdef AS_DEPTH\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#endif //AS_DEPTH\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#include <ipyvolume>\n\n#ifdef USE_VOLUME\nuniform sampler2D volume_texture;\nuniform sampler2D transfer_function;\nuniform Volume volume;\n#endif //USE_VOLUME\n\n\n// mesh-fragment shader\n#if defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\nvarying vec4 vertex_color;\nvarying vec3 vertex_position;\nvarying vec2 vertex_uv;\nvarying vec3 vPositionEye;\n\n#ifdef USE_TEXTURE\n    uniform sampler2D texture;\n    uniform sampler2D texture_previous;\n    uniform float animation_time_texture;\n#endif\n\n    // taken similar to phong shading\n    #include <common>\n    #include <packing>\n    #include <dithering_pars_fragment>\n    #include <color_pars_fragment>\n    #include <uv_pars_fragment>\n    #include <uv2_pars_fragment>\n    #include <map_pars_fragment>\n    #include <alphamap_pars_fragment>\n    #include <aomap_pars_fragment>\n    #include <lightmap_pars_fragment>\n    #include <emissivemap_pars_fragment>\n    #include <envmap_pars_fragment>\n    #include <gradientmap_pars_fragment>\n    #include <fog_pars_fragment>\n    #include <bsdfs>\n    #include <lights_pars_begin>\n    // #include <lights_phong_pars_fragment>\n    #include <shadowmap_pars_fragment>\n    #include <shadowmask_pars_fragment> // extra compared to phong\n\n    #include <bumpmap_pars_fragment>\n    #include <normalmap_pars_fragment>\n    #include <specularmap_pars_fragment>\n    #include <logdepthbuf_pars_fragment>\n    #include <clipping_planes_pars_fragment>\n    void main(void)\n    {\n        #if defined( AS_COORDINATE ) || defined( AS_ID )\n            // should we ignore shading for RGB pass?\n            gl_FragColor = vec4(vertex_color.rgb, 1.0);\n        #else\n            // 0 when in shadow, 1 if visible\n            float shadow_visibility = getShadowMask();\n            #ifdef IS_LINE\n                gl_FragColor = vec4(vertex_color.rgb * shadow_visibility, vertex_color.a);\n            #else\n                vec3 fdx = dFdx( vPositionEye );\n                vec3 fdy = dFdy( vPositionEye );\n                vec3 normal = normalize( cross( fdx, fdy ) );\n                float diffuse = dot( normal, vec3( 0.0, 0.0, 1.0 ) );\n\n                #if defined(USE_TEXTURE)\n                    vec4 sample = mix(texture2D(texture_previous, vertex_uv), texture2D(texture, vertex_uv), animation_time_texture);\n                    gl_FragColor = vec4(clamp(diffuse, 0.2, 1.) * sample.rgb * shadow_visibility, 1.0);\n                #elif defined(USE_VOLUME)\n\t\t\t\t\tvec3 sample_position = vertex_position*volume.scale + vec3(0.5, 0.5, 0.5);\n\t\t\t\t\tvec4 sample = sample_as_3d_texture(volume_texture, volume.size, sample_position, volume.slice_size, volume.slices, volume.rows, volume.columns);\n\n\t\t\t\t\t// quite similar to volr-fragment.glsl\n\t\t\t\t\tfloat raw_data_value = sample.a;\n\t\t\t\t\tfloat scaled_data_value = (raw_data_value*(volume.data_range[1] - volume.data_range[0])) + volume.data_range[0];\n\t\t\t\t\tfloat data_value = (scaled_data_value - volume.show_range[0])/(volume.show_range[1] - volume.show_range[0]);\n\t\t\t\t\tvec4 color_sample = texture2D(transfer_function, vec2(data_value, 0.5));\n\n\t\t\t\t\t// TODO: 30 should be configurable\n\t\t\t\t\tgl_FragColor.rgb = color_sample.rgb * volume.brightness * color_sample.a * 30.;\n\t\t\t\t\tgl_FragColor.a = 1.;\n                #else\n                    gl_FragColor = vec4(clamp(diffuse, 0.2, 1.) * vertex_color.rgb * shadow_visibility, vertex_color.a);\n                #endif // USE_TEXTURE / USE_VOLUME\n            #endif // IS_LINE\n        #endif // defined( AS_COORDINATE ) || defined( AS_ID )\n    }\n#endif //defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n\n\n\n#ifdef AS_LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\n\n#ifdef DOUBLE_SIDED\n\n\tvarying vec3 vLightBack;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n#endif //AS_LAMBERT\n#ifdef AS_PHONG\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n#endif //AS_PHONG\n#ifdef AS_PHYSICAL\n    #define PHYSICAL\n    uniform vec3 diffuse;\n    uniform vec3 emissive;\n    uniform float roughness;\n    uniform float metalness;\n    uniform float opacity;\n    uniform float emissiveIntensity;\n\n    #ifndef STANDARD\n        uniform float clearCoat;\n        uniform float clearCoatRoughness;\n    #endif\n\n    varying vec3 vViewPosition;\n\n    #ifndef FLAT_SHADED\n        varying vec3 vNormal;\n    #endif\n\n    #include <common>\n    #include <packing>\n    #include <dithering_pars_fragment>\n    #include <color_pars_fragment>\n    #include <uv_pars_fragment>\n    #include <uv2_pars_fragment>\n    #include <map_pars_fragment>\n    #include <alphamap_pars_fragment>\n    #include <aomap_pars_fragment>\n    #include <lightmap_pars_fragment>\n    #include <emissivemap_pars_fragment>\n    #include <bsdfs>\n    #include <cube_uv_reflection_fragment>\n    #include <envmap_pars_fragment>\n    #include <envmap_physical_pars_fragment>\n    #include <fog_pars_fragment>\n    #include <lights_pars_begin>\n    #include <lights_physical_pars_fragment>\n    #include <shadowmap_pars_fragment>\n    #include <bumpmap_pars_fragment>\n    #include <normalmap_pars_fragment>\n    #include <roughnessmap_pars_fragment>\n    #include <metalnessmap_pars_fragment>\n    #include <logdepthbuf_pars_fragment>\n    #include <clipping_planes_pars_fragment>\n\nvoid main(void)\n{\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0, 1.0, 1.0, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive * emissiveIntensity;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n#endif //AS_PHYSICAL\n#ifdef AS_DISTANCE\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist ); // clamp to [ 0, 1 ]\n\n\tgl_FragColor = packDepthToRGBA( dist );\n\n}\n#endif//AS_DISTANCE\n\n#ifdef AS_DEPTH\n#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\n\t#endif\n\n}\n#endif //AS_DEPTH\n"},function(e){e.exports=JSON.parse('{"normals":[[0.6722792983055115,0.7387584447860718,0.04771288111805916],[0.7488530874252319,0.6626735329627991,0.009104926139116287],[0.992845356464386,0.1163879781961441,-0.026680562645196915],[0.988349199295044,0.1501944661140442,-0.0246476661413908],[0.9485647082328796,-0.2816155254840851,-0.14462943375110626],[0.925125002861023,-0.375169962644577,-0.058234188705682755],[0.988349199295044,0.1501944661140442,-0.0246476661413908],[0.992845356464386,0.1163879781961441,-0.026680562645196915],[0.9870246648788452,-0.13484345376491547,0.08717460930347443],[0.9485647082328796,-0.2816155254840851,-0.14462943375110626],[0.992845356464386,0.1163879781961441,-0.026680562645196915],[0.9768072366714478,0.1450829803943634,0.1574755609035492],[0.9768072366714478,0.1450829803943634,0.1574755609035492],[0.992845356464386,0.1163879781961441,-0.026680562645196915],[0.7488530874252319,0.6626735329627991,0.009104926139116287],[0.7618468403816223,0.646384596824646,0.04214463010430336],[0.4218263030052185,0.893310010433197,-0.15511257946491241],[0.35690364241600037,0.9336850047111511,-0.029189903289079666],[0.2723502814769745,0.9614163041114807,-0.03878369182348251],[0.2525371015071869,0.9163177609443665,-0.3107839524745941],[0.9953411221504211,0.09576618671417236,0.011168275028467178],[0.6457383632659912,0.7610315084457397,0.06207112967967987],[0.6722792983055115,0.7387584447860718,0.04771288111805916],[0.988349199295044,0.1501944661140442,-0.0246476661413908],[0.9291253089904785,-0.3697633743286133,-0.0010595708154141903],[0.9953411221504211,0.09576618671417236,0.011168275028467178],[0.988349199295044,0.1501944661140442,-0.0246476661413908],[0.925125002861023,-0.375169962644577,-0.058234188705682755],[-0.007396361790597439,-0.9999653697013855,0.003803872736170888],[-0.009718821384012699,-0.9997833967208862,-0.018406139686703682],[-0.007655521389096975,-0.9999698996543884,0.001327343052253127],[0.5234197378158569,0.8474974632263184,-0.08820322155952454],[0.8727967739105225,0.48596683144569397,-0.04540829733014107],[0.6919021606445312,0.6509979963302612,-0.3122063875198364],[0.5376883745193481,0.8232352137565613,-0.18213941156864166],[0.6919021606445312,0.6509979963302612,-0.3122063875198364],[0.8727967739105225,0.48596683144569397,-0.04540829733014107],[0.9940851926803589,0.10859742015600204,0.0011142655275762081],[0.8643118143081665,0.35945847630500793,-0.35178789496421814],[-0.003276081522926688,-0.9999516010284424,0.00927703082561493],[-0.0032760819885879755,-0.9999516606330872,0.00927703082561493],[-0.003276081522926688,-0.9999516010284424,0.009277029894292355],[-0.003276081755757332,-0.9999516606330872,0.009277029894292355],[0.5376883745193481,0.8232352137565613,-0.18213941156864166],[0.6919021606445312,0.6509979963302612,-0.3122063875198364],[0.37462636828422546,0.6200053691864014,-0.6893826723098755],[0.41769927740097046,0.4760781228542328,-0.7738713026046753],[0.6919021606445312,0.6509979963302612,-0.3122063875198364],[0.8643118143081665,0.35945847630500793,-0.35178789496421814],[0.34577468037605286,0.5889291763305664,-0.7304808497428894],[0.37462636828422546,0.6200053691864014,-0.6893826723098755],[0.9940851926803589,0.10859742015600204,0.0011142655275762081],[0.994776725769043,-0.10139967501163483,0.011717659421265125],[0.9535025358200073,0.03478159382939339,-0.29937097430229187],[0.8643118143081665,0.35945847630500793,-0.35178789496421814],[0.5455085635185242,-0.8378602266311646,0.020260393619537354],[0.9291253089904785,-0.3697633743286133,-0.0010595708154141903],[0.925125002861023,-0.375169962644577,-0.058234188705682755],[0.5313248038291931,-0.8438926935195923,-0.07442483305931091],[0.9477870464324951,-0.3114435374736786,0.06857644021511078],[0.7406501770019531,-0.43752405047416687,-0.5099119544029236],[0.9485647082328796,-0.2816155254840851,-0.14462943375110626],[0.9870246648788452,-0.13484345376491547,0.08717460930347443],[0.7618468403816223,0.646384596824646,0.04214463010430336],[0.8426366448402405,0.4910145699977875,0.22106125950813293],[0.9381476044654846,0.19051600992679596,0.28910666704177856],[0.9768072366714478,0.1450829803943634,0.1574755609035492],[0.7488530874252319,0.6626735329627991,0.009104926139116287],[0.35690364241600037,0.9336850047111511,-0.029189903289079666],[0.4218263030052185,0.893310010433197,-0.15511257946491241],[0.7618468403816223,0.646384596824646,0.04214463010430336],[0.3756128251552582,0.9234598278999329,0.0783376395702362],[0.35690364241600037,0.9336850047111511,-0.029189903289079666],[0.7488530874252319,0.6626735329627991,0.009104926139116287],[0.6722792983055115,0.7387584447860718,0.04771288111805916],[0.6457383632659912,0.7610315084457397,0.06207112967967987],[0.38265588879585266,0.9199751615524292,0.08497147262096405],[0.3756128251552582,0.9234598278999329,0.0783376395702362],[0.6722792983055115,0.7387584447860718,0.04771288111805916],[0.5150745511054993,0.8528239727020264,-0.08596205711364746],[0.426266610622406,0.8994579315185547,-0.09629113972187042],[0.5234197378158569,0.8474974632263184,-0.08820322155952454],[0.5376883745193481,0.8232352137565613,-0.18213941156864166],[0.7433125972747803,-0.6685736179351807,0.02226567082107067],[0.7520958781242371,-0.6584120392799377,0.02907477132976055],[0.28822171688079834,-0.9561523795127869,0.05196940153837204],[0.29988452792167664,-0.9533481597900391,0.034590303897857666],[0.8036648631095886,0.5537902116775513,-0.217805415391922],[0.6157482266426086,0.7863949537277222,-0.049367424100637436],[0.5150745511054993,0.8528239727020264,-0.08596205711364746],[0.5376883745193481,0.8232352137565613,-0.18213941156864166],[0.7460655570030212,-0.6658671498298645,0.0026501123793423176],[0.7433125972747803,-0.6685736179351807,0.02226567082107067],[0.29988452792167664,-0.9533481597900391,0.034590303897857666],[0.31369441747665405,-0.9492788314819336,0.02157321386039257],[0.9991246461868286,-0.034952837973833084,-0.022984294220805168],[0.812343418598175,0.5824594497680664,-0.0289674773812294],[0.7433125972747803,-0.6685736179351807,0.02226567082107067],[0.7460655570030212,-0.6658671498298645,0.0026501123793423176],[0.9962080717086792,-0.0641126036643982,-0.05881289765238762],[0.9991246461868286,-0.034952837973833084,-0.022984294220805168],[0.7460655570030212,-0.6658671498298645,0.0026501123793423176],[0.7457423210144043,-0.6656472086906433,-0.027963895350694656],[0.7457423210144043,-0.6656472086906433,-0.027963895350694656],[0.7460655570030212,-0.6658671498298645,0.0026501123793423176],[0.31369441747665405,-0.9492788314819336,0.02157321386039257],[0.34119275212287903,-0.9399923086166382,0.0014598877169191837],[0.996460497379303,-0.06455107778310776,-0.053849659860134125],[0.9962080717086792,-0.0641126036643982,-0.05881289765238762],[0.7457423210144043,-0.6656472086906433,-0.027963895350694656],[0.7923128604888916,-0.6072733998298645,-0.05881620571017265],[0.7923128604888916,-0.6072733998298645,-0.05881620571017265],[0.7457423210144043,-0.6656472086906433,-0.027963895350694656],[0.34119275212287903,-0.9399923086166382,0.0014598877169191837],[0.3986782729625702,-0.9157551527023315,-0.04947711527347565],[0.9978228807449341,-0.05201764032244682,-0.040543824434280396],[0.996460497379303,-0.06455107778310776,-0.053849659860134125],[0.7923128604888916,-0.6072733998298645,-0.05881620571017265],[0.8045254349708557,-0.5899364948272705,-0.06865765154361725],[0.8045254349708557,-0.5899364948272705,-0.06865765154361725],[0.7923128604888916,-0.6072733998298645,-0.05881620571017265],[0.3986782729625702,-0.9157551527023315,-0.04947711527347565],[0.42811119556427,-0.9006050229072571,-0.07504191249608994],[0.9999374747276306,-0.010656150989234447,-0.0033726822584867477],[0.9999375343322754,-0.010656150989234447,-0.003372682724148035],[0.9999374747276306,-0.010656150057911873,-0.0033726817928254604],[0.9999375343322754,-0.010656151920557022,-0.0033726824913173914],[0.4665221869945526,-0.8773672580718994,-0.1121765673160553],[0.4665221571922302,-0.8773673176765442,-0.1121765673160553],[0.4665221869945526,-0.877367377281189,-0.1121765673160553],[0.4665221869945526,-0.877367377281189,-0.1121765673160553],[0.998106837272644,0.010563117451965809,-0.060587748885154724],[0.9981068968772888,0.010563117451965809,-0.060587748885154724],[0.9981070160865784,0.010563119314610958,-0.06058775633573532],[0.9981069564819336,0.010563118383288383,-0.06058775261044502],[0.511317789554596,-0.8463999629020691,-0.14886613190174103],[0.511317789554596,-0.8464000821113586,-0.14886613190174103],[0.5113177299499512,-0.8463999629020691,-0.14886613190174103],[0.511317789554596,-0.8463999629020691,-0.14886611700057983],[0.7703723907470703,0.364370197057724,-0.5232215523719788],[0.7184544801712036,0.4904933571815491,-0.4931929409503937],[0.7226928472518921,-0.0716477632522583,-0.6874456405639648],[0.7748353481292725,0.075252965092659,-0.6276678442955017],[0.7748353481292725,0.075252965092659,-0.6276678442955017],[0.7226928472518921,-0.0716477632522583,-0.6874456405639648],[0.3967260420322418,-0.543319821357727,-0.739872932434082],[0.36102649569511414,0.7485342025756836,0.5561981797218323],[0.36102646589279175,0.7485341429710388,0.5561981201171875],[0.43389180302619934,0.48191967606544495,0.7612432837486267],[0.4282975196838379,0.5146201848983765,0.7427835464477539],[0.3756128251552582,0.9234598278999329,0.0783376395702362],[0.30924931168556213,0.946604311466217,0.09113304316997528],[0.2723502814769745,0.9614163041114807,-0.03878369182348251],[0.35690364241600037,0.9336850047111511,-0.029189903289079666],[0.38265588879585266,0.9199751615524292,0.08497147262096405],[0.32308486104011536,0.9413825273513794,0.09703188389539719],[0.30924931168556213,0.946604311466217,0.09113304316997528],[0.3756128251552582,0.9234598278999329,0.0783376395702362],[0.5150745511054993,0.8528239727020264,-0.08596205711364746],[0.4702720046043396,0.8819447159767151,-0.031901802867650986],[0.4184861183166504,0.9036914706230164,-0.09061478823423386],[0.426266610622406,0.8994579315185547,-0.09629113972187042],[0.6157482266426086,0.7863949537277222,-0.049367424100637436],[0.49254393577575684,0.8694345355033875,0.03852318972349167],[0.4702720046043396,0.8819447159767151,-0.031901802867650986],[0.5150745511054993,0.8528239727020264,-0.08596205711364746],[0.4887421131134033,0.8688849806785583,-0.07854924350976944],[0.4874696135520935,0.8697015643119812,-0.0774112120270729],[0.5186543464660645,0.8537455201148987,-0.04600219428539276],[0.812343418598175,0.5824594497680664,-0.0289674773812294],[0.4989731013774872,0.8658507466316223,-0.03644828870892525],[0.4985501170158386,0.8660682439804077,-0.0370621494948864],[0.4874696135520935,0.8697015643119812,-0.0774112120270729],[0.4887421131134033,0.8688849806785583,-0.07854924350976944],[0.5233396887779236,0.852124035358429,-0.0002806649135891348],[0.5233396887779236,0.8521241545677185,-0.00028066494269296527],[0.4985501170158386,0.8660682439804077,-0.0370621494948864],[0.4989731013774872,0.8658507466316223,-0.03644828870892525],[0.5939923524856567,0.8027538657188416,0.05252972990274429],[0.5939922332763672,0.8027538061141968,0.05252972990274429],[0.593992292881012,0.8027538061141968,0.05252972990274429],[0.593992292881012,0.802753746509552,0.05252972990274429],[0.6263990998268127,0.7756832242012024,0.0770687535405159],[0.6263991594314575,0.7756832838058472,0.0770687684416771],[0.6263991594314575,0.7756832242012024,0.0770687684416771],[0.6263991594314575,0.7756832838058472,0.0770687609910965],[0.6624122858047485,0.7462863922119141,0.06531935185194016],[0.6624122858047485,0.7462863922119141,0.06531934440135956],[0.6624122858047485,0.7462863922119141,0.06531935185194016],[0.6624122262001038,0.7462863326072693,0.06531935185194016],[0.7703723907470703,0.364370197057724,-0.5232215523719788],[0.5710009336471558,0.715075671672821,-0.40326735377311707],[0.7184544801712036,0.4904933571815491,-0.4931929409503937],[0.37462636828422546,0.6200053691864014,-0.6893826723098755],[0.016368180513381958,0.41040074825286865,-0.911758303642273],[0.07877559959888458,-0.25413259863853455,-0.9639558792114258],[0.41769927740097046,0.4760781228542328,-0.7738713026046753],[0.37462636828422546,0.6200053691864014,-0.6893826723098755],[0.34577468037605286,0.5889291763305664,-0.7304808497428894],[0.0019773005042225122,0.5299733281135559,-0.8480120301246643],[0.016368180513381958,0.41040074825286865,-0.911758303642273],[0.9417835474014282,-0.049175508320331573,0.3326040506362915],[0.9091628789901733,-0.16485607624053955,0.38242053985595703],[0.9477870464324951,-0.3114435374736786,0.06857644021511078],[0.9870246648788452,-0.13484345376491547,0.08717460930347443],[0.14885027706623077,-0.9885218143463135,0.0258492399007082],[0.5455085635185242,-0.8378602266311646,0.020260393619537354],[0.5313248038291931,-0.8438926935195923,-0.07442483305931091],[0.1343700885772705,-0.9893593192100525,-0.05579141527414322],[0.994776725769043,-0.10139967501163483,0.011717659421265125],[0.9454845190048218,-0.18804335594177246,0.26589235663414],[0.9277397990226746,-0.26224467158317566,0.2655685245990753],[0.9816802144050598,-0.18131236732006073,0.05856389179825783],[0.07883576303720474,-0.9942485690116882,-0.07248955965042114],[0.07883576303720474,-0.9942484498023987,-0.07248955219984055],[0.07883577048778534,-0.9942485690116882,-0.07248955965042114],[0.9535025358200073,0.03478159382939339,-0.29937097430229187],[0.994776725769043,-0.10139967501163483,0.011717659421265125],[0.9816802144050598,-0.18131236732006073,0.05856389179825783],[0.9511677026748657,-0.04723962023854256,-0.3050382733345032],[-0.19625768065452576,-0.11801380664110184,-0.9734246730804443],[-0.2926790714263916,-0.3033236265182495,-0.9068261384963989],[-0.32536008954048157,-0.23565585911273956,-0.9157549738883972],[-0.3316536545753479,-0.3071261942386627,-0.8920086622238159],[-0.05927730351686478,0.1270371675491333,-0.9901250600814819],[-0.05927730351686478,0.1270371526479721,-0.9901250600814819],[-0.2926790714263916,-0.3033236265182495,-0.9068261384963989],[-0.19625768065452576,-0.11801380664110184,-0.9734246730804443],[0.5783531069755554,0.037188682705163956,-0.8149384260177612],[0.5758730173110962,0.09083724021911621,-0.8124769330024719],[0.5564614534378052,0.26213952898979187,-0.7884374260902405],[0.5564614534378052,0.26213952898979187,-0.7884373664855957],[0.6000460982322693,-0.09697715193033218,-0.794065535068512],[0.5758730173110962,0.09083724021911621,-0.8124769330024719],[0.5783531069755554,0.037188682705163956,-0.8149384260177612],[0.6286618709564209,-0.02641300857067108,-0.7772300839424133],[0.9816802144050598,-0.18131236732006073,0.05856389179825783],[0.9277397990226746,-0.26224467158317566,0.2655685245990753],[0.880256712436676,-0.2203819453716278,0.42021414637565613],[0.9598467946052551,-0.14224128425121307,0.24178816378116608],[-0.4995267689228058,-0.6674507260322571,0.5522522330284119],[-0.4995267689228058,-0.6674506664276123,0.5522521734237671],[-0.7392453551292419,-0.5592052340507507,0.37524107098579407],[-0.8281887769699097,-0.48730725049972534,0.2768303155899048],[0.9511677026748657,-0.04723962023854256,-0.3050382733345032],[0.9816802144050598,-0.18131236732006073,0.05856389179825783],[0.9598467946052551,-0.14224128425121307,0.24178816378116608],[0.9868009686470032,0.016181373968720436,-0.16112716495990753],[-0.3316536545753479,-0.3071261942386627,-0.8920086622238159],[-0.32536008954048157,-0.23565585911273956,-0.9157549738883972],[-0.21552973985671997,0.056692883372306824,-0.9748501777648926],[-0.21570317447185516,0.05686187371611595,-0.9748018980026245],[0.6000460982322693,-0.09697715193033218,-0.794065535068512],[0.6286618709564209,-0.02641300857067108,-0.7772300839424133],[0.7030335664749146,0.08082249015569687,-0.7065488696098328],[0.6975869536399841,0.09133404493331909,-0.7106549739837646],[0.9598467946052551,-0.14224128425121307,0.24178816378116608],[0.880256712436676,-0.2203819453716278,0.42021414637565613],[0.5838391780853271,0.21363331377506256,0.7832577228546143],[0.9488987326622009,0.10196034610271454,0.29865553975105286],[-0.46847423911094666,-0.1571734994649887,0.8693839311599731],[-0.4684741497039795,-0.15717348456382751,0.8693838119506836],[-0.8334598541259766,-0.12069139629602432,0.539238452911377],[-0.8397976756095886,-0.11944134533405304,0.5295974612236023],[0.9868009686470032,0.016181373968720436,-0.16112716495990753],[0.9598467946052551,-0.14224128425121307,0.24178816378116608],[0.9488987326622009,0.10196034610271454,0.29865553975105286],[0.994851291179657,0.025057118386030197,-0.09819892793893814],[-0.21570317447185516,0.05686187371611595,-0.9748018980026245],[-0.21552973985671997,0.056692883372306824,-0.9748501777648926],[-0.14557555317878723,-0.182363361120224,-0.9723946452140808],[-0.1493588238954544,-0.2086780071258545,-0.9665119051933289],[0.6975869536399841,0.09133404493331909,-0.7106549739837646],[0.7030335664749146,0.08082249015569687,-0.7065488696098328],[0.7033784985542297,-0.1011778935790062,-0.7035778760910034],[0.7059258818626404,-0.09110114723443985,-0.7024023532867432],[0.9488987326622009,0.10196034610271454,0.29865553975105286],[0.5838391780853271,0.21363331377506256,0.7832577228546143],[0.5448250770568848,0.30212247371673584,0.7822324633598328],[0.8804023265838623,0.20492564141750336,0.4276648163795471],[-0.47070038318634033,0.29190725088119507,0.8326050043106079],[-0.4707004427909851,0.29190728068351746,0.8326051235198975],[-0.8098574280738831,0.1927443891763687,0.5540580153465271],[-0.7826141715049744,0.20474077761173248,0.5878743529319763],[0.994851291179657,0.025057118386030197,-0.09819892793893814],[0.9488987326622009,0.10196034610271454,0.29865553975105286],[0.8804023265838623,0.20492564141750336,0.4276648163795471],[0.991542637348175,0.02448795922100544,-0.12745055556297302],[-0.9741464257240295,-0.09507003426551819,-0.20493975281715393],[-0.9741464853286743,-0.09507003426551819,-0.20493975281715393],[-0.9741464257240295,-0.09507003426551819,-0.20493975281715393],[-0.9741464853286743,-0.09507004171609879,-0.20493976771831512],[-0.1493588238954544,-0.2086780071258545,-0.9665119051933289],[-0.14557555317878723,-0.182363361120224,-0.9723946452140808],[-0.15870679914951324,-0.27659744024276733,-0.9477900862693787],[-0.15870678424835205,-0.27659744024276733,-0.9477900266647339],[0.7059258818626404,-0.09110114723443985,-0.7024023532867432],[0.7033784985542297,-0.1011778935790062,-0.7035778760910034],[0.6870550513267517,-0.1595001220703125,-0.7088828682899475],[0.6870550513267517,-0.1595001220703125,-0.7088829874992371],[-0.7594459652900696,-0.5591992139816284,-0.3324725925922394],[-0.7612725496292114,-0.5448256731033325,-0.35160934925079346],[-0.7639512419700623,-0.4725126326084137,-0.4394431710243225],[-0.7639512419700623,-0.4725125730037689,-0.4394431710243225],[-0.6542017459869385,-0.7388257384300232,0.1617303341627121],[-0.7013145685195923,-0.7126237154006958,0.01804005168378353],[-0.7612725496292114,-0.5448256731033325,-0.35160934925079346],[-0.7594459652900696,-0.5591992139816284,-0.3324725925922394],[-0.9570808410644531,-0.2858492136001587,-0.047818198800086975],[-0.9580674171447754,-0.2737380564212799,-0.08470072597265244],[-0.907597541809082,-0.15491488575935364,-0.3902152180671692],[-0.9075976014137268,-0.15491488575935364,-0.3902152478694916],[-0.8281887769699097,-0.48730725049972534,0.2768303155899048],[-0.7392453551292419,-0.5592052340507507,0.37524107098579407],[-0.9580674171447754,-0.2737380564212799,-0.08470072597265244],[-0.9570808410644531,-0.2858492136001587,-0.047818198800086975],[-0.8397976756095886,-0.11944134533405304,0.5295974612236023],[-0.8334598541259766,-0.12069139629602432,0.539238452911377],[-0.9977579712867737,-0.06672408431768417,-0.005191626958549023],[-0.9967944622039795,-0.06933978199958801,0.03990751504898071],[-0.9967944622039795,-0.06933978199958801,0.03990751504898071],[-0.9977579712867737,-0.06672408431768417,-0.005191626958549023],[-0.968826413154602,-0.05067602917551994,-0.2425018846988678],[-0.968826413154602,-0.05067602917551994,-0.2425018846988678],[-0.007080026902258396,-0.9999517202377319,0.0068261693231761456],[-0.0070800259709358215,-0.9999516606330872,0.006826168857514858],[-0.007396361790597439,-0.9999653697013855,0.003803872736170888],[-0.007655521389096975,-0.9999698996543884,0.001327343052253127],[-0.8098574280738831,0.1927443891763687,0.5540580153465271],[-0.9692126512527466,0.07919885963201523,0.23313987255096436],[-0.9692126512527466,0.07919885963201523,0.23313987255096436],[-0.7826141715049744,0.20474077761173248,0.5878743529319763],[0.9766407608985901,-0.049606338143348694,0.20907409489154816],[0.9454845190048218,-0.18804335594177246,0.26589235663414],[0.994776725769043,-0.10139967501163483,0.011717659421265125],[0.9940851926803589,0.10859742015600204,0.0011142655275762081],[0.8727967739105225,0.48596683144569397,-0.04540829733014107],[0.8970381617546082,0.4411088824272156,0.027302822098135948],[0.9766407608985901,-0.049606338143348694,0.20907409489154816],[0.9940851926803589,0.10859742015600204,0.0011142655275762081],[0.5234197378158569,0.8474974632263184,-0.08820322155952454],[0.5382925271987915,0.8391603231430054,-0.07778876274824142],[0.8970381617546082,0.4411088824272156,0.027302822098135948],[0.8727967739105225,0.48596683144569397,-0.04540829733014107],[0.426266610622406,0.8994579315185547,-0.09629113972187042],[0.4193996787071228,0.9029867649078369,-0.09337382763624191],[0.5382925271987915,0.8391603231430054,-0.07778876274824142],[0.5234197378158569,0.8474974632263184,-0.08820322155952454],[0.426266610622406,0.8994579315185547,-0.09629113972187042],[0.4184861183166504,0.9036914706230164,-0.09061478823423386],[0.397386759519577,0.9139290452003479,-0.08256830275058746],[0.4193996787071228,0.9029867649078369,-0.09337382763624191],[-0.4563031494617462,-0.7228989601135254,0.5188493132591248],[-0.45630308985710144,-0.7228989005088806,0.51884925365448],[-0.7013145685195923,-0.7126237154006958,0.01804005168378353],[-0.6542017459869385,-0.7388257384300232,0.1617303341627121],[0.812343418598175,0.5824594497680664,-0.0289674773812294],[0.8409687876701355,0.5410745739936829,-0.003117515239864588],[0.7520958781242371,-0.6584120392799377,0.02907477132976055],[0.7433125972747803,-0.6685736179351807,0.02226567082107067],[0.812343418598175,0.5824594497680664,-0.0289674773812294],[0.5186543464660645,0.8537455201148987,-0.04600219428539276],[0.5403411984443665,0.8414300680160522,0.005176173057407141],[0.8409687876701355,0.5410745739936829,-0.003117515239864588],[0.9381476044654846,0.19051600992679596,0.28910666704177856],[0.9417835474014282,-0.049175508320331573,0.3326040506362915],[0.9870246648788452,-0.13484345376491547,0.08717460930347443],[0.9768072366714478,0.1450829803943634,0.1574755609035492],[0.3048708438873291,-0.3601263463497162,0.8816817402839661],[0.3048708438873291,-0.3601263463497162,0.8816817998886108],[0.3048708736896515,-0.3601263761520386,0.8816817998886108],[0.009669899009168148,-0.9999527335166931,-0.0009911151137202978],[0.01335916668176651,-0.9997296333312988,-0.019029799848794937],[0.008899079635739326,-0.9999565482139587,0.002775831613689661],[0.008292901329696178,-0.9999492168426514,0.005737709812819958],[0.009669899009168148,-0.9999527335166931,-0.0009911151137202978],[0.008899079635739326,-0.9999565482139587,0.002775831613689661],[0.008292900398373604,-0.9999490976333618,0.00573770934715867],[-0.000327377172652632,-0.9999869465827942,0.005087403580546379],[-0.0003273772308602929,-0.9999870657920837,0.005087404511868954],[-0.00032737720175646245,-0.999987006187439,0.005087404046207666],[-0.000327377172652632,-0.9999869465827942,0.005087404046207666],[0.1814485490322113,0.09529119729995728,-0.9787726402282715],[0.7972792387008667,0.2637723684310913,-0.5429269671440125],[0.6811290383338928,0.1718948930501938,-0.7116989493370056],[0.08690784126520157,0.012723428197205067,-0.9961351156234741],[0.6811290383338928,0.1718948930501938,-0.7116989493370056],[0.7972792387008667,0.2637723684310913,-0.5429269671440125],[0.8920365571975708,0.3482467830181122,-0.2880887985229492],[0.892036497592926,0.3482467532157898,-0.2880887985229492],[0.05003644526004791,0.7857836484909058,0.6164740920066833],[-0.5313484072685242,0.7057963013648987,0.4685301184654236],[-0.5509044528007507,0.7043324112892151,0.447683185338974],[0.2159183919429779,0.5571125745773315,0.8018757700920105],[-0.5313484072685242,0.7057963013648987,0.4685301184654236],[-0.8174833655357361,0.5758097767829895,0.012800747528672218],[-0.5509044528007507,0.7043324112892151,0.447683185338974],[-0.8916581869125366,0.42880943417549133,-0.145148366689682],[-0.6992805600166321,0.27376049757003784,-0.6603497862815857],[-0.5561168193817139,0.14663560688495636,-0.8180659413337708],[-0.8941298723220825,0.40962284803390503,-0.18094424903392792],[-0.6992805600166321,0.27376049757003784,-0.6603497862815857],[0.1814485490322113,0.09529119729995728,-0.9787726402282715],[0.08690784126520157,0.012723428197205067,-0.9961351156234741],[-0.5561168193817139,0.14663560688495636,-0.8180659413337708],[0.6097199320793152,0.38178151845932007,0.6946110129356384],[0.2159183919429779,0.5571125745773315,0.8018757700920105],[0.5276976823806763,-0.13558554649353027,0.8385413885116577],[0.5276976823806763,-0.13558554649353027,0.8385413885116577],[0.08690784126520157,0.012723428197205067,-0.9961351156234741],[0.6811290383338928,0.1718948930501938,-0.7116989493370056],[0.35492509603500366,-0.03222038596868515,-0.9343393445014954],[0.06122444570064545,-0.05399129539728165,-0.9966627359390259],[0.9835129380226135,-0.17904329299926758,0.025407595559954643],[0.9835130572319031,-0.17904330790042877,0.025407597422599792],[0.9835129976272583,-0.17904330790042877,0.025407597422599792],[0.9835131168365479,-0.17904330790042877,0.02540759928524494],[-0.5027428865432739,-0.15944384038448334,0.8496041893959045],[-0.5027428269386292,-0.15944382548332214,0.8496041297912598],[-0.5027428269386292,-0.15944382548332214,0.8496041893959045],[-0.5027428865432739,-0.15944384038448334,0.8496041297912598],[-0.9903079867362976,-0.13654690980911255,-0.02539708837866783],[-0.9903079867362976,-0.13654690980911255,-0.02539708837866783],[-0.9903078675270081,-0.13654689490795135,-0.025397086516022682],[-0.9903079867362976,-0.13654692471027374,-0.02539709024131298],[-0.9545094966888428,-0.051332514733076096,-0.293728768825531],[-0.9545094966888428,-0.051332518458366394,-0.293728768825531],[-0.9545095562934875,-0.05133252218365669,-0.293728768825531],[-0.9545095562934875,-0.05133252218365669,-0.2937287986278534],[-0.5561168193817139,0.14663560688495636,-0.8180659413337708],[0.08690784126520157,0.012723428197205067,-0.9961351156234741],[0.06122444570064545,-0.05399129539728165,-0.9966627359390259],[-0.21681351959705353,-0.06985045969486237,-0.9737108945846558],[0.5794637203216553,0.6613138914108276,0.47632521390914917],[0.05003644526004791,0.7857836484909058,0.6164740920066833],[0.2159183919429779,0.5571125745773315,0.8018757700920105],[0.6097199320793152,0.38178151845932007,0.6946110129356384],[-0.8372636437416077,0.5378450155258179,0.09855113178491592],[-0.8916581869125366,0.42880943417549133,-0.145148366689682],[-0.8941298723220825,0.40962284803390503,-0.18094424903392792],[0.8823044300079346,-0.05031672492623329,-0.4679820239543915],[0.8823044300079346,-0.05031672865152359,-0.4679820239543915],[0.8823044300079346,-0.05031673237681389,-0.4679820239543915],[0.8823044300079346,-0.05031672120094299,-0.4679819941520691],[0.9080635905265808,0.41698211431503296,0.03932438790798187],[0.5794637203216553,0.6613138914108276,0.47632521390914917],[0.6097199320793152,0.38178151845932007,0.6946110129356384],[0.4252643287181854,-0.326079785823822,-0.8442878723144531],[0.41716256737709045,-0.5338594913482666,-0.7355061769485474],[0.4247870147228241,-0.3042740523815155,-0.8526272177696228],[0.7406501770019531,-0.43752405047416687,-0.5099119544029236],[0.9477870464324951,-0.3114435374736786,0.06857644021511078],[0.9551147222518921,-0.2813762128353119,0.09264519810676575],[0.9193760752677917,-0.18071384727954865,-0.34941378235816956],[0.17346534132957458,-0.4330552816390991,0.8845183849334717],[0.09481082111597061,-0.5233485102653503,0.8468276262283325],[0.27656683325767517,-0.2505062520503998,0.9277701377868652],[0.26483190059661865,-0.24258455634117126,0.9332828521728516],[-0.8077946901321411,-0.550134539604187,0.21170684695243835],[-0.8316102027893066,-0.4946551024913788,-0.25246918201446533],[-0.8786116242408752,-0.32081088423728943,-0.3537260591983795],[-0.9311760663986206,-0.36401504278182983,-0.020105909556150436],[0.4247870147228241,-0.3042740523815155,-0.8526272177696228],[0.37875980138778687,-0.09532086551189423,-0.9205731153488159],[0.38566529750823975,-0.1070541962981224,-0.9164069294929504],[0.4252643287181854,-0.326079785823822,-0.8442878723144531],[0.9551147222518921,-0.2813762128353119,0.09264519810676575],[0.9803988933563232,-0.06604071706533432,0.18562422692775726],[0.9505224823951721,-0.025599543005228043,-0.309599369764328],[0.9193760752677917,-0.18071384727954865,-0.34941378235816956],[-0.012466281652450562,-0.10213904082775116,0.9946919083595276],[0.01848628744482994,-0.11704268306493759,0.9929547905921936],[-0.191960871219635,-0.013161209411919117,0.9813143610954285],[-0.19196085631847382,-0.013161208480596542,0.9813142418861389],[-0.9780387878417969,-0.11297819763422012,-0.17514568567276],[-0.8510448932647705,-0.09574438631534576,-0.5162901282310486],[-0.8051036596298218,-0.04565700888633728,-0.5913742184638977],[-0.9590003490447998,-0.05345573276281357,-0.2783178687095642],[0.36195024847984314,-0.00780502799898386,-0.9321647882461548],[0.37022340297698975,-0.006347283720970154,-0.9289209842681885],[0.39872634410858154,-0.001279944204725325,-0.9170689582824707],[0.39872637391090393,-0.001279944321140647,-0.9170690774917603],[0.9600644707679749,0.017666827887296677,-0.2792203724384308],[0.9999285340309143,-0.008907451294362545,0.007981736212968826],[0.9705500602722168,0.041453126817941666,-0.2373063713312149],[0.970550000667572,0.04145312309265137,-0.23730634152889252],[0.3728489577770233,-0.427837997674942,0.8233699798583984],[0.3866685628890991,-0.2683693468570709,0.8823068141937256],[0.3863925039768219,-0.27374768257141113,0.8807740807533264],[0.3896631896495819,-0.14819471538066864,0.9089559316635132],[0.3863925039768219,-0.27374768257141113,0.8807740807533264],[0.3866685628890991,-0.2683693468570709,0.8823068141937256],[0.4050523042678833,0.8312997221946716,-0.3806225061416626],[0.4218263030052185,0.893310010433197,-0.15511257946491241],[0.2525371015071869,0.9163177609443665,-0.3107839524745941],[0.2435235232114792,0.8133171796798706,-0.5284045338630676],[0.766213059425354,-0.4164203405380249,0.48939943313598633],[0.9551147222518921,-0.2813762128353119,0.09264519810676575],[0.9477870464324951,-0.3114435374736786,0.06857644021511078],[0.9091628789901733,-0.16485607624053955,0.38242053985595703],[0.766213059425354,-0.4164203405380249,0.48939943313598633],[0.8380744457244873,-0.08995909243822098,0.5380879640579224],[0.9803988933563232,-0.06604071706533432,0.18562422692775726],[0.9551147222518921,-0.2813762128353119,0.09264519810676575],[-0.9798529148101807,-0.11036249250173569,0.16645821928977966],[-0.9780387878417969,-0.11297819763422012,-0.17514568567276],[-0.9590003490447998,-0.05345573276281357,-0.2783178687095642],[-0.9920427203178406,-0.05442262068390846,0.11353173851966858],[-0.6722142696380615,-0.5465120673179626,0.49945202469825745],[-0.8077946901321411,-0.550134539604187,0.21170684695243835],[-0.9311760663986206,-0.36401504278182983,-0.020105909556150436],[-0.8176161050796509,-0.39186012744903564,0.4218408763408661],[-0.5182480812072754,-0.6767961978912354,0.5228439569473267],[-0.8077946901321411,-0.550134539604187,0.21170684695243835],[-0.6722142696380615,-0.5465120673179626,0.49945202469825745],[-0.002707137493416667,-0.9999943375587463,-0.0020069817546755075],[-0.00009738043445395306,-1,-0.00008159968274412677],[-0.0024870464112609625,-0.9999951720237732,-0.0018446068279445171],[-0.0030398331582546234,-0.999992847442627,-0.002252432284876704],[-0.002707137493416667,-0.9999943375587463,-0.0020069817546755075],[-0.0024870464112609625,-0.9999951720237732,-0.0018446068279445171],[-0.0030398338567465544,-0.9999929666519165,-0.0022524327505379915],[0.002526939148083329,-0.999995231628418,-0.001767946989275515],[0.000009873355338640977,-0.9999999403953552,-0.00008601942681707442],[0.002916933037340641,-0.9999936819076538,-0.0020285448990762234],[0.002916933037340641,-0.9999936819076538,-0.0020285448990762234],[0.003246558364480734,-0.9999921917915344,-0.002248803386464715],[0.0032465581316500902,-0.9999921917915344,-0.0022488031536340714],[0.002526939148083329,-0.999995231628418,-0.001767946989275515],[-0.13146741688251495,0.2366977334022522,-0.9626476764678955],[0.697407603263855,0.42583221197128296,-0.5764456391334534],[0.7435843348503113,0.27636152505874634,-0.608856737613678],[-0.005266580265015364,0.020573601126670837,-0.9997743964195251],[0.7435843348503113,0.27636152505874634,-0.608856737613678],[0.697407603263855,0.42583221197128296,-0.5764456391334534],[0.8141242861747742,0.5578469038009644,-0.16127179563045502],[0.8141242265701294,0.5578469038009644,-0.16127179563045502],[-0.3610418736934662,0.7736912369728088,0.5206252932548523],[-0.6349890232086182,0.7232478260993958,0.2714802026748657],[-0.5544269680976868,0.7512640357017517,0.35806867480278015],[-0.3610419034957886,0.7736911177635193,0.5206252336502075],[-0.5544269680976868,0.7512640357017517,0.35806867480278015],[-0.6349890232086182,0.7232478260993958,0.2714802026748657],[-0.8289161920547485,0.35599374771118164,-0.4314700663089752],[-0.7784214615821838,0.2177102118730545,-0.5887802839279175],[-0.8289161920547485,0.35599374771118164,-0.4314700663089752],[-0.13146741688251495,0.2366977334022522,-0.9626476764678955],[-0.005266580265015364,0.020573601126670837,-0.9997743964195251],[-0.7784214615821838,0.2177102118730545,-0.5887802839279175],[0.5507657527923584,-0.1490505039691925,0.8212436437606812],[0.5507657527923584,-0.1490505188703537,0.8212436437606812],[0.5507656931877136,-0.1490504890680313,0.8212435245513916],[0.5507657527923584,-0.1490504890680313,0.8212435841560364],[-0.005266580265015364,0.020573601126670837,-0.9997743964195251],[0.7435843348503113,0.27636152505874634,-0.608856737613678],[0.5358596444129944,-0.11738801002502441,-0.8361066579818726],[-0.02385599911212921,-0.09995710104703903,-0.9947056770324707],[0.9810167551040649,-0.06483679264783859,-0.18276314437389374],[0.9810166358947754,-0.06483679264783859,-0.18276314437389374],[0.9810167551040649,-0.06483680009841919,-0.18276314437389374],[0.9810166954994202,-0.064836785197258,-0.18276312947273254],[-0.5430971384048462,-0.20497308671474457,0.8142674565315247],[-0.543097198009491,-0.20497307181358337,0.8142675161361694],[-0.5430971384048462,-0.20497310161590576,0.8142674565315247],[-0.5430971384048462,-0.20497310161590576,0.8142675757408142],[-0.976665198802948,0.012919560074806213,-0.2143784761428833],[-0.976665198802948,0.012919561006128788,-0.21437852084636688],[-0.976665198802948,0.012919559143483639,-0.2143784761428833],[-0.9766652584075928,0.012919561006128788,-0.2143784910440445],[-0.7784214615821838,0.2177102118730545,-0.5887802839279175],[-0.005266580265015364,0.020573601126670837,-0.9997743964195251],[-0.02385599911212921,-0.09995710104703903,-0.9947056770324707],[-0.5808340907096863,-0.0479637086391449,-0.8126077055931091],[0.9485647082328796,-0.2816155254840851,-0.14462943375110626],[0.7406501770019531,-0.43752405047416687,-0.5099119544029236],[0.2705770432949066,-0.6124230623245239,-0.7427825927734375],[0.9803988933563232,-0.06604071706533432,0.18562422692775726],[0.9999285340309143,-0.008907451294362545,0.007981736212968826],[0.9600644707679749,0.017666827887296677,-0.2792203724384308],[0.9505224823951721,-0.025599543005228043,-0.309599369764328],[0.38566529750823975,-0.1070541962981224,-0.9164069294929504],[0.37875980138778687,-0.09532086551189423,-0.9205731153488159],[0.37022340297698975,-0.006347283720970154,-0.9289209842681885],[0.36195024847984314,-0.00780502799898386,-0.9321647882461548],[-0.9311760663986206,-0.36401504278182983,-0.020105909556150436],[-0.8786116242408752,-0.32081088423728943,-0.3537260591983795],[-0.8510448932647705,-0.09574438631534576,-0.5162901282310486],[-0.9780387878417969,-0.11297819763422012,-0.17514568567276],[-0.8176161050796509,-0.39186012744903564,0.4218408763408661],[-0.9311760663986206,-0.36401504278182983,-0.020105909556150436],[-0.9780387878417969,-0.11297819763422012,-0.17514568567276],[-0.9798529148101807,-0.11036249250173569,0.16645821928977966],[0.26483190059661865,-0.24258455634117126,0.9332828521728516],[0.27656683325767517,-0.2505062520503998,0.9277701377868652],[0.01848628744482994,-0.11704268306493759,0.9929547905921936],[-0.012466281652450562,-0.10213904082775116,0.9946919083595276],[0.9803988933563232,-0.06604071706533432,0.18562422692775726],[0.8380744457244873,-0.08995909243822098,0.5380879640579224],[0.7823804020881653,-0.0719861164689064,0.6186265349388123],[0.9999285340309143,-0.008907451294362545,0.007981736212968826],[0.06757760047912598,-0.5010526180267334,0.8627743124961853],[0.07932622730731964,-0.4095267057418823,0.9088428020477295],[0.07932621240615845,-0.40952667593955994,0.9088428020477295],[0.07088138908147812,-0.4764057397842407,0.8763636946678162],[0.17346534132957458,-0.4330552816390991,0.8845183849334717],[0.06757760047912598,-0.5010526180267334,0.8627743124961853],[0.07088138908147812,-0.4764057397842407,0.8763636946678162],[0.09481082111597061,-0.5233485102653503,0.8468276262283325],[0.3956208825111389,0.7391512393951416,-0.5451050400733948],[0.3956208825111389,0.7391512393951416,-0.54510498046875],[0.38196152448654175,0.7307950258255005,-0.56572425365448],[0.388986736536026,0.7351351380348206,-0.5552167296409607],[0.8651763796806335,0.20427031815052032,0.4579775333404541],[0.9119406938552856,0.39943942427635193,0.09387387335300446],[0.9397345781326294,0.2088989019393921,-0.2706661522388458],[0.9552299380302429,0.09224513918161392,0.2811165153980255],[0.13695234060287476,-0.32076290249824524,0.9372060298919678],[0.13695234060287476,-0.3207629323005676,0.9372060894966125],[0.13695234060287476,-0.32076290249824524,0.9372060894966125],[0.13695229589939117,-0.32076284289360046,0.9372059106826782],[0.7926474213600159,0.10113353282213211,0.6012336015701294],[0.8651763796806335,0.20427031815052032,0.4579775333404541],[0.9552299380302429,0.09224513918161392,0.2811165153980255],[0.8267838954925537,0.01610807329416275,0.5622889995574951],[0.388986736536026,0.7351351380348206,-0.5552167296409607],[0.38196152448654175,0.7307950258255005,-0.56572425365448],[0.3725777566432953,0.7248623967170715,-0.5794482827186584],[0.3725777566432953,0.7248624563217163,-0.5794482827186584],[0.9552299380302429,0.09224513918161392,0.2811165153980255],[0.9397345781326294,0.2088989019393921,-0.2706661522388458],[0.9984315037727356,0.05574440956115723,-0.005208582151681185],[0.9962441325187683,-0.08337707817554474,-0.023362543433904648],[0.2921980917453766,-0.5222808122634888,0.8011509776115417],[0.292198121547699,-0.5222808122634888,0.8011510372161865],[0.3535509705543518,-0.748909592628479,0.5604783296585083],[0.3495377004146576,-0.7314228415489197,0.5855288505554199],[0.8267838954925537,0.01610807329416275,0.5622889995574951],[0.9552299380302429,0.09224513918161392,0.2811165153980255],[0.9962441325187683,-0.08337707817554474,-0.023362543433904648],[0.9066129922866821,-0.3023506999015808,0.2943413257598877],[0.9962441325187683,-0.08337707817554474,-0.023362543433904648],[0.9984315037727356,0.05574440956115723,-0.005208582151681185],[0.9873501062393188,0.009570947848260403,0.15826503932476044],[0.9682334661483765,-0.19593490660190582,0.15534937381744385],[0.3495377004146576,-0.7314228415489197,0.5855288505554199],[0.3535509705543518,-0.748909592628479,0.5604783296585083],[0.3966310918331146,-0.874226450920105,0.28002092242240906],[0.3966022729873657,-0.8742861151695251,0.2798754870891571],[0.9066129922866821,-0.3023506999015808,0.2943413257598877],[0.9962441325187683,-0.08337707817554474,-0.023362543433904648],[0.9682334661483765,-0.19593490660190582,0.15534937381744385],[0.923740804195404,-0.35312986373901367,0.14833100140094757],[0.34378063678741455,0.7168905138969421,0.606533408164978],[0.34378060698509216,0.7168905138969421,0.6065334677696228],[0.3437805771827698,0.7168905138969421,0.606533408164978],[0.34378066658973694,0.7168905735015869,0.6065335273742676],[0.7423210144042969,0.22705449163913727,0.6304013133049011],[0.6109460592269897,0.4342992603778839,0.6619130969047546],[0.6109461188316345,0.4342992901802063,0.6619130969047546],[0.770629346370697,0.16736017167568207,0.6149153709411621],[0.3966022729873657,-0.8742861151695251,0.2798754870891571],[0.3966310918331146,-0.874226450920105,0.28002092242240906],[0.4231787323951721,-0.7899394631385803,0.4437515139579773],[0.4231787621974945,-0.7899393439292908,0.4437515437602997],[0.8336090445518494,-0.014377200976014137,0.5521677136421204],[0.7423210144042969,0.22705449163913727,0.6304013133049011],[0.770629346370697,0.16736017167568207,0.6149153709411621],[0.8336091041564941,-0.014377201907336712,0.5521677732467651],[0.45546984672546387,0.1650240272283554,0.8748223781585693],[0.45546987652778625,0.1650240421295166,0.8748224377632141],[0.4282975196838379,0.5146201848983765,0.7427835464477539],[0.43389180302619934,0.48191967606544495,0.7612432837486267],[0.10482406616210938,0.9720267653465271,0.21018041670322418],[0.10482407361268997,0.9720268249511719,0.21018043160438538],[0.10482407361268997,0.9720267653465271,0.21018043160438538],[0.10482405126094818,0.9720266461372375,0.210180401802063],[0.4050523042678833,0.8312997221946716,-0.3806225061416626],[0.7011295557022095,0.7121444940567017,0.035601671785116196],[0.7618468403816223,0.646384596824646,0.04214463010430336],[0.4218263030052185,0.893310010433197,-0.15511257946491241],[0.7128168344497681,0.5547977089881897,-0.42905882000923157],[0.8051605820655823,0.5251745581626892,-0.2755143642425537],[0.8051605224609375,0.5251745581626892,-0.2755143642425537],[0.6335839629173279,0.5647056102752686,-0.5288468599319458],[0.552563488483429,0.5657110810279846,-0.6120822429656982],[0.7128168344497681,0.5547977089881897,-0.42905882000923157],[0.6335839629173279,0.5647056102752686,-0.5288468599319458],[0.5525634288787842,0.5657110214233398,-0.6120821833610535],[0.48474282026290894,0.756238579750061,0.43946269154548645],[0.4847428798675537,0.7562386393547058,0.4394627809524536],[0.4847429096698761,0.7562386989593506,0.4394627511501312],[0.48474279046058655,0.756238579750061,0.43946269154548645],[0.27773410081863403,0.743943989276886,0.6077921390533447],[0.27773404121398926,0.7439438700675964,0.6077920198440552],[0.27773404121398926,0.743943989276886,0.6077920794487],[0.968436062335968,-0.17695017158985138,0.17555688321590424],[0.968436062335968,-0.17695018649101257,0.17555688321590424],[0.9684360027313232,-0.17695015668869019,0.17555686831474304],[0.9684361219406128,-0.17695017158985138,0.17555689811706543],[0.10337559878826141,0.23609063029289246,-0.9662166833877563],[0.10337559878826141,0.23609063029289246,-0.9662166833877563],[0.1213289424777031,0.28933531045913696,-0.9495073556900024],[0.12569350004196167,0.3023165762424469,-0.9448839426040649],[-0.5987306237220764,0.7815070748329163,0.1754090040922165],[-0.5987306237220764,0.7815070152282715,0.17540901899337769],[-0.5916424989700317,0.79185950756073,0.1513853222131729],[-0.5941922068595886,0.7882744669914246,0.15987159311771393],[-0.03073604218661785,0.06645089387893677,0.9973161220550537],[-0.030736036598682404,0.06645088642835617,0.9973161220550537],[-0.0025426747743040323,0.05963180214166641,0.9982172250747681],[-0.010676821693778038,0.06160430610179901,0.9980434775352478],[0.9105457663536072,-0.3529585599899292,0.215236097574234],[0.9105458855628967,-0.3529585897922516,0.2152361124753952],[0.9105457663536072,-0.3529585599899292,0.2152361124753952],[0.910545825958252,-0.3529585897922516,0.2152361422777176],[0.12569350004196167,0.3023165762424469,-0.9448839426040649],[0.1213289424777031,0.28933531045913696,-0.9495073556900024],[0.21081222593784332,0.5589836835861206,-0.8019322752952576],[0.21081221103668213,0.5589836239814758,-0.8019322156906128],[-0.5941922068595886,0.7882744669914246,0.15987159311771393],[-0.5916424989700317,0.79185950756073,0.1513853222131729],[-0.5729642510414124,0.8142195343971252,0.0935879647731781],[-0.5729641914367676,0.8142194747924805,0.0935879647731781],[-0.010676821693778038,0.06160430610179901,0.9980434775352478],[-0.0025426747743040323,0.05963180214166641,0.9982172250747681],[0.12312792986631393,0.028629768639802933,0.9919777512550354],[0.12312791496515274,0.028629764914512634,0.9919776320457458],[-0.6724090576171875,0.7385257482528687,0.04945340007543564],[-0.9888207912445068,0.14657975733280182,-0.027346821501851082],[-0.9914775490760803,0.12642793357372284,-0.03143296018242836],[-0.7527928948402405,0.6582412719726562,0.004626768175512552],[-0.9602015614509583,-0.24244357645511627,-0.13868680596351624],[-0.9914775490760803,0.12642793357372284,-0.03143296018242836],[-0.9888207912445068,0.14657975733280182,-0.027346821501851082],[-0.927798330783844,-0.3665548264980316,-0.06948138028383255],[-0.9889450073242188,-0.10021429508924484,0.10929232835769653],[-0.9776735305786133,0.1435503214597702,0.15345264971256256],[-0.9914775490760803,0.12642793357372284,-0.03143296018242836],[-0.9602015614509583,-0.24244357645511627,-0.13868680596351624],[-0.9776735305786133,0.1435503214597702,0.15345264971256256],[-0.7619723081588745,0.6466788649559021,0.03470776230096817],[-0.7527928948402405,0.6582412719726562,0.004626768175512552],[-0.9914775490760803,0.12642793357372284,-0.03143296018242836],[-0.42595726251602173,0.8905650973320007,-0.15954336524009705],[-0.2557784914970398,0.9142258763313293,-0.3142741918563843],[-0.27628374099731445,0.9602630138397217,-0.039524421095848083],[-0.3624524176120758,0.931523859500885,-0.029859352856874466],[-0.9968475699424744,0.07736142724752426,0.017608797177672386],[-0.9888207912445068,0.14657975733280182,-0.027346821501851082],[-0.6724090576171875,0.7385257482528687,0.04945340007543564],[-0.6531815528869629,0.7541465759277344,0.06794661283493042],[-0.9304522275924683,-0.3664124310016632,0.0007129135774448514],[-0.927798330783844,-0.3665548264980316,-0.06948138028383255],[-0.9888207912445068,0.14657975733280182,-0.027346821501851082],[-0.9968475699424744,0.07736142724752426,0.017608797177672386],[0.005796223413199186,-0.9999817609786987,0.0016803601756691933],[0.005813247058540583,-0.9999827742576599,0.0006093024858273566],[0.005953340791165829,-0.9999483823776245,-0.008220691233873367],[-0.522422730922699,0.8478277921676636,-0.09089833498001099],[-0.5374892950057983,0.8233551383018494,-0.18218517303466797],[-0.6925307512283325,0.65254807472229,-0.3075423836708069],[-0.8752921223640442,0.48130813241004944,-0.04696930944919586],[-0.6925307512283325,0.65254807472229,-0.3075423836708069],[-0.8652673363685608,0.35965806245803833,-0.34922564029693604],[-0.9942461252212524,0.10711942613124847,-0.0001879819465102628],[-0.8752921223640442,0.48130813241004944,-0.04696930944919586],[0.005804457701742649,-0.9999387860298157,0.009420884773135185],[0.0058044558390975,-0.9999386668205261,0.009420882910490036],[0.0058044567704200745,-0.9999387264251709,0.00942088384181261],[0.0058044558390975,-0.9999386668205261,0.00942088384181261],[-0.5374892950057983,0.8233551383018494,-0.18218517303466797],[-0.42644965648651123,0.44377845525741577,-0.7881631851196289],[-0.3751875162124634,0.6258243918418884,-0.6837967038154602],[-0.6925307512283325,0.65254807472229,-0.3075423836708069],[-0.6925307512283325,0.65254807472229,-0.3075423836708069],[-0.3751875162124634,0.6258243918418884,-0.6837967038154602],[-0.34529393911361694,0.6041271686553955,-0.718193769454956],[-0.8652673363685608,0.35965806245803833,-0.34922564029693604],[-0.9942461252212524,0.10711942613124847,-0.0001879819465102628],[-0.8652673363685608,0.35965806245803833,-0.34922564029693604],[-0.9524434804916382,0.03328288346529007,-0.30289217829704285],[-0.9950538277626038,-0.0990152582526207,0.007980860769748688],[-0.5452626347541809,-0.8380714058876038,0.01802668161690235],[-0.5241155624389648,-0.8468071222305298,-0.09066712856292725],[-0.927798330783844,-0.3665548264980316,-0.06948138028383255],[-0.9304522275924683,-0.3664124310016632,0.0007129135774448514],[-0.9473277926445007,-0.29350194334983826,0.12816645205020905],[-0.9889450073242188,-0.10021429508924484,0.10929232835769653],[-0.9602015614509583,-0.24244357645511627,-0.13868680596351624],[-0.8023288249969482,-0.39257118105888367,-0.4496179223060608],[-0.7619723081588745,0.6466788649559021,0.03470776230096817],[-0.9776735305786133,0.1435503214597702,0.15345264971256256],[-0.9415944814682007,0.18800051510334015,0.2793843746185303],[-0.8426296710968018,0.49594929814338684,0.20978452265262604],[-0.7527928948402405,0.6582412719726562,0.004626768175512552],[-0.7619723081588745,0.6466788649559021,0.03470776230096817],[-0.42595726251602173,0.8905650973320007,-0.15954336524009705],[-0.3624524176120758,0.931523859500885,-0.029859352856874466],[-0.37878361344337463,0.9222328662872314,0.077520452439785],[-0.6724090576171875,0.7385257482528687,0.04945340007543564],[-0.7527928948402405,0.6582412719726562,0.004626768175512552],[-0.3624524176120758,0.931523859500885,-0.029859352856874466],[-0.6531815528869629,0.7541465759277344,0.06794661283493042],[-0.6724090576171875,0.7385257482528687,0.04945340007543564],[-0.37878361344337463,0.9222328662872314,0.077520452439785],[-0.38555166125297546,0.9189807176589966,0.08260949701070786],[-0.5132337212562561,0.853890597820282,-0.08638280630111694],[-0.5374892950057983,0.8233551383018494,-0.18218517303466797],[-0.522422730922699,0.8478277921676636,-0.09089833498001099],[-0.42569205164909363,0.8998918533325195,-0.09476727247238159],[-0.7427892088890076,-0.6691581606864929,0.02216845005750656],[-0.3007699251174927,-0.9530642628669739,0.03472787141799927],[-0.28909388184547424,-0.9559243321418762,0.051316678524017334],[-0.7525398135185242,-0.6579435467720032,0.028177954256534576],[-0.7857488393783569,0.5784883499145508,-0.21897518634796143],[-0.5374892950057983,0.8233551383018494,-0.18218517303466797],[-0.5132337212562561,0.853890597820282,-0.08638280630111694],[-0.613581657409668,0.7878734469413757,-0.052658841013908386],[-0.7459130883216858,-0.6660369038581848,0.002902149921283126],[-0.3141822814941406,-0.9491105079650879,0.02188180387020111],[-0.3007699251174927,-0.9530642628669739,0.03472787141799927],[-0.7427892088890076,-0.6691581606864929,0.02216845005750656],[-0.9991235136985779,-0.03501037135720253,-0.022945178672671318],[-0.7459130883216858,-0.6660369038581848,0.002902149921283126],[-0.7427892088890076,-0.6691581606864929,0.02216845005750656],[-0.8112958073616028,0.5839515328407288,-0.02827322669327259],[-0.996208131313324,-0.0641126036643982,-0.058812860399484634],[-0.7457423210144043,-0.6656471490859985,-0.02796381339430809],[-0.7459130883216858,-0.6660369038581848,0.002902149921283126],[-0.9991235136985779,-0.03501037135720253,-0.022945178672671318],[-0.7457423210144043,-0.6656471490859985,-0.02796381339430809],[-0.34119269251823425,-0.9399923086166382,0.00145998306106776],[-0.3141822814941406,-0.9491105079650879,0.02188180387020111],[-0.7459130883216858,-0.6660369038581848,0.002902149921283126],[-0.9964603781700134,-0.06455106288194656,-0.05384964123368263],[-0.7923129200935364,-0.6072733402252197,-0.05881613865494728],[-0.7457423210144043,-0.6656471490859985,-0.02796381339430809],[-0.996208131313324,-0.0641126036643982,-0.058812860399484634],[-0.7923129200935364,-0.6072733402252197,-0.05881613865494728],[-0.39867833256721497,-0.9157551527023315,-0.04947701096534729],[-0.34119269251823425,-0.9399923086166382,0.00145998306106776],[-0.7457423210144043,-0.6656471490859985,-0.02796381339430809],[-0.9978228807449341,-0.052017636597156525,-0.04054385796189308],[-0.8045254349708557,-0.5899363160133362,-0.06865759193897247],[-0.7923129200935364,-0.6072733402252197,-0.05881613865494728],[-0.9964603781700134,-0.06455106288194656,-0.05384964123368263],[-0.8045254349708557,-0.5899363160133362,-0.06865759193897247],[-0.4281114637851715,-0.9006050229072571,-0.07504181563854218],[-0.39867833256721497,-0.9157551527023315,-0.04947701096534729],[-0.7923129200935364,-0.6072733402252197,-0.05881613865494728],[-0.9999374747276306,-0.010656140744686127,-0.0033726776018738747],[-0.9999374747276306,-0.010656139813363552,-0.0033726776018738747],[-0.9999374747276306,-0.010656139813363552,-0.0033726771362125874],[-0.9999374747276306,-0.010656141676008701,-0.003372677369043231],[-0.46652281284332275,-0.8773670196533203,-0.11217646300792694],[-0.46652284264564514,-0.8773669600486755,-0.11217647045850754],[-0.46652284264564514,-0.8773670196533203,-0.11217647045850754],[-0.46652284264564514,-0.8773670196533203,-0.11217647790908813],[-0.998106837272644,0.010563105344772339,-0.060587745159864426],[-0.9981069564819336,0.010563106276094913,-0.06058775261044502],[-0.9981070160865784,0.010563107207417488,-0.06058775261044502],[-0.9981068968772888,0.010563105344772339,-0.060587745159864426],[-0.511318027973175,-0.8463997840881348,-0.14886631071567535],[-0.511318027973175,-0.8463997840881348,-0.14886629581451416],[-0.5113179683685303,-0.8463996648788452,-0.14886628091335297],[-0.5113181471824646,-0.8463999032974243,-0.14886634051799774],[-0.7703719735145569,0.36437028646469116,-0.5232220888137817],[-0.7748350501060486,0.07525312900543213,-0.6276682615280151],[-0.7226925492286682,-0.07164765894412994,-0.6874459385871887],[-0.7184540033340454,0.49049338698387146,-0.4931935667991638],[-0.7748350501060486,0.07525312900543213,-0.6276682615280151],[-0.3967260420322418,-0.543319821357727,-0.739872932434082],[-0.7226925492286682,-0.07164765894412994,-0.6874459385871887],[-0.3866487145423889,0.7524677515029907,0.5331932306289673],[-0.4746325612068176,0.5189173817634583,0.7109490036964417],[-0.4824405908584595,0.4865904748439789,0.7283408641815186],[-0.3866487443447113,0.7524677515029907,0.5331932306289673],[-0.37878361344337463,0.9222328662872314,0.077520452439785],[-0.3624524176120758,0.931523859500885,-0.029859352856874466],[-0.27628374099731445,0.9602630138397217,-0.039524421095848083],[-0.3125985860824585,0.9456348419189453,0.08975975215435028],[-0.38555166125297546,0.9189807176589966,0.08260949701070786],[-0.37878361344337463,0.9222328662872314,0.077520452439785],[-0.3125985860824585,0.9456348419189453,0.08975975215435028],[-0.32564088702201843,0.9408991932868958,0.09309463202953339],[-0.5132337212562561,0.853890597820282,-0.08638280630111694],[-0.42569205164909363,0.8998918533325195,-0.09476727247238159],[-0.4223349988460541,0.9020577669143677,-0.08902166038751602],[-0.47521063685417175,0.8792427778244019,-0.03327258676290512],[-0.613581657409668,0.7878734469413757,-0.052658841013908386],[-0.5132337212562561,0.853890597820282,-0.08638280630111694],[-0.47521063685417175,0.8792427778244019,-0.03327258676290512],[-0.49966830015182495,0.8654713034629822,0.03592948615550995],[-0.48874396085739136,0.8688843250274658,-0.07854470610618591],[-0.8112958073616028,0.5839515328407288,-0.02827322669327259],[-0.5200663208961487,0.8529512286186218,-0.044778332114219666],[-0.48747149109840393,0.8697009682655334,-0.07740731537342072],[-0.4989730417728424,0.8658506870269775,-0.0364481545984745],[-0.48874396085739136,0.8688843250274658,-0.07854470610618591],[-0.48747149109840393,0.8697009682655334,-0.07740731537342072],[-0.4985499382019043,0.8660683035850525,-0.037062011659145355],[-0.5233396291732788,0.8521240949630737,-0.0002806649135891348],[-0.4989730417728424,0.8658506870269775,-0.0364481545984745],[-0.4985499382019043,0.8660683035850525,-0.037062011659145355],[-0.5233396887779236,0.8521241545677185,-0.00028066494269296527],[-0.593992292881012,0.8027538061141968,0.052529819309711456],[-0.5939923524856567,0.8027538061141968,0.052529823035001755],[-0.5939923524856567,0.8027538657188416,0.052529823035001755],[-0.5939922332763672,0.8027538061141968,0.052529819309711456],[-0.6263992786407471,0.7756830453872681,0.07706866413354874],[-0.6263992786407471,0.7756831049919128,0.07706867158412933],[-0.6263992786407471,0.7756831645965576,0.07706866413354874],[-0.6263993382453918,0.7756831049919128,0.07706866413354874],[-0.6624122858047485,0.7462863922119141,0.06531944870948792],[-0.6624122262001038,0.7462863326072693,0.06531944870948792],[-0.6624122262001038,0.7462863326072693,0.06531943380832672],[-0.6624122858047485,0.7462863922119141,0.06531944870948792],[-0.7703719735145569,0.36437028646469116,-0.5232220888137817],[-0.7184540033340454,0.49049338698387146,-0.4931935667991638],[-0.5710006952285767,0.7150753736495972,-0.40326809883117676],[-0.3751875162124634,0.6258243918418884,-0.6837967038154602],[-0.42644965648651123,0.44377845525741577,-0.7881631851196289],[-0.08843350410461426,-0.2680386006832123,-0.9593408107757568],[-0.01909593679010868,0.41793292760849,-0.908277153968811],[-0.3751875162124634,0.6258243918418884,-0.6837967038154602],[-0.01909593679010868,0.41793292760849,-0.908277153968811],[-0.0025348279159516096,0.5433701276779175,-0.8394894003868103],[-0.34529393911361694,0.6041271686553955,-0.718193769454956],[-0.9440922141075134,-0.05124950408935547,0.3256736099720001],[-0.9889450073242188,-0.10021429508924484,0.10929232835769653],[-0.9473277926445007,-0.29350194334983826,0.12816645205020905],[-0.9089924097061157,-0.16209730505943298,0.3840016722679138],[-0.14601776003837585,-0.9890109300613403,0.023154597729444504],[-0.1164323017001152,-0.9908350110054016,-0.06847979128360748],[-0.5241155624389648,-0.8468071222305298,-0.09066712856292725],[-0.5452626347541809,-0.8380714058876038,0.01802668161690235],[-0.9950538277626038,-0.0990152582526207,0.007980860769748688],[-0.9836636781692505,-0.17351125180721283,0.04795341566205025],[-0.9323112368583679,-0.2517188787460327,0.25967937707901],[-0.9480769634246826,-0.18246516585350037,0.2604924142360687],[-0.07733840495347977,-0.994351327419281,-0.07269264757633209],[-0.07733839005231857,-0.9943512678146362,-0.0726926326751709],[-0.07733841240406036,-0.994351327419281,-0.07269264757633209],[-0.9524434804916382,0.03328288346529007,-0.30289217829704285],[-0.9473239183425903,-0.03956227004528046,-0.3178243041038513],[-0.9836636781692505,-0.17351125180721283,0.04795341566205025],[-0.9950538277626038,-0.0990152582526207,0.007980860769748688],[0.19794845581054688,-0.10567755252122879,-0.9744991660118103],[0.36142194271087646,-0.31621846556663513,-0.8771430850028992],[0.3618732988834381,-0.24133867025375366,-0.9004461169242859],[0.3067537546157837,-0.2993679940700531,-0.9034827351570129],[0.05825778469443321,0.1261458396911621,-0.9902995228767395],[0.19794845581054688,-0.10567755252122879,-0.9744991660118103],[0.3067537546157837,-0.2993679940700531,-0.9034827351570129],[0.05825778841972351,0.1261458396911621,-0.9902995228767395],[-0.573340117931366,0.03138911724090576,-0.8187159895896912],[-0.5588298439979553,0.24200040102005005,-0.7931865453720093],[-0.5588299036026001,0.24200041592121124,-0.793186604976654],[-0.5725812315940857,0.07158352434635162,-0.8167169094085693],[-0.5824649333953857,-0.08963058143854141,-0.8078991174697876],[-0.5974618196487427,-0.026273036375641823,-0.801466703414917],[-0.573340117931366,0.03138911724090576,-0.8187159895896912],[-0.5725812315940857,0.07158352434635162,-0.8167169094085693],[-0.9836636781692505,-0.17351125180721283,0.04795341566205025],[-0.9701706767082214,-0.13367219269275665,0.20223893225193024],[-0.8858831524848938,-0.2169192135334015,0.4100697338581085],[-0.9323112368583679,-0.2517188787460327,0.25967937707901],[0.4892696440219879,-0.6696873307228088,0.5586896538734436],[0.8253296613693237,-0.4897189140319824,0.2810806930065155],[0.7361050248146057,-0.5608598589897156,0.37892648577690125],[0.48926958441734314,-0.6696872711181641,0.5586895942687988],[-0.9473239183425903,-0.03956227004528046,-0.3178243041038513],[-0.9773173332214355,0.023850541561841965,-0.21043281257152557],[-0.9701706767082214,-0.13367219269275665,0.20223893225193024],[-0.9836636781692505,-0.17351125180721283,0.04795341566205025],[0.36142194271087646,-0.31621846556663513,-0.8771430850028992],[0.30721333622932434,0.06397239118814468,-0.9494879841804504],[0.3064556419849396,0.06269384920597076,-0.9498180150985718],[0.3618732988834381,-0.24133867025375366,-0.9004461169242859],[-0.5824649333953857,-0.08963058143854141,-0.8078991174697876],[-0.6289485692977905,0.09341081976890564,-0.7718148827552795],[-0.6298378705978394,0.08495340496301651,-0.7720667123794556],[-0.5974618196487427,-0.026273036375641823,-0.801466703414917],[-0.9701706767082214,-0.13367219269275665,0.20223893225193024],[-0.9699404239654541,0.08530983328819275,0.22789880633354187],[-0.6252967715263367,0.2084946185350418,0.7520199418067932],[-0.8858831524848938,-0.2169192135334015,0.4100697338581085],[0.44077548384666443,-0.15774056315422058,0.8836487531661987],[0.8349682092666626,-0.11871185153722763,0.5373412370681763],[0.8264356851577759,-0.12037667632102966,0.5500122308731079],[0.44077542424201965,-0.1577405482530594,0.8836486339569092],[-0.9773173332214355,0.023850541561841965,-0.21043281257152557],[-0.9860050678253174,0.010643646121025085,-0.1663745939731598],[-0.9699404239654541,0.08530983328819275,0.22789880633354187],[-0.9701706767082214,-0.13367219269275665,0.20223893225193024],[0.30721333622932434,0.06397239118814468,-0.9494879841804504],[0.27058839797973633,-0.22081521153450012,-0.9370286464691162],[0.26844555139541626,-0.19278335571289062,-0.9438068270683289],[0.3064556419849396,0.06269384920597076,-0.9498180150985718],[-0.6289485692977905,0.09341081976890564,-0.7718148827552795],[-0.6188177466392517,-0.11514642834663391,-0.7770494222640991],[-0.6176766753196716,-0.12217335402965546,-0.7768841981887817],[-0.6298378705978394,0.08495340496301651,-0.7720667123794556],[-0.9699404239654541,0.08530983328819275,0.22789880633354187],[-0.9185221791267395,0.179682195186615,0.3521808981895447],[-0.5893592238426208,0.2972886562347412,0.751182496547699],[-0.6252967715263367,0.2084946185350418,0.7520199418067932],[0.45717763900756836,0.2989414632320404,0.8376291394233704],[0.7812478542327881,0.20770178735256195,0.5886525511741638],[0.8054727911949158,0.19689813256263733,0.5589675903320312],[0.45717766880989075,0.298941433429718,0.8376291990280151],[-0.9860050678253174,0.010643646121025085,-0.1663745939731598],[-0.9825411438941956,-0.002801100490614772,-0.18602432310581207],[-0.9185221791267395,0.179682195186615,0.3521808981895447],[-0.9699404239654541,0.08530983328819275,0.22789880633354187],[0.9796860218048096,-0.0870121568441391,-0.18067669868469238],[0.9796860814094543,-0.0870121568441391,-0.18067671358585358],[0.9796860218048096,-0.0870121568441391,-0.18067669868469238],[0.9796860218048096,-0.0870121568441391,-0.18067669868469238],[0.27058839797973633,-0.22081521153450012,-0.9370286464691162],[0.2750524580478668,-0.29193371534347534,-0.9160352945327759],[0.2750525176525116,-0.2919337749481201,-0.9160354137420654],[0.26844555139541626,-0.19278335571289062,-0.9438068270683289],[-0.6188177466392517,-0.11514642834663391,-0.7770494222640991],[-0.6042844653129578,-0.19331619143486023,-0.7729612588882446],[-0.604284405708313,-0.19331616163253784,-0.7729611992835999],[-0.6176766753196716,-0.12217335402965546,-0.7768841981887817],[0.7592925429344177,-0.5591611266136169,-0.3328869938850403],[0.7637971043586731,-0.47234907746315,-0.43988677859306335],[0.7637970447540283,-0.47234907746315,-0.43988680839538574],[0.7611100077629089,-0.5448593497276306,-0.351908802986145],[0.653254508972168,-0.738763153553009,0.16579394042491913],[0.7592925429344177,-0.5591611266136169,-0.3328869938850403],[0.7611100077629089,-0.5448593497276306,-0.351908802986145],[0.7014369964599609,-0.7124874591827393,0.018645010888576508],[0.957516610622406,-0.28402209281921387,-0.04993342235684395],[0.9081516265869141,-0.15485897660255432,-0.38894644379615784],[0.9081515669822693,-0.15485896170139313,-0.38894644379615784],[0.958380937576294,-0.272652268409729,-0.08465664088726044],[0.8253296613693237,-0.4897189140319824,0.2810806930065155],[0.957516610622406,-0.28402209281921387,-0.04993342235684395],[0.958380937576294,-0.272652268409729,-0.08465664088726044],[0.7361050248146057,-0.5608598589897156,0.37892648577690125],[0.8349682092666626,-0.11871185153722763,0.5373412370681763],[0.9973436594009399,-0.06475552171468735,0.033351972699165344],[0.9980437755584717,-0.06244455277919769,-0.0030331613961607218],[0.8264356851577759,-0.12037667632102966,0.5500122308731079],[0.9973436594009399,-0.06475552171468735,0.033351972699165344],[0.9729381203651428,-0.04641494154930115,-0.22635598480701447],[0.972938060760498,-0.04641493782401085,-0.22635596990585327],[0.9980437755584717,-0.06244455277919769,-0.0030331613961607218],[0.005773970857262611,-0.9999786019325256,0.0030797752551734447],[0.005813247058540583,-0.9999827742576599,0.0006093024858273566],[0.005796223413199186,-0.9999817609786987,0.0016803601756691933],[0.005773970391601324,-0.9999785423278809,0.0030797747895121574],[0.8054727911949158,0.19689813256263733,0.5589675903320312],[0.7812478542327881,0.20770178735256195,0.5886525511741638],[0.9732228517532349,0.07332519441843033,0.21785473823547363],[0.9732228517532349,0.07332518696784973,0.21785475313663483],[-0.976742684841156,-0.052896250039339066,0.20778752863407135],[-0.9942461252212524,0.10711942613124847,-0.0001879819465102628],[-0.9950538277626038,-0.0990152582526207,0.007980860769748688],[-0.9480769634246826,-0.18246516585350037,0.2604924142360687],[-0.8752921223640442,0.48130813241004944,-0.04696930944919586],[-0.9942461252212524,0.10711942613124847,-0.0001879819465102628],[-0.976742684841156,-0.052896250039339066,0.20778752863407135],[-0.9018002152442932,0.43143555521965027,0.024890722706913948],[-0.522422730922699,0.8478277921676636,-0.09089833498001099],[-0.8752921223640442,0.48130813241004944,-0.04696930944919586],[-0.9018002152442932,0.43143555521965027,0.024890722706913948],[-0.5388258695602417,0.838491678237915,-0.08123032748699188],[-0.42569205164909363,0.8998918533325195,-0.09476727247238159],[-0.522422730922699,0.8478277921676636,-0.09089833498001099],[-0.5388258695602417,0.838491678237915,-0.08123032748699188],[-0.4188113212585449,0.9034200310707092,-0.09181131422519684],[-0.42569205164909363,0.8998918533325195,-0.09476727247238159],[-0.4188113212585449,0.9034200310707092,-0.09181131422519684],[-0.4022566080093384,0.9120044112205505,-0.08023528009653091],[-0.4223349988460541,0.9020577669143677,-0.08902166038751602],[0.453835129737854,-0.7205432653427124,0.5242624878883362],[0.653254508972168,-0.738763153553009,0.16579394042491913],[0.7014369964599609,-0.7124874591827393,0.018645010888576508],[0.45383507013320923,-0.7205432653427124,0.5242624282836914],[-0.8112958073616028,0.5839515328407288,-0.02827322669327259],[-0.7427892088890076,-0.6691581606864929,0.02216845005750656],[-0.7525398135185242,-0.6579435467720032,0.028177954256534576],[-0.8390973806381226,0.5439773201942444,-0.002080581383779645],[-0.8112958073616028,0.5839515328407288,-0.02827322669327259],[-0.8390973806381226,0.5439773201942444,-0.002080581383779645],[-0.5433249473571777,0.8394855856895447,0.007872949354350567],[-0.5200663208961487,0.8529512286186218,-0.044778332114219666],[-0.9415944814682007,0.18800051510334015,0.2793843746185303],[-0.9776735305786133,0.1435503214597702,0.15345264971256256],[-0.9889450073242188,-0.10021429508924484,0.10929232835769653],[-0.9440922141075134,-0.05124950408935547,0.3256736099720001],[-0.3431074023246765,-0.3458298444747925,0.8733149170875549],[-0.3431074023246765,-0.3458298146724701,0.8733147978782654],[-0.3431074023246765,-0.3458298444747925,0.8733148574829102],[-0.00481108482927084,-0.9999883770942688,-0.00021707858832087368],[-0.004620146472007036,-0.9999879598617554,0.001657801796682179],[-0.005666486918926239,-0.9999467730522156,-0.008618608117103577],[-0.004471795167773962,-0.9999850988388062,0.0031143990345299244],[-0.004471795167773962,-0.9999850392341614,0.0031143990345299244],[-0.004620146472007036,-0.9999879598617554,0.001657801796682179],[-0.00481108482927084,-0.9999883770942688,-0.00021707858832087368],[-0.0010187785374000669,-0.9999849796295166,0.005365046672523022],[-0.0010187787702307105,-0.9999850988388062,0.005365047138184309],[-0.0010187787702307105,-0.9999851584434509,0.005365047603845596],[-0.0010187785374000669,-0.9999849796295166,0.005365046672523022],[-0.1169370636343956,0.10038254410028458,-0.9880532622337341],[-0.062225598841905594,0.01109904982149601,-0.9980003833770752],[-0.6522122621536255,0.1848730444908142,-0.7351468801498413],[-0.7579457759857178,0.27697327733039856,-0.5905961990356445],[-0.6522122621536255,0.1848730444908142,-0.7351468801498413],[-0.8674748539924622,0.37473905086517334,-0.32719752192497253],[-0.8674747943878174,0.37473902106285095,-0.32719749212265015],[-0.7579457759857178,0.27697327733039856,-0.5905961990356445],[-0.05369451642036438,0.7826659679412842,0.6201216578483582],[-0.2027406543493271,0.552531898021698,0.8084582090377808],[0.5579318404197693,0.6933944225311279,0.45597830414772034],[0.5375236868858337,0.6949065327644348,0.4776747524738312],[0.5375236868858337,0.6949065327644348,0.4776747524738312],[0.5579318404197693,0.6933944225311279,0.45597830414772034],[0.8256932497024536,0.5639258027076721,0.014774173498153687],[0.8919774293899536,0.4263274669647217,-0.1504036784172058],[0.8951589465141296,0.40545105934143066,-0.18520253896713257],[0.577497124671936,0.14261436462402344,-0.8038396239280701],[0.7394495010375977,0.2839336097240448,-0.6104065179824829],[0.7394495010375977,0.2839336097240448,-0.6104065179824829],[0.577497124671936,0.14261436462402344,-0.8038396239280701],[-0.062225598841905594,0.01109904982149601,-0.9980003833770752],[-0.1169370636343956,0.10038254410028458,-0.9880532622337341],[-0.600369393825531,0.3730711340904236,0.7073715329170227],[-0.5113011002540588,-0.13511663675308228,0.8487134575843811],[-0.5113010406494141,-0.13511662185192108,0.8487133979797363],[-0.2027406543493271,0.552531898021698,0.8084582090377808],[-0.062225598841905594,0.01109904982149601,-0.9980003833770752],[-0.07047327607870102,-0.056778404861688614,-0.9958964586257935],[-0.34511494636535645,-0.029002906754612923,-0.9381122589111328],[-0.6522122621536255,0.1848730444908142,-0.7351468801498413],[-0.9913008809089661,-0.13160249590873718,0.0017998266266658902],[-0.9913009405136108,-0.13160249590873718,0.001799826743081212],[-0.9913008809089661,-0.13160249590873718,0.0017998265102505684],[-0.9913009405136108,-0.13160249590873718,0.001799826743081212],[0.4942286014556885,-0.19463640451431274,0.8472630977630615],[0.4942286014556885,-0.19463637471199036,0.8472630977630615],[0.4942285716533661,-0.19463635981082916,0.8472630381584167],[0.4942286014556885,-0.19463637471199036,0.8472630977630615],[0.9881885051727295,-0.1460365206003189,-0.04644080996513367],[0.988188624382019,-0.1460365206003189,-0.046440813690423965],[0.9881885051727295,-0.14603650569915771,-0.04644080623984337],[0.9881885051727295,-0.1460365206003189,-0.04644080996513367],[0.9552457928657532,-0.07108645141124725,-0.2871449589729309],[0.9552457928657532,-0.07108644396066666,-0.2871449291706085],[0.9552457332611084,-0.07108644396066666,-0.2871449291706085],[0.9552457928657532,-0.07108644396066666,-0.2871449589729309],[0.577497124671936,0.14261436462402344,-0.8038396239280701],[0.23435240983963013,-0.08183195441961288,-0.9687013626098633],[-0.07047327607870102,-0.056778404861688614,-0.9958964586257935],[-0.062225598841905594,0.01109904982149601,-0.9980003833770752],[-0.5763696432113647,0.6622241139411926,0.4788082242012024],[-0.600369393825531,0.3730711340904236,0.7073715329170227],[-0.2027406543493271,0.552531898021698,0.8084582090377808],[-0.05369451642036438,0.7826659679412842,0.6201216578483582],[0.8391563296318054,0.5393615961074829,0.07004023343324661],[0.8951589465141296,0.40545105934143066,-0.18520253896713257],[0.8919774293899536,0.4263274669647217,-0.1504036784172058],[-0.882590115070343,-0.03650842234492302,-0.46872344613075256],[-0.882590115070343,-0.036508429795503616,-0.4687235355377197],[-0.882590115070343,-0.03650842607021332,-0.46872347593307495],[-0.882590115070343,-0.03650842607021332,-0.4687235355377197],[-0.889030396938324,0.451751708984375,0.07446818053722382],[-0.600369393825531,0.3730711340904236,0.7073715329170227],[-0.5763696432113647,0.6622241139411926,0.4788082242012024],[0.7184011936187744,-0.6829391717910767,-0.13226424157619476],[0.7996262311935425,-0.5610377788543701,0.21408973634243011],[0.8230825662612915,-0.48958125710487366,-0.28782880306243896],[-0.8023288249969482,-0.39257118105888367,-0.4496179223060608],[-0.9208201766014099,-0.29577285051345825,-0.2541823387145996],[-0.9269654154777527,-0.3435562551021576,0.15067937970161438],[-0.9473277926445007,-0.29350194334983826,0.12816645205020905],[-0.15191736817359924,-0.44608259201049805,0.8820042610168457],[-0.25170090794563293,-0.22472083568572998,0.9413539171218872],[-0.26237815618515015,-0.23019830882549286,0.9371053576469421],[-0.06973143666982651,-0.5524761080741882,0.8306068181991577],[0.7996262311935425,-0.5610377788543701,0.21408973634243011],[0.9406462907791138,-0.33650943636894226,-0.04411286488175392],[0.8721233010292053,-0.2860887944698334,-0.396930992603302],[0.8230825662612915,-0.48958125710487366,-0.28782880306243896],[-0.42734047770500183,-0.3831574618816376,-0.8188837766647339],[-0.42732101678848267,-0.3530570864677429,-0.8323144912719727],[-0.4079180657863617,-0.11905945837497711,-0.905222475528717],[-0.4048710763454437,-0.10387067496776581,-0.9084548354148865],[-0.9269654154777527,-0.3435562551021576,0.15067937970161438],[-0.9208201766014099,-0.29577285051345825,-0.2541823387145996],[-0.9601566791534424,-0.03858241066336632,-0.2767859101295471],[-0.975777804851532,-0.06980238854885101,0.2073289453983307],[0.017434529960155487,-0.09912088513374329,0.9949226379394531],[0.192292720079422,-0.014951392076909542,0.9812236428260803],[0.1922927349805832,-0.014951393008232117,0.9812237024307251],[-0.01032331120222807,-0.11210950464010239,0.993642270565033],[0.9751980304718018,-0.11135800182819366,-0.19128048419952393],[0.9552814364433289,-0.05336516350507736,-0.29084277153015137],[0.7979761958122253,-0.04630596935749054,-0.6009073853492737],[0.8455327749252319,-0.09537559002637863,-0.5253358483314514],[-0.41832828521728516,-0.009852799586951733,-0.908242404460907],[-0.45054566860198975,0.015090747736394405,-0.8926258683204651],[-0.4505457282066345,0.01509074866771698,-0.8926258683204651],[-0.4249478876590729,-0.004779197741299868,-0.9052051901817322],[-0.9693365097045898,0.016211897134780884,-0.24520176649093628],[-0.9765109419822693,0.04683363065123558,-0.21031633019447327],[-0.9765108227729797,0.046833623200654984,-0.21031630039215088],[-0.9990457892417908,-0.007293658331036568,0.043061260133981705],[-0.3569827079772949,-0.42108333110809326,0.8338177800178528],[-0.3664427697658539,-0.2725484073162079,0.8896274566650391],[-0.36669278144836426,-0.26424306631088257,0.892026960849762],[-0.3673076629638672,-0.1461908519268036,0.9185385704040527],[-0.36669278144836426,-0.26424306631088257,0.892026960849762],[-0.3664427697658539,-0.2725484073162079,0.8896274566650391],[-0.4056936502456665,0.8296096324920654,-0.3836149275302887],[-0.24315686523914337,0.8125669956207275,-0.5297257900238037],[-0.2557784914970398,0.9142258763313293,-0.3142741918563843],[-0.42595726251602173,0.8905650973320007,-0.15954336524009705],[-0.7374564409255981,-0.445467084646225,0.5076581835746765],[-0.9089924097061157,-0.16209730505943298,0.3840016722679138],[-0.9473277926445007,-0.29350194334983826,0.12816645205020905],[-0.9269654154777527,-0.3435562551021576,0.15067937970161438],[-0.7374564409255981,-0.445467084646225,0.5076581835746765],[-0.9269654154777527,-0.3435562551021576,0.15067937970161438],[-0.975777804851532,-0.06980238854885101,0.2073289453983307],[-0.8294135928153992,-0.08758260309696198,0.5517268180847168],[0.981040894985199,-0.1073567122220993,0.16134801506996155],[0.9929326176643372,-0.05349728837609291,0.1059369444847107],[0.9552814364433289,-0.05336516350507736,-0.29084277153015137],[0.9751980304718018,-0.11135800182819366,-0.19128048419952393],[0.6430631875991821,-0.5529570579528809,0.5298190712928772],[0.8140770792961121,-0.37448689341545105,0.44388967752456665],[0.9406462907791138,-0.33650943636894226,-0.04411286488175392],[0.7996262311935425,-0.5610377788543701,0.21408973634243011],[0.45072656869888306,-0.7097382545471191,0.5414029955863953],[0.6430631875991821,-0.5529570579528809,0.5298190712928772],[0.7996262311935425,-0.5610377788543701,0.21408973634243011],[0.002940503880381584,-0.9999933838844299,-0.0021192675922065973],[0.0027015653904527426,-0.9999943971633911,-0.00194975221529603],[0.00006992677663220093,-1,-0.0000827307885629125],[0.0033051983918994665,-0.999991774559021,-0.0023780008777976036],[0.003305198159068823,-0.9999916553497314,-0.0023780004121363163],[0.0027015653904527426,-0.9999943971633911,-0.00194975221529603],[0.002940503880381584,-0.9999933838844299,-0.0021192675922065973],[-0.0027710082940757275,-0.9999944567680359,-0.0018955926643684506],[-0.003205943154171109,-0.9999924898147583,-0.002180637326091528],[-0.00000987338262348203,-0.9999999403953552,-0.00008601825538789853],[-0.003205943154171109,-0.9999924898147583,-0.002180637326091528],[-0.0027710082940757275,-0.9999944567680359,-0.0018955926643684506],[-0.003571542212739587,-0.999990701675415,-0.0024202410131692886],[-0.003571541979908943,-0.9999906420707703,-0.0024202410131692886],[0.10659994184970856,0.22384177148342133,-0.9687782526016235],[0.024921411648392677,0.016289647668600082,-0.9995567202568054],[-0.7404559850692749,0.273591011762619,-0.6138997673988342],[-0.702672004699707,0.40140748023986816,-0.5874725580215454],[0.35547885298728943,0.776340663433075,0.5205093026161194],[0.35547885298728943,0.7763406038284302,0.5205092430114746],[0.5515531897544861,0.7534278631210327,0.3579602837562561],[0.6331616640090942,0.7248905301094055,0.27136680483818054],[0.5515531897544861,0.7534278631210327,0.3579602837562561],[0.7814196944236755,0.2204984575510025,-0.583749532699585],[0.8275907635688782,0.36162346601486206,-0.42932745814323425],[0.6331616640090942,0.7248905301094055,0.27136680483818054],[0.8275907635688782,0.36162346601486206,-0.42932745814323425],[0.7814196944236755,0.2204984575510025,-0.583749532699585],[0.024921411648392677,0.016289647668600082,-0.9995567202568054],[0.10659994184970856,0.22384177148342133,-0.9687782526016235],[-0.5469435453414917,-0.15651975572109222,0.8224075436592102],[-0.5469436049461365,-0.15651977062225342,0.822407603263855],[-0.5469436049461365,-0.15651977062225342,0.822407603263855],[-0.5469436049461365,-0.15651975572109222,0.822407603263855],[0.024921411648392677,0.016289647668600082,-0.9995567202568054],[0.014822925440967083,-0.09616053104400635,-0.9952554702758789],[-0.5146061778068542,-0.10557375848293304,-0.8509023189544678],[-0.7404559850692749,0.273591011762619,-0.6138997673988342],[0.5432253479957581,-0.2052222639322281,0.8141191601753235],[0.5432253479957581,-0.2052222341299057,0.8141191005706787],[0.5432254076004028,-0.2052222490310669,0.8141191601753235],[0.5432254076004028,-0.2052222341299057,0.8141191005706787],[0.9766983985900879,0.013071822933852673,-0.21421776711940765],[0.9766983985900879,0.013071823865175247,-0.21421778202056885],[0.9766984581947327,0.013071823865175247,-0.21421779692173004],[0.9766984581947327,0.013071822933852673,-0.21421779692173004],[0.7814196944236755,0.2204984575510025,-0.583749532699585],[0.584661066532135,-0.05284975841641426,-0.8095544576644897],[0.014822925440967083,-0.09616053104400635,-0.9952554702758789],[0.024921411648392677,0.016289647668600082,-0.9995567202568054],[-0.9812504649162292,-0.06350800395011902,-0.1819731593132019],[-0.9812504649162292,-0.06350800395011902,-0.1819731742143631],[-0.9812504649162292,-0.06350800395011902,-0.1819731444120407],[-0.981250524520874,-0.06350801140069962,-0.1819731742143631],[-0.7404559850692749,0.273591011762619,-0.6138997673988342],[-0.8199886679649353,0.5490710735321045,-0.1616777777671814],[-0.8199886083602905,0.5490710139274597,-0.1616777628660202],[-0.702672004699707,0.40140748023986816,-0.5874725580215454],[-0.08212380856275558,-0.9820094108581543,-0.17003856599330902],[-0.4672388732433319,-0.8609240055084229,-0.20123977959156036],[-0.5241155624389648,-0.8468071222305298,-0.09066712856292725],[-0.1164323017001152,-0.9908350110054016,-0.06847979128360748],[-0.9602015614509583,-0.24244357645511627,-0.13868680596351624],[-0.927798330783844,-0.3665548264980316,-0.06948138028383255],[-0.5241155624389648,-0.8468071222305298,-0.09066712856292725],[-0.4672388732433319,-0.8609240055084229,-0.20123977959156036],[-0.975777804851532,-0.06980238854885101,0.2073289453983307],[-0.9601566791534424,-0.03858241066336632,-0.2767859101295471],[-0.9693365097045898,0.016211897134780884,-0.24520176649093628],[-0.9990457892417908,-0.007293658331036568,0.043061260133981705],[-0.4079180657863617,-0.11905945837497711,-0.905222475528717],[-0.41832828521728516,-0.009852799586951733,-0.908242404460907],[-0.4249478876590729,-0.004779197741299868,-0.9052051901817322],[-0.4048710763454437,-0.10387067496776581,-0.9084548354148865],[0.9406462907791138,-0.33650943636894226,-0.04411286488175392],[0.9751980304718018,-0.11135800182819366,-0.19128048419952393],[0.8455327749252319,-0.09537559002637863,-0.5253358483314514],[0.8721233010292053,-0.2860887944698334,-0.396930992603302],[0.8140770792961121,-0.37448689341545105,0.44388967752456665],[0.981040894985199,-0.1073567122220993,0.16134801506996155],[0.9751980304718018,-0.11135800182819366,-0.19128048419952393],[0.9406462907791138,-0.33650943636894226,-0.04411286488175392],[-0.25170090794563293,-0.22472083568572998,0.9413539171218872],[0.017434529960155487,-0.09912088513374329,0.9949226379394531],[-0.01032331120222807,-0.11210950464010239,0.993642270565033],[-0.26237815618515015,-0.23019830882549286,0.9371053576469421],[-0.975777804851532,-0.06980238854885101,0.2073289453983307],[-0.9990457892417908,-0.007293658331036568,0.043061260133981705],[-0.7721172571182251,-0.06749111413955688,0.6318860650062561],[-0.8294135928153992,-0.08758260309696198,0.5517268180847168],[-0.04987340047955513,-0.5272462964057922,0.8482475280761719],[-0.05676192045211792,-0.4981537163257599,0.8652287721633911],[-0.07380927354097366,-0.42228904366493225,0.9034512639045715],[-0.07380927354097366,-0.42228904366493225,0.9034512042999268],[-0.15191736817359924,-0.44608259201049805,0.8820042610168457],[-0.06973143666982651,-0.5524761080741882,0.8306068181991577],[-0.05676192045211792,-0.4981537163257599,0.8652287721633911],[-0.04987340047955513,-0.5272462964057922,0.8482475280761719],[-0.3823562264442444,0.7435925006866455,-0.5485195517539978],[-0.37371256947517395,0.7407341003417969,-0.5582579374313354],[-0.36483970284461975,0.7376870512962341,-0.5680755376815796],[-0.382356196641922,0.7435925602912903,-0.5485196113586426],[-0.8538330793380737,0.20588931441307068,0.47809889912605286],[-0.952582061290741,0.091758131980896,0.2901168465614319],[-0.9451659917831421,0.2027226686477661,-0.2560560405254364],[-0.9093189835548401,0.4027748107910156,0.1044585332274437],[-0.12615735828876495,-0.3186514675617218,0.9394389390945435],[-0.12615734338760376,-0.3186514675617218,0.9394389390945435],[-0.12615735828876495,-0.3186514973640442,0.9394389390945435],[-0.12615734338760376,-0.3186514675617218,0.9394388794898987],[-0.7794650793075562,0.1058986485004425,0.617429792881012],[-0.8184667229652405,0.018256813287734985,0.5742636919021606],[-0.952582061290741,0.091758131980896,0.2901168465614319],[-0.8538330793380737,0.20588931441307068,0.47809889912605286],[-0.37371256947517395,0.7407341003417969,-0.5582579374313354],[-0.3530687987804413,0.7334728837013245,-0.5808269381523132],[-0.35306885838508606,0.7334729433059692,-0.580826997756958],[-0.36483970284461975,0.7376870512962341,-0.5680755376815796],[-0.952582061290741,0.091758131980896,0.2901168465614319],[-0.9957332015037537,-0.09205184876918793,-0.006468675099313259],[-0.9985544085502625,0.053307000547647476,0.006882904563099146],[-0.9451659917831421,0.2027226686477661,-0.2560560405254364],[-0.2771816551685333,-0.5325545072555542,0.7997224926948547],[-0.3361224830150604,-0.726291835308075,0.5996015071868896],[-0.3422775864601135,-0.7490001320838928,0.5673136711120605],[-0.2771816551685333,-0.5325545072555542,0.7997224926948547],[-0.8184667229652405,0.018256813287734985,0.5742636919021606],[-0.9033880233764648,-0.30862173438072205,0.2977290153503418],[-0.9957332015037537,-0.09205184876918793,-0.006468675099313259],[-0.952582061290741,0.091758131980896,0.2901168465614319],[-0.9957332015037537,-0.09205184876918793,-0.006468675099313259],[-0.9655999541282654,-0.2024228423833847,0.16322247684001923],[-0.9866953492164612,0.01157301478087902,0.16216762363910675],[-0.9985544085502625,0.053307000547647476,0.006882904563099146],[-0.3361224830150604,-0.726291835308075,0.5996015071868896],[-0.40485987067222595,-0.873597264289856,0.2700302004814148],[-0.4063848555088043,-0.8713362812995911,0.27499908208847046],[-0.3422775864601135,-0.7490001320838928,0.5673136711120605],[-0.9033880233764648,-0.30862173438072205,0.2977290153503418],[-0.9148621559143066,-0.37137898802757263,0.15844525396823883],[-0.9655999541282654,-0.2024228423833847,0.16322247684001923],[-0.9957332015037537,-0.09205184876918793,-0.006468675099313259],[-0.33072471618652344,0.7130166292190552,0.6182462573051453],[-0.33072471618652344,0.7130166888237,0.61824631690979],[-0.33072471618652344,0.7130166888237,0.6182462573051453],[-0.33072471618652344,0.7130166888237,0.6182462573051453],[-0.7358707785606384,0.20594705641269684,0.6450425386428833],[-0.7616881728172302,0.14306820929050446,0.6319513916969299],[-0.6089897155761719,0.4303660988807678,0.66627037525177],[-0.6089898347854614,0.4303662180900574,0.6662704348564148],[-0.40485987067222595,-0.873597264289856,0.2700302004814148],[-0.4520634412765503,-0.7724806070327759,0.4459960162639618],[-0.4520634114742279,-0.7724805474281311,0.4459960460662842],[-0.4063848555088043,-0.8713362812995911,0.27499908208847046],[-0.8172847032546997,-0.05075358599424362,0.5739944577217102],[-0.8172847628593445,-0.05075358971953392,0.5739944577217102],[-0.7616881728172302,0.14306820929050446,0.6319513916969299],[-0.7358707785606384,0.20594705641269684,0.6450425386428833],[-0.5218523144721985,0.12872415781021118,0.843267560005188],[-0.4824405908584595,0.4865904748439789,0.7283408641815186],[-0.4746325612068176,0.5189173817634583,0.7109490036964417],[-0.5218522548675537,0.12872417271137238,0.8432676196098328],[-0.0833234190940857,0.9758344888687134,0.20200049877166748],[-0.0833234190940857,0.9758344888687134,0.20200049877166748],[-0.08332342654466629,0.9758344888687134,0.20200051367282867],[-0.08332342654466629,0.9758344888687134,0.20200049877166748],[-0.4056936502456665,0.8296096324920654,-0.3836149275302887],[-0.42595726251602173,0.8905650973320007,-0.15954336524009705],[-0.7619723081588745,0.6466788649559021,0.03470776230096817],[-0.7022985219955444,0.7114459872245789,0.024928009137511253],[-0.7165502309799194,0.5546915531158447,-0.4229336977005005],[-0.6365807056427002,0.5654520392417908,-0.5244320034980774],[-0.8085176348686218,0.5237716436386108,-0.2682582139968872],[-0.8085176348686218,0.5237715840339661,-0.2682582139968872],[-0.5550318956375122,0.5669994950294495,-0.6086469292640686],[-0.555031955242157,0.5669995546340942,-0.6086468696594238],[-0.6365807056427002,0.5654520392417908,-0.5244320034980774],[-0.7165502309799194,0.5546915531158447,-0.4229336977005005],[-0.48476293683052063,0.7562461495399475,0.4394277036190033],[-0.484762966632843,0.7562462687492371,0.4394277036190033],[-0.48476290702819824,0.7562460899353027,0.43942761421203613],[-0.48476290702819824,0.7562460899353027,0.43942761421203613],[-0.2713889181613922,0.7295088171958923,0.6278254389762878],[-0.2713889181613922,0.7295088768005371,0.6278254389762878],[-0.2713888883590698,0.7295088768005371,0.6278254389762878],[-0.9646292328834534,-0.18377573788166046,0.18898944556713104],[-0.9646292328834534,-0.18377572298049927,0.18898946046829224],[-0.9646291136741638,-0.18377570807933807,0.18898943066596985],[-0.9646292328834534,-0.18377573788166046,0.18898946046829224],[-0.10347545146942139,0.23581929504871368,-0.966272234916687],[-0.12586091458797455,0.3021451234817505,-0.9449166059494019],[-0.12141623347997665,0.28894558548927307,-0.9496148228645325],[-0.10347545146942139,0.23581930994987488,-0.966272234916687],[0.5906820893287659,0.791027843952179,0.15927840769290924],[0.5870707631111145,0.7962804436683655,0.14589446783065796],[0.5851361155509949,0.7989506125450134,0.1389012187719345],[0.5906820297241211,0.791027843952179,0.15927839279174805],[0.015503320842981339,0.08264702558517456,0.9964582324028015],[-0.0007061606738716364,0.07823371142148972,0.9969347715377808],[-0.007696251384913921,0.07632371783256531,0.9970533847808838],[0.015503320842981339,0.08264703303575516,0.9964582324028015],[-0.9076508283615112,-0.3570781648159027,0.22060135006904602],[-0.907650887966156,-0.3570781648159027,0.2206013798713684],[-0.907650887966156,-0.3570782244205475,0.2206013947725296],[-0.9076509475708008,-0.3570781648159027,0.2206013798713684],[-0.12586091458797455,0.3021451234817505,-0.9449166059494019],[-0.21108824014663696,0.5587577223777771,-0.8020172119140625],[-0.21108822524547577,0.5587576627731323,-0.8020172119140625],[-0.12141623347997665,0.28894558548927307,-0.9496148228645325],[0.5870707631111145,0.7962804436683655,0.14589446783065796],[0.5699755549430847,0.816970944404602,0.08767196536064148],[0.5699754953384399,0.816970944404602,0.08767195791006088],[0.5851361155509949,0.7989506125450134,0.1389012187719345],[-0.0007061606738716364,0.07823371142148972,0.9969347715377808],[-0.10919831693172455,0.04812295362353325,0.9928544759750366],[-0.10919830948114395,0.04812295362353325,0.9928543567657471],[-0.007696251384913921,0.07632371783256531,0.9970533847808838],[-0.8077946901321411,-0.550134539604187,0.21170684695243835],[-0.7513380646705627,-0.646805465221405,-0.13089564442634583],[-0.8316102027893066,-0.4946551024913788,-0.25246918201446533],[0.7430096864700317,0.0557236447930336,0.6669567823410034],[0.7430096864700317,0.055723633617162704,0.6669567227363586],[0.7430097460746765,0.0557236522436142,0.6669568419456482],[0.7430096864700317,0.0557236447930336,0.6669568419456482],[-0.4017104208469391,0.8051612377166748,0.436284601688385],[-0.4017103314399719,0.80516117811203,0.4362845718860626],[-0.4017103910446167,0.80516117811203,0.4362845718860626],[-0.4017103612422943,0.80516117811203,0.436284601688385],[-0.722770631313324,0.05587755888700485,0.688825249671936],[-0.7227705717086792,0.055877555161714554,0.688825249671936],[-0.7227705717086792,0.05587755888700485,0.688825249671936],[-0.7227706909179688,0.05587756633758545,0.6888251900672913],[0.41099199652671814,0.8038304448127747,0.43004918098449707],[0.41099199652671814,0.8038303256034851,0.43004921078681946],[0.41099199652671814,0.8038303852081299,0.43004921078681946],[0.4109920263290405,0.8038303852081299,0.43004924058914185],[0.47810599207878113,-0.8609418272972107,-0.17376361787319183],[0.11485107243061066,-0.9807531833648682,-0.15790025889873505],[0.1343700885772705,-0.9893593192100525,-0.05579141527414322],[0.5313248038291931,-0.8438926935195923,-0.07442483305931091],[0.9485647082328796,-0.2816155254840851,-0.14462943375110626],[0.47810599207878113,-0.8609418272972107,-0.17376361787319183],[0.5313248038291931,-0.8438926935195923,-0.07442483305931091],[0.925125002861023,-0.375169962644577,-0.058234188705682755],[-0.8023288249969482,-0.39257118105888367,-0.4496179223060608],[-0.16912665963172913,-0.595000147819519,-0.7857295274734497],[-0.015343433246016502,-0.6270102262496948,-0.7788599729537964],[-0.015343430452048779,-0.6270101070404053,-0.7788599133491516],[-0.9602015614509583,-0.24244357645511627,-0.13868680596351624],[-0.16912665963172913,-0.595000147819519,-0.7857295274734497],[-0.8023288249969482,-0.39257118105888367,-0.4496179223060608],[0.01625058241188526,-0.6071835160255432,-0.7943953275680542],[0.2705770432949066,-0.6124230623245239,-0.7427825927734375],[0.7406501770019531,-0.43752405047416687,-0.5099119544029236],[0.01625058427453041,-0.6071835160255432,-0.7943953275680542],[-0.40848779678344727,-0.621504008769989,-0.6684836149215698],[-0.42732101678848267,-0.3530570864677429,-0.8323144912719727],[-0.42734047770500183,-0.3831574618816376,-0.8188837766647339]],"edges":[7,1,0,3,5,4,2,8,10,14,21,23,31,27,36,34,33,32,37,38,46,82,84,44,45,53,49,51,52,57,209,60,1481,59,64,67,492,74,71,80,76,79,88,83,96,86,95,91,98,94,99,101,106,102,107,109,110,115,117,122,118,123,125,130,126,131,133,138,134,139,141,145,142,495,17,494,150,151,160,155,158,159,168,163,166,167,170,171,174,175,178,179,182,183,186,187,190,137,129,105,93,85,193,194,199,220,207,1303,603,602,113,114,121,58,208,205,212,352,211,219,218,223,222,227,48,198,228,235,225,221,239,237,238,247,246,251,249,250,254,259,257,258,263,267,266,271,269,270,274,279,277,278,282,283,287,286,290,291,293,294,298,215,241,301,303,300,305,307,304,243,315,242,311,308,319,262,289,318,330,288,335,336,340,344,349,55,24,20,75,154,213,356,361,87,162,364,601,393,405,383,385,384,389,392,400,395,398,399,403,408,406,28,29,30,410,412,39,40,41,327,418,372,373,422,376,377,426,380,381,436,391,394,325,414,42,413,388,514,454,1460,458,448,449,452,455,457,470,459,474,462,478,482,471,473,475,476,479,480,484,487,210,332,18,16,19,69,65,15,204,11,62,496,451,598,466,483,506,504,477,508,587,512,515,516,517,521,518,520,523,524,525,526,530,531,532,472,538,539,540,543,544,547,549,550,552,554,556,536,562,567,535,576,578,467,583,463,461,460,591,510,595,456,501,202,201,499,609,611,610,615,614,617,619,618,622,625,627,626,631,630,633,635,634,638,675,652,643,642,645,647,646,650,653,655,146,147,659,148,149,661,663,368,666,370,671,369,673,676,683,687,693,63,613,629,641,657,696,698,697,700,701,704,705,709,712,714,688,716,689,720,690,691,731,729,730,727,733,734,728,738,736,740,749,747,761,751,764,758,759,760,763,762,770,806,812,772,771,779,775,781,780,783,939,788,1301,789,792,797,1222,798,801,808,804,809,816,813,824,810,825,821,822,818,829,827,830,826,837,835,834,845,843,846,842,853,851,854,850,861,859,862,858,869,867,1219,745,880,886,888,894,896,900,904,908,912,916,915,919,923,950,933,1332,838,782,935,936,1082,937,943,944,947,948,776,926,958,959,953,949,963,965,964,971,972,975,977,976,980,983,985,984,987,991,992,995,997,996,1000,1003,1005,1004,1008,1007,1011,1012,1016,1015,1021,1020,1024,969,1027,1030,1031,1034,967,1039,968,1035,1038,1043,988,1017,1044,1056,1018,1059,1066,1070,1074,785,754,750,805,884,942,1086,817,892,1094,1334,1117,1135,1111,1109,1110,1113,1118,1124,1122,1126,1125,1129,1132,1134,757,756,755,1138,1136,769,768,767,1051,1146,1099,1098,1150,1102,1101,1154,1106,1105,1160,1119,1123,1053,1142,766,1143,1114,1239,1184,1176,1175,1177,1189,1178,1183,1181,1200,1187,1204,1192,1208,1212,1199,1197,1203,1202,1207,1206,1210,1214,938,1062,746,743,795,791,739,928,735,786,1226,1179,1329,1196,1211,1232,1234,1201,1238,1316,1244,1243,1242,1245,1248,1246,1250,1249,1255,1254,1258,1257,1256,1198,1262,1261,1260,1265,1264,1269,1275,1274,1272,1278,1276,1295,1282,1285,1297,1311,1309,1195,1312,1191,1185,1186,1320,1236,1324,1182,1229,930,931,1223,1340,1341,1344,1345,1350,1349,1353,1356,1357,1360,1361,1366,1365,1369,1404,1387,1372,1373,1378,1377,1381,1384,876,1388,874,873,1394,1097,1397,1096,1411,1412,1416,1425,793,1346,1362,1374,1390,1429,1427,1428,1433,1432,1437,1436,1440,1445,1443,1423,1449,1422,1453,1421,1420,1174,1466,1462,574,1478,575,1486,1300,1307,447,1489],"indices":[3,2,1,-5,0,5,4,-2,144,0,1,-144,143,1,2,-143,141,21,41,-141,101,102,3,-5,100,101,4,-6,116,117,-119,6,7,10,-10,10,7,8,-12,120,121,119,-126,9,10,14,-14,10,11,71,-15,8,16,15,-12,65,100,5,-18,145,18,0,-145,142,194,19,-144,2,21,141,-143,22,21,2,-4,102,103,22,-4,12,23,6,-10,25,13,58,-58,13,105,12,-10,27,25,57,-57,26,24,25,-28,28,26,27,-30,29,27,56,-56,30,28,29,-32,31,29,55,-65,32,30,31,-34,33,31,64,-55,34,32,33,-36,35,33,54,-54,36,34,35,-38,37,35,53,-53,38,36,37,-40,39,37,-53,188,187,189,-191,22,42,41,-22,103,104,42,-23,12,44,43,-24,105,106,44,-13,26,46,45,-25,28,47,46,-27,30,48,47,-29,32,49,48,-31,34,50,49,-33,36,51,50,-35,38,51,-37,14,59,58,-14,14,71,72,-60,107,171,145,-145,66,65,17,-62,16,139,68,-68,94,65,-67,15,16,67,-70,60,73,74,-71,72,71,73,-61,15,73,71,-12,74,73,15,-70,67,68,76,-76,76,68,95,-97,69,67,75,-78,70,74,79,-79,74,69,77,-80,75,76,81,-81,81,76,96,-83,77,75,80,-84,78,79,85,-85,79,77,83,-86,80,81,87,-87,87,81,82,-89,83,80,86,-90,99,98,84,-91,84,85,91,-91,85,83,89,-92,93,92,60,-71,95,94,92,-94,97,93,70,-79,96,95,93,-98,82,96,97,-99,98,97,78,-85,120,125,116,-119,82,98,99,-89,100,139,16,-9,7,101,100,-9,6,102,101,-8,23,103,102,-7,23,43,104,-104,68,65,94,-96,24,105,13,-26,24,45,106,-106,19,107,144,-144,192,191,-194,118,117,-123,120,118,122,-124,121,120,123,-125,91,89,111,-113,111,89,86,-127,87,88,113,-111,88,114,-114,99,90,115,-115,90,91,112,-116,109,110,117,-117,112,111,119,-122,125,126,109,-117,110,113,122,-118,113,114,123,-123,114,115,124,-124,115,112,121,-125,86,87,110,-110,88,99,-115,111,126,125,-120,126,86,-110,129,18,-131,18,145,146,-131,128,127,169,-171,151,129,167,-169,130,166,167,-130,146,165,166,-131,132,131,135,-137,150,133,137,-150,133,134,138,-138,134,147,148,-139,68,139,-66,100,65,-140,20,141,140,-41,128,146,145,-172,128,170,165,-147,131,150,149,-136,127,151,168,-170,63,151,-128,152,153,-155,156,152,154,-156,154,153,-158,157,158,155,-155,137,138,159,-161,159,138,148,-165,136,135,161,-163,161,135,149,-164,149,137,160,-164,164,162,153,-153,160,159,156,-156,159,164,152,-157,162,161,157,-154,157,161,163,-159,163,160,155,-159,0,18,-368,165,147,134,-167,167,166,134,-134,168,167,133,-151,169,168,150,-132,170,169,131,-133,165,170,132,-148,171,107,108,-64,128,171,63,-128,20,40,172,-174,19,194,195,-175,108,107,175,-177,107,19,174,-176,173,172,177,-179,174,195,196,-180,176,175,180,-182,175,174,179,-181,179,196,197,-185,181,180,185,-187,180,179,184,-186,183,182,187,-189,184,197,188,-191,186,185,191,-193,185,184,190,-192,193,191,190,-190,178,177,182,-184,20,194,142,-142,195,194,20,-174,196,195,173,-179,203,202,204,-206,188,197,-184,197,196,198,-200,196,178,200,-199,178,183,201,-201,183,197,199,-202,199,198,202,-204,198,200,204,-203,200,201,205,-205,201,199,203,-206,209,210,207,-209,206,207,210,-212,316,315,207,-207,315,314,208,-208,313,140,41,-228,277,210,209,-279,276,211,210,-278,289,291,-291,212,215,216,-214,216,217,214,-214,293,298,292,-295,215,219,220,-217,216,220,250,-218,214,217,221,-223,245,223,211,-277,317,316,206,-225,314,315,225,-356,208,314,313,-228,228,209,208,-228,278,209,228,-280,218,215,212,-230,231,57,58,-220,219,215,218,-281,233,56,57,-232,232,233,231,-231,234,235,233,-233,235,55,56,-234,236,237,235,-235,237,64,55,-236,238,239,237,-237,239,54,64,-238,240,241,239,-239,241,53,54,-240,242,243,241,-241,243,52,53,-242,38,39,243,-243,39,52,-244,352,353,189,-188,228,227,41,-43,279,228,42,-105,218,229,43,-45,280,218,44,-107,232,230,45,-47,234,232,46,-48,236,234,47,-49,238,236,48,-50,240,238,49,-51,242,240,50,-245,38,242,-245,220,219,58,-60,220,59,72,-251,281,316,317,-343,66,61,223,-246,222,246,247,-313,94,66,-246,221,248,246,-223,60,249,252,-252,72,60,251,-251,221,217,250,-252,252,248,221,-252,246,253,254,-248,254,272,271,-248,248,255,253,-247,249,256,257,-253,252,257,255,-249,253,258,259,-255,259,260,272,-255,255,261,258,-254,256,262,263,-258,257,263,261,-256,258,264,265,-260,265,266,260,-260,261,267,264,-259,275,268,262,-275,262,268,269,-264,263,269,267,-262,270,249,60,-93,271,270,92,-95,273,256,249,-271,272,273,270,-272,260,274,273,-273,274,262,256,-274,293,291,289,-299,260,266,275,-275,276,214,222,-313,213,214,276,-278,212,213,277,-279,229,212,278,-280,229,279,104,-44,247,271,94,-246,230,231,219,-281,230,280,106,-46,225,315,316,-282,192,193,-355,291,295,-291,293,296,295,-292,294,297,296,-294,269,285,284,-268,284,299,264,-268,265,283,286,-267,266,286,-288,275,287,288,-269,268,288,285,-270,282,289,290,-284,285,294,292,-285,298,289,282,-300,283,290,295,-287,286,295,296,-288,287,296,297,-289,288,297,294,-286,264,282,283,-266,266,287,-276,284,292,298,-300,299,282,-265,62,151,-303,224,303,318,-318,301,341,340,-301,151,339,338,-303,303,302,338,-338,318,303,337,-337,305,309,308,-305,322,321,310,-307,306,310,311,-308,307,311,320,-320,247,245,-313,276,312,-246,226,40,140,-314,301,342,317,-319,301,318,336,-342,304,308,321,-323,300,340,339,-152,63,300,-152,323,325,-325,327,326,325,-324,325,328,-325,328,325,326,-330,310,331,330,-312,309,333,332,-309,332,334,321,-309,321,334,331,-311,335,323,324,-334,331,326,327,-331,333,324,328,-333,328,329,334,-333,334,329,326,-332,330,327,323,-336,330,335,320,-312,62,368,223,-62,206,211,223,-369,336,337,307,-320,338,306,307,-338,339,322,306,-339,340,304,322,-340,341,305,304,-341,336,319,305,-342,342,63,108,-282,301,300,63,-343,226,343,172,-41,225,344,356,-356,108,176,345,-282,281,345,344,-226,343,346,177,-173,344,347,357,-357,176,181,348,-346,345,348,347,-345,347,350,358,-358,181,186,351,-349,348,351,350,-348,349,352,187,-183,350,353,352,-359,186,192,354,-352,351,354,353,-351,193,189,353,-355,346,349,182,-178,226,313,314,-356,356,343,226,-356,357,346,343,-357,364,366,365,-364,352,349,-359,358,360,359,-358,357,359,361,-347,346,361,362,-350,349,362,360,-359,360,364,363,-360,359,363,365,-362,361,365,366,-363,362,366,364,-361,151,62,-130,136,148,147,-133,309,320,335,-334,309,305,319,-321,136,162,164,-149,367,62,61,-18,0,367,17,-6,224,368,62,-303,206,368,-225,62,367,18,-130,224,302,-304],"vertices":[[0.0157338739516657,-0.3731179032440599,-0.32995091819094924],[0.11687308808801855,-0.35310123346158495,-0.30618964469864796],[0.20075006391154804,-0.3372663122765826,-0.35346234278807576],[0.21376653949833713,-0.4586353926753043,-0.3644821931439939],[0.1462680608791268,-0.4789949608683861,-0.31827696717897946],[0.02909283600772916,-0.5189211101896504,-0.3429796328397152],[0.2266313792215815,-0.7336079497801105,-0.39612760920656453],[0.18517119924079262,-0.7556619933046275,-0.3344087141160079],[0.09432772032275161,-0.7898673630747339,-0.29925991060658697],[0.22226867697366093,-0.8420862070617336,-0.4150355298249529],[0.19372548486164387,-0.8609811631868679,-0.3710872863761998],[0.12479181300360287,-0.904793730260175,-0.3345827036261946],[0.24086914945346416,-0.8390654904968264,-0.4509747269824572],[0.20488551963023072,-0.9318172060262624,-0.4513162548461153],[0.18687376572179482,-0.9250028362338856,-0.4340865469444228],[0.04034784009380665,-0.9272736433976296,-0.3350249887126051],[-0.0078003602774770475,-0.8265943526910275,-0.3005164197585371],[-0.04373171759553546,-0.5172659428701358,-0.40378309583825756],[-0.09231542545243976,-0.3607376308873834,-0.38384447209790634],[0.15854741538183958,-0.13278122569164597,-0.34811464995196056],[0.2972139356461112,-0.1430455393723507,-0.44456236529564985],[0.23242065243943788,-0.32572418249098567,-0.41988411557904415],[0.24351925354214898,-0.44110500646333844,-0.42748771832946075],[0.252313553282717,-0.7308192054110468,-0.4513450337412126],[0.2433512022051315,-1.0189215634222721,-0.4529352257357231],[0.20102896114772306,-1.013305564646629,-0.45336631327220467],[0.2353650743605905,-1.1121492655025969,-0.45227552889553296],[0.19898175263022277,-1.1098628719296966,-0.4533390681460935],[0.2293866915720696,-1.2196178468059924,-0.4572879533035819],[0.19466017197241614,-1.2189368533761642,-0.45971414784690423],[0.23087171157634068,-1.3224632753063412,-0.4639676934142127],[0.19624807885840334,-1.325536119290168,-0.4671454917588955],[0.24046647291478918,-1.436182545573114,-0.46933615431146397],[0.2055254743763768,-1.446555466679321,-0.4703311662145881],[0.252759589885161,-1.554674573298902,-0.47019247411768966],[0.22173674930799536,-1.5634024649876934,-0.4699648545095093],[0.2687676611527293,-1.6862270170202698,-0.4779183845814437],[0.24120226749595863,-1.6983844161619797,-0.47879375214034814],[0.26825861566220754,-1.719871773499349,-0.5010424340581925],[0.26020185153787434,-1.7242664776298982,-0.5010424340581925],[0.3197018078010073,-0.1407680582408563,-0.5006491822967628],[0.2552811060983087,-0.3152468200074686,-0.5018674102944807],[0.2670241388944766,-0.43296294716576134,-0.5013808881294625],[0.27804397888709087,-0.7327584075746746,-0.5010438432338127],[0.2644026375247217,-0.8445926343043153,-0.5012655974254291],[0.27245442726315416,-1.02588222161335,-0.5010424340581925],[0.261020220924998,-1.1187079104064535,-0.5010424340581925],[0.2536758717681,-1.2182037947072404,-0.5010424340581925],[0.25622632232590437,-1.3184962025504028,-0.5010424340581925],[0.26545098935332867,-1.4316689536195342,-0.5010424340581925],[0.27729740646980294,-1.5491772136269946,-0.5010424340581925],[0.2911469258821232,-1.6794230519850688,-0.5011391413341425],[0.22696242460328386,-1.6998574976400886,-0.5010424340581925],[0.20443881977633327,-1.5657790607582625,-0.5010424340581925],[0.19011830892563286,-1.4453513336655854,-0.5010424340581925],[0.1802932335199744,-1.2211875971834414,-0.5010424340581925],[0.18347766956084377,-1.1098716600114549,-0.5010424340581925],[0.1854752171257671,-1.0132325240803182,-0.5010280889949845],[0.19111136216430857,-0.9315884257280386,-0.5010019172437798],[0.17386292777236012,-0.9277026012751475,-0.5010465165029092],[0.08906378370924217,-0.9548489029197704,-0.501088208199981],[-0.06665870366583032,-0.5265560049363746,-0.5014962457294326],[-0.078245084759337,-0.3738967988063995,-0.5013970703273921],[-0.01604988185546874,-0.10566638703784598,-0.5011546151739334],[0.18099271508406745,-1.3273355204833734,-0.5010424340581925],[-0.05480312538865528,-0.6709641919909357,-0.3976845816302308],[-0.06256868067170884,-0.6769721620122628,-0.5011454623726946],[-0.11204301087094687,-0.8565196364723835,-0.32028962444107667],[-0.12241249136023896,-0.7232612892861385,-0.3597764448083851],[-0.10270766375722834,-0.9002413380965681,-0.33380131050760065],[-0.08204717371623016,-0.9101598490507312,-0.413349793349582],[0.13048358825780237,-0.9546151482356457,-0.41622589000772553],[0.13346652021647087,-0.958536249375217,-0.5009846822849621],[0.04798418570308527,-0.9756241354622152,-0.3987578468415579],[-0.08720121785454632,-0.9262443600483095,-0.3680969861084156],[-0.21179569784386576,-0.8715243326505318,-0.3265818080735104],[-0.2193511682290395,-0.8426875895905401,-0.35474862571230337],[-0.19416174854460033,-0.909378787557864,-0.3298906555784211],[-0.1924488602128539,-0.932054401327302,-0.39099745248387646],[-0.18823163802592574,-0.9382437395312353,-0.3582642004046108],[-0.2750072921469279,-0.8740381385655331,-0.32588829577249834],[-0.2801507449885968,-0.8540190955864513,-0.3531126330959411],[-0.2821261772628692,-0.8679019848375231,-0.38047982856447427],[-0.2675889697263625,-0.9079510558978845,-0.32710078160922584],[-0.2765896650286004,-0.9321858494747322,-0.3837428909924891],[-0.26883188222351695,-0.9344988974654178,-0.35078252710693714],[-0.4267743033031933,-0.8256152484594821,-0.3125861453487443],[-0.41525332502097906,-0.8035847918147783,-0.3492709045014004],[-0.4280193610042675,-0.8188384767338728,-0.38258437724278593],[-0.4226837621438738,-0.8719605448408216,-0.32197409659336446],[-0.4306821186870878,-0.8817829672406664,-0.38352406982937093],[-0.42711614724762226,-0.8939579425458928,-0.3496974477290955],[0.008775288421379646,-0.8553944303816083,-0.5010269360786841],[-0.09516815286015318,-0.8814535385343818,-0.42935742935838395],[-0.05679333573437484,-0.7560765047364248,-0.5010469728121367],[-0.12058950328722012,-0.7788019867245188,-0.41608177790285594],[-0.2159641088691417,-0.8602680849679791,-0.3862440122234432],[-0.21207272968532798,-0.9019510759839108,-0.3946854725540805],[-0.28562601009646116,-0.9074875674915717,-0.39227286430224995],[-0.4302202987727124,-0.8450427955017354,-0.38708264186980895],[0.047167515897811096,-0.6791209516351804,-0.3398766109147567],[0.1709339679007159,-0.6310600310098489,-0.3169962700755864],[0.231705004121167,-0.604650394463928,-0.3798302877621651],[0.2622930004641656,-0.60038373931711,-0.43731419796280585],[0.28546111989100476,-0.603102427751403,-0.5010424340581925],[0.2409513926336917,-0.934164038387858,-0.4528639521127373],[0.27376094972001586,-0.941379177870981,-0.5010327615914043],[0.049126511972002684,-0.08819054030379636,-0.36489817616495357],[0.018218496802715256,-0.08854790847755756,-0.5010668748125175],[-0.46377085281879393,-0.7895889218239331,-0.2971575278588029],[-0.45636754682566677,-0.7549061146403834,-0.3498977496680369],[-0.45828259990024145,-0.877163130694887,-0.3169331782810771],[-0.4583390565893903,-0.8942146208583772,-0.3520752870961398],[-0.4644544163480042,-0.788427029637139,-0.4077718797159925],[-0.46387807156156546,-0.8406193642926086,-0.40818318888686617],[-0.46217133385071935,-0.8838545917022967,-0.390958071928828],[-0.49951540413434625,-0.7913033024714498,-0.3031468957495216],[-0.49959904053125,-0.7614625625238005,-0.3510575484674311],[-0.49896611178133565,-0.7953574891604771,-0.3519750117670216],[-0.49996629788781516,-0.8805045915173604,-0.31976269188791984],[-0.49952915429558187,-0.8451740156564786,-0.35314405463354825],[-0.49990291025336314,-0.889536542544342,-0.35328441522238424],[-0.49966809009205,-0.7952897131525778,-0.4044108633389465],[-0.49965027767758863,-0.8429828193937563,-0.4015198538864043],[-0.4997033879911181,-0.8820197065563317,-0.3935165022306816],[-0.49965733022978676,-0.8450465262911612,-0.302257786449566],[-0.463179983861855,-0.8383702371607491,-0.29531634182403005],[-0.10272930233589711,-0.16585560664736737,-0.44868022412420827],[-0.13205952520386238,-0.19296169867262497,-0.3831356739235531],[-0.16003569950300478,-0.3415203138292653,-0.43662639584227586],[-0.15760469638664498,-0.30427682750690266,-0.36785071255310703],[-0.30677624915600726,-0.232708306343606,-0.415839509764528],[-0.3094584587603607,-0.23335704917151023,-0.38487470887119096],[-0.30205394026067023,-0.3101054812798075,-0.4024668836921931],[-0.30504232331722175,-0.2984135602987709,-0.37090520312562025],[-0.4234108463680647,-0.24053069398557692,-0.413733981753992],[-0.41847725561324045,-0.22793260570626633,-0.38376743129626667],[-0.42432253212569737,-0.3068465952632886,-0.39068407653542603],[-0.4246738325849899,-0.2931137252003436,-0.3637795093189772],[-0.051220282490342606,-0.6930680519175892,-0.34476092934090247],[0.2719064157497424,-0.20831020782295456,-0.5016535894660049],[0.2511784813265716,-0.21130271547448226,-0.42484384776810785],[0.21959461292622018,-0.21522704996488917,-0.3620583303440626],[0.12108154291979645,-0.2197703431476189,-0.3193187072196598],[0.017971725808816563,-0.23448179927691126,-0.3169183587564141],[-0.08431503770164961,-0.23733875491264045,-0.3216714052112969],[-0.1516474961914186,-0.2578748645795091,-0.3571408700718523],[-0.3083902922945819,-0.26226681207120506,-0.36120380338942204],[-0.4237945736054485,-0.256448086343494,-0.3555723322009665],[-0.42830959569497495,-0.28334042486127,-0.41496676412152544],[-0.3020111190887069,-0.27108235658489127,-0.42389026317256434],[-0.1076786919476086,-0.22509585851325942,-0.501982106565876],[-0.5,-0.21596079261187445,-0.33077423087406194],[-0.49999734926115896,-0.185241741926996,-0.38373594757883583],[-0.4999942979158492,-0.22088300964060242,-0.38520442774998653],[-0.4996264874179352,-0.30819492328832554,-0.3853031796734226],[-0.4999790590012291,-0.2835335968470868,-0.3437950694118182],[-0.4999947817526028,-0.22138880105368064,-0.43861549213281975],[-0.49998963119053463,-0.28295841275069156,-0.42676496596632524],[-0.45393069880587344,-0.28608431685079405,-0.3407934316895016],[-0.45779052172912854,-0.31559875780995467,-0.3845846296300429],[-0.45572155027331196,-0.21269214436302508,-0.4416028595855832],[-0.45459817330568564,-0.17278154777017896,-0.38287177238820835],[-0.4550752739117502,-0.28277373867412203,-0.42454726037207285],[-0.45428692183454705,-0.21439535336887278,-0.3278947765054353],[-0.22387354826437772,-0.258915423203538,-0.3567911707430216],[-0.2216229702699638,-0.3012862681565195,-0.37382199647841524],[-0.22169967944587665,-0.3157089611842667,-0.41712619685761],[-0.22315190995641787,-0.2634123716909581,-0.4379340168093574],[-0.21796864130093413,-0.20472491918490737,-0.4234266659515598],[-0.22136836461827125,-0.22076128227228675,-0.38601531483165097],[-0.02890937411386968,-0.1216716394867371,-0.36486806040364544],[0.3824839467879616,-0.0681177739569852,-0.500636049440301],[0.34634768622400336,-0.07018745011747107,-0.4531830796948856],[0.2012077074144275,-0.07321005280369897,-0.39566503277100007],[0.1407647319441383,-0.061373252833299696,-0.40000969250672597],[0.09443549868393697,-0.05275910876877471,-0.5012453470437112],[0.4385008380433101,0.015364940330685029,-0.49941540699516873],[0.4366655383651865,0.01783509600940625,-0.47237079397524157],[0.30078032161773516,0.011838515259131266,-0.3857192974173338],[0.23099366693734358,0.00789565118124369,-0.4234622742639669],[0.2013940810728465,0.015051305299635609,-0.5011811777894433],[0.42289594075300685,0.09580283300843684,-0.5010181272020051],[0.42208818338913834,0.07572583843360992,-0.46825062931155204],[0.32322392173811354,0.10887145674075316,-0.40441861509030863],[0.25354985399194485,0.11311551988493806,-0.4200373992079185],[0.21850232068882236,0.11390259209410225,-0.5036258164432295],[0.37841357261814845,0.1460189270519252,-0.5011937110923375],[0.3790469777561918,0.12570971156195965,-0.4623441212176466],[0.34349205709118114,0.20098526945822714,-0.5045958380484868],[0.3353287582021377,0.17853677785837951,-0.46196078778581334],[0.28469796618738064,0.18731938779208046,-0.45704552453404257],[0.2517401724012108,0.19016755534605145,-0.504213288989222],[0.2952965586006234,0.20770433830738666,-0.5034788011559114],[0.21990634110934093,-0.14534830696550788,-0.39642938861788357],[0.29191546850380656,-0.06299651931239891,-0.413714757825146],[0.37619599138354365,0.014600252858074758,-0.3898211138513619],[0.3884891912603471,0.08487655292397467,-0.39827697917450383],[0.4472388443167665,0.03054821696267429,-0.3776938097443522],[0.45035853043449303,0.07633196735563008,-0.3874609957340894],[0.46825827775372786,0.03383881468931116,-0.4202576764152431],[0.46514116173538356,0.07918519220193365,-0.4172287521135995],[0.499099304526217,0.06935808558869894,-0.3669188960775318],[0.4976656865095882,0.0721331711231431,-0.3679765748797028],[0.5,0.06954023101910223,-0.36926747983749664],[0.49912202088849766,0.07276230657995475,-0.37004048904318687],[0.014025711286525078,-0.3769411540676397,-0.6762976767373217],[0.1166960414031637,-0.3541797839579317,-0.6952468329421674],[0.1997245942580851,-0.3349985311975949,-0.6496201591473352],[0.2131222736177436,-0.45565539094083046,-0.6375479774540894],[0.14562798177333314,-0.4804601092373136,-0.6833074155359549],[0.02779211700108508,-0.5221509297293871,-0.6575783682510077],[0.22611155589494125,-0.733508234069406,-0.6068996148655231],[0.18478332150017285,-0.7556419714013765,-0.6679505431993294],[0.09560634476535268,-0.7898673838013418,-0.7031108188862343],[0.22231386097892714,-0.8421591854482209,-0.5880210534872538],[0.19315857068180886,-0.8606810004509666,-0.6313146055716296],[0.12489440971280819,-0.9049104210627661,-0.6673919818424863],[0.24086143915531777,-0.839423542648649,-0.5506863856349979],[0.20505381968654335,-0.9317840020003741,-0.5513094948305568],[0.18648895551914713,-0.9240108193256059,-0.5691943915352168],[0.04060605217527735,-0.9273373155371607,-0.666763229827921],[-0.007180800513524488,-0.8276637005734577,-0.7007530843288725],[-0.044430577361390944,-0.5218498187511735,-0.5994006037603241],[-0.09172272737235188,-0.3602500685259711,-0.6433657393945322],[0.15781937255203238,-0.13131382330410718,-0.6561658188313297],[0.2976272242080412,-0.14265525734521217,-0.5587326776406795],[0.23243192771414645,-0.32559754291659293,-0.581638175400213],[0.24393950624434035,-0.4369945159438957,-0.5735269365686133],[0.2523594834458682,-0.7309077702066902,-0.5505988053532309],[0.24335252870803847,-1.018949627249396,-0.5491405123098729],[0.20114420108775977,-1.013432660206396,-0.5487046628352217],[0.2353650743605905,-1.1121492655025969,-0.549809339220852],[0.19898175263022277,-1.1098628719296966,-0.5487457999702915],[0.2293866915720696,-1.2196178468059924,-0.544796914812803],[0.19466017197241614,-1.2189368533761642,-0.5423707202694806],[0.23087171157634068,-1.3224632753063412,-0.5381171747021722],[0.19624807885840334,-1.325536119290168,-0.5349393763574893],[0.24046647291478918,-1.436182545573114,-0.532748713804921],[0.2055254743763768,-1.446555466679321,-0.5317537019017968],[0.252759589885161,-1.554674573298902,-0.5318923939986953],[0.22173674930799536,-1.5634024649876934,-0.5321200136068756],[0.2687676611527293,-1.6862270170202698,-0.5241664835349412],[0.24120226749595863,-1.6983844161619797,-0.5232911159760367],[0.2911469258821232,-1.6794230519850688,-0.5009457267822424],[-0.05484238158405624,-0.672512334879628,-0.6046755980191589],[-0.11204118692944987,-0.858167816334203,-0.6822526591855005],[-0.12278872074720759,-0.7234529275029692,-0.6435124526886958],[-0.10295783391482594,-0.9013768245848719,-0.6674776241864128],[-0.0820468835437193,-0.9101596003314363,-0.5887338726235435],[0.13201420679949805,-0.9545253191169193,-0.5885892009002601],[0.04599861811753991,-0.9755767958897252,-0.6012558942517867],[-0.08862426530113582,-0.9270451947251326,-0.6322341933485318],[-0.21114270606133784,-0.8741242783480497,-0.6765369446991532],[-0.21932345675425013,-0.8432597061489631,-0.6477895851358175],[-0.19589780922400163,-0.9154613008245763,-0.6696728310477678],[-0.19382369756942086,-0.9322362980384101,-0.6112669806002257],[-0.1909037330456141,-0.940904828722118,-0.6376876955180799],[-0.2750377602605707,-0.8769901464251846,-0.6774817463945905],[-0.27972848180543725,-0.8543324404449898,-0.6502125359650004],[-0.2821780559624936,-0.8677616242486872,-0.6211630031847952],[-0.2700695508888676,-0.9143649047188103,-0.6730120223066737],[-0.2784561997048598,-0.933285188758823,-0.6178712447681147],[-0.27270896004786566,-0.9386388715846272,-0.644430807232427],[-0.42572666654255964,-0.8270603075636829,-0.6890976214511677],[-0.4139749285710651,-0.8031217179406238,-0.6534145792592979],[-0.4275875014016409,-0.8185790832357507,-0.6190361734029692],[-0.4247734809342186,-0.8747751767431777,-0.6774742226359154],[-0.4309104740898493,-0.8802124707053322,-0.6177584816577245],[-0.42932257756716596,-0.8942068276537992,-0.6478504177300635],[-0.09504026968928514,-0.8814571864173757,-0.5726744719114608],[-0.12047770396409818,-0.7789066353679084,-0.5859783789152361],[-0.21665867822715762,-0.8602362488982136,-0.6158060559182437],[-0.21216902550572553,-0.90201317290124,-0.6074334493791174],[-0.2855788985166584,-0.9073714570340023,-0.6098593848398407],[-0.43029517364382436,-0.8450573663071035,-0.6150858166563185],[0.047357951971382484,-0.6792039409732931,-0.662085897671771],[0.17010888309262606,-0.6312954749125191,-0.6853874550004009],[0.2292896910470028,-0.6048164767731931,-0.6279650613720673],[0.2614418001300962,-0.5997977877479002,-0.5652052604867992],[0.24063037893022265,-0.9342026727850214,-0.5488849532342162],[0.047794868866341655,-0.08709733609564996,-0.6391417292435102],[-0.46269711089548465,-0.7894318141358975,-0.7047319090715018],[-0.4562206521736839,-0.7544916653884097,-0.6527699817529777],[-0.45818819538281663,-0.8776880113138599,-0.6840246598030355],[-0.4596655154522453,-0.8945779997484353,-0.647003124361587],[-0.4650906221689427,-0.7882718080704241,-0.5939648850203716],[-0.463919252740677,-0.8408684981198102,-0.5938237782736504],[-0.4626553545530033,-0.8834295718802838,-0.6111947172817116],[-0.49956175287782156,-0.7910449867569396,-0.701991851504443],[-0.4994893809065426,-0.7629113316908189,-0.6509875556516588],[-0.4992063691148421,-0.7965032353197015,-0.6498371460056525],[-0.4999477326764771,-0.8804072593665668,-0.6821375850583272],[-0.4994203452714323,-0.8450264007548706,-0.6487087272906495],[-0.4997690715831771,-0.8893797250288173,-0.648749164902702],[-0.49950178254285044,-0.7969555313577374,-0.5970185050753521],[-0.4995649540052589,-0.8423817477640687,-0.6016025156793413],[-0.4996591523900909,-0.8819662319078974,-0.6088373247133806],[-0.4996434631575284,-0.8445155313228518,-0.6999270046436026],[-0.46008564897644105,-0.8361049640013197,-0.7073144236917588],[-0.10073992105449436,-0.17157981904296205,-0.555338224063406],[-0.1309199763004063,-0.19583428217072602,-0.6189802841047122],[-0.1603829738187088,-0.33934092136975347,-0.5731183684916371],[-0.1550045641496558,-0.30652694951594234,-0.635000957149896],[-0.3073782534830513,-0.23318661427458193,-0.5859535225306877],[-0.30983226313420265,-0.23310039158563362,-0.6162887164368828],[-0.30155925830943725,-0.31064435235912646,-0.6003238186936125],[-0.3041533383769137,-0.2944227348501558,-0.6326613687377685],[-0.42350301241183413,-0.24037246706071363,-0.5880192813622765],[-0.4187311461969597,-0.22861152647530247,-0.617957208374464],[-0.42394422489628475,-0.30679386677273945,-0.6121638105616315],[-0.42450341841466954,-0.29365396423578527,-0.6381033676399208],[-0.050511349593037935,-0.6930275313991051,-0.6577023859094986],[0.25107791582494254,-0.2106731033056884,-0.5776820566565604],[0.2192018022529154,-0.21441363423705845,-0.6407266204080451],[0.12002829961172035,-0.21854890341626987,-0.6841317334595516],[0.018076934070619832,-0.23520737564037597,-0.6855676521296596],[-0.08445946070563803,-0.23725284312281097,-0.6836694057432822],[-0.15250342219209378,-0.25917744898086603,-0.6452775202558816],[-0.30830547901497224,-0.26038023476508687,-0.6396968292568307],[-0.42320864794449853,-0.2558019757947956,-0.6466892406112426],[-0.42830960605827895,-0.28334042486127,-0.5871181039948594],[-0.30200867334897236,-0.2710837038144061,-0.5781968019642602],[-0.4999985122181752,-0.21595045003452223,-0.6713120051984457],[-0.49999734926115896,-0.185241741926996,-0.6183489205375491],[-0.4999942979158492,-0.22088300964060242,-0.6168804403663984],[-0.4995978163659697,-0.30772459510139893,-0.6161100012600903],[-0.49998198436762503,-0.2836024506385979,-0.6582798913859809],[-0.4999947817526028,-0.22138880105368064,-0.5634693759835652],[-0.4999928085147582,-0.28288149630869946,-0.5752844441055601],[-0.45392641357968594,-0.286066927226749,-0.661290731722214],[-0.45751414795746775,-0.31472307935193145,-0.6155342989984971],[-0.4557215088200961,-0.21269243453553593,-0.5604824956060879],[-0.4545633785126395,-0.17269791590722067,-0.6192779389210551],[-0.4550770201284675,-0.2827709820352686,-0.5775334054245562],[-0.45481834169831864,-0.21375772000281373,-0.6741556647151941],[-0.22337188144627562,-0.25835456119321565,-0.6445138380237555],[-0.2199321557756524,-0.30128678632171746,-0.6291575149422399],[-0.21785663471173305,-0.31708638936682365,-0.5861226827412289],[-0.22315190995641787,-0.2634123716909581,-0.5641508616703315],[-0.2178508312615154,-0.20608462611769252,-0.578587260167566],[-0.22106061594387116,-0.2214999371253491,-0.6155040174243256],[-0.029719618670688674,-0.122189721778312,-0.6385841005840235],[0.34666016056500926,-0.07014748921740083,-0.5495322503812179],[0.2019645602292438,-0.07246750134834762,-0.6066075769599266],[0.14036450114519805,-0.06075821146987381,-0.6026488155737642],[0.43659929612627335,0.01781901216166004,-0.529588631528358],[0.29904542162837733,0.012538991700404511,-0.6157889979199253],[0.22906095220199474,0.010646362224773553,-0.5769670094099192],[0.4226667873758404,0.07812415568927944,-0.5327075403982874],[0.3214059495042114,0.11018668437294143,-0.5972140813476878],[0.2518522618968436,0.11460327580145468,-0.57895484137738],[0.37855998537649727,0.1268128230886919,-0.538634003033968],[0.3352456859575933,0.1802060159538459,-0.5380595858220658],[0.2827380581424406,0.18843995112268164,-0.5398540903541502],[0.21984714591712073,-0.1446188547263621,-0.6069750804449607],[0.2922245436811136,-0.06272404732467912,-0.5887529100129183],[0.37621986843586774,0.014609579831638908,-0.6122796722999058],[0.3901393608765269,0.08566321060098037,-0.6027022591322865],[0.44725144609438205,0.030569150836673664,-0.6243769020988232],[0.45060832751314794,0.07707485043670814,-0.6142136202684257],[0.4682288459704811,0.03379727856703896,-0.5817703593422244],[0.46533209524754504,0.07914506548900002,-0.5846038006412682],[0.499099304526217,0.06935808558869894,-0.6351659720388532],[0.4976657694160199,0.07213312966992724,-0.6341083243265939],[0.5,0.06954023101910223,-0.6328173882788882],[0.4991221037949293,0.07276230657995475,-0.632044399799806],[-0.07365745736226581,-0.40672151740641727,-0.3965094555042796],[-0.07860183113486058,-0.4044202110391185,-0.6115684698390338]]}')},function(e,t,n){"use strict";n.r(t),t.default="// scatter-vertex shader\n#define USE_SCALE_X\n#define USE_SCALE_Y\n#define USE_SCALE_Z\n#define USE_SCALE_SIZE_X\n#define USE_SCALE_SIZE_Y\n#define USE_SCALE_SIZE_Z\n#define USE_SCALE_AUX\n#include <scales>\n\n// for animation, all between 0 and 1\nuniform float animation_time_x;\nuniform float animation_time_y;\nuniform float animation_time_z;\nuniform float animation_time_aux;\nuniform float animation_time_vx;\nuniform float animation_time_vy;\nuniform float animation_time_vz;\nuniform float animation_time_size;\nuniform float animation_time_color;\n\nuniform vec2 domain_x;\nuniform vec2 domain_y;\nuniform vec2 domain_z;\nuniform vec2 domain_aux;\n\nuniform vec2 domain_size_x;\nuniform vec2 domain_size_y;\nuniform vec2 domain_size_z;\n\nuniform mat4 geo_matrix;\nuniform vec3 aspect;\n\nvarying vec4 vertex_color;\nvarying vec3 vertex_position;\nvarying vec2 vertex_uv;\n\n#ifdef IS_LINE\n    attribute vec3 position_previous;\n#else\n    attribute float x_next;\n    attribute float x_previous;\n    attribute float y_next;\n    attribute float y_previous;\n    attribute float z_next;\n    attribute float z_previous;\n#ifdef USE_AUX\n    attribute float aux_next;\n    attribute float aux_previous;\n#endif\n    attribute vec3 v_next;\n    attribute vec3 v_previous;\n\n    attribute float size_next;\n    attribute float size_previous;\n#endif\n\n#ifdef USE_COLORMAP\n    attribute float color_next;\n    attribute float color_previous;\n    uniform vec2 domain_color;\n#else\n    attribute vec4 color_next;\n    attribute vec4 color_previous;\n#endif\n\nuniform sampler2D colormap;\n\nattribute float instance_id;\nuniform float id_offset;\n\nvec4 encodeId(float v) {\n    vec4 color;\n    // matches Figure.readId\n    color.b = floor(v / 256.0 / 256.0);\n    color.g = floor((v - color.b * 256.0 * 256.0) / 256.0);\n    color.r = floor(v - color.b * 256.0 * 256.0 - color.g * 256.0);\n    color.a = 255.0;\n    // normalize\n    return color / 255.0;\n}\n\n#if defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n    // similar to phong\n    // varying vec3 vColor;\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <uv2_pars_vertex>\n    #include <envmap_pars_vertex>\n    #include <bsdfs>\n    #include <lights_pars_begin>\n    #include <color_pars_vertex>\n    #include <fog_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <shadowmap_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n\n#ifdef AS_LAMBERT\n    #define LAMBERT\n    varying vec3 vLightFront;\n\n    #ifdef DOUBLE_SIDED\n        varying vec3 vLightBack;\n    #endif\n\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <uv2_pars_vertex>\n    #include <envmap_pars_vertex>\n    #include <bsdfs>\n    #include <lights_pars_begin>\n    #include <color_pars_vertex>\n    #include <fog_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <shadowmap_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //AS_LAMBERT\n#ifdef AS_PHONG\n    #define PHONG\n    varying vec3 vViewPosition;\n\n    #ifndef FLAT_SHADED\n        varying vec3 vNormal;\n    #endif\n\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <uv2_pars_vertex>\n    #include <displacementmap_pars_vertex>\n    #include <envmap_pars_vertex>\n    #include <color_pars_vertex>\n    #include <fog_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <shadowmap_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //AS_PHONG\n#ifdef AS_PHYSICAL\n    #define PHYSICAL\n    varying vec3 vViewPosition;\n\n    #ifndef FLAT_SHADED\n        varying vec3 vNormal;\n    #endif\n\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <uv2_pars_vertex>\n    #include <displacementmap_pars_vertex>\n    #include <color_pars_vertex>\n    #include <fog_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <shadowmap_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //AS_PHYSICAL\n#ifdef AS_DEPTH\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <displacementmap_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //AS_DEPTH\n#ifdef AS_DISTANCE\n    #define DISTANCE\n\n    varying vec3 vWorldPosition;\n\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <displacementmap_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n#endif //AS_DISTANCE\n\n\nvoid main(void) {\n    vec3 animation_time = vec3(animation_time_x, animation_time_y, animation_time_z);\n    vec3 animation_time_v = vec3(animation_time_vx, animation_time_vy, animation_time_vz);\n\n#ifdef IS_LINE\n    vec3 position_current = mix(position_previous, position, animation_time);\n    vec3 model_pos = vec3(SCALE_X(position_current.x), SCALE_Y(position_current.y), SCALE_Z(position_current.z));\n    vec4 view_pos = modelViewMatrix * vec4(model_pos, 1.0);\n#else\n    vec3 vector_next = v_next;\n    vec3 vector_previous = v_previous;\n    vec3 position_offset_next = vec3(x_next, y_next, z_next);\n    vec3 position_offset_previous = vec3(x_previous, y_previous, z_previous);\n\n    // assume the vector points to the y axis\n    vec3 vector_current = mix(normalize(vector_previous), normalize(vector_next), animation_time_v)\n           * mix(length(vector_previous), length(vector_next), (animation_time_vx+ animation_time_vy+ animation_time_vz)/3.);\n    vec3 y_axis = normalize(vector_current);\n    // we may have bad luck, and alight with 1 vector, so take two vectors, and we'll always find a non-zero vector\n    vec3 some_z_vector_a = vec3(0., 1., 1.);\n    vec3 some_z_vector_b = normalize(vec3(0., 2., 1.));\n    vec3 x_axis = normalize(cross(y_axis, some_z_vector_a)  + cross(y_axis, some_z_vector_b));\n    vec3 z_axis = -normalize(cross(y_axis, x_axis)); // - to keep it right handed\n    //float vector_length = length(vector_current);\n    // the following matrix should point it to the direction of 'vector'\n    mat3 move_to_vector = mat3(x_axis, y_axis, z_axis);\n\n    float size_current = mix(size_previous, size_next, animation_time_size);\n    // TODO: replace the 0. in SCALE_SIZE_X(0.) by a uniform, so we can make it work with log?\n    vec3 size_vector = vec3(SCALE_SIZE_X(size_current) - SCALE_SIZE_X(0.), SCALE_SIZE_Y(size_current) - SCALE_SIZE_Y(0.), SCALE_SIZE_Z(size_current) -  SCALE_SIZE_Z(0.));\n#ifdef USE_AUX\n    float aux_current = mix(aux_previous, aux_next, animation_time_aux);\n#endif\n    vec3 position_current_offset = mix(position_offset_previous, position_offset_next, animation_time);\n    vec3 model_pos = vec3(SCALE_X(position_current_offset.x), SCALE_Y(position_current_offset.y), SCALE_Z(position_current_offset.z));\n    // vec3 model_pos = vec3((position_current_offset.x), (position_current_offset.y), (position_current_offset.z));\n    SHADER_SNIPPET_SIZE;\n    //vec3 pos = (pos_object ) / size;// - 0.5;\n    #ifdef USE_SPRITE\n        // if we are a sprite, we add the position in view coordinates, and need to\n        vec4 view_pos = modelViewMatrix * vec4(model_pos, 1.0);\n        view_pos += vec4((position.xy)*(s*0.5),0,0);\n    #else\n        // the position is the orignal mesh position, so we scale and add that to the central location\n        // and we also rotate it into the direction of the vector v\n        vec4 position_transformed = geo_matrix * vec4(position, 1.0);\n        position_transformed.xyz = position_transformed.xyz / position_transformed.w;\n        // correct the aspect of the bounding box, so that glyphs are not transformed\n        position_transformed.xyz = position_transformed.xyz / aspect;\n        model_pos += move_to_vector * (position_transformed.xyz*size_vector);\n        vec4 view_pos = viewMatrix * vec4(model_pos, 1.0);\n    #endif\n#endif\n\n    // we repeat threejs's shader, up to begin_vertex\n#if defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #include <color_vertex>\n\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n\n    #include <begin_vertex>\n#endif //defined( AS_DEFAULT ) || defined( AS_COORDINATE )\n#ifdef AS_LAMBERT\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #include <color_vertex>\n\n    #include <beginnormal_vertex>\n    objectNormal = move_to_vector * objectNormal;\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n\n    #include <begin_vertex>\n#endif //AS_LAMBERT\n#ifdef AS_PHONG\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #include <color_vertex>\n\n    #include <beginnormal_vertex>\n    objectNormal = move_to_vector * objectNormal;\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n\n    #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n        vNormal = normalize( transformedNormal );\n    #endif\n\n    #include <begin_vertex>\n#endif //AS_PHONG\n#ifdef AS_PHYSICAL\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #include <color_vertex>\n\n    #include <beginnormal_vertex>\n    objectNormal = move_to_vector * objectNormal;\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n\n    #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n        vNormal = normalize( transformedNormal );\n    #endif\n\n    #include <begin_vertex>\n#endif //AS_PHYSICAL\n#ifdef AS_DEPTH\n    #include <uv_vertex>\n\n    #include <skinbase_vertex>\n\n    #ifdef USE_DISPLACEMENTMAP\n\n        #include <beginnormal_vertex>\n        #include <morphnormal_vertex>\n        #include <skinnormal_vertex>\n\n    #endif\n\n    #include <begin_vertex>\n#endif //AS_DEPTH\n#ifdef AS_DISTANCE\n    #include <uv_vertex>\n\n    #include <skinbase_vertex>\n\n    #ifdef USE_DISPLACEMENTMAP\n\n        #include <beginnormal_vertex>\n        #include <morphnormal_vertex>\n        #include <skinnormal_vertex>\n\n    #endif\n\n    #include <begin_vertex>\n#endif //AS_DISTANCE\n\n    // after begin_vertex, we modify transformed\n    transformed = model_pos;\n\n    // mvPosition = view_pos;\n    gl_Position = projectionMatrix * view_pos;\n    // vec3 positionEye = ( modelViewMatrix * vec4( model_pos, 1.0 ) ).xyz;\n    // vertex_position = positionEye;\n    vertex_uv = position.xy / 2. - 0.5;\n#if defined( AS_COORDINATE )\n    vertex_color = vec4(model_pos + vec3(0.5, 0.5, 0.5), 1.0);\n#elif defined( AS_ID )\n    vertex_color = encodeId(instance_id + id_offset);\n#else\n    #ifdef USE_COLORMAP\n        float color_current = mix(color_previous, color_next, animation_time_color);\n        float color_index = scale_transform_linear(color_current, vec2(0.0, 1.0), domain_color);\n        vertex_color = texture2D(colormap, vec2(color_index, 0));\n    #else\n        vertex_color = mix(color_previous, color_next, animation_time_color);\n    #endif\n#endif\n    #if defined(USE_COLOR) && !(defined(AS_DEPTH) || defined(AS_DISTANCE))\n        vColor = vertex_color.rgb;\n    #endif\n\n\n#if defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n\n\n    #include <worldpos_vertex>\n    vec3 positionEye = ( modelViewMatrix * vec4(transformed, 1.0 ) ).xyz;\n    vertex_position = positionEye;\n    // vViewPosition = - mvPosition.xyz;\n    // #include <envmap_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>    \n#endif // defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n#ifdef AS_LAMBERT\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n\n    #include <worldpos_vertex>\n    #include <envmap_vertex>\n    #include <lights_lambert_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>\n#endif //AS_LAMBERT\n#ifdef AS_PHONG\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n\n    vViewPosition = - mvPosition.xyz;\n\n    #include <worldpos_vertex>\n    #include <envmap_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>\n#endif //AS_PHONG\n#ifdef AS_PHYSICAL\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n\n    vViewPosition = - mvPosition.xyz;\n\n    #include <worldpos_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>\n#endif //AS_PHYSICAL\n#ifdef AS_DISTANCE\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n    #include <project_vertex>\n    #include <worldpos_vertex>\n    #include <clipping_planes_vertex>\n\n    vWorldPosition = worldPosition.xyz;\n#endif //AS_DISTANCE\n#ifdef AS_DEPTH\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n#endif //AS_DEPTH\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="// scatter-fragment shader\nvarying vec4 vertex_color;\nvarying vec3 vertex_position;\nvarying vec2 vertex_uv;\n\n#if defined( AS_DEFAULT ) || defined( AS_COORDINATE ) || defined( AS_ID )\n    // extra only used for the default shading\n\n    #ifdef USE_TEXTURE\n        uniform sampler2D texture;\n        uniform sampler2D texture_previous;\n        uniform float animation_time_texture;\n    #endif\n    // end of extra only used for the default shading\n    // taken similar to phong shading\n    #include <common>\n    #include <packing>\n    #include <dithering_pars_fragment>\n    #include <color_pars_fragment>\n    #include <uv_pars_fragment>\n    #include <uv2_pars_fragment>\n    #include <map_pars_fragment>\n    #include <alphamap_pars_fragment>\n    #include <aomap_pars_fragment>\n    #include <lightmap_pars_fragment>\n    #include <emissivemap_pars_fragment>\n    #include <envmap_pars_fragment>\n    #include <gradientmap_pars_fragment>\n    #include <fog_pars_fragment>\n    #include <bsdfs>\n    #include <lights_pars_begin>\n    // #include <lights_phong_pars_fragment>\n    #include <shadowmap_pars_fragment>\n    #include <shadowmask_pars_fragment> // extra compared to phong\n\n    #include <bumpmap_pars_fragment>\n    #include <normalmap_pars_fragment>\n    #include <specularmap_pars_fragment>\n    #include <logdepthbuf_pars_fragment>\n    #include <clipping_planes_pars_fragment>\n\n\nvoid main(void)\n{\n    #if defined(AS_COORDINATE)\n        gl_FragColor = vertex_color;\n    #elif defined(AS_ID)\n        gl_FragColor = vertex_color;\n    #else //AS_COORDINATE\n        // 0 when in shadow, 1 if visible\n        #ifdef IS_LINE\n            gl_FragColor = vertex_color;\n        #else //IS_LINE\n            #ifdef USE_SPRITE\n                #ifdef USE_TEXTURE\n                    gl_FragColor = mix(texture2D(texture_previous, vertex_uv), texture2D(texture, vertex_uv), animation_time_texture);\n                #else\n                    gl_FragColor = vertex_color;\n                #endif //USE_TEXTURE\n            #else //USE_SPRITE\n                vec3 fdxmy = dFdx( vertex_position );\n                vec3 fdymy = dFdy( vertex_position );\n                vec3 normalmy = normalize( cross( fdxmy, fdymy ) );\n                float diffuse = dot( normalmy, vec3( 0.0, 0.0, 1.0 ) );\n\n                gl_FragColor = vec4(clamp(diffuse, 0.2, 1.) * vertex_color.rgb, vertex_color.a);\n            #endif//USE_SPRITE\n            float shadow_visibility = getShadowMask();\n            gl_FragColor.rgb *= shadow_visibility;\n        #endif //IS_LINE\n    #endif //AS_COORDINATE\n    #include <fog_fragment>\n}\n#endif //defined( AS_DEFAULT ) || defined( AS_COORDINATE )\n\n#ifdef AS_LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\n\n#ifdef DOUBLE_SIDED\n\n\tvarying vec3 vLightBack;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n#endif //AS_LAMBERT\n#ifdef AS_PHONG\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n#endif //AS_PHONG\n#ifdef AS_PHYSICAL\n    #define PHYSICAL\n    uniform vec3 diffuse;\n    uniform vec3 emissive;\n    uniform float roughness;\n    uniform float metalness;\n    uniform float opacity;\n    uniform float emissiveIntensity;\n\n    #ifndef STANDARD\n        uniform float clearCoat;\n        uniform float clearCoatRoughness;\n    #endif\n\n    varying vec3 vViewPosition;\n\n    #ifndef FLAT_SHADED\n        varying vec3 vNormal;\n    #endif\n\n    #include <common>\n    #include <packing>\n    #include <dithering_pars_fragment>\n    #include <color_pars_fragment>\n    #include <uv_pars_fragment>\n    #include <uv2_pars_fragment>\n    #include <map_pars_fragment>\n    #include <alphamap_pars_fragment>\n    #include <aomap_pars_fragment>\n    #include <lightmap_pars_fragment>\n    #include <emissivemap_pars_fragment>\n    #include <bsdfs>\n    #include <cube_uv_reflection_fragment>\n    #include <envmap_pars_fragment>\n    #include <envmap_physical_pars_fragment>\n    #include <fog_pars_fragment>\n    #include <lights_pars_begin>\n    #include <lights_physical_pars_fragment>\n    #include <shadowmap_pars_fragment>\n    #include <bumpmap_pars_fragment>\n    #include <normalmap_pars_fragment>\n    #include <roughnessmap_pars_fragment>\n    #include <metalnessmap_pars_fragment>\n    #include <logdepthbuf_pars_fragment>\n    #include <clipping_planes_pars_fragment>\n\nvoid main(void)\n{\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0, 1.0, 1.0, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive * emissiveIntensity;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n#endif //AS_PHYSICAL\n#ifdef AS_DISTANCE\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist ); // clamp to [ 0, 1 ]\n\n\tgl_FragColor = packDepthToRGBA( dist );\n\n}\n#endif//AS_DISTANCE\n\n#ifdef AS_DEPTH\n#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\n\t#endif\n\n}\n#endif //AS_DEPTH\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Transition=class{constructor(e,t,n,r=1){this.on_done=t,this.on_animation=e,this.animation_exponent=r,this.duration=n,this.time_start=(new Date).getTime(),this.cancelled=!1,this.called_on_done=!1}is_done(){return(new Date).getTime()-this.time_start>=this.duration||this.cancelled}cancel(){this.cancelled=!0}update(){if(this.cancelled)return;const e=((new Date).getTime()-this.time_start)/this.duration;let t=Math.min(1,e);t=Math.pow(t,this.animation_exponent),this.on_animation(t),e>=1&&!this.called_on_done&&(this.called_on_done=!0,this.on_done())}}},function(e,t,n){var r=n(48);"string"==typeof r&&(r=[[e.i,r,""]]);var i={transform:void 0};n(50)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(49)(!1)).push([e.i,"a.ipyvolume-toolicon  {\n    text-align: center;\n    padding: 2px 2px; /* Some top and bottom padding */\n    color: #1867c0;\n    position: relative;\n    display: inline-block;\n}\n\n.fa-inactive {\n    opacity: 0.3;\n}\n.fa-disabled {\n  opacity: 0.3;\n  cursor: not-allowed;\n}\n\n\n.ipyvolume-toolicon-inactive {\n    opacity: 0.3;\n}\n\n.ipyvolume-toolicon:hover .ipyvolume-toolicon-dropdown-container {\n\tdisplay: block;\n}\n.ipyvolume-toolicon-dropdown-container  {\n\tdisplay: none;\n\tposition: absolute;\n\tz-index: 10;\n\tmin-width: 200px;\n\tbackground-color: #999;\n\tbox-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n\tbackground-color: #f9f9f9;\n\tpadding-left: 2px;\n\tfont-family: Verdana, Geneva, Tahoma, sans-serif;\n\n}\n.ipyvolume-toolicon-dropdown  {\n\ttext-align: left;\n\tdisplay: block;\n}\n\n.ipyvolume-popup-container {\n\tposition: absolute;\n\tz-index: 3;\n\twhite-space: nowrap;\n}\n\n.ipyvolume-canvas-container {\n\tposition: relative;\n\tmargin: 5px; /* otherwise we get scrollbars */\n}\n\n/* the default is white */\n.ipyvolume-popup-container > .p-Widget > .vuetify-styles > .v-application {\n\tbackground-color: unset;\n}\n",""])},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(a=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),o=r.sources.map((function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"}));return[n].concat(o).concat([i]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(e,t,n){var r,i,o={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=r.apply(this,arguments)),i}),s=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e.call(this,n)),t[n]}}((function(e){return document.querySelector(e)})),c=null,u=0,l=[],h=n(51);function f(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=o[r.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](r.parts[a]);for(;a<r.parts.length;a++)i.parts.push(_(r.parts[a],t))}else{var s=[];for(a=0;a<r.parts.length;a++)s.push(_(r.parts[a],t));o[r.id]={id:r.id,refs:1,parts:s}}}}function d(e,t){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function p(e,t){var n=s(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=l[l.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),l.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function m(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=l.indexOf(e);t>=0&&l.splice(t,1)}function g(e){var t=document.createElement("style");return e.attrs.type="text/css",v(t,e.attrs),p(e,t),t}function v(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function _(e,t){var n,r,i,o;if(t.transform&&e.css){if(!(o=t.transform(e.css)))return function(){};e.css=o}if(t.singleton){var a=u++;n=c||(c=g(t)),r=b.bind(null,n,a,!1),i=b.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return e.attrs.type="text/css",e.attrs.rel="stylesheet",v(t,e.attrs),p(e,t),t}(t),r=E.bind(null,n,t),i=function(){m(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(t),r=w.bind(null,n),i=function(){m(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=d(e,t);return f(n,t),function(e){for(var r=[],i=0;i<n.length;i++){var a=n[i];(s=o[a.id]).refs--,r.push(s)}e&&f(d(e,t),t);for(i=0;i<r.length;i++){var s;if(0===(s=r[i]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete o[s.id]}}}};var y,x=(y=[],function(e,t){return y[e]=t,y.filter(Boolean).join("\n")});function b(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=x(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function w(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function E(e,t,n){var r=n.css,i=n.sourceMap,o=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||o)&&(r=h(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var i,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(o)?e:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},function(e){e.exports=JSON.parse('{"demo":{"background-color":"white","box":{"color":"pink","visible":true},"axes":{"z":{"color":"#00f","ticklabel":{"color":"#0f0"},"label":{"color":"#f00"}},"ticklabel":{"color":"black"},"label":{"color":"black"},"x":{"color":"#f00","ticklabel":{"color":"#00f"},"label":{"color":"#0f0"}},"y":{"color":"#0f0","ticklabel":{"color":"#f00"},"label":{"color":"#00f"}},"color":"black","visible":true}},"dark":{"background-color":"black","box":{"visible":true},"axes":{"color":"white","ticklabel":{"color":"white"},"visible":true,"label":{"color":"white"}}},"light":{"background-color":"white","box":{"visible":true},"axes":{"color":"black","ticklabel":{"color":"black"},"visible":true,"label":{"color":"black"}}}}')},function(e,t){THREE.CombinedCamera=function(e,t,n,r,i,o,a){THREE.Camera.call(this),this.fov=n,this.far=i,this.near=r,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2,this.aspect=e/t,this.zoom=1,this.view=null,this.cameraO=new THREE.OrthographicCamera(e/-2,e/2,t/2,t/-2,o,a),this.cameraP=new THREE.PerspectiveCamera(n,e/t,r,i),this.toPerspective()},THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype),THREE.CombinedCamera.prototype.constructor=THREE.CombinedCamera,THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near,this.far=this.cameraP.far,this.cameraP.aspect=this.aspect,this.cameraP.fov=this.fov/this.zoom,this.cameraP.view=this.view,this.cameraP.updateProjectionMatrix(),this.projectionMatrix=this.cameraP.projectionMatrix,this.inPerspectiveMode=!0,this.inOrthographicMode=!1},THREE.CombinedCamera.prototype.toOrthographic=function(){var e=this.fov,t=this.cameraP.aspect,n=(this.cameraP.near+this.cameraP.far)/2,r=Math.tan(e*Math.PI/180/2)*n,i=r*t;r/=this.zoom,i/=this.zoom,this.cameraO.left=-i,this.cameraO.right=i,this.cameraO.top=r,this.cameraO.bottom=-r,this.cameraO.view=this.view,this.cameraO.updateProjectionMatrix(),this.near=this.cameraO.near,this.far=this.cameraO.far,this.projectionMatrix=this.cameraO.projectionMatrix,this.inPerspectiveMode=!1,this.inOrthographicMode=!0},THREE.CombinedCamera.prototype.copy=function(e){return THREE.Camera.prototype.copy.call(this,e),this.fov=e.fov,this.far=e.far,this.near=e.near,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this.aspect=e.aspect,this.cameraO.copy(e.cameraO),this.cameraP.copy(e.cameraP),this.inOrthographicMode=e.inOrthographicMode,this.inPerspectiveMode=e.inPerspectiveMode,this},THREE.CombinedCamera.prototype.setViewOffset=function(e,t,n,r,i,o){this.view={fullWidth:e,fullHeight:t,offsetX:n,offsetY:r,width:i,height:o},this.inPerspectiveMode?(this.aspect=e/t,this.toPerspective()):this.toOrthographic()},THREE.CombinedCamera.prototype.clearViewOffset=function(){this.view=null,this.updateProjectionMatrix()},THREE.CombinedCamera.prototype.setSize=function(e,t){this.cameraP.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2},THREE.CombinedCamera.prototype.setFov=function(e){this.fov=e,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())},THREE.CombinedCamera.prototype.setLens=function(e,t){void 0===t&&(t=35);var n=.5*t/(e*Math.max(this.cameraP.aspect,1)),r=2*THREE.Math.RAD2DEG*Math.atan(n);return this.setFov(r),r},THREE.CombinedCamera.prototype.setZoom=function(e){this.zoom=e,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0,this.rotation.y=0,this.rotation.z=0},THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0,this.rotation.y=Math.PI,this.rotation.z=0},THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0,this.rotation.y=-Math.PI/2,this.rotation.z=0},THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0,this.rotation.y=Math.PI/2,this.rotation.z=0},THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2,this.rotation.y=0,this.rotation.z=0},THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2,this.rotation.y=0,this.rotation.z=0}},function(e,t){THREE.DeviceOrientationControls=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var n,r,i,o,a=function(e){t.deviceOrientation=e},s=function(){t.screenOrientation=window.orientation||0},c=(n=new THREE.Vector3(0,0,1),r=new THREE.Euler,i=new THREE.Quaternion,o=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(e,t,a,s,c){r.set(a,t,-s,"YXZ"),e.setFromEuler(r),e.multiply(o),e.multiply(i.setFromAxisAngle(n,-c))});this.connect=function(){s(),window.addEventListener("orientationchange",s,!1),window.addEventListener("deviceorientation",a,!1),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",s,!1),window.removeEventListener("deviceorientation",a,!1),t.enabled=!1},this.update=function(){if(!1!==t.enabled){var e=t.deviceOrientation.alpha?THREE.Math.degToRad(t.deviceOrientation.alpha)+this.alphaOffsetAngle:0,n=t.deviceOrientation.beta?THREE.Math.degToRad(t.deviceOrientation.beta):0,r=t.deviceOrientation.gamma?THREE.Math.degToRad(t.deviceOrientation.gamma):0,i=t.screenOrientation?THREE.Math.degToRad(t.screenOrientation):0;c(t.object.quaternion,e,n,r,i),this.alpha=e}},this.updateAlphaOffsetAngle=function(e){this.alphaOffsetAngle=e,this.update()},this.dispose=function(){this.disconnect()},this.connect()}},function(e,t){THREE.OrbitControls=function(e,t){var n,r,i,o,a;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return p.phi},this.getAzimuthalAngle=function(){return p.theta},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(c),s.update(),f=h.NONE},this.update=(n=new THREE.Vector3,r=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),i=r.clone().inverse(),o=new THREE.Vector3,a=new THREE.Quaternion,function(){var e=s.object.position;return n.copy(e).sub(s.target),n.applyQuaternion(r),p.setFromVector3(n),s.autoRotate&&f===h.NONE&&C(2*Math.PI/60/60*s.autoRotateSpeed),p.theta+=m.theta,p.phi+=m.phi,p.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,p.theta)),p.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,p.phi)),p.makeSafe(),p.radius*=g,p.radius=Math.max(s.minDistance,Math.min(s.maxDistance,p.radius)),s.target.add(v),n.setFromSpherical(p),n.applyQuaternion(i),e.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(m.theta*=1-s.dampingFactor,m.phi*=1-s.dampingFactor):m.set(0,0,0),g=1,v.set(0,0,0),!!(_||o.distanceToSquared(s.object.position)>d||8*(1-a.dot(s.object.quaternion))>d)&&(s.dispatchEvent(c),o.copy(s.object.position),a.copy(s.object.quaternion),_=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",W,!1),s.domElement.removeEventListener("mousedown",U,!1),s.domElement.removeEventListener("wheel",B,!1),s.domElement.removeEventListener("touchstart",H,!1),s.domElement.removeEventListener("touchend",V,!1),s.domElement.removeEventListener("touchmove",G,!1),document.removeEventListener("mousemove",k,!1),document.removeEventListener("mouseup",F,!1),window.removeEventListener("keydown",j,!1)};var s=this,c={type:"change"},u={type:"start"},l={type:"end"},h={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},f=h.NONE,d=1e-6,p=new THREE.Spherical,m=new THREE.Spherical,g=1,v=new THREE.Vector3,_=!1,y=new THREE.Vector2,x=new THREE.Vector2,b=new THREE.Vector2,w=new THREE.Vector2,E=new THREE.Vector2,M=new THREE.Vector2,S=new THREE.Vector2,T=new THREE.Vector2,A=new THREE.Vector2;function L(){return Math.pow(.95,s.zoomSpeed)}function C(e){m.theta-=e}function R(e){m.phi-=e}var P,O=(P=new THREE.Vector3,function(e,t){P.setFromMatrixColumn(t,0),P.multiplyScalar(-e),v.add(P)}),N=function(){var e=new THREE.Vector3;return function(t,n){e.setFromMatrixColumn(n,1),e.multiplyScalar(t),v.add(e)}}(),I=function(){var e=new THREE.Vector3;return function(t,n){var r=s.domElement===document?s.domElement.body:s.domElement;if(s.object instanceof THREE.PerspectiveCamera){var i=s.object.position;e.copy(i).sub(s.target);var o=e.length();o*=Math.tan(s.object.fov/2*Math.PI/180),O(2*t*o/r.clientHeight,s.object.matrix),N(2*n*o/r.clientHeight,s.object.matrix)}else s.object instanceof THREE.OrthographicCamera?(O(t*(s.object.right-s.object.left)/s.object.zoom/r.clientWidth,s.object.matrix),N(n*(s.object.top-s.object.bottom)/s.object.zoom/r.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function D(e){s.object instanceof THREE.PerspectiveCamera?g/=e:s.object instanceof THREE.OrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),_=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function z(e){s.object instanceof THREE.PerspectiveCamera?g*=e:s.object instanceof THREE.OrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),_=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function U(e){if(!1!==s.enabled){if(e.preventDefault(),e.button===s.mouseButtons.ORBIT){if(!1===s.enableRotate)return;!function(e){y.set(e.clientX,e.clientY)}(e),f=h.ROTATE}else if(e.button===s.mouseButtons.ZOOM){if(!1===s.enableZoom)return;!function(e){S.set(e.clientX,e.clientY)}(e),f=h.DOLLY}else if(e.button===s.mouseButtons.PAN){if(!1===s.enablePan)return;!function(e){w.set(e.clientX,e.clientY)}(e),f=h.PAN}f!==h.NONE&&(document.addEventListener("mousemove",k,!1),document.addEventListener("mouseup",F,!1),s.dispatchEvent(u))}}function k(e){if(!1!==s.enabled)if(e.preventDefault(),f===h.ROTATE){if(!1===s.enableRotate)return;!function(e){x.set(e.clientX,e.clientY),b.subVectors(x,y);var t=s.domElement===document?s.domElement.body:s.domElement;C(2*Math.PI*b.x/t.clientWidth*s.rotateSpeed),R(2*Math.PI*b.y/t.clientHeight*s.rotateSpeed),y.copy(x),s.update()}(e)}else if(f===h.DOLLY){if(!1===s.enableZoom)return;!function(e){T.set(e.clientX,e.clientY),A.subVectors(T,S),A.y>0?D(L()):A.y<0&&z(L()),S.copy(T),s.update()}(e)}else if(f===h.PAN){if(!1===s.enablePan)return;!function(e){E.set(e.clientX,e.clientY),M.subVectors(E,w),I(M.x,M.y),w.copy(E),s.update()}(e)}}function F(e){!1!==s.enabled&&(document.removeEventListener("mousemove",k,!1),document.removeEventListener("mouseup",F,!1),s.dispatchEvent(l),f=h.NONE)}function B(e){!1===s.enabled||!1===s.enableZoom||f!==h.NONE&&f!==h.ROTATE||(e.preventDefault(),e.stopPropagation(),function(e){e.deltaY<0?z(L()):e.deltaY>0&&D(L()),s.update()}(e),s.dispatchEvent(u),s.dispatchEvent(l))}function j(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){switch(e.keyCode){case s.keys.UP:I(0,s.keyPanSpeed),s.update();break;case s.keys.BOTTOM:I(0,-s.keyPanSpeed),s.update();break;case s.keys.LEFT:I(s.keyPanSpeed,0),s.update();break;case s.keys.RIGHT:I(-s.keyPanSpeed,0),s.update()}}(e)}function H(e){if(!1!==s.enabled){switch(e.touches.length){case 1:if(!1===s.enableRotate)return;!function(e){y.set(e.touches[0].pageX,e.touches[0].pageY)}(e),f=h.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom)return;!function(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);S.set(0,r)}(e),f=h.TOUCH_DOLLY;break;case 3:if(!1===s.enablePan)return;!function(e){w.set(e.touches[0].pageX,e.touches[0].pageY)}(e),f=h.TOUCH_PAN;break;default:f=h.NONE}f!==h.NONE&&s.dispatchEvent(u)}}function G(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===s.enableRotate)return;if(f!==h.TOUCH_ROTATE)return;!function(e){x.set(e.touches[0].pageX,e.touches[0].pageY),b.subVectors(x,y);var t=s.domElement===document?s.domElement.body:s.domElement;C(2*Math.PI*b.x/t.clientWidth*s.rotateSpeed),R(2*Math.PI*b.y/t.clientHeight*s.rotateSpeed),y.copy(x),s.update()}(e);break;case 2:if(!1===s.enableZoom)return;if(f!==h.TOUCH_DOLLY)return;!function(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);T.set(0,r),A.subVectors(T,S),A.y>0?z(L()):A.y<0&&D(L()),S.copy(T),s.update()}(e);break;case 3:if(!1===s.enablePan)return;if(f!==h.TOUCH_PAN)return;!function(e){E.set(e.touches[0].pageX,e.touches[0].pageY),M.subVectors(E,w),I(M.x,M.y),w.copy(E),s.update()}(e);break;default:f=h.NONE}}function V(e){!1!==s.enabled&&(s.dispatchEvent(l),f=h.NONE)}function W(e){e.preventDefault()}s.domElement.addEventListener("contextmenu",W,!1),s.domElement.addEventListener("mousedown",U,!1),s.domElement.addEventListener("wheel",B,!1),s.domElement.addEventListener("touchstart",H,!1),s.domElement.addEventListener("touchend",V,!1),s.domElement.addEventListener("touchmove",G,!1),window.addEventListener("keydown",j,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}})},function(e,t){THREE.StereoEffect=function(e){var t=new THREE.StereoCamera;t.aspect=.5,this.setEyeSeparation=function(e){t.eyeSep=e},this.setSize=function(t,n){e.setSize(t,n)},this.render=function(n,r){n.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),t.update(r);var i=e.getSize();e.autoClear&&e.clear(),e.setScissorTest(!0),e.setScissor(0,0,i.width/2,i.height),e.setViewport(0,0,i.width/2,i.height),e.render(n,t.cameraL),e.setScissor(i.width/2,0,i.width/2,i.height),e.setViewport(i.width/2,0,i.width/2,i.height),e.render(n,t.cameraR),e.setScissorTest(!1)}}},function(e,t){var n=n||{};window.THREEx=n,n.FullScreen=n.FullScreen||{},n.FullScreen.available=function(){return this._hasWebkitFullScreen||this._hasMozFullScreen},n.FullScreen.activated=function(){return this._hasWebkitFullScreen?document.webkitIsFullScreen:this._hasMozFullScreen?document.mozFullScreen:void console.assert(!1)},n.FullScreen.request=function(e){e=e||document.body,this._hasWebkitFullScreen?e.webkitRequestFullScreen():this._hasMozFullScreen?e.mozRequestFullScreen():console.assert(!1)},n.FullScreen.cancel=function(){this._hasWebkitFullScreen?document.webkitCancelFullScreen():this._hasMozFullScreen?document.mozCancelFullScreen():console.assert(!1)},n.FullScreen.element=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement},n.FullScreen.addFullScreenChangeListener=function(e){document.addEventListener("webkitfullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1),document.addEventListener("fullscreenchange",e,!1),document.addEventListener("MSFullscreenChange",e,!1)},n.FullScreen.removeFullScreenChangeListener=function(e){document.removeEventListener("webkitfullscreenchange",e,!1),document.removeEventListener("mozfullscreenchange",e,!1),document.removeEventListener("fullscreenchange",e,!1),document.removeEventListener("MSFullscreenChange",e,!1)},n.FullScreen._hasWebkitFullScreen="webkitCancelFullScreen"in document,n.FullScreen._hasMozFullScreen="mozCancelFullScreen"in document},function(e,t){THREE.TrackballControls=function(e,t){var n=this,r={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var i=new THREE.Vector3,o=r.NONE,a=r.NONE,s=new THREE.Vector3,c=new THREE.Vector2,u=new THREE.Vector2,l=new THREE.Vector3,h=0,f=new THREE.Vector2,d=new THREE.Vector2,p=0,m=0,g=new THREE.Vector2,v=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var _={type:"change"},y={type:"start"},x={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var b,w,E,M,S,T,A,L,C,R,P,O=(b=new THREE.Vector2,function(e,t){var r=n.domElement===document?n.domElement.body:n.domElement;return b.set(e/r.clientWidth,t/r.clientHeight),b}),N=function(){new THREE.Vector2;return function(e,t){return O(2*e*Math.PI,2*-t*Math.PI)}}();function I(e){!1!==n.enabled&&(window.removeEventListener("keydown",I),a=o,o===r.NONE&&(e.keyCode!==n.keys[r.ROTATE]||n.noRotate?e.keyCode!==n.keys[r.ZOOM]||n.noZoom?e.keyCode!==n.keys[r.PAN]||n.noPan||(o=r.PAN):o=r.ZOOM:o=r.ROTATE))}function D(e){!1!==n.enabled&&(o=a,window.addEventListener("keydown",I,!1))}function z(e){!1!==n.enabled&&(e.preventDefault(),e.stopPropagation(),o===r.NONE&&(o=e.button),o!==r.ROTATE||n.noRotate?o!==r.ZOOM||n.noZoom?o!==r.PAN||n.noPan||(g.copy(O(e.pageX,e.pageY)),v.copy(g)):(f.copy(O(e.pageX,e.pageY)),d.copy(f)):(u.copy(N(e.pageX,e.pageY)),c.copy(u)),document.addEventListener("mousemove",U,!1),document.addEventListener("mouseup",k,!1),n.dispatchEvent(y))}function U(e){!1!==n.enabled&&(e.preventDefault(),e.stopPropagation(),o!==r.ROTATE||n.noRotate?o!==r.ZOOM||n.noZoom?o!==r.PAN||n.noPan||v.copy(O(e.pageX,e.pageY)):d.copy(O(e.pageX,e.pageY)):(c.copy(u),u.copy(N(e.pageX,e.pageY))),n.update())}function k(e){!1!==n.enabled&&(e.preventDefault(),e.stopPropagation(),o=r.NONE,document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",k),n.dispatchEvent(x))}function F(e){if(!1!==n.enabled){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:f.y-=.025*e.deltaY;break;case 1:f.y-=.01*e.deltaY;break;default:f.y-=25e-5*e.deltaY}n.dispatchEvent(y),n.dispatchEvent(x),n.update()}}function B(e){if(!1!==n.enabled){switch(e.touches.length){case 1:o=r.TOUCH_ROTATE,u.copy(N(e.touches[0].pageX,e.touches[0].pageY)),c.copy(u);break;default:o=r.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY;m=p=Math.sqrt(t*t+i*i);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;g.copy(O(a,s)),v.copy(g)}n.dispatchEvent(y)}}function j(e){if(!1!==n.enabled){switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:c.copy(u),u.copy(N(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;m=Math.sqrt(t*t+r*r);var i=(e.touches[0].pageX+e.touches[1].pageX)/2,o=(e.touches[0].pageY+e.touches[1].pageY)/2;v.copy(O(i,o))}n.update()}}function H(e){if(!1!==n.enabled){switch(e.touches.length){case 0:o=r.NONE;break;case 1:o=r.TOUCH_ROTATE,u.copy(N(e.touches[0].pageX,e.touches[0].pageY)),c.copy(u)}n.dispatchEvent(x),n.update()}}function G(e){e.preventDefault()}this.rotateCamera=(E=new THREE.Vector3,M=new THREE.Quaternion,S=new THREE.Vector3,T=new THREE.Vector3,A=new THREE.Vector3,L=new THREE.Vector3,function(){L.set(u.x-c.x,u.y-c.y,0),(w=L.length())?(s.copy(n.object.position).sub(n.target),S.copy(s).normalize(),T.copy(n.object.up).normalize(),A.crossVectors(T,S).normalize(),T.setLength(u.y-c.y),A.setLength(u.x-c.x),L.copy(T.add(A)),E.crossVectors(L,s).normalize(),w*=n.rotateSpeed,M.setFromAxisAngle(E,w),s.applyQuaternion(M),n.object.up.applyQuaternion(M),l.copy(E),h=w):!n.staticMoving&&h&&(h*=Math.sqrt(1-n.dynamicDampingFactor),s.copy(n.object.position).sub(n.target),M.setFromAxisAngle(l,h),s.applyQuaternion(M),n.object.up.applyQuaternion(M)),c.copy(u)}),this.zoomCamera=function(){var e;o===r.TOUCH_ZOOM_PAN?(e=p/m,p=m,s.multiplyScalar(e)):(1!==(e=1+(d.y-f.y)*n.zoomSpeed)&&e>0&&s.multiplyScalar(e),n.staticMoving?f.copy(d):f.y+=(d.y-f.y)*this.dynamicDampingFactor)},this.panCamera=(C=new THREE.Vector2,R=new THREE.Vector3,P=new THREE.Vector3,function(){C.copy(v).sub(g),C.lengthSq()&&(C.multiplyScalar(s.length()*n.panSpeed),P.copy(s).cross(n.object.up).setLength(C.x),P.add(R.copy(n.object.up).setLength(C.y)),n.object.position.add(P),n.target.add(P),n.staticMoving?g.copy(v):g.add(C.subVectors(v,g).multiplyScalar(n.dynamicDampingFactor)))}),this.checkDistances=function(){n.noZoom&&n.noPan||(s.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,s.setLength(n.maxDistance)),f.copy(d)),s.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,s.setLength(n.minDistance)),f.copy(d)))},this.update=function(){s.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,s),n.checkDistances(),n.object.lookAt(n.target),i.distanceToSquared(n.object.position)>1e-6&&(n.dispatchEvent(_),i.copy(n.object.position))},this.reset=function(){o=r.NONE,a=r.NONE,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),s.subVectors(n.object.position,n.target),n.object.lookAt(n.target),i.copy(n.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",G,!1),this.domElement.removeEventListener("mousedown",z,!1),this.domElement.removeEventListener("wheel",F,!1),this.domElement.removeEventListener("touchstart",B,!1),this.domElement.removeEventListener("touchend",H,!1),this.domElement.removeEventListener("touchmove",j,!1),document.removeEventListener("mousemove",U,!1),document.removeEventListener("mouseup",k,!1),window.removeEventListener("keydown",I,!1),window.removeEventListener("keyup",D,!1)},this.domElement.addEventListener("contextmenu",G,!1),this.domElement.addEventListener("mousedown",z,!1),this.domElement.addEventListener("wheel",F,!1),this.domElement.addEventListener("touchstart",B,!1),this.domElement.addEventListener("touchend",H,!1),this.domElement.addEventListener("touchmove",j,!1),window.addEventListener("keydown",I,!1),window.addEventListener("keyup",D,!1),this.handleResize(),this.update()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.TrackballControls.prototype.constructor=THREE.TrackballControls},function(e,t,n){"use strict";n.r(t),t.default="varying  vec2 tex_uv;\n\n#if defined(PANORAMA_360) || defined(PANORAMA_180)\nuniform samplerCube tex;\n#else\nuniform sampler2D tex;\n#endif\n\n\nvoid main(void) {\n\tconst float PI = 3.141592653589793238462643383;\n#if defined(PANORAMA_360)\n\tfloat phi   = (1.-tex_uv.x)* PI * 2.0;\n\tfloat theta = (1.-tex_uv.y) * PI;\n    vec3 uvw = vec3(sin(phi) * sin(theta),\n                               cos(theta),\n                    cos(phi) * sin(theta)\n                    );\n    gl_FragColor = textureCube(tex, uvw);\n#elif defined(PANORAMA_180)\n\tfloat x = (tex_uv.x-0.5)*2.;\n\tfloat y = (tex_uv.y-0.5)*2.;\n\tfloat r = sqrt(x*x + y*y);\n\tif(r > 1.)\n\t\tdiscard;\n\tfloat theta = r * PI/2.;\n\tfloat phi = atan(y, x);\n\tvec3 uvw = vec3(cos(phi) * sin(theta),\n\t\t\t\t\tsin(phi) * sin(theta),\n\t\t\t\t\t          -cos(theta));\n    gl_FragColor = textureCube(tex, uvw);\n#else\n    gl_FragColor = texture2D(tex, tex_uv);\n#endif\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="varying vec2 tex_uv;\n\nvoid main(void) {\n    gl_Position = projectionMatrix *\n                modelViewMatrix *\n                vec4(position,1.0);\n    tex_uv = vec2(position.x+0.5, position.y+0.5);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="precision highp float;\n#include <common>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n\nuniform mat3 normalMatrix;\n\nuniform sampler2D back_tex;\nuniform sampler2D geometry_depth_tex;\n\n\n#include <ipyvolume>\n\n// samplers in structs has bad support, so we put it here\n#if (VOLUME_COUNT > 0)\nuniform sampler2D data[VOLUME_COUNT];\nuniform sampler2D transfer_function[VOLUME_COUNT];\nuniform Volume volumes[VOLUME_COUNT];\n#endif\n\n#if (VOLUME_COUNT_MAX_INT > 0)\nuniform Volume volumes_max_int[VOLUME_COUNT_MAX_INT];\nuniform sampler2D data_max_int[VOLUME_COUNT_MAX_INT];\nuniform sampler2D transfer_function_max_int[VOLUME_COUNT_MAX_INT];\nfloat max_values[VOLUME_COUNT_MAX_INT];\nfloat max_depth[VOLUME_COUNT_MAX_INT];\nbool  has_values[VOLUME_COUNT_MAX_INT];\n// for MAX_INT, we cannot add the coordinate directly, we do it after we found the max\nvec4  max_weighted_coordinate[VOLUME_COUNT_MAX_INT];\nvec4  max_colors[VOLUME_COUNT_MAX_INT];\n#endif\n\nstruct Layer {\n    float depth;\n    vec4 color;\n    bool skip;\n};\n\nLayer layers[VOLUME_COUNT_MAX_INT+1];\n\n\n//uniform float brightness;\n\n//uniform sampler2D colormap;\n//uniform int colormap_index;\n//uniform int surfaces;\n//uniform float opacity[4];\n//uniform float level[4];\n//uniform float width[4];\nuniform vec2 render_size;\n\nvarying vec3 front;\n\n// for lighting\nuniform mat3 mvMatrix;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nvec3 light_dir;\nvec3 eye;\n//uniform float color_index;\n\nuniform int steps;\n\n\nuniform float ambient_coefficient;\nuniform float diffuse_coefficient;\nuniform float specular_coefficient;\nuniform float specular_exponent;\n\nmat3 transpose3(mat3 m) {\n    vec3 v0 = m[0];\n    vec3 v1 = m[1];\n    vec3 v2 = m[2];\n    return mat3(\n        vec3(v0.x, v1.x, v2.x),\n        vec3(v0.y, v1.y, v2.y),\n        vec3(v0.z, v1.z, v2.z)\n        );\n}\n\nvec2 sample(sampler2D data, Volume volume, vec3 ray_pos, inout vec3 normal) {\n    vec3 pos_relative = (ray_pos+volume.offset)*volume.scale;\n    if(any(lessThan(pos_relative, vec3(0.))) || any(greaterThan(pos_relative, vec3(1.))))\n        return vec2(0.0);\n    vec4 sample = sample_as_3d_texture(data, volume.size, pos_relative, volume.slice_size, volume.slices, volume.rows, volume.columns);\n    normal = (-sample.xyz)*2.+1.;\n    // this seems to match observations, not fully sure why x and z are flipped.\n    normal.xyz = normal.zyx;\n\n    float raw_data_value = sample.a; //(sample.a - data_min) * data_scale;\n    float scaled_data_value = (raw_data_value*(volume.data_range[1] - volume.data_range[0])) + volume.data_range[0];\n    float data_value = (scaled_data_value - volume.show_range[0])/(volume.show_range[1] - volume.show_range[0]);\n    // TODO: how do we deal with this with multivolume rendering\n    // if(((data_value < 0.) && !volume.clamp_min) || ((data_value > 1.) && !volume.clamp_max)) {\n    //     ray_pos += ray_delta;\n    //     continue;\n    // }\n    data_value = clamp(data_value, 0., 1.);\n    return vec2(data_value, 1);\n}\n\nvec4 apply_lighting(vec4 color, vec3 objectNormal, vec3 position, Volume volume) {\n    // only do phong lighting when we have lights\n    #if ( NUM_POINT_LIGHTS > 0 ) || ( NUM_SPOT_LIGHTS > 0 ) || ( NUM_DIR_LIGHTS > 0 ) || ( NUM_RECT_AREA_LIGHTS > 0 ) || ( NUM_HEMI_LIGHTS > 0 )\n        vec3 normal = normalize(normalMatrix * objectNormal);\n        vec3 vViewPosition = position;\n        vec3 emissive = volume.emissive;\n\n\n        // this is quite similar to meshphong_frag.glsl\n        vec4 diffuseColor = color;\n        ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n        vec3 totalEmissiveRadiance = emissive;\n\n\n        // the replacement for: #include <lights_phong_fragment>\n        BlinnPhongMaterial material;\n        material.diffuseColor = diffuseColor.rgb;\n        material.specularColor = volume.specular;\n        material.specularShininess = volume.shininess;\n        material.specularStrength = 1.0;\n\n        #include <lights_fragment_begin>\n        // we don't support light maps\n        // #include <lights_fragment_maps>\n        // no need to include this for Phong, but more consistent with mesh_phong_frag.glsl\n        #include <lights_fragment_end>\n\n        // modulation (not supported)\n        #include <aomap_fragment>\n\n        vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n        // also not supported\n        // #include <envmap_fragment>\n\n        vec4 result = vec4( outgoingLight, diffuseColor.a );\n    #else\n        vec4 result = color;\n    #endif\n\n    return result;\n}\n\nvec4 add_sample(sampler2D data, sampler2D transfer_function, Volume volume, vec3 ray_pos, vec4 color_in) {\n    vec4 color;\n    vec3 pos_relative = (ray_pos+volume.offset)*volume.scale;\n    /*vec4 sample_x = sample_as_3d_texture(volume, size, pos + vec3(delta, 0, 0), slice_size, slices, rows, columns);\n    vec4 sample_y = sample_as_3d_texture(volume, size, pos + vec3(0, delta, 0), slice_size, slices, rows, columns);\n    vec4 sample_z = sample_as_3d_texture(volume, size, pos + vec3(0, 0, delta), slice_size, slices, rows, columns);\n\n    vec3 normal = normalize(vec3((sample_x[0]-sample[0])/delta, (sample_y[0]-sample[0])/delta, (sample_z[0]-sample[0])/delta));\n    normal = -vec3(normal.x, normal.y, normal.z);\n    float cosangle_light = max((dot(light_dir, normal)), 0.);\n    float cosangle_eye = max((dot(eye, normal)), 0.);*/\n\n    vec3 normal;\n    vec2 sample = sample(data, volume, ray_pos, normal);\n    float data_value = sample[0];\n    if(sample[1] == 0.0)\n        return color_in;\n    if(((data_value < 0.) && !volume.clamp_min) || ((data_value > 1.) && !volume.clamp_max))\n        return color_in;\n\n    vec4 color_sample = texture2D(transfer_function, vec2(data_value, 0.5));\n    if(volume.lighting) {\n        color_sample = apply_lighting(color_sample, normal, ray_pos, volume);\n    }\n\n    // float intensity = color_sample.a;\n    //float alpha_sample = intensity * sign(data_value) * sign(1.-data_value) * 100. / float(steps) * ray_length;//clamp(1.-chisq, 0., 1.) * 0.5;//1./128.* length(color_sample) * 100.;\n    // float alpha_sample = intensity * 100. / float(steps);//clamp(1.-chisq, 0., 1.) * 0.5;//1./128.* length(color_sample) * 100.;\n    // alpha_sample = clamp(alpha_sample * volume.opacity_scale, 0., 1.);\n\n    //float intensity = texture2D(transfer_function, vec2(data_value, 0.5)).a;\n    //color_sample = texture2D(transfer_function, data_value);\n    //vec4 color_sample = texture2D(colormap, vec2(sample.a, colormap_index_scaled));\n    //color_sample = texture2D(volume, ray_pos.yz);\n    //float alpha_sample = opacity*intensity;//1./128.* length(color_sample) * 100.;\n    // float alpha_total = color_in.a + alpha_sample;\n    // color.rgb = color_in.rgb + (1.0 - alpha_total) * color_sample.rgb * alpha_sample;\n    // color.a = alpha_total;\n    vec4 dst = color_in;\n    vec4 src = color_sample;\n    src.a *= clamp(100./float(steps) * volume.opacity_scale, 0.0, 1.0);\n    #ifdef COORDINATE\n        color.a   = src.a  + dst.a;\n        color.rgb = dst.xyz + ray_pos * src.a;\n    #else\n        color.rgb = (1.0-dst.a) * src.rgb * src.a * volume.brightness + dst.rgb;\n        color.a   = src.a  + dst.a;\n    #endif\n    return color;\n}\n\nvec4 blend_pre_multiplied(vec4 dst, vec4 src) {\n    return dst * (1.0-src.a) + src;\n}\n\nconst int MAX_STEPS = 1000;\nvec2 pixel;\n\nvec4 cast_ray(vec3 ray_begin, vec3 ray_end, vec4 color) {\n    vec3 ray_direction = ray_end - ray_begin;\n    vec3 ray_delta = normalize(ray_direction) * (1./float(steps));\n    vec3 ray_pos = ray_begin;\n\n    float ray_length = length(ray_direction);\n    float ray_length_delta = length(ray_delta);\n    float ray_length_traveled = 0.;\n\n    vec2 pixel = vec2(gl_FragCoord.x, gl_FragCoord.y) / render_size;\n    vec4 voxel_view_space_coord;\n    float voxel_frag_depth;\n    vec4 geometry_depth;\n\n    for(int i = 0; i < MAX_STEPS; i++) {\n        geometry_depth = texture2D(geometry_depth_tex, pixel); \n        voxel_view_space_coord = projectionMatrix * modelViewMatrix * vec4(ray_pos+vec3(-0.5, -0.5, -0.5),1.0);\n        voxel_frag_depth = ((voxel_view_space_coord.z / voxel_view_space_coord.w)+1.0)/2.0;\n        if(geometry_depth.x > 0.0 && voxel_frag_depth > geometry_depth.x){\n            break;\n        }\n\n        {{#volumes}}\n            color = add_sample(data[{{.}}], transfer_function[{{.}}], volumes[{{.}}], ray_pos, color);\n        {{/volumes}}\n        if(color.a >= 1.)\n            break;\n        ray_pos += ray_delta;\n        ray_length_traveled += ray_length_delta;\n        if(ray_length_traveled >= ray_length)\n            break;\n    }\n    return color;\n}\n\nvoid cast_ray_max(vec3 ray_begin, vec3 ray_end);\n\nvoid main(void) {\n#ifdef METHOD_MAX_INTENSITY\n    float max_value = 0.;\n    float max_cosangle_light = 0.;\n    float max_cosangle_eye = 0.;\n#endif\n\n\n    pixel = vec2(gl_FragCoord.x, gl_FragCoord.y) / render_size;\n    vec4 color = vec4(0, 0, 0, 0);\n    // float color_index;\n\n    //mat3 rotation = mat3(mvMatrix);\n    mat3 rotation = (mat3(viewMatrix));\n    light_dir = normalize(vec3(-1,-1,1) * rotation);\n    eye = vec3(0, 0, 1) * rotation;\n\n    float delta = 1.0/256./2.;\n\n#ifdef COORDINATE\n    // contains the weighted coordinate, where the last component is the weight\n    // diving by w gives it the average value\n    vec4 weighted_coordinate = vec4(0., 0., 0., 0.);\n#endif \n    vec3 ray_begin = front;\n    vec3 ray_end = texture2D(back_tex, pixel).rgb;\n    vec3 ray_begin0 = ray_begin;\n    vec3 ray_end0 = ray_end;\n    cast_ray_max(ray_begin, ray_end);\n    #if (VOLUME_COUNT_MAX_INT > 1)\n        // TODO: horrible sort, fix!!\n        for(int i = 0; i < VOLUME_COUNT_MAX_INT-1; i++) {\n            for(int j = 1; j < VOLUME_COUNT_MAX_INT; j++) {\n                if(has_values[i] && has_values[j] && (i < j)) {\n                    if(max_depth[j] < max_depth[i]) {\n                        float depth = max_depth[i];\n                        max_depth[i] = max_depth[j];\n                        max_depth[j] = depth;\n                        vec4 color = max_colors[i];\n                        max_colors[i] = max_colors[j];\n                        max_colors[j] = color;\n                    }\n                }\n            }\n        }\n    #endif\n    #if (VOLUME_COUNT_MAX_INT > 0)\n        for(int i = 0; i < VOLUME_COUNT_MAX_INT; i++) {\n            layers[i].depth = 0.0;\n            layers[i].color = vec4(0.0);\n            if(has_values[i]) {\n                layers[i].depth = max_depth[i];\n                layers[i].color = max_colors[i];\n            }\n        }\n    #endif\n    // last layer is the absolute end of the volume, its color is fully transparant\n    layers[VOLUME_COUNT_MAX_INT].depth = 1.0;\n    layers[VOLUME_COUNT_MAX_INT].color = vec4(0.0);\n    float depth = -100.0;\n    ray_begin = ray_begin0;\n    for(int i = 0; i < VOLUME_COUNT_MAX_INT+1; i++) {\n        // TODO: debug this, it seems that > makes more sense, but gives artifacts in the situation of\n        // having 2 max int volr, 1 normal, the 2nd will have holes when it's the only volume in the los.\n        if(layers[i].depth >= depth)\n        {\n            ray_end = ray_begin0 + (ray_end0 - ray_begin0) * layers[i].depth;\n            color = cast_ray(ray_begin, ray_end, color);\n            #ifdef COORDINATE\n                // color += layers[i].color;\n                color = blend_pre_multiplied(layers[i].color, color);\n            #else\n                color = blend_pre_multiplied(layers[i].color, color);\n            #endif\n            ray_begin = ray_end;\n            depth = layers[i].depth;\n        }\n    }\n\n    #ifdef COORDINATE\n        vec3 average_coordinate = color.xyz/color.a;\n        gl_FragColor = vec4(average_coordinate, color.a);\n    #else\n        gl_FragColor = color;\n    #endif\n    // code below is used for debugging purposes\n    // float x = floor((pixel.x *500. / 10.));\n    // float y = floor((pixel.y *500. / 10.));\n    // // gl_FragColor = vec4(x / 10., 0.0, 0.0, 1.0);\n    // // gl_FragColor = vec4(y / 10., 0.0, 0.0, 1.0);\n    // vec2 result;\n    // float eps = 1. - 1e-4;\n    // float modulo = mod(x, y * eps);\n    // float offset = x - modulo * y;\n    // offset = floor(x / y);\n    // gl_FragColor = vec4(mod(x, x) > 0. ? 1.0 : 0., 0.0, 0.0, 1.0);\n    // gl_FragColor = vec4(modulo >= x ? 1.0 : 0., 0.0, 0.0, 1.0);\n    // gl_FragColor = vec4(offset >= 0.5 ? 1.0 : 0., 0.0, 0.0, 1.0);\n    // gl_FragColor = vec4(offset/x, 0.0, 0.0, 1.0);\n    // eps = 0.;\n    // gl_FragColor = vec4(float(int(x / (y - eps))) / 1., 0.0, 0.0, 1.0);\n    // gl_FragColor = vec4(texture2D(data[0], pixel).a * 140., 0., 0., 1.0);\n    // gl_FragColor = vec4(ray_begin.xyz, 1.);\n    // gl_FragColor = vec4(ray_begin.xyz, 0.1) * brightness;\n    //gl_FragColor = vec4(rotation[0], 1) * brightness;\n    // gl_FragColor = vec4(alpha_total, 0., 0., 1.);\n    //gl_FragColor = texture2D(volume, vec2(ray_begin.x, ray_begin.y));\n    // gl_FragColor = vec4(ray_begin.x, ray_begin.y, ray_begin.z, 1.);\n    // gl_FragColor = texture2D(transfer_function, vec2(pixel.x, 0.5));\n    //gl_FragColor = vec4(texture2D(volume, vec2(pixel.x, pixel.y)).rgb, 1.0);\n    // gl_FragColor = vec4(pixel.x, pixel.y, 0, 1);\n    // gl_FragColor = vec4(ray_end, 1.);\n    // gl_FragColor = vec4(ray_begin, 1);\n    //float tintensity = texture2D(transfer_function, vec2(pixel.x / 1., 0.5)).a;\n    //gl_FragColor = vec4(0, tintensity, 0., 1.);\n    //gl_FragColor = vec4(ray_e, 1);\n}\n\n\n\n\nvoid cast_ray_max(vec3 ray_begin, vec3 ray_end) {\n    vec3 ray_direction = ray_end - ray_begin;\n    vec3 ray_delta = normalize(ray_direction) * (1./float(steps));\n    vec3 ray_pos = ray_begin;\n\n    float ray_length = length(ray_direction);\n    float ray_length_delta = length(ray_delta);\n    float ray_length_traveled = 0.;\n\n    vec4 voxel_view_space_coord;\n    float voxel_frag_depth;\n    vec4 geometry_depth;\n    for(int i = 0; i < MAX_STEPS; i++) {\n\n        {{#volumes_max_int}}\n        {\n            vec3 normal;\n            vec2 sample = sample(data_max_int[{{.}}], volumes_max_int[{{.}}], ray_pos, normal);\n            if(sample.x > max_values[{{.}}] && sample.y > 0.0) {\n                max_values[{{.}}] = sample.x;\n                has_values[{{.}}] = true;\n                // the weight of the coordinate equals its opacity\n                max_colors[{{.}}] = texture2D(transfer_function_max_int[{{.}}], vec2(max_values[{{.}}], 0.5));\n                if(volumes_max_int[{{.}}].lighting)\n                    max_colors[{{.}}] = apply_lighting(max_colors[{{.}}], normal, ray_pos, volumes_max_int[{{.}}]);\n                float alpha = clamp(max_colors[{{.}}].a * volumes_max_int[{{.}}].opacity_scale * 10., 0., 1.);\n                max_colors[{{.}}].a = alpha;\n                #ifdef COORDINATE\n                    max_colors[{{.}}].rgb = ray_pos * alpha; // no need to use brightness for the coordinates\n                #else\n                    max_colors[{{.}}].rgb *= alpha * volumes_max_int[{{.}}].brightness; // pre-blend\n                #endif\n                max_weighted_coordinate[{{.}}].xyz = ray_pos * alpha;\n                max_weighted_coordinate[{{.}}].a = alpha;\n                max_depth[{{.}}] = ray_length_traveled/ray_length;\n            }\n        }\n        {{/volumes_max_int}}\n\n        ray_pos += ray_delta;\n        ray_length_traveled += ray_length_delta;\n        if(ray_length_traveled >= ray_length)\n            break;\n    }\n}"},function(e,t,n){"use strict";n.r(t),t.default="//attribute vec3 aVertexPosition;\n\n//uniform mat4 uMVMatrix;\n//uniform mat4 uPMatrix;\nvarying vec3 front;\n\nvoid main(void) {\n    //gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    gl_Position = projectionMatrix *\n                modelViewMatrix *\n                vec4(position,1.0);\n    //vertex_color = vec4(aVertexPosition, 1);\n    front = position+vec3(0.5, 0.5, 0.5);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="uniform sampler2D map;\nvarying vec2 vUv;\n#include <packing>\n\nvoid main ()\n{\n    vec4 rgbaDepth = texture2D (map, vUv);\n    float fDepth = unpackRGBAToDepth(rgbaDepth);\n    gl_FragColor = vec4 (vec3 (fDepth), 1.0);\n    // gl_FragColor = vec4 (vec3 (rgbaDepth.w), 1.0);\n}\n\n"},function(e,t,n){"use strict";n.r(t),t.default="varying vec2 vUv;\n\nvoid main ()\n{\n    vUv = vec2 (uv.x, 1.0 - uv.y);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4 (position, 1.0);\n}\n"},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(2)),a=i(n(13)),s=r(n(6)),c=n(1);class u extends o.DOMWidgetView{render(){this.img=document.createElement("img"),this.img.setAttribute("src",this.model.get("rgba")),this.img.setAttribute("style",this.model.get("style")),this.model.on("change:rgba",(function(){this.img.setAttribute("src",this.model.get("rgba"))}),this),this.model.on("change:style",(function(){this.img.setAttribute("style",this.model.get("style"))}),this),this.el.appendChild(this.img)}}t.TransferFunctionView=u;class l extends o.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"TransferFunctionModel",_view_name:"TransferFunctionView",_model_module:"ipyvolume",_view_module:"ipyvolume",_model_module_version:c.semver_range,_view_module_version:c.semver_range,rgba:null})}get_data_array(){const e=[],t=this.get("rgba");for(let n=0;n<t.shape[0];n++)for(let r=0;r<4;r++)e.push(255*t.get(n,r));return new Uint8Array(e)}}t.TransferFunctionModel=l,l.serializers=Object.assign(Object.assign({},o.WidgetModel.serializers),{rgba:s.ndarray});t.TransferFunctionJsBumpsModel=class extends l{constructor(...e){super(...e),this.on("change:levels",this.recalculate_rgba,this),this.on("change:opacities",this.recalculate_rgba,this),this.on("change:widths",this.recalculate_rgba,this),this.recalculate_rgba()}defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"TransferFunctionJsBumpsModel",levels:[.1,.5,.8],opacities:[.01,.05,.1],widths:[.1,.1,.1]})}recalculate_rgba(){const e=[],t=[[1,0,0],[0,1,0],[0,0,1]],n=this.get("levels"),r=this.get("widths"),i=this.get("opacities");window.rgba=e,window.tfjs=this;for(let o=0;o<256;o++){const a=o/255,s=[0,0,0,0];for(let e=0;e<n.length;e++){const o=t[e],c=Math.exp(-Math.pow(a-n[e],2)/Math.pow(r[e],2));for(let t=0;t<3;t++)s[t]+=o[t]*c*i[e];s[3]+=c*i[e]}let c=s[0];for(let e=1;e<3;e++)c=Math.max(c,s[e]);for(let e=0;e<3;e++)s[e]=Math.min(1,s[e]/c);s[3]=Math.min(1,s[3]),e.push(s)}this.set("rgba",e),this.save_changes()}};t.TransferFunctionWidgetJs3Model=class extends l{constructor(...e){super(...e),this.on("change:level1",this.recalculate_rgba,this),this.on("change:level2",this.recalculate_rgba,this),this.on("change:level3",this.recalculate_rgba,this),this.on("change:opacity1",this.recalculate_rgba,this),this.on("change:opacity2",this.recalculate_rgba,this),this.on("change:opacity3",this.recalculate_rgba,this),this.on("change:width1",this.recalculate_rgba,this),this.on("change:width2",this.recalculate_rgba,this),this.on("change:width3",this.recalculate_rgba,this),this.recalculate_rgba()}defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"TransferFunctionWidgetJs3Model",level1:.1,level2:.5,level3:.8,opacity1:.01,opacity2:.05,opacity3:.1,width1:.1,width2:.1,width3:.1})}recalculate_rgba(){let e=[];const t=[[1,0,0],[0,1,0],[0,0,1]],n=[this.get("level1"),this.get("level2"),this.get("level3")],r=[this.get("width1"),this.get("width2"),this.get("width3")],i=[this.get("opacity1"),this.get("opacity2"),this.get("opacity3")];for(let o=0;o<256;o++){const a=o/255,s=[0,0,0,0];for(let e=0;e<3;e++){const o=t[e],c=Math.exp(-Math.pow(a-n[e],2)/Math.pow(r[e],2));for(let t=0;t<3;t++)s[t]+=o[t]*c*i[e];s[3]+=c*i[e]}let c=s[0];for(let e=1;e<3;e++)c=Math.max(c,s[e]);for(let e=0;e<3;e++)s[e]=Math.min(1,s[e]/c);s[3]=Math.min(1,s[3]),e.push(s)}e=a.default(e),this.set("rgba",e),this.save_changes()}}}])}));
//# sourceMappingURL=index.js.map